{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/flexblock/source/favicon.ico","path":"favicon.ico","modified":1,"renderable":1},{"_id":"themes/flexblock/source/icons-192.png","path":"icons-192.png","modified":1,"renderable":1},{"_id":"themes/flexblock/source/icons-512.png","path":"icons-512.png","modified":1,"renderable":1},{"_id":"themes/flexblock/source/manifest.json","path":"manifest.json","modified":1,"renderable":1},{"_id":"themes/flexblock/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/flexblock/source/js/script.js","path":"js/script.js","modified":1,"renderable":1},{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"source/images/banner.jpg","path":"images/banner.jpg","modified":1,"renderable":0},{"_id":"source/images/favicon.ico","path":"images/favicon.ico","modified":1,"renderable":0},{"_id":"source/images/profile_photo.jpg","path":"images/profile_photo.jpg","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011037150.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011037150.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011055652.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011055652.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011217372.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011217372.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011231365.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011231365.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011116952.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011116952.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011540956.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011540956.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011500179.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011500179.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011644759.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011644759.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011734330.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011734330.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011822347.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011822347.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011909465.png","path":"images/DDNS到反向代理全流程.assets/image-20260117011909465.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012041843.png","path":"images/DDNS到反向代理全流程.assets/image-20260117012041843.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012048140.png","path":"images/DDNS到反向代理全流程.assets/image-20260117012048140.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012100674.png","path":"images/DDNS到反向代理全流程.assets/image-20260117012100674.png","modified":1,"renderable":0},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012257481.png","path":"images/DDNS到反向代理全流程.assets/image-20260117012257481.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_10.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_10.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_12.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_12.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_13.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_13.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_11.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_11.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_1.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_1.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_14.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_14.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_15.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_15.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_16.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_16.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_3.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_3.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_4.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_4.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_2.webp","path":"images/Git_Github_Markdown/Git_Github_Markdown_2.webp","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_5.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_5.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_6.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_6.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_7.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_7.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_8.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_8.png","modified":1,"renderable":0},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_9.png","path":"images/Git_Github_Markdown/Git_Github_Markdown_9.png","modified":1,"renderable":0},{"_id":"source/images/二级路由公网IPv6再分配.assets/image-20260115233010932.png","path":"images/二级路由公网IPv6再分配.assets/image-20260115233010932.png","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg","modified":1,"renderable":0},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg","path":"images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg","modified":1,"renderable":0}],"Cache":[{"_id":"source/CNAME","hash":"2485b9188dee393a5df820f0023bf0d31b744670","modified":1768490274790},{"_id":"source/__pycache__/push.cpython-312.pyc","hash":"4af6c75b69b0f3469b2a88f90eec3b387fc4ea93","modified":1760112432488},{"_id":"source/_data/site_info.yml","hash":"c9092603329b39b15ee8a0d0cd8a1b96cf2d1ffc","modified":1760113487648},{"_id":"source/_posts/DDNS.md","hash":"a41b499e405b8ab46b0d88185a6bb401cbf1d227","modified":1768544537892},{"_id":"source/_posts/DDNS到反向代理全流程.md","hash":"19bfa8eb0afe998ded16ae32f42c1e2b595dee8a","modified":1768584412651},{"_id":"source/_posts/Git_Github_Markdown.md","hash":"662690feebc2048e6ddb789756adf348d39043c5","modified":1768490970178},{"_id":"source/_posts/test.md","hash":"d42e930cc8b56c9a94a44c34542ad3ff505c2d78","modified":1768490967955},{"_id":"source/_posts/数据备份策略.md","hash":"5f8955783c20b55139716d518f7d8585c7cdc386","modified":1760671478156},{"_id":"source/_posts/网规论文.md","hash":"780cbd5de1679c88c56576bf562d36462672379f","modified":1762266969110},{"_id":"source/images/favicon.ico","hash":"ab420f6de20c78e8f7c395061224ca7b4057d721","modified":1760110255093},{"_id":"source/_posts/适老化——自动拨打视频和刷抖音.md","hash":"3e476edb82f84a108b9fb6051cc76077fa10bacf","modified":1768489216585},{"_id":"source/images/profile_photo.jpg","hash":"ab420f6de20c78e8f7c395061224ca7b4057d721","modified":1760110255093},{"_id":"source/_posts/二级路由公网IPv6再分配.md","hash":"4123dc4f4f978218ed35ce17a795951b2b297980","modified":1768491138889},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_15.webp","hash":"0f7264473879657019c5ae792184479b2e9880aa","modified":1761396235728},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_4.png","hash":"df32bbab4df6167a36d69d5acc8258a3929caf31","modified":1760664783059},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_5.png","hash":"ddcf629f28289031257919ced24aa9d3d469a717","modified":1760664798610},{"_id":"source/images/二级路由公网IPv6再分配.assets/image-20260115233010932.png","hash":"0913641ec1f68da72c10a55a4dde1168d51d368d","modified":1768491010962},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_2.webp","hash":"541b7c25f37b747fcfaa2a4b36e0cc55f0820d02","modified":1760598016432},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011734330.png","hash":"9c5d343dc4339c9662f04c6e02cc62edaecbf4a1","modified":1768583854353},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011644759.png","hash":"b6156669b3ba357d2574a1f218ae00670dc394bc","modified":1768583804773},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011909465.png","hash":"30d7990a124c060c26e0cc2a0254f84eb21da8b9","modified":1768583949482},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_10.png","hash":"ead416b891d5c11d2fb472b8bab99802f9b35c1b","modified":1760665023539},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_11.png","hash":"dfb7d2119cf48ef9a7cc84476328ed17dd3216c1","modified":1760665048169},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_14.webp","hash":"7a1891ac9c63dd0404a885f7e91dce11e1518433","modified":1761395600036},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_16.webp","hash":"c9eae85191a6cd7cd7f8604398fa85687d30ea08","modified":1761396062413},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_13.webp","hash":"0afe547231a7149a9b0b2698b55c1d07f13e39dc","modified":1761395577938},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_6.png","hash":"9142a369bf215af3b947adecaa15208560ec140c","modified":1760664807194},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg","hash":"a3054582a824498ec15cf31869060f0c9fcb0730","modified":1760110255096},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg","hash":"9843427a0b6ec2626890967e9ebc514c2a0084fe","modified":1760110255103},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011217372.png","hash":"a5e5de108d390b88963e517b2bd0e40095e4dffc","modified":1768583537436},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011116952.png","hash":"30267227c7dce16786b9dbe3be43fde6fa07c7f3","modified":1768583477060},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011055652.png","hash":"f825241db22a44738ad0c4e43cd1086cc116ad55","modified":1768583455781},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012257481.png","hash":"0ecdfece60c1839c7c1c916b4b04fe16e927f934","modified":1768584177547},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_3.png","hash":"3bae691085d3662300723ea5f14f51a464f1c829","modified":1760664461856},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_7.png","hash":"8455a20859c885b3764f2e77c32981f562231900","modified":1762265647633},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_1.png","hash":"7c78166cae41635f0ab9f2d7a5f4b92794490908","modified":1760608440513},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_8.png","hash":"0aebbf8c7661eefb59576314c77ea4f1b0da4e71","modified":1760664921879},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_9.png","hash":"7afc58a8123a573b20c5056d0aa7b97c37711fb4","modified":1760664978033},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011231365.png","hash":"2f5302889fde4050026226563d292a89ecd06c0b","modified":1768583551437},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011540956.png","hash":"2fa3163e1f1fa6c1cb3192d86f07300246a77e87","modified":1768583741013},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011500179.png","hash":"557ff8423fe988fe936c7e3eeeff0800e1b405ae","modified":1768583700246},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011822347.png","hash":"bcffb75095ca67fd008263358e7310f3b714f154","modified":1768583902493},{"_id":"source/images/Git_Github_Markdown/Git_Github_Markdown_12.webp","hash":"1a136f6eabe11a0fd42f618b358df3796b960979","modified":1761395519651},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg","hash":"b56aaf5a7cd7e5582ff684bb052daecd8d0a152a","modified":1760110255095},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117011037150.png","hash":"ca29a2976a8849eea1a2e69b022da18cd9762193","modified":1768583437229},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg","hash":"55427ffdb8dc59c121133c77bd889e860e4b9184","modified":1760110255100},{"_id":"themes/flexblock/.gitignore","hash":"705b1b2062454bbf1210389b79ba6e61c3534417","modified":1760110255104},{"_id":"themes/flexblock/README.md","hash":"1e27429af144fb3615cdf8d25c76a461a74e4de8","modified":1760110255104},{"_id":"themes/flexblock/.prettierrc.cjs","hash":"9916efd6945b7b22b5c550574447318f986c0799","modified":1760110255104},{"_id":"themes/flexblock/_config.yml","hash":"6d6f45a3c907dac1bc183a1e7f36982007823f55","modified":1760113960869},{"_id":"themes/flexblock/package.json","hash":"ed009741bbaec0388d2ce95a08e4cafff4dca703","modified":1760110255112},{"_id":"themes/flexblock/LICENSE","hash":"44df18c795efc5c5784abed3812b7662ad670e4c","modified":1760110255104},{"_id":"themes/flexblock/languages/de.yml","hash":"d45cea36c5c83d7d09afcd1c26fff4a4c513c25b","modified":1760110255105},{"_id":"themes/flexblock/languages/default.yml","hash":"f26a34a7983d4bc17c65c7f0f14da598e62ce66d","modified":1760110255105},{"_id":"themes/flexblock/languages/fr.yml","hash":"8cb0fe4b6913b4d5b662cdd0108a923c90025f85","modified":1760110255105},{"_id":"themes/flexblock/languages/ko.yml","hash":"11330316e3c1262474a2b496e40dbc29f93fe01b","modified":1760110255105},{"_id":"themes/flexblock/languages/es.yml","hash":"e3b4937da4cd2d0393b8a0ba310e70fc605cc431","modified":1760110255105},{"_id":"themes/flexblock/languages/nl.yml","hash":"3d82ec703d0b3287739d7cb4750a715ae83bfcb3","modified":1760110255105},{"_id":"themes/flexblock/languages/ja.yml","hash":"3e2fedca096678c0c234ebffa4637828979296fa","modified":1760110255105},{"_id":"themes/flexblock/languages/no.yml","hash":"ddf2035e920a5ecb9076138c184257d9f51896a7","modified":1760110255106},{"_id":"themes/flexblock/languages/pt.yml","hash":"ae2c61b30e638f74f1a42c9ce39ac08d063b30f5","modified":1760110255106},{"_id":"themes/flexblock/languages/zh-CN.yml","hash":"fb8f221242b3997833189f11cd14407a867de3b8","modified":1760110255106},{"_id":"themes/flexblock/languages/ru.yml","hash":"2a476b4c6e04900914c81378941640ac5d58a1f0","modified":1760110255106},{"_id":"themes/flexblock/languages/zh-TW.yml","hash":"f5f0ca88185da7a8457760d84bf221781473bd7c","modified":1760110255106},{"_id":"themes/flexblock/layout/archive.ejs","hash":"4d7b10afd09db8960ee27d6809c5bb0312eb0b6f","modified":1760110255110},{"_id":"themes/flexblock/layout/category.ejs","hash":"5551f6309ac4f835bd135ebb35fd40ba961f09b3","modified":1760110255110},{"_id":"themes/flexblock/layout/index.ejs","hash":"b2d5cf681e351c2cdfd5f549bddc4f428812fd36","modified":1760110255110},{"_id":"themes/flexblock/layout/layout.ejs","hash":"1ec02f1349251fc68943d2f84050c18d063f8939","modified":1760110255112},{"_id":"themes/flexblock/layout/page.ejs","hash":"4aaf6496c9e4c61355bbed51ea0bf15023d8bcf3","modified":1760110255112},{"_id":"themes/flexblock/layout/post.ejs","hash":"f4de584f9181669b301e43c4f30439f57c959108","modified":1760110255112},{"_id":"themes/flexblock/scripts/index.js","hash":"a77000771288f129de0b62e5436ee299d66c094a","modified":1760110255117},{"_id":"themes/flexblock/layout/tag.ejs","hash":"4621d964e6505fdc19ae270918ea08356cc5c789","modified":1760110255112},{"_id":"themes/flexblock/source/favicon.ico","hash":"cd1b610096d9c5c780fd2a7e24baaa78dada3163","modified":1760110255120},{"_id":"themes/flexblock/source/icons-192.png","hash":"8cd106d9039f1d5aa8163ecd4a5e352058a0f6cf","modified":1760110255120},{"_id":"themes/flexblock/source/manifest.json","hash":"6689646167bbe5bc836615a0c2019ea9aaa9e015","modified":1760110255120},{"_id":"themes/flexblock/.github/workflows/npm-publish.yml","hash":"5e3e009558334172a96f95ba6ac3badfc6b0e78d","modified":1760110255104},{"_id":"themes/flexblock/layout/_partial/archive-article-list.ejs","hash":"37fd5017d849cd57b81f58a64eac5fbfd55de073","modified":1760110255106},{"_id":"themes/flexblock/layout/_partial/article-list.ejs","hash":"7bc89e7b22554bf5f940a1d49ce1f2b7097c8dd1","modified":1760110255106},{"_id":"themes/flexblock/layout/_partial/content.ejs","hash":"361c043b7c43e20a46cea15154a0a403118c4847","modified":1760110255107},{"_id":"themes/flexblock/layout/_partial/footer-other.ejs","hash":"9e93e20f3e3ded687abe00a6478e3c4dbfff479e","modified":1760110255107},{"_id":"themes/flexblock/layout/_partial/footer.ejs","hash":"973582f37cdcc7a4317c1b3f2b7ca5e9f7bc888e","modified":1760114492885},{"_id":"themes/flexblock/layout/_partial/header.ejs","hash":"66454b5be35946c4a1e82a597d177476b8f1e88f","modified":1760111551235},{"_id":"themes/flexblock/layout/_partial/footer-script.ejs","hash":"1e5a6a358e23a430161610148253250da4aeee28","modified":1760110255107},{"_id":"themes/flexblock/layout/_partial/pagination.ejs","hash":"22d60f90cf93b7a80ab1dc044fbf5808a723872a","modified":1760110255108},{"_id":"themes/flexblock/layout/_partial/page.ejs","hash":"d8cee30f5585ba3c4873e918d238803ae6e9869f","modified":1760110255107},{"_id":"themes/flexblock/layout/_widget/archive-year-card.ejs","hash":"a4d44afb5e403ebc4d6ea45b7c32927684927e09","modified":1760110255109},{"_id":"themes/flexblock/layout/_partial/nav.ejs","hash":"e58516a49b3997d9f2fe2bcd6bcced97b3e6ecd6","modified":1760110255107},{"_id":"themes/flexblock/layout/_widget/article-nav.ejs","hash":"8df3b527e6153323c8ded33768bd5e5267dfa422","modified":1760110255109},{"_id":"themes/flexblock/layout/_widget/category.ejs","hash":"04ce3963213a8bdc446585b8b68c360f7c752b4d","modified":1760110255109},{"_id":"themes/flexblock/layout/_widget/comment.ejs","hash":"6516d13e8de17f33932197acd17e70fbb6441dc2","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/date.ejs","hash":"5c275ec71f7ce628599683393ae71cf95196f71f","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/updated.ejs","hash":"7ce6c7f3d22f7c394cf43f4f4b893dabc9503e83","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/widget-author.ejs","hash":"275895bf6688dce4d3219967a0260071c7a45752","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/widget-notice.ejs","hash":"0a1ec45028b2abd123bb6a96017168fd55759971","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/widget-categories.ejs","hash":"8b2453ac3b229ef1c242c063c926b63e9cac7b85","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/tag.ejs","hash":"2a1642735fe62363cee1eeeb09a3d36c2e8ac00e","modified":1760110255110},{"_id":"themes/flexblock/layout/_widget/widget-tags.ejs","hash":"aab2e0046e64f30ee7763ab128419430d712c4f5","modified":1760675722363},{"_id":"themes/flexblock/layout/_svg/icon-article.svg","hash":"f89ab250586cf0bd8108b77e48a5288f1d0dd512","modified":1760110255108},{"_id":"themes/flexblock/layout/_widget/widget-toc.ejs","hash":"0607e05641735d1fea7c74bc3c5b5f41f3bfb16f","modified":1760110255110},{"_id":"themes/flexblock/layout/_svg/icon-tags.svg","hash":"0d974ce6d089d08ef009ad56d1b5d66bf9c2c1e6","modified":1760110255108},{"_id":"themes/flexblock/layout/_svg/icon-categories.svg","hash":"cfe4012051132281255e211c28971e05726cdc43","modified":1760110255108},{"_id":"themes/flexblock/layout/_svg/icon-toc.svg","hash":"05d2eecfb27deade461f25b2a396c230e18cd6b4","modified":1760110255108},{"_id":"themes/flexblock/layout/_svg/social-github.svg","hash":"880c135b980866f77047cd4507f5bf8671934333","modified":1760110255108},{"_id":"themes/flexblock/layout/_svg/social-ins.svg","hash":"aad8cb2136a7c8af682d9c9dae726b80ee1b57dd","modified":1760110255109},{"_id":"themes/flexblock/layout/_svg/social-twitter.svg","hash":"acb180ecf694e6b91a309e9247d691200f5540ac","modified":1760110255109},{"_id":"themes/flexblock/layout/_svg/icon-notice.svg","hash":"0d2f705ca65673eda3d38420aa512d83fcbc1e72","modified":1760110255108},{"_id":"themes/flexblock/layout/_svg/social-weibo.svg","hash":"a10c19805388d60e9532a44db09f4d117fb4f1cf","modified":1760110255109},{"_id":"themes/flexblock/layout/_svg/social-zhihu.svg","hash":"9f46e99ec2a82ab4d85f38a6771378cddd83a70a","modified":1760110255109},{"_id":"themes/flexblock/layout/plug-in/bilibili-emoji.ejs","hash":"221c1bdf75e63a832b4deb1d47db288918075da3","modified":1760110255112},{"_id":"themes/flexblock/layout/plug-in/clipboard.ejs","hash":"335014c6a3eb368ffae9a96914c138a4cdc35d3a","modified":1760110255112},{"_id":"themes/flexblock/layout/plug-in/aplayer.ejs","hash":"4bedc5293b4a2a990fe3e0cedc909ae23c3a110e","modified":1760110255112},{"_id":"themes/flexblock/layout/plug-in/mathjax.ejs","hash":"b105462c607e927f342d1110176d4151149abf1c","modified":1760110255112},{"_id":"themes/flexblock/layout/plug-in/dplayer.ejs","hash":"e760becec354b5096dcc706a3b14ef9ea81d8a12","modified":1760110255112},{"_id":"themes/flexblock/source/css/style.styl","hash":"c56dc27939e0ca92b2e3f3e6119eeb654a198ec6","modified":1760110255119},{"_id":"themes/flexblock/source/css/_partial/card.styl","hash":"bf3fd3d7a2ecb6f5fb0e53983b1ed7bfaf62e0da","modified":1760110255118},{"_id":"themes/flexblock/source/css/_partial/footer.styl","hash":"11cf25e1999463aeec061c23ca7d32ee7dbc783d","modified":1760110255118},{"_id":"themes/flexblock/source/js/script.js","hash":"86d4097694c1f7eae89d8d7a527de86bb73a5173","modified":1760110255120},{"_id":"themes/flexblock/source/css/_partial/content.styl","hash":"e0450ecdbb3ad6ba0e6b5875dbc62bcc52eafce9","modified":1760110255118},{"_id":"themes/flexblock/source/css/_partial/header.styl","hash":"8e0b53e4bebfc120e2301e9b852bef5406afbd9c","modified":1760110255118},{"_id":"themes/flexblock/source/css/_partial/page.styl","hash":"f35fed107fd20716b33c6216f4fe0b8188058b6c","modified":1760675269955},{"_id":"themes/flexblock/source/css/_partial/pagination.styl","hash":"268bb486fc8682aa7e8e2417211c84cd1d5da264","modified":1760110255119},{"_id":"themes/flexblock/source/css/_partial/nav.styl","hash":"891257e01cc805a5cfbf7298b44f24616a22d8fb","modified":1760110255118},{"_id":"themes/flexblock/source/css/_util/mixins.styl","hash":"2189d5e686410ecc79c4e8e357dc0737965d295d","modified":1760110255119},{"_id":"themes/flexblock/source/css/_util/variables.styl","hash":"c185d9a94f9894b6430757af5fe1c0d38c665fe5","modified":1760110255119},{"_id":"themes/flexblock/source/css/_util/theme.styl","hash":"68fea7a3bf7d2e5cad165fb096efa74bcc8f3023","modified":1760110255119},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg","hash":"44adfd0dd623e20173075814c6a256945ca895b3","modified":1760110255098},{"_id":"source/images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg","hash":"e40339007fc105bbbac2306d76f1264ac09cd4d4","modified":1760110255102},{"_id":"themes/flexblock/source/icons-512.png","hash":"c2cd59a7712738831ee0cca4338343d407777a4b","modified":1760110255120},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012100674.png","hash":"d81c79a675163922033cfb996393769615ed815e","modified":1768584060812},{"_id":"themes/flexblock/screenshots/flex-block--post.jpeg","hash":"bc607db875e42fe2c82ed5130c07d67cca5adc41","modified":1760110255116},{"_id":"themes/flexblock/screenshots/flex-block--home.jpeg","hash":"7f6c738298108020ab2e4918592007a2d4bcb9d8","modified":1760110255114},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012041843.png","hash":"bc026e7cdb8dce427e886b9804e6ca31af62525a","modified":1768584041959},{"_id":"source/images/DDNS到反向代理全流程.assets/image-20260117012048140.png","hash":"31b3171fe4413dcd90c9baf14052abb152eb9304","modified":1768584048305},{"_id":"themes/flexblock/screenshots/flex-block.png","hash":"93a5456d4f3a51f5e9fd4a957b85584273083fe6","modified":1760110255117},{"_id":"source/images/banner.jpg","hash":"373ab4916d13f47630719f164866fd4efa2c6f2e","modified":1760110255093},{"_id":"public/2026/01/17/DDNS到反向代理全流程/index.html","hash":"0ecf66c5b927f252ec9606269d288bc62bb612a4","modified":1768584443851},{"_id":"public/2026/01/15/二级路由公网IPv6再分配/index.html","hash":"fa830349b6f535c7ca96cbbd05a6ce9c54bee065","modified":1768584443851},{"_id":"public/2025/12/09/DDNS/index.html","hash":"2e62d6d5a85092a7826db79a17ce7d84805d203b","modified":1768584443851},{"_id":"public/2025/11/04/网规论文/index.html","hash":"3edf78dd0bc35e74aec632496194423a03b7d810","modified":1768584443851},{"_id":"public/2025/10/17/Git_Github_Markdown/index.html","hash":"ea650aa5492ebb2715d5142d0c1b02c13809e4c8","modified":1768584443851},{"_id":"public/2025/08/04/数据备份策略/index.html","hash":"8b1195ad360020c95a67a90bf5cf25664be7e31d","modified":1768584443851},{"_id":"public/2025/10/10/适老化——自动拨打视频和刷抖音/index.html","hash":"a4dec136e8211b591c9c5b32c7173d8bc132db8b","modified":1768584443851},{"_id":"public/2025/08/04/test/index.html","hash":"ce63c7337dbf606a56327a35844f3fd98d8155c0","modified":1768584443851},{"_id":"public/archives/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2025/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2025/10/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2025/08/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2025/11/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2025/12/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/archives/2026/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/index.html","hash":"ec662390cab06f7b17b0aa20019404f4318fd816","modified":1768584443851},{"_id":"public/archives/2026/01/index.html","hash":"1d11f1380d5f232e277a1030f030b570c89a8136","modified":1768584443851},{"_id":"public/categories/学习笔记/index.html","hash":"1355960f1d10950fe9374f4510e5b14682b1443c","modified":1768584443851},{"_id":"public/tags/教程/index.html","hash":"d4c1d4c56660b8b6dac2ebea09454b0d6ea5a387","modified":1768584443851},{"_id":"public/tags/技术/index.html","hash":"d2845a795e67eef6be6925f0dac0aeeb42494adb","modified":1768584443851},{"_id":"public/tags/Openwrt/index.html","hash":"cc5e0c1a99846ebee1c9353b0340c156a0133208","modified":1768584443851},{"_id":"public/tags/Hexo/index.html","hash":"b329413f710fd5edca22724b1c831791d9971638","modified":1768584443851},{"_id":"public/tags/博客/index.html","hash":"f80f74d32f06a497c1f9584a760e945ddb109cc7","modified":1768584443851},{"_id":"public/tags/c/index.html","hash":"ed6b976de99054385d617743d461898562462897","modified":1768584443851},{"_id":"public/favicon.ico","hash":"cd1b610096d9c5c780fd2a7e24baaa78dada3163","modified":1768584443851},{"_id":"public/icons-192.png","hash":"8cd106d9039f1d5aa8163ecd4a5e352058a0f6cf","modified":1768584443851},{"_id":"public/CNAME","hash":"2485b9188dee393a5df820f0023bf0d31b744670","modified":1768584443851},{"_id":"public/images/favicon.ico","hash":"ab420f6de20c78e8f7c395061224ca7b4057d721","modified":1768584443851},{"_id":"public/images/profile_photo.jpg","hash":"ab420f6de20c78e8f7c395061224ca7b4057d721","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_15.webp","hash":"0f7264473879657019c5ae792184479b2e9880aa","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_4.png","hash":"df32bbab4df6167a36d69d5acc8258a3929caf31","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_2.webp","hash":"541b7c25f37b747fcfaa2a4b36e0cc55f0820d02","modified":1768584443851},{"_id":"public/images/二级路由公网IPv6再分配.assets/image-20260115233010932.png","hash":"0913641ec1f68da72c10a55a4dde1168d51d368d","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_5.png","hash":"ddcf629f28289031257919ced24aa9d3d469a717","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011734330.png","hash":"9c5d343dc4339c9662f04c6e02cc62edaecbf4a1","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011909465.png","hash":"30d7990a124c060c26e0cc2a0254f84eb21da8b9","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011644759.png","hash":"b6156669b3ba357d2574a1f218ae00670dc394bc","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_10.png","hash":"ead416b891d5c11d2fb472b8bab99802f9b35c1b","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_11.png","hash":"dfb7d2119cf48ef9a7cc84476328ed17dd3216c1","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_16.webp","hash":"c9eae85191a6cd7cd7f8604398fa85687d30ea08","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_14.webp","hash":"7a1891ac9c63dd0404a885f7e91dce11e1518433","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_13.webp","hash":"0afe547231a7149a9b0b2698b55c1d07f13e39dc","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_6.png","hash":"9142a369bf215af3b947adecaa15208560ec140c","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg","hash":"a3054582a824498ec15cf31869060f0c9fcb0730","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg","hash":"9843427a0b6ec2626890967e9ebc514c2a0084fe","modified":1768584443851},{"_id":"public/css/style.css","hash":"1c7fa28ec78c0544e774fdf644acbfb8430aa479","modified":1768584443851},{"_id":"public/js/script.js","hash":"6fa1c2eb3da6152e6f7d8e1a2949f51553a5c745","modified":1768584443851},{"_id":"public/manifest.json","hash":"70ae21c5c320fbc0df5922a4baf3fa73d5343959","modified":1768584443851},{"_id":"public/icons-512.png","hash":"c2cd59a7712738831ee0cca4338343d407777a4b","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011055652.png","hash":"f825241db22a44738ad0c4e43cd1086cc116ad55","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011217372.png","hash":"a5e5de108d390b88963e517b2bd0e40095e4dffc","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011116952.png","hash":"30267227c7dce16786b9dbe3be43fde6fa07c7f3","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117012257481.png","hash":"0ecdfece60c1839c7c1c916b4b04fe16e927f934","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_1.png","hash":"7c78166cae41635f0ab9f2d7a5f4b92794490908","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_3.png","hash":"3bae691085d3662300723ea5f14f51a464f1c829","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_8.png","hash":"0aebbf8c7661eefb59576314c77ea4f1b0da4e71","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_7.png","hash":"8455a20859c885b3764f2e77c32981f562231900","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_9.png","hash":"7afc58a8123a573b20c5056d0aa7b97c37711fb4","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011231365.png","hash":"2f5302889fde4050026226563d292a89ecd06c0b","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011540956.png","hash":"2fa3163e1f1fa6c1cb3192d86f07300246a77e87","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011500179.png","hash":"557ff8423fe988fe936c7e3eeeff0800e1b405ae","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011822347.png","hash":"bcffb75095ca67fd008263358e7310f3b714f154","modified":1768584443851},{"_id":"public/images/Git_Github_Markdown/Git_Github_Markdown_12.webp","hash":"1a136f6eabe11a0fd42f618b358df3796b960979","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg","hash":"b56aaf5a7cd7e5582ff684bb052daecd8d0a152a","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117011037150.png","hash":"ca29a2976a8849eea1a2e69b022da18cd9762193","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg","hash":"55427ffdb8dc59c121133c77bd889e860e4b9184","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg","hash":"44adfd0dd623e20173075814c6a256945ca895b3","modified":1768584443851},{"_id":"public/images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg","hash":"e40339007fc105bbbac2306d76f1264ac09cd4d4","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117012100674.png","hash":"d81c79a675163922033cfb996393769615ed815e","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117012041843.png","hash":"bc026e7cdb8dce427e886b9804e6ca31af62525a","modified":1768584443851},{"_id":"public/images/DDNS到反向代理全流程.assets/image-20260117012048140.png","hash":"31b3171fe4413dcd90c9baf14052abb152eb9304","modified":1768584443851},{"_id":"public/images/banner.jpg","hash":"373ab4916d13f47630719f164866fd4efa2c6f2e","modified":1768584443851}],"Category":[{"name":"学习笔记","_id":"cmkh5iivl000224j3f85q2bmk"}],"Data":[{"_id":"site_info","data":{"site_title":"shiranzby","banner":"/images/banner.jpg","favicon":"/images/favicon.ico","profile":"/images/profile_photo.jpg","author_name":"shiranzby","author_description":"释然","notice":"知不可乎骤得，\n托遗响于悲风。             \n","social":{"github":"https://github.com/shiranzby","cool":"http://www.coolapk.com/u/18690800"},"friend_links":[{"name":"miiiku","url":"https://github.com/miiiku"},{"name":"Guanquan","url":"https://twitter.com/guanquanhong"}]}}],"Page":[],"Post":[{"title":"路由器DDNS到域名访问服务全流程","date":"2026-01-16T17:26:00.000Z","_content":"\n\n## 分为两种情况\n\n**只需要HTTP基础访问功能**\n**需要HTTPS加密访问**\n\n### 只需要HTTP访问（非加密）\n\n#### 注册免费域名\n\n[免费域名注册](my.dnshe.com)\n\n默认可免费注册三个\n\n如果只需要HTTP访问则需要拿到API\n\nAPI要求有五个免费域名\n\n需要要求两个好友才能拿到五个\n\n\n\n记录下API Key和API Secret\n\n\n\n#### Openwrt安装动态DNS\n\n在系统 软件包 查找**luci-app-ddns、luci-i18n-ddns-zh-cn**安装\n\n安装好后刷新页面\n\n登录到路由器的 SSH（或使用 TTYD 终端），输入下面命令一键部署脚本\n\n\n\n```bash\n# ===================== 第一步：更新opkg源 =====================\necho \"==== 开始更新opkg软件源 ====\"\nopkg update\n\n# ===================== 第二步：安装DDNS核心插件及中文语言包 =====================\necho -e \"\\n==== 开始安装luci-app-ddns及中文语言包 ====\"\nopkg install luci-app-ddns luci-i18n-ddns-zh-cn\n\n# ===================== 第三步：创建DDNS脚本目录并写入自定义脚本 =====================\necho -e \"\\n==== 开始创建并写入DNSHE DDNS脚本 ====\"\n# 确保脚本目录存在\nmkdir -p /usr/lib/ddns\n\n# 写入自定义脚本（用户配置区置顶，日志位置说明紧随其后）\ncat > /usr/lib/ddns/dnshe-update.sh << 'EOF'\n#!/bin/sh\n\n# ==============================================================================\n# OpenWrt Production DDNS Script for dnshe.com\n# 功能：1. 兼容DNSHE的name存储规则（完整域名）；2. 根域名匹配@和完整域名；\n#       3. 子域名匹配拆分后的记录名和完整域名；4. 不做IP优化，保留完整IPv6；\n# ==============================================================================\n\n# --- [用户配置区] ---\nDDNS_SERVICE_NAME=\"myddns_ipv6\"  # UCI ddns服务名称（必须与DDNS Luci界面一致）\nAPI_URL=\"https://api005.dnshe.com/index.php?m=domain_hub\"\n\n# ==============================================================================\n# --- [环境初始化] ---\n. /lib/functions.sh\n. /lib/functions/network.sh\n\n# 工具路径\nCURL=\"/usr/bin/curl\"\nJSONFILTER=\"/usr/bin/jsonfilter\"\nLOGGER=\"/usr/bin/logger\"\nMKDIR=\"/bin/mkdir\"\nDATE=\"/bin/date\"\nRM=\"/bin/rm\"\nMV=\"/bin/mv\"\nAWK=\"/usr/bin/awk\"\n\n# 日志配置\nSCRIPT_NAME=$(basename \"$0\")\nSCRIPT_BASE=\"${SCRIPT_NAME%.*}\"\nLOG_DIR=\"/var/log/ddns\"\nLOG_FILE_PERSIST=\"$LOG_DIR/${SCRIPT_BASE}.log\"\nLOG_FILE_TMP=\"/tmp/${SCRIPT_BASE}_last_run.log\"\n\n# 日志轮转\nrotate_logs() {\n    [ -f \"${LOG_FILE_PERSIST}.2\" ] && $RM \"${LOG_FILE_PERSIST}.2\"\n    [ -f \"${LOG_FILE_PERSIST}.1\" ] && $MV \"${LOG_FILE_PERSIST}.1\" \"${LOG_FILE_PERSIST}.2\"\n    [ -f \"${LOG_FILE_PERSIST}\" ]   && $MV \"${LOG_FILE_PERSIST}\" \"${LOG_FILE_PERSIST}.1\"\n    echo \"=== [$(date '+%Y-%m-%d %H:%M:%S')] 新的执行开始 ===\" > \"$LOG_FILE_PERSIST\"\n    echo \"=== [$(date '+%Y-%m-%d %H:%M:%S')] 新的执行开始 ===\" > \"$LOG_FILE_TMP\"\n}\n\n# 日志函数\nwrite_log() {\n    local timestamp=$($DATE '+%H:%M:%S')\n    local msg=\"[$timestamp] $1\"\n    $LOGGER -t \"ddns-$SCRIPT_BASE\" \"$1\"\n    echo \"$msg\" >> \"$LOG_FILE_PERSIST\"\n    echo \"$msg\" >> \"$LOG_FILE_TMP\"\n    echo \"$msg\"\n}\n\n# ==============================================================================\n# --- [核心：自动拆分域名（子域名→实例+记录名）] ---\nsplit_domain() {\n    local input_domain=\"$1\"  # 传入的完整域名（如zby.shyhome.cc.cd/shyhome.cc.cd）\n    \n    # 步骤1：获取DNSHE后台所有subdomain实例\n    local subdomains_res=$($CURL -k -s -X GET \"$API_URL&endpoint=subdomains&action=list\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\")\n    \n    # 步骤2：遍历所有实例，匹配input_domain所属的根实例\n    local subdomain_list=$(echo \"$subdomains_res\" | $JSONFILTER -e \"@.subdomains[*].full_domain\")\n    for instance in $subdomain_list; do\n        # 匹配规则：input_domain以instance结尾（如zby.shyhome.cc.cd 以 shyhome.cc.cd 结尾）\n        if echo \"$input_domain\" | grep -q \"\\.$instance$\"; then\n            SUBDOMAIN_INSTANCE=\"$instance\"  # 根实例（如shyhome.cc.cd）\n            # 拆分记录名（zby.shyhome.cc.cd → zby）\n            RECORD_NAME=$(echo \"$input_domain\" | sed \"s/\\.${instance}$//\")\n            TARGET_FULL_DOMAIN=\"$input_domain\"  # 子域名完整域名\n            write_log \"  域名拆分成功: 根实例[$SUBDOMAIN_INSTANCE] | 记录名[$RECORD_NAME] | 完整域名[$TARGET_FULL_DOMAIN]\"\n            return 0\n        fi\n    done\n    \n    # 步骤3：如果是根域名（无匹配则input_domain本身就是实例）\n    SUBDOMAIN_INSTANCE=\"$input_domain\"\n    RECORD_NAME=\"@\"\n    TARGET_FULL_DOMAIN=\"$input_domain\"  # 根域名完整域名\n    write_log \"  检测到根域名: 根实例[$SUBDOMAIN_INSTANCE] | 记录名[$RECORD_NAME] | 完整域名[$TARGET_FULL_DOMAIN]\"\n}\n\n# ==============================================================================\n# --- [匹配Record ID（兼容DNSHE的name存储规则）] ---\nget_target_record_id() {\n    local records_json=\"$1\"\n    local record_name=\"$2\"\n    local full_domain=\"$3\"\n    \n    # 初始化Record ID\n    RECORD_ID=\"\"\n    \n    # 第一步：匹配记录名=record_name（如zby/@）\n    RECORD_ID=$(echo \"$records_json\" | $JSONFILTER -e \"@.records[@.type='AAAA' && @.name='$record_name'].id\")\n    if [ -n \"$RECORD_ID\" ]; then\n        write_log \"  匹配到记录名=$record_name的记录，ID: $RECORD_ID\"\n        return 0\n    fi\n    \n    # 第二步：匹配记录名=完整域名（DNSHE实际存储的格式）\n    RECORD_ID=$(echo \"$records_json\" | $JSONFILTER -e \"@.records[@.type='AAAA' && @.name='$full_domain'].id\")\n    if [ -n \"$RECORD_ID\" ]; then\n        write_log \"  匹配到记录名=$full_domain的记录（DNSHE存储格式），ID: $RECORD_ID\"\n        return 0\n    fi\n    \n    # 第三步：未匹配到\n    write_log \"  未发现目标记录（记录名=$record_name 或 $full_domain），准备新建\"\n}\n\n# ==============================================================================\n# --- [初始化] ---\n[ ! -d \"$LOG_DIR\" ] && $MKDIR -p \"$LOG_DIR\"\nrotate_logs\n\n# ==============================================================================\n# --- [核心逻辑] ---\nwrite_log \"步骤 1: 环境检查与工具验证...\"\nif [ ! -x \"$CURL\" ]; then write_log \"错误: 找不到 curl 工具\"; exit 1; fi\nif [ ! -x \"$JSONFILTER\" ]; then write_log \"错误: 找不到 jsonfilter 工具\"; exit 1; fi\n\nwrite_log \"步骤 2: 获取参数...\"\n# 优先从环境变量获取（DDNS传参：$1=KEY, $2=SECRET, $3=DOMAIN, $4=IP）\nMY_KEY=\"${username:-$__USERNAME}\"\n[ -z \"$MY_KEY\" ] && MY_KEY=\"$1\"\n\nMY_SECRET=\"${password:-$__PASSWORD}\"\n[ -z \"$MY_SECRET\" ] && MY_SECRET=\"$2\"\n\nMY_DOMAIN=\"${domain:-$__DOMAIN}\"\n[ -z \"$MY_DOMAIN\" ] && MY_DOMAIN=\"$3\"\n\nMY_IP=\"${__IP:-$4}\"\n\n# 灾难恢复机制\ncase \"$MY_KEY\" in\n    *:*|*.*) \n        write_log \"警告: 检测到参数错乱 (Key 似 IP)，启动灾难恢复机制...\"\n        write_log \"正在从 UCI 配置 'ddns.$DDNS_SERVICE_NAME' 强制读取参数...\"\n        MY_KEY=$(uci get ddns.$DDNS_SERVICE_NAME.username 2>/dev/null)\n        MY_SECRET=$(uci get ddns.$DDNS_SERVICE_NAME.password 2>/dev/null)\n        MY_DOMAIN=$(uci get ddns.$DDNS_SERVICE_NAME.domain 2>/dev/null)\n        ;;\nesac\n\n# 仅清洗IP格式（去除换行符），不做任何前缀提取/优化\nMY_IP=$(echo \"$MY_IP\" | tr -d '\\n\\r')\n# 二次补救 IP\nif [ -z \"$MY_IP\" ]; then\n    case \"$1\" in *:*) MY_IP=\"$1\" ;; esac\nfi\n\n# 记录参数 (敏感信息打码)\nwrite_log \"参数确认:\"\nwrite_log \"  - API Key: ${MY_KEY:0:6}******\"\nwrite_log \"  - 目标域名 : $MY_DOMAIN\"\nwrite_log \"  - Target IP: $MY_IP\" # 完整保留获取到的IPv6地址\n\nif [ -z \"$MY_KEY\" ] || [ -z \"$MY_SECRET\" ] || [ -z \"$MY_DOMAIN\" ] || [ -z \"$MY_IP\" ]; then\n    write_log \"致命错误: 必要参数缺失\"\n    exit 1\nfi\n\n# ==============================================================================\n# --- [自动拆分域名] ---\nwrite_log \"步骤 3: 自动拆分域名...\"\nsplit_domain \"$MY_DOMAIN\"\n\n# 获取根实例的Subdomain ID\nSUBDOMAIN_RES=$($CURL -k -s -X GET \"$API_URL&endpoint=subdomains&action=list\" \\\n  -H \"X-API-Key: $MY_KEY\" \\\n  -H \"X-API-Secret: $MY_SECRET\")\nSUBDOMAIN_ID=$(echo \"$SUBDOMAIN_RES\" | $JSONFILTER -e \"@.subdomains[@.full_domain='$SUBDOMAIN_INSTANCE'].id\")\n\nif [ -z \"$SUBDOMAIN_ID\" ]; then\n    write_log \"错误: 未能提取 Subdomain ID，请检查域名[$SUBDOMAIN_INSTANCE]是否在账号下\"\n    exit 1\nfi\nwrite_log \"  获取成功，Subdomain ID: $SUBDOMAIN_ID | 根实例: $SUBDOMAIN_INSTANCE\"\n\n# ==============================================================================\n# --- [获取Record ID（兼容DNSHE存储规则）] ---\nwrite_log \"步骤 4: 获取 Record ID (现有记录)...\"\nRECORDS_RES=$($CURL -k -s -X GET \"$API_URL&endpoint=dns_records&action=list&subdomain_id=$SUBDOMAIN_ID\" \\\n  -H \"X-API-Key: $MY_KEY\" \\\n  -H \"X-API-Secret: $MY_SECRET\")\nwrite_log \"  API 响应: $RECORDS_RES\"\n\n# 匹配Record ID（兼容DNSHE的name存储规则）\nget_target_record_id \"$RECORDS_RES\" \"$RECORD_NAME\" \"$TARGET_FULL_DOMAIN\"\n\nif [ -n \"$RECORD_ID\" ]; then\n    ACTION_TYPE=\"update\" # 更新现有记录\nelse\n    ACTION_TYPE=\"create\" # 新建记录\nfi\n\n# ==============================================================================\n# --- [执行更新/创建] ---\nwrite_log \"步骤 5: 执行操作 ($ACTION_TYPE)...\"\nif [ \"$ACTION_TYPE\" = \"update\" ]; then\n    # 更新现有记录（覆盖旧IP）\n    JSON_PAYLOAD=$(printf '{\"record_id\": %d, \"name\": \"%s\", \"content\": \"%s\", \"ttl\": 600}' \"$RECORD_ID\" \"$RECORD_NAME\" \"$MY_IP\")\n    FINAL_RES=$($CURL -k -s -X POST \"$API_URL&endpoint=dns_records&action=update\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\" \\\n      -H \"Content-Type: application/json\" \\\n      -d \"$JSON_PAYLOAD\")\nelse\n    # 新建记录（使用拆分后的记录名）\n    JSON_PAYLOAD=$(printf '{\"subdomain_id\": %d, \"type\": \"AAAA\", \"name\": \"%s\", \"content\": \"%s\", \"ttl\": 600}' \"$SUBDOMAIN_ID\" \"$RECORD_NAME\" \"$MY_IP\")\n    FINAL_RES=$($CURL -k -s -X POST \"$API_URL&endpoint=dns_records&action=create\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\" \\\n      -H \"Content-Type: application/json\" \\\n      -d \"$JSON_PAYLOAD\")\nfi\n\nwrite_log \"  Payload: $JSON_PAYLOAD\"\nwrite_log \"  API 最终响应: $FINAL_RES\"\n\n# ==============================================================================\n# --- [结果判定] ---\nIS_SUCCESS=$(echo \"$FINAL_RES\" | $JSONFILTER -e \"@.success\")\n\nif [ \"$IS_SUCCESS\" = \"true\" ]; then\n    write_log \"步骤 6: 结果判定 -> 成功！\"\n    write_log \"=== 脚本执行结束 (Success) ===\"\n    exit 0\nelse\n    write_log \"步骤 6: 结果判定 -> 失败！错误信息: $FINAL_RES\"\n    write_log \"=== 脚本执行结束 (Failed) ===\"\n    exit 1\nfi\nEOF\n\n# ===================== 第四步：给脚本添加可执行权限 =====================\necho -e \"\\n==== 给DNSHE DDNS脚本添加执行权限 ====\"\nchmod +x /usr/lib/ddns/dnshe-update.sh\n\n# ===================== 第五步：验证安装和脚本创建结果 =====================\necho -e \"\\n==== 验证结果 ====\"\necho \"1. DDNS插件安装状态：\"\nopkg list-installed | grep ddns\necho -e \"\\n2. 脚本文件及权限：\"\nls -l /usr/lib/ddns/dnshe-update.sh\necho -e \"\\n==== 所有操作完成！====\n- DDNS插件已安装并支持中文\n- DNSHE自定义脚本已创建：/usr/lib/ddns/dnshe-update.sh\n- 脚本已赋予执行权限\n- 日志文件位置：/var/log/ddns/dnshe-update.log（持久）/tmp/dnshe-update_last_run.log（临时）\"\n```\n\n#### 配置 LuCI 界面\n\n回到 OpenWrt 界面（`服务项 » 动态DNS  » myddns_ipv6`），按照以下方式填空：\n\n**基础设置**\n\n- **勾选已启用**\n- **域名**: `yourhost.example.com` (填写你的实际完整域名，必须要在你的 API 账号里已经存在)\n- **IP 地址版本**: `IPv6`\n- **DDNS 服务提供商 [IPv4/IPv6]**: 选择 `自定义` \n- **自定义更新 URL**: (留空，不要填)\n- **自定义更新脚本**: `/etc/ddns/update_dnshe_ipv6.sh`\n- **用户名**: 填写你的 **API Key**\n- **密码**:  填写你的 **API Secret**\n- **使用 HTTPS**: (如果脚本不工作，可以尝试取消勾选，但在脚本模式下这个选项通常只影响 wget/curl 库的选择，脚本里我们强制用了 curl，所以这个选项影响不大，建议勾选)\n- **CA证书路径:** 默认留空，会自动填入IGNORE\n\n**高级设置**\n\n- **IP地址来源：**网络\n- **网络：**wan6（有ipv6的）\n- **勾选记录日志到文件**\n- 其余默认\n\n**定时器设定**\n\n- **检查间隔：**10\n- **检查间隔单位：**分钟\n- **强制更新间隔：**3\n- **强制更新间隔单位**：天\n- 其余默认\n\n![image-20260117011037150](/images/DDNS到反向代理全流程.assets/image-20260117011037150.png)\n\n![image-20260117011055652](/images/DDNS到反向代理全流程.assets/image-20260117011055652.png)\n\n![image-20260117011116952](/images/DDNS到反向代理全流程.assets/image-20260117011116952.png)\n\n\n\n防火墙区域设置\n\n常规设置全部接受\n\n下方区域全部接受\n\n通信规则页可再配置WAN到本设备接受入站、WAN到LAN接受转发\n\n**注意，这样谁都可以访问进入你的局域网，极其危险！！！**\n\n**如需精细化管理，可单独只开部分端口**\n\n![image-20260117011217372](/images/DDNS到反向代理全流程.assets/image-20260117011217372.png)\n\n![image-20260117011231365](/images/DDNS到反向代理全流程.assets/image-20260117011231365.png)\n\n#### 补充说明\n\n以上配置好后，就可以通过域名加端口形式访问路由器部署的服务\n\n如果像访问内部局域网设备，则需要配置相应端口转发\n\n家庭宽带默认不开放80和443端口\n\n由于是非加密的访问，建议开放的服务都配置账号密码\n\n\n\n### 需要HTTPS加密访问，托管到Cloudflare并部署证书\n\n#### 域名托管到Cloudflare\n\n[Cloudflare官网](dash.cloudflare.com)\n\n进入后登录\n\n填写要托管的域名\n\n下一步\n\n如果可以选择套餐了就说明可以托管\n\n接着下一步\n\n会出现两个NS用的服务器\n\n记录下来\n\n![image-20260117011500179](/images/DDNS到反向代理全流程.assets/image-20260117011500179.png)\n\n\n\n点左侧SSL/TLS Origin Server\n\n创建证书\n\n记录两串字符\n\n上面的保存为  .pem后缀文件\n\n下面的保存为  .key后缀文件\n\n![image-20260117011540956](/images/DDNS到反向代理全流程.assets/image-20260117011540956.png)\n\n\n\n接着获取全局密钥\n\n全局密钥在Cloudflare右上角个人中心\n\n左侧API令牌\n\n下方API密钥Global API KEY\n\n需要收邮箱验证码查看 \n\n保留好全局密钥\n\n![image-20260117012257481](/images/DDNS到反向代理全流程.assets/image-20260117012257481.png)\n\n#### DNSHE网页端配置\n\n找到要托管的域名\n\n点击对应域名的右侧DNS服务器\n\n设置NS服务器列表\n\n填入Cloudflare给的两个Cloudflare NameServers\n\n相应每行填入一个\n\n勾选强制替换\n\n![image-20260117011644759](/images/DDNS到反向代理全流程.assets/image-20260117011644759.png)\n\n保存后如下所示\n\n![image-20260117011734330](/images/DDNS到反向代理全流程.assets/image-20260117011734330.png)\n\n#### Openwrt端配置\n\n路由器安装ddns配套cloudflare插件\n\n```bash\nopkg update\nopkg install ddns-scripts-cloudflare luci-app-ddns\n```\n\n```\n上下域名一致\nIP地址版本IPv6\nDDNS服务提供商cloudflare.com-v4\n用户名填写Cloudflare登录邮箱\n密码填写Cloudflare全局密钥\n```\n\n![image-20260117011822347](/images/DDNS到反向代理全流程.assets/image-20260117011822347.png)\n\n![image-20260117011909465](/images/DDNS到反向代理全流程.assets/image-20260117011909465.png)\n\n#### Lucky端配置\n\n自行安装Lucky\n\n进入后禁用安全入口设置检查\n\n设置好用户名密码\n\n打开防火墙自动放行\n\n下面保存\n\n![image-20260117012041843](/images/DDNS到反向代理全流程.assets/image-20260117012041843.png)\n\n点击左侧SSL/TLS证书\n\n添加证书\n\n证书备注随意\n\n添加方式选文件\n\n证书一栏上传前面保存的.pem后缀的文件\n\nKey一栏上传前面保存的.key后缀的文件\n\n点击添加即可\n\n![image-20260117012048140](/images/DDNS到反向代理全流程.assets/image-20260117012048140.png)\n\n点击左侧Web服务\n\n添加Web服务规则\n\n规则名称随意\n\n规则开关启用\n\n操作模式 简易模式\n\n监听类型必须打开IPv6，IPv4随意\n\n监听端口填想通过域名加端口形式访问的端口\n\n打开防火墙自动放行\n\n启用TLS 版本限制TLS1.2\n\n\n\n默认规则部分\n\n默认标记关\n\n服务类型反向代理\n\n默认目标地址 127.0.0.1:端口号\n\n该端口号为服务部署实际占用端口，即想代理出去的服务端口号\n\n打开万事大吉\n\n忽略后端TLS证书验证\n\n打开自动反代重定向\n\n默认记录访问日志\n\n点击修改WEB服务规则\n\n![image-20260117012100674](/images/DDNS到反向代理全流程.assets/image-20260117012100674.png)\n\n#### 此时外网就可以通过HTTPS安全访问了","source":"_posts/DDNS到反向代理全流程.md","raw":"---\ntitle: 路由器DDNS到域名访问服务全流程\ndate: 2026-01-17 01:26\ncategories: 学习笔记\ntags: [技术, 教程, Openwrt]\n---\n\n\n## 分为两种情况\n\n**只需要HTTP基础访问功能**\n**需要HTTPS加密访问**\n\n### 只需要HTTP访问（非加密）\n\n#### 注册免费域名\n\n[免费域名注册](my.dnshe.com)\n\n默认可免费注册三个\n\n如果只需要HTTP访问则需要拿到API\n\nAPI要求有五个免费域名\n\n需要要求两个好友才能拿到五个\n\n\n\n记录下API Key和API Secret\n\n\n\n#### Openwrt安装动态DNS\n\n在系统 软件包 查找**luci-app-ddns、luci-i18n-ddns-zh-cn**安装\n\n安装好后刷新页面\n\n登录到路由器的 SSH（或使用 TTYD 终端），输入下面命令一键部署脚本\n\n\n\n```bash\n# ===================== 第一步：更新opkg源 =====================\necho \"==== 开始更新opkg软件源 ====\"\nopkg update\n\n# ===================== 第二步：安装DDNS核心插件及中文语言包 =====================\necho -e \"\\n==== 开始安装luci-app-ddns及中文语言包 ====\"\nopkg install luci-app-ddns luci-i18n-ddns-zh-cn\n\n# ===================== 第三步：创建DDNS脚本目录并写入自定义脚本 =====================\necho -e \"\\n==== 开始创建并写入DNSHE DDNS脚本 ====\"\n# 确保脚本目录存在\nmkdir -p /usr/lib/ddns\n\n# 写入自定义脚本（用户配置区置顶，日志位置说明紧随其后）\ncat > /usr/lib/ddns/dnshe-update.sh << 'EOF'\n#!/bin/sh\n\n# ==============================================================================\n# OpenWrt Production DDNS Script for dnshe.com\n# 功能：1. 兼容DNSHE的name存储规则（完整域名）；2. 根域名匹配@和完整域名；\n#       3. 子域名匹配拆分后的记录名和完整域名；4. 不做IP优化，保留完整IPv6；\n# ==============================================================================\n\n# --- [用户配置区] ---\nDDNS_SERVICE_NAME=\"myddns_ipv6\"  # UCI ddns服务名称（必须与DDNS Luci界面一致）\nAPI_URL=\"https://api005.dnshe.com/index.php?m=domain_hub\"\n\n# ==============================================================================\n# --- [环境初始化] ---\n. /lib/functions.sh\n. /lib/functions/network.sh\n\n# 工具路径\nCURL=\"/usr/bin/curl\"\nJSONFILTER=\"/usr/bin/jsonfilter\"\nLOGGER=\"/usr/bin/logger\"\nMKDIR=\"/bin/mkdir\"\nDATE=\"/bin/date\"\nRM=\"/bin/rm\"\nMV=\"/bin/mv\"\nAWK=\"/usr/bin/awk\"\n\n# 日志配置\nSCRIPT_NAME=$(basename \"$0\")\nSCRIPT_BASE=\"${SCRIPT_NAME%.*}\"\nLOG_DIR=\"/var/log/ddns\"\nLOG_FILE_PERSIST=\"$LOG_DIR/${SCRIPT_BASE}.log\"\nLOG_FILE_TMP=\"/tmp/${SCRIPT_BASE}_last_run.log\"\n\n# 日志轮转\nrotate_logs() {\n    [ -f \"${LOG_FILE_PERSIST}.2\" ] && $RM \"${LOG_FILE_PERSIST}.2\"\n    [ -f \"${LOG_FILE_PERSIST}.1\" ] && $MV \"${LOG_FILE_PERSIST}.1\" \"${LOG_FILE_PERSIST}.2\"\n    [ -f \"${LOG_FILE_PERSIST}\" ]   && $MV \"${LOG_FILE_PERSIST}\" \"${LOG_FILE_PERSIST}.1\"\n    echo \"=== [$(date '+%Y-%m-%d %H:%M:%S')] 新的执行开始 ===\" > \"$LOG_FILE_PERSIST\"\n    echo \"=== [$(date '+%Y-%m-%d %H:%M:%S')] 新的执行开始 ===\" > \"$LOG_FILE_TMP\"\n}\n\n# 日志函数\nwrite_log() {\n    local timestamp=$($DATE '+%H:%M:%S')\n    local msg=\"[$timestamp] $1\"\n    $LOGGER -t \"ddns-$SCRIPT_BASE\" \"$1\"\n    echo \"$msg\" >> \"$LOG_FILE_PERSIST\"\n    echo \"$msg\" >> \"$LOG_FILE_TMP\"\n    echo \"$msg\"\n}\n\n# ==============================================================================\n# --- [核心：自动拆分域名（子域名→实例+记录名）] ---\nsplit_domain() {\n    local input_domain=\"$1\"  # 传入的完整域名（如zby.shyhome.cc.cd/shyhome.cc.cd）\n    \n    # 步骤1：获取DNSHE后台所有subdomain实例\n    local subdomains_res=$($CURL -k -s -X GET \"$API_URL&endpoint=subdomains&action=list\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\")\n    \n    # 步骤2：遍历所有实例，匹配input_domain所属的根实例\n    local subdomain_list=$(echo \"$subdomains_res\" | $JSONFILTER -e \"@.subdomains[*].full_domain\")\n    for instance in $subdomain_list; do\n        # 匹配规则：input_domain以instance结尾（如zby.shyhome.cc.cd 以 shyhome.cc.cd 结尾）\n        if echo \"$input_domain\" | grep -q \"\\.$instance$\"; then\n            SUBDOMAIN_INSTANCE=\"$instance\"  # 根实例（如shyhome.cc.cd）\n            # 拆分记录名（zby.shyhome.cc.cd → zby）\n            RECORD_NAME=$(echo \"$input_domain\" | sed \"s/\\.${instance}$//\")\n            TARGET_FULL_DOMAIN=\"$input_domain\"  # 子域名完整域名\n            write_log \"  域名拆分成功: 根实例[$SUBDOMAIN_INSTANCE] | 记录名[$RECORD_NAME] | 完整域名[$TARGET_FULL_DOMAIN]\"\n            return 0\n        fi\n    done\n    \n    # 步骤3：如果是根域名（无匹配则input_domain本身就是实例）\n    SUBDOMAIN_INSTANCE=\"$input_domain\"\n    RECORD_NAME=\"@\"\n    TARGET_FULL_DOMAIN=\"$input_domain\"  # 根域名完整域名\n    write_log \"  检测到根域名: 根实例[$SUBDOMAIN_INSTANCE] | 记录名[$RECORD_NAME] | 完整域名[$TARGET_FULL_DOMAIN]\"\n}\n\n# ==============================================================================\n# --- [匹配Record ID（兼容DNSHE的name存储规则）] ---\nget_target_record_id() {\n    local records_json=\"$1\"\n    local record_name=\"$2\"\n    local full_domain=\"$3\"\n    \n    # 初始化Record ID\n    RECORD_ID=\"\"\n    \n    # 第一步：匹配记录名=record_name（如zby/@）\n    RECORD_ID=$(echo \"$records_json\" | $JSONFILTER -e \"@.records[@.type='AAAA' && @.name='$record_name'].id\")\n    if [ -n \"$RECORD_ID\" ]; then\n        write_log \"  匹配到记录名=$record_name的记录，ID: $RECORD_ID\"\n        return 0\n    fi\n    \n    # 第二步：匹配记录名=完整域名（DNSHE实际存储的格式）\n    RECORD_ID=$(echo \"$records_json\" | $JSONFILTER -e \"@.records[@.type='AAAA' && @.name='$full_domain'].id\")\n    if [ -n \"$RECORD_ID\" ]; then\n        write_log \"  匹配到记录名=$full_domain的记录（DNSHE存储格式），ID: $RECORD_ID\"\n        return 0\n    fi\n    \n    # 第三步：未匹配到\n    write_log \"  未发现目标记录（记录名=$record_name 或 $full_domain），准备新建\"\n}\n\n# ==============================================================================\n# --- [初始化] ---\n[ ! -d \"$LOG_DIR\" ] && $MKDIR -p \"$LOG_DIR\"\nrotate_logs\n\n# ==============================================================================\n# --- [核心逻辑] ---\nwrite_log \"步骤 1: 环境检查与工具验证...\"\nif [ ! -x \"$CURL\" ]; then write_log \"错误: 找不到 curl 工具\"; exit 1; fi\nif [ ! -x \"$JSONFILTER\" ]; then write_log \"错误: 找不到 jsonfilter 工具\"; exit 1; fi\n\nwrite_log \"步骤 2: 获取参数...\"\n# 优先从环境变量获取（DDNS传参：$1=KEY, $2=SECRET, $3=DOMAIN, $4=IP）\nMY_KEY=\"${username:-$__USERNAME}\"\n[ -z \"$MY_KEY\" ] && MY_KEY=\"$1\"\n\nMY_SECRET=\"${password:-$__PASSWORD}\"\n[ -z \"$MY_SECRET\" ] && MY_SECRET=\"$2\"\n\nMY_DOMAIN=\"${domain:-$__DOMAIN}\"\n[ -z \"$MY_DOMAIN\" ] && MY_DOMAIN=\"$3\"\n\nMY_IP=\"${__IP:-$4}\"\n\n# 灾难恢复机制\ncase \"$MY_KEY\" in\n    *:*|*.*) \n        write_log \"警告: 检测到参数错乱 (Key 似 IP)，启动灾难恢复机制...\"\n        write_log \"正在从 UCI 配置 'ddns.$DDNS_SERVICE_NAME' 强制读取参数...\"\n        MY_KEY=$(uci get ddns.$DDNS_SERVICE_NAME.username 2>/dev/null)\n        MY_SECRET=$(uci get ddns.$DDNS_SERVICE_NAME.password 2>/dev/null)\n        MY_DOMAIN=$(uci get ddns.$DDNS_SERVICE_NAME.domain 2>/dev/null)\n        ;;\nesac\n\n# 仅清洗IP格式（去除换行符），不做任何前缀提取/优化\nMY_IP=$(echo \"$MY_IP\" | tr -d '\\n\\r')\n# 二次补救 IP\nif [ -z \"$MY_IP\" ]; then\n    case \"$1\" in *:*) MY_IP=\"$1\" ;; esac\nfi\n\n# 记录参数 (敏感信息打码)\nwrite_log \"参数确认:\"\nwrite_log \"  - API Key: ${MY_KEY:0:6}******\"\nwrite_log \"  - 目标域名 : $MY_DOMAIN\"\nwrite_log \"  - Target IP: $MY_IP\" # 完整保留获取到的IPv6地址\n\nif [ -z \"$MY_KEY\" ] || [ -z \"$MY_SECRET\" ] || [ -z \"$MY_DOMAIN\" ] || [ -z \"$MY_IP\" ]; then\n    write_log \"致命错误: 必要参数缺失\"\n    exit 1\nfi\n\n# ==============================================================================\n# --- [自动拆分域名] ---\nwrite_log \"步骤 3: 自动拆分域名...\"\nsplit_domain \"$MY_DOMAIN\"\n\n# 获取根实例的Subdomain ID\nSUBDOMAIN_RES=$($CURL -k -s -X GET \"$API_URL&endpoint=subdomains&action=list\" \\\n  -H \"X-API-Key: $MY_KEY\" \\\n  -H \"X-API-Secret: $MY_SECRET\")\nSUBDOMAIN_ID=$(echo \"$SUBDOMAIN_RES\" | $JSONFILTER -e \"@.subdomains[@.full_domain='$SUBDOMAIN_INSTANCE'].id\")\n\nif [ -z \"$SUBDOMAIN_ID\" ]; then\n    write_log \"错误: 未能提取 Subdomain ID，请检查域名[$SUBDOMAIN_INSTANCE]是否在账号下\"\n    exit 1\nfi\nwrite_log \"  获取成功，Subdomain ID: $SUBDOMAIN_ID | 根实例: $SUBDOMAIN_INSTANCE\"\n\n# ==============================================================================\n# --- [获取Record ID（兼容DNSHE存储规则）] ---\nwrite_log \"步骤 4: 获取 Record ID (现有记录)...\"\nRECORDS_RES=$($CURL -k -s -X GET \"$API_URL&endpoint=dns_records&action=list&subdomain_id=$SUBDOMAIN_ID\" \\\n  -H \"X-API-Key: $MY_KEY\" \\\n  -H \"X-API-Secret: $MY_SECRET\")\nwrite_log \"  API 响应: $RECORDS_RES\"\n\n# 匹配Record ID（兼容DNSHE的name存储规则）\nget_target_record_id \"$RECORDS_RES\" \"$RECORD_NAME\" \"$TARGET_FULL_DOMAIN\"\n\nif [ -n \"$RECORD_ID\" ]; then\n    ACTION_TYPE=\"update\" # 更新现有记录\nelse\n    ACTION_TYPE=\"create\" # 新建记录\nfi\n\n# ==============================================================================\n# --- [执行更新/创建] ---\nwrite_log \"步骤 5: 执行操作 ($ACTION_TYPE)...\"\nif [ \"$ACTION_TYPE\" = \"update\" ]; then\n    # 更新现有记录（覆盖旧IP）\n    JSON_PAYLOAD=$(printf '{\"record_id\": %d, \"name\": \"%s\", \"content\": \"%s\", \"ttl\": 600}' \"$RECORD_ID\" \"$RECORD_NAME\" \"$MY_IP\")\n    FINAL_RES=$($CURL -k -s -X POST \"$API_URL&endpoint=dns_records&action=update\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\" \\\n      -H \"Content-Type: application/json\" \\\n      -d \"$JSON_PAYLOAD\")\nelse\n    # 新建记录（使用拆分后的记录名）\n    JSON_PAYLOAD=$(printf '{\"subdomain_id\": %d, \"type\": \"AAAA\", \"name\": \"%s\", \"content\": \"%s\", \"ttl\": 600}' \"$SUBDOMAIN_ID\" \"$RECORD_NAME\" \"$MY_IP\")\n    FINAL_RES=$($CURL -k -s -X POST \"$API_URL&endpoint=dns_records&action=create\" \\\n      -H \"X-API-Key: $MY_KEY\" \\\n      -H \"X-API-Secret: $MY_SECRET\" \\\n      -H \"Content-Type: application/json\" \\\n      -d \"$JSON_PAYLOAD\")\nfi\n\nwrite_log \"  Payload: $JSON_PAYLOAD\"\nwrite_log \"  API 最终响应: $FINAL_RES\"\n\n# ==============================================================================\n# --- [结果判定] ---\nIS_SUCCESS=$(echo \"$FINAL_RES\" | $JSONFILTER -e \"@.success\")\n\nif [ \"$IS_SUCCESS\" = \"true\" ]; then\n    write_log \"步骤 6: 结果判定 -> 成功！\"\n    write_log \"=== 脚本执行结束 (Success) ===\"\n    exit 0\nelse\n    write_log \"步骤 6: 结果判定 -> 失败！错误信息: $FINAL_RES\"\n    write_log \"=== 脚本执行结束 (Failed) ===\"\n    exit 1\nfi\nEOF\n\n# ===================== 第四步：给脚本添加可执行权限 =====================\necho -e \"\\n==== 给DNSHE DDNS脚本添加执行权限 ====\"\nchmod +x /usr/lib/ddns/dnshe-update.sh\n\n# ===================== 第五步：验证安装和脚本创建结果 =====================\necho -e \"\\n==== 验证结果 ====\"\necho \"1. DDNS插件安装状态：\"\nopkg list-installed | grep ddns\necho -e \"\\n2. 脚本文件及权限：\"\nls -l /usr/lib/ddns/dnshe-update.sh\necho -e \"\\n==== 所有操作完成！====\n- DDNS插件已安装并支持中文\n- DNSHE自定义脚本已创建：/usr/lib/ddns/dnshe-update.sh\n- 脚本已赋予执行权限\n- 日志文件位置：/var/log/ddns/dnshe-update.log（持久）/tmp/dnshe-update_last_run.log（临时）\"\n```\n\n#### 配置 LuCI 界面\n\n回到 OpenWrt 界面（`服务项 » 动态DNS  » myddns_ipv6`），按照以下方式填空：\n\n**基础设置**\n\n- **勾选已启用**\n- **域名**: `yourhost.example.com` (填写你的实际完整域名，必须要在你的 API 账号里已经存在)\n- **IP 地址版本**: `IPv6`\n- **DDNS 服务提供商 [IPv4/IPv6]**: 选择 `自定义` \n- **自定义更新 URL**: (留空，不要填)\n- **自定义更新脚本**: `/etc/ddns/update_dnshe_ipv6.sh`\n- **用户名**: 填写你的 **API Key**\n- **密码**:  填写你的 **API Secret**\n- **使用 HTTPS**: (如果脚本不工作，可以尝试取消勾选，但在脚本模式下这个选项通常只影响 wget/curl 库的选择，脚本里我们强制用了 curl，所以这个选项影响不大，建议勾选)\n- **CA证书路径:** 默认留空，会自动填入IGNORE\n\n**高级设置**\n\n- **IP地址来源：**网络\n- **网络：**wan6（有ipv6的）\n- **勾选记录日志到文件**\n- 其余默认\n\n**定时器设定**\n\n- **检查间隔：**10\n- **检查间隔单位：**分钟\n- **强制更新间隔：**3\n- **强制更新间隔单位**：天\n- 其余默认\n\n![image-20260117011037150](/images/DDNS到反向代理全流程.assets/image-20260117011037150.png)\n\n![image-20260117011055652](/images/DDNS到反向代理全流程.assets/image-20260117011055652.png)\n\n![image-20260117011116952](/images/DDNS到反向代理全流程.assets/image-20260117011116952.png)\n\n\n\n防火墙区域设置\n\n常规设置全部接受\n\n下方区域全部接受\n\n通信规则页可再配置WAN到本设备接受入站、WAN到LAN接受转发\n\n**注意，这样谁都可以访问进入你的局域网，极其危险！！！**\n\n**如需精细化管理，可单独只开部分端口**\n\n![image-20260117011217372](/images/DDNS到反向代理全流程.assets/image-20260117011217372.png)\n\n![image-20260117011231365](/images/DDNS到反向代理全流程.assets/image-20260117011231365.png)\n\n#### 补充说明\n\n以上配置好后，就可以通过域名加端口形式访问路由器部署的服务\n\n如果像访问内部局域网设备，则需要配置相应端口转发\n\n家庭宽带默认不开放80和443端口\n\n由于是非加密的访问，建议开放的服务都配置账号密码\n\n\n\n### 需要HTTPS加密访问，托管到Cloudflare并部署证书\n\n#### 域名托管到Cloudflare\n\n[Cloudflare官网](dash.cloudflare.com)\n\n进入后登录\n\n填写要托管的域名\n\n下一步\n\n如果可以选择套餐了就说明可以托管\n\n接着下一步\n\n会出现两个NS用的服务器\n\n记录下来\n\n![image-20260117011500179](/images/DDNS到反向代理全流程.assets/image-20260117011500179.png)\n\n\n\n点左侧SSL/TLS Origin Server\n\n创建证书\n\n记录两串字符\n\n上面的保存为  .pem后缀文件\n\n下面的保存为  .key后缀文件\n\n![image-20260117011540956](/images/DDNS到反向代理全流程.assets/image-20260117011540956.png)\n\n\n\n接着获取全局密钥\n\n全局密钥在Cloudflare右上角个人中心\n\n左侧API令牌\n\n下方API密钥Global API KEY\n\n需要收邮箱验证码查看 \n\n保留好全局密钥\n\n![image-20260117012257481](/images/DDNS到反向代理全流程.assets/image-20260117012257481.png)\n\n#### DNSHE网页端配置\n\n找到要托管的域名\n\n点击对应域名的右侧DNS服务器\n\n设置NS服务器列表\n\n填入Cloudflare给的两个Cloudflare NameServers\n\n相应每行填入一个\n\n勾选强制替换\n\n![image-20260117011644759](/images/DDNS到反向代理全流程.assets/image-20260117011644759.png)\n\n保存后如下所示\n\n![image-20260117011734330](/images/DDNS到反向代理全流程.assets/image-20260117011734330.png)\n\n#### Openwrt端配置\n\n路由器安装ddns配套cloudflare插件\n\n```bash\nopkg update\nopkg install ddns-scripts-cloudflare luci-app-ddns\n```\n\n```\n上下域名一致\nIP地址版本IPv6\nDDNS服务提供商cloudflare.com-v4\n用户名填写Cloudflare登录邮箱\n密码填写Cloudflare全局密钥\n```\n\n![image-20260117011822347](/images/DDNS到反向代理全流程.assets/image-20260117011822347.png)\n\n![image-20260117011909465](/images/DDNS到反向代理全流程.assets/image-20260117011909465.png)\n\n#### Lucky端配置\n\n自行安装Lucky\n\n进入后禁用安全入口设置检查\n\n设置好用户名密码\n\n打开防火墙自动放行\n\n下面保存\n\n![image-20260117012041843](/images/DDNS到反向代理全流程.assets/image-20260117012041843.png)\n\n点击左侧SSL/TLS证书\n\n添加证书\n\n证书备注随意\n\n添加方式选文件\n\n证书一栏上传前面保存的.pem后缀的文件\n\nKey一栏上传前面保存的.key后缀的文件\n\n点击添加即可\n\n![image-20260117012048140](/images/DDNS到反向代理全流程.assets/image-20260117012048140.png)\n\n点击左侧Web服务\n\n添加Web服务规则\n\n规则名称随意\n\n规则开关启用\n\n操作模式 简易模式\n\n监听类型必须打开IPv6，IPv4随意\n\n监听端口填想通过域名加端口形式访问的端口\n\n打开防火墙自动放行\n\n启用TLS 版本限制TLS1.2\n\n\n\n默认规则部分\n\n默认标记关\n\n服务类型反向代理\n\n默认目标地址 127.0.0.1:端口号\n\n该端口号为服务部署实际占用端口，即想代理出去的服务端口号\n\n打开万事大吉\n\n忽略后端TLS证书验证\n\n打开自动反代重定向\n\n默认记录访问日志\n\n点击修改WEB服务规则\n\n![image-20260117012100674](/images/DDNS到反向代理全流程.assets/image-20260117012100674.png)\n\n#### 此时外网就可以通过HTTPS安全访问了","slug":"DDNS到反向代理全流程","published":1,"updated":"2026-01-16T17:26:52.651Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivi000024j39efd8pir","content":"<h2 id=\"分为两种情况\"><a href=\"#分为两种情况\" class=\"headerlink\" title=\"分为两种情况\"></a>分为两种情况</h2><p><strong>只需要HTTP基础访问功能</strong><br><strong>需要HTTPS加密访问</strong></p>\n<h3 id=\"只需要HTTP访问（非加密）\"><a href=\"#只需要HTTP访问（非加密）\" class=\"headerlink\" title=\"只需要HTTP访问（非加密）\"></a>只需要HTTP访问（非加密）</h3><h4 id=\"注册免费域名\"><a href=\"#注册免费域名\" class=\"headerlink\" title=\"注册免费域名\"></a>注册免费域名</h4><p><a href=\"my.dnshe.com\">免费域名注册</a></p>\n<p>默认可免费注册三个</p>\n<p>如果只需要HTTP访问则需要拿到API</p>\n<p>API要求有五个免费域名</p>\n<p>需要要求两个好友才能拿到五个</p>\n<p>记录下API Key和API Secret</p>\n<h4 id=\"Openwrt安装动态DNS\"><a href=\"#Openwrt安装动态DNS\" class=\"headerlink\" title=\"Openwrt安装动态DNS\"></a>Openwrt安装动态DNS</h4><p>在系统 软件包 查找<strong>luci-app-ddns、luci-i18n-ddns-zh-cn</strong>安装</p>\n<p>安装好后刷新页面</p>\n<p>登录到路由器的 SSH（或使用 TTYD 终端），输入下面命令一键部署脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ===================== 第一步：更新opkg源 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;==== 开始更新opkg软件源 ====&quot;</span></span><br><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第二步：安装DDNS核心插件及中文语言包 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 开始安装luci-app-ddns及中文语言包 ====&quot;</span></span><br><span class=\"line\">opkg install luci-app-ddns luci-i18n-ddns-zh-cn</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第三步：创建DDNS脚本目录并写入自定义脚本 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 开始创建并写入DNSHE DDNS脚本 ====&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 确保脚本目录存在</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /usr/lib/ddns</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 写入自定义脚本（用户配置区置顶，日志位置说明紧随其后）</span></span><br><span class=\"line\"><span class=\"built_in\">cat</span> &gt; /usr/lib/ddns/dnshe-update.sh &lt;&lt; <span class=\"string\">&#x27;EOF&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#!/bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># OpenWrt Production DDNS Script for dnshe.com</span></span><br><span class=\"line\"><span class=\"comment\"># 功能：1. 兼容DNSHE的name存储规则（完整域名）；2. 根域名匹配@和完整域名；</span></span><br><span class=\"line\"><span class=\"comment\">#       3. 子域名匹配拆分后的记录名和完整域名；4. 不做IP优化，保留完整IPv6；</span></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --- [用户配置区] ---</span></span><br><span class=\"line\">DDNS_SERVICE_NAME=<span class=\"string\">&quot;myddns_ipv6&quot;</span>  <span class=\"comment\"># UCI ddns服务名称（必须与DDNS Luci界面一致）</span></span><br><span class=\"line\">API_URL=<span class=\"string\">&quot;https://api005.dnshe.com/index.php?m=domain_hub&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [环境初始化] ---</span></span><br><span class=\"line\">. /lib/functions.sh</span><br><span class=\"line\">. /lib/functions/network.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 工具路径</span></span><br><span class=\"line\">CURL=<span class=\"string\">&quot;/usr/bin/curl&quot;</span></span><br><span class=\"line\">JSONFILTER=<span class=\"string\">&quot;/usr/bin/jsonfilter&quot;</span></span><br><span class=\"line\">LOGGER=<span class=\"string\">&quot;/usr/bin/logger&quot;</span></span><br><span class=\"line\">MKDIR=<span class=\"string\">&quot;/bin/mkdir&quot;</span></span><br><span class=\"line\">DATE=<span class=\"string\">&quot;/bin/date&quot;</span></span><br><span class=\"line\">RM=<span class=\"string\">&quot;/bin/rm&quot;</span></span><br><span class=\"line\">MV=<span class=\"string\">&quot;/bin/mv&quot;</span></span><br><span class=\"line\">AWK=<span class=\"string\">&quot;/usr/bin/awk&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志配置</span></span><br><span class=\"line\">SCRIPT_NAME=$(<span class=\"built_in\">basename</span> <span class=\"string\">&quot;<span class=\"variable\">$0</span>&quot;</span>)</span><br><span class=\"line\">SCRIPT_BASE=<span class=\"string\">&quot;<span class=\"variable\">$&#123;SCRIPT_NAME%.*&#125;</span>&quot;</span></span><br><span class=\"line\">LOG_DIR=<span class=\"string\">&quot;/var/log/ddns&quot;</span></span><br><span class=\"line\">LOG_FILE_PERSIST=<span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>/<span class=\"variable\">$&#123;SCRIPT_BASE&#125;</span>.log&quot;</span></span><br><span class=\"line\">LOG_FILE_TMP=<span class=\"string\">&quot;/tmp/<span class=\"variable\">$&#123;SCRIPT_BASE&#125;</span>_last_run.log&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志轮转</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">rotate_logs</span></span>() &#123;</span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span> ] &amp;&amp; <span class=\"variable\">$RM</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span></span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span> ] &amp;&amp; <span class=\"variable\">$MV</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span></span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>&quot;</span> ]   &amp;&amp; <span class=\"variable\">$MV</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;=== [<span class=\"subst\">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span>] 新的执行开始 ===&quot;</span> &gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_PERSIST</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;=== [<span class=\"subst\">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span>] 新的执行开始 ===&quot;</span> &gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_TMP</span>&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">write_log</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> timestamp=$(<span class=\"variable\">$DATE</span> <span class=\"string\">&#x27;+%H:%M:%S&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">local</span> msg=<span class=\"string\">&quot;[<span class=\"variable\">$timestamp</span>] <span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"variable\">$LOGGER</span> -t <span class=\"string\">&quot;ddns-<span class=\"variable\">$SCRIPT_BASE</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span> &gt;&gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_PERSIST</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span> &gt;&gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_TMP</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [核心：自动拆分域名（子域名→实例+记录名）] ---</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">split_domain</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> input_domain=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span>  <span class=\"comment\"># 传入的完整域名（如zby.shyhome.cc.cd/shyhome.cc.cd）</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤1：获取DNSHE后台所有subdomain实例</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> subdomains_res=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=subdomains&amp;action=list&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤2：遍历所有实例，匹配input_domain所属的根实例</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> subdomain_list=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$subdomains_res</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.subdomains[*].full_domain&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> instance <span class=\"keyword\">in</span> <span class=\"variable\">$subdomain_list</span>; <span class=\"keyword\">do</span></span><br><span class=\"line\">        <span class=\"comment\"># 匹配规则：input_domain以instance结尾（如zby.shyhome.cc.cd 以 shyhome.cc.cd 结尾）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span> | grep -q <span class=\"string\">&quot;\\.$instance$&quot;</span>; <span class=\"keyword\">then</span></span><br><span class=\"line\">            SUBDOMAIN_INSTANCE=<span class=\"string\">&quot;<span class=\"variable\">$instance</span>&quot;</span>  <span class=\"comment\"># 根实例（如shyhome.cc.cd）</span></span><br><span class=\"line\">            <span class=\"comment\"># 拆分记录名（zby.shyhome.cc.cd → zby）</span></span><br><span class=\"line\">            RECORD_NAME=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span> | sed <span class=\"string\">&quot;s/\\.<span class=\"variable\">$&#123;instance&#125;</span>$//&quot;</span>)</span><br><span class=\"line\">            TARGET_FULL_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span>  <span class=\"comment\"># 子域名完整域名</span></span><br><span class=\"line\">            write_log <span class=\"string\">&quot;  域名拆分成功: 根实例[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>] | 记录名[<span class=\"variable\">$RECORD_NAME</span>] | 完整域名[<span class=\"variable\">$TARGET_FULL_DOMAIN</span>]&quot;</span></span><br><span class=\"line\">            <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\">    <span class=\"keyword\">done</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤3：如果是根域名（无匹配则input_domain本身就是实例）</span></span><br><span class=\"line\">    SUBDOMAIN_INSTANCE=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span></span><br><span class=\"line\">    RECORD_NAME=<span class=\"string\">&quot;@&quot;</span></span><br><span class=\"line\">    TARGET_FULL_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span>  <span class=\"comment\"># 根域名完整域名</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;  检测到根域名: 根实例[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>] | 记录名[<span class=\"variable\">$RECORD_NAME</span>] | 完整域名[<span class=\"variable\">$TARGET_FULL_DOMAIN</span>]&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [匹配Record ID（兼容DNSHE的name存储规则）] ---</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">get_target_record_id</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> records_json=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> record_name=<span class=\"string\">&quot;<span class=\"variable\">$2</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> full_domain=<span class=\"string\">&quot;<span class=\"variable\">$3</span>&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 初始化Record ID</span></span><br><span class=\"line\">    RECORD_ID=<span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第一步：匹配记录名=record_name（如zby/@）</span></span><br><span class=\"line\">    RECORD_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$records_json</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.records[@.type=&#x27;AAAA&#x27; &amp;&amp; @.name=&#x27;<span class=\"variable\">$record_name</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;  匹配到记录名=<span class=\"variable\">$record_name</span>的记录，ID: <span class=\"variable\">$RECORD_ID</span>&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第二步：匹配记录名=完整域名（DNSHE实际存储的格式）</span></span><br><span class=\"line\">    RECORD_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$records_json</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.records[@.type=&#x27;AAAA&#x27; &amp;&amp; @.name=&#x27;<span class=\"variable\">$full_domain</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;  匹配到记录名=<span class=\"variable\">$full_domain</span>的记录（DNSHE存储格式），ID: <span class=\"variable\">$RECORD_ID</span>&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第三步：未匹配到</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;  未发现目标记录（记录名=<span class=\"variable\">$record_name</span> 或 <span class=\"variable\">$full_domain</span>），准备新建&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [初始化] ---</span></span><br><span class=\"line\">[ ! -d <span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>&quot;</span> ] &amp;&amp; <span class=\"variable\">$MKDIR</span> -p <span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>&quot;</span></span><br><span class=\"line\">rotate_logs</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [核心逻辑] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 1: 环境检查与工具验证...&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ ! -x <span class=\"string\">&quot;<span class=\"variable\">$CURL</span>&quot;</span> ]; <span class=\"keyword\">then</span> write_log <span class=\"string\">&quot;错误: 找不到 curl 工具&quot;</span>; <span class=\"built_in\">exit</span> 1; <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ ! -x <span class=\"string\">&quot;<span class=\"variable\">$JSONFILTER</span>&quot;</span> ]; <span class=\"keyword\">then</span> write_log <span class=\"string\">&quot;错误: 找不到 jsonfilter 工具&quot;</span>; <span class=\"built_in\">exit</span> 1; <span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 2: 获取参数...&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 优先从环境变量获取（DDNS传参：$1=KEY, $2=SECRET, $3=DOMAIN, $4=IP）</span></span><br><span class=\"line\">MY_KEY=<span class=\"string\">&quot;<span class=\"variable\">$&#123;username:-<span class=\"variable\">$__USERNAME</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> ] &amp;&amp; MY_KEY=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_SECRET=<span class=\"string\">&quot;<span class=\"variable\">$&#123;password:-<span class=\"variable\">$__PASSWORD</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_SECRET</span>&quot;</span> ] &amp;&amp; MY_SECRET=<span class=\"string\">&quot;<span class=\"variable\">$2</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$&#123;domain:-<span class=\"variable\">$__DOMAIN</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span> ] &amp;&amp; MY_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$3</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_IP=<span class=\"string\">&quot;<span class=\"variable\">$&#123;__IP:-<span class=\"variable\">$4</span>&#125;</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 灾难恢复机制</span></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    *:*|*.*) </span><br><span class=\"line\">        write_log <span class=\"string\">&quot;警告: 检测到参数错乱 (Key 似 IP)，启动灾难恢复机制...&quot;</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;正在从 UCI 配置 &#x27;ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>&#x27; 强制读取参数...&quot;</span></span><br><span class=\"line\">        MY_KEY=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.username 2&gt;/dev/null)</span><br><span class=\"line\">        MY_SECRET=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.password 2&gt;/dev/null)</span><br><span class=\"line\">        MY_DOMAIN=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.domain 2&gt;/dev/null)</span><br><span class=\"line\">        ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 仅清洗IP格式（去除换行符），不做任何前缀提取/优化</span></span><br><span class=\"line\">MY_IP=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> | <span class=\"built_in\">tr</span> -d <span class=\"string\">&#x27;\\n\\r&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 二次补救 IP</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span> <span class=\"keyword\">in</span> *:*) MY_IP=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span> ;; <span class=\"keyword\">esac</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 记录参数 (敏感信息打码)</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;参数确认:&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - API Key: <span class=\"variable\">$&#123;MY_KEY:0:6&#125;</span>******&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - 目标域名 : <span class=\"variable\">$MY_DOMAIN</span>&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - Target IP: <span class=\"variable\">$MY_IP</span>&quot;</span> <span class=\"comment\"># 完整保留获取到的IPv6地址</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_SECRET</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;致命错误: 必要参数缺失&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [自动拆分域名] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 3: 自动拆分域名...&quot;</span></span><br><span class=\"line\">split_domain <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取根实例的Subdomain ID</span></span><br><span class=\"line\">SUBDOMAIN_RES=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=subdomains&amp;action=list&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">SUBDOMAIN_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_RES</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.subdomains[@.full_domain=&#x27;<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;错误: 未能提取 Subdomain ID，请检查域名[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>]是否在账号下&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  获取成功，Subdomain ID: <span class=\"variable\">$SUBDOMAIN_ID</span> | 根实例: <span class=\"variable\">$SUBDOMAIN_INSTANCE</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [获取Record ID（兼容DNSHE存储规则）] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 4: 获取 Record ID (现有记录)...&quot;</span></span><br><span class=\"line\">RECORDS_RES=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=list&amp;subdomain_id=<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">write_log <span class=\"string\">&quot;  API 响应: <span class=\"variable\">$RECORDS_RES</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 匹配Record ID（兼容DNSHE的name存储规则）</span></span><br><span class=\"line\">get_target_record_id <span class=\"string\">&quot;<span class=\"variable\">$RECORDS_RES</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$TARGET_FULL_DOMAIN</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    ACTION_TYPE=<span class=\"string\">&quot;update&quot;</span> <span class=\"comment\"># 更新现有记录</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    ACTION_TYPE=<span class=\"string\">&quot;create&quot;</span> <span class=\"comment\"># 新建记录</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [执行更新/创建] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 5: 执行操作 (<span class=\"variable\">$ACTION_TYPE</span>)...&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">&quot;<span class=\"variable\">$ACTION_TYPE</span>&quot;</span> = <span class=\"string\">&quot;update&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"comment\"># 更新现有记录（覆盖旧IP）</span></span><br><span class=\"line\">    JSON_PAYLOAD=$(<span class=\"built_in\">printf</span> <span class=\"string\">&#x27;&#123;&quot;record_id&quot;: %d, &quot;name&quot;: &quot;%s&quot;, &quot;content&quot;: &quot;%s&quot;, &quot;ttl&quot;: 600&#125;&#x27;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span>)</span><br><span class=\"line\">    FINAL_RES=$(<span class=\"variable\">$CURL</span> -k -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=update&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">      -d <span class=\"string\">&quot;<span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    <span class=\"comment\"># 新建记录（使用拆分后的记录名）</span></span><br><span class=\"line\">    JSON_PAYLOAD=$(<span class=\"built_in\">printf</span> <span class=\"string\">&#x27;&#123;&quot;subdomain_id&quot;: %d, &quot;type&quot;: &quot;AAAA&quot;, &quot;name&quot;: &quot;%s&quot;, &quot;content&quot;: &quot;%s&quot;, &quot;ttl&quot;: 600&#125;&#x27;</span> <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span>)</span><br><span class=\"line\">    FINAL_RES=$(<span class=\"variable\">$CURL</span> -k -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=create&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">      -d <span class=\"string\">&quot;<span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  Payload: <span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  API 最终响应: <span class=\"variable\">$FINAL_RES</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [结果判定] ---</span></span><br><span class=\"line\">IS_SUCCESS=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$FINAL_RES</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.success&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">&quot;<span class=\"variable\">$IS_SUCCESS</span>&quot;</span> = <span class=\"string\">&quot;true&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;步骤 6: 结果判定 -&gt; 成功！&quot;</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;=== 脚本执行结束 (Success) ===&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 0</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;步骤 6: 结果判定 -&gt; 失败！错误信息: <span class=\"variable\">$FINAL_RES</span>&quot;</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;=== 脚本执行结束 (Failed) ===&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\">EOF</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第四步：给脚本添加可执行权限 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 给DNSHE DDNS脚本添加执行权限 ====&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">chmod</span> +x /usr/lib/ddns/dnshe-update.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第五步：验证安装和脚本创建结果 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 验证结果 ====&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;1. DDNS插件安装状态：&quot;</span></span><br><span class=\"line\">opkg list-installed | grep ddns</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n2. 脚本文件及权限：&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">ls</span> -l /usr/lib/ddns/dnshe-update.sh</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 所有操作完成！====</span></span><br><span class=\"line\"><span class=\"string\">- DDNS插件已安装并支持中文</span></span><br><span class=\"line\"><span class=\"string\">- DNSHE自定义脚本已创建：/usr/lib/ddns/dnshe-update.sh</span></span><br><span class=\"line\"><span class=\"string\">- 脚本已赋予执行权限</span></span><br><span class=\"line\"><span class=\"string\">- 日志文件位置：/var/log/ddns/dnshe-update.log（持久）/tmp/dnshe-update_last_run.log（临时）&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置-LuCI-界面\"><a href=\"#配置-LuCI-界面\" class=\"headerlink\" title=\"配置 LuCI 界面\"></a>配置 LuCI 界面</h4><p>回到 OpenWrt 界面（<code>服务项 » 动态DNS  » myddns_ipv6</code>），按照以下方式填空：</p>\n<p><strong>基础设置</strong></p>\n<ul>\n<li><strong>勾选已启用</strong></li>\n<li><strong>域名</strong>: <code>yourhost.example.com</code> (填写你的实际完整域名，必须要在你的 API 账号里已经存在)</li>\n<li><strong>IP 地址版本</strong>: <code>IPv6</code></li>\n<li><strong>DDNS 服务提供商 [IPv4&#x2F;IPv6]</strong>: 选择 <code>自定义</code> </li>\n<li><strong>自定义更新 URL</strong>: (留空，不要填)</li>\n<li><strong>自定义更新脚本</strong>: <code>/etc/ddns/update_dnshe_ipv6.sh</code></li>\n<li><strong>用户名</strong>: 填写你的 <strong>API Key</strong></li>\n<li><strong>密码</strong>:  填写你的 <strong>API Secret</strong></li>\n<li><strong>使用 HTTPS</strong>: (如果脚本不工作，可以尝试取消勾选，但在脚本模式下这个选项通常只影响 wget&#x2F;curl 库的选择，脚本里我们强制用了 curl，所以这个选项影响不大，建议勾选)</li>\n<li><strong>CA证书路径:</strong> 默认留空，会自动填入IGNORE</li>\n</ul>\n<p><strong>高级设置</strong></p>\n<ul>\n<li><strong>IP地址来源：</strong>网络</li>\n<li><strong>网络：</strong>wan6（有ipv6的）</li>\n<li><strong>勾选记录日志到文件</strong></li>\n<li>其余默认</li>\n</ul>\n<p><strong>定时器设定</strong></p>\n<ul>\n<li><strong>检查间隔：</strong>10</li>\n<li><strong>检查间隔单位：</strong>分钟</li>\n<li><strong>强制更新间隔：</strong>3</li>\n<li><strong>强制更新间隔单位</strong>：天</li>\n<li>其余默认</li>\n</ul>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011037150.png\" alt=\"image-20260117011037150\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011055652.png\" alt=\"image-20260117011055652\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011116952.png\" alt=\"image-20260117011116952\"></p>\n<p>防火墙区域设置</p>\n<p>常规设置全部接受</p>\n<p>下方区域全部接受</p>\n<p>通信规则页可再配置WAN到本设备接受入站、WAN到LAN接受转发</p>\n<p><strong>注意，这样谁都可以访问进入你的局域网，极其危险！！！</strong></p>\n<p><strong>如需精细化管理，可单独只开部分端口</strong></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011217372.png\" alt=\"image-20260117011217372\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011231365.png\" alt=\"image-20260117011231365\"></p>\n<h4 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h4><p>以上配置好后，就可以通过域名加端口形式访问路由器部署的服务</p>\n<p>如果像访问内部局域网设备，则需要配置相应端口转发</p>\n<p>家庭宽带默认不开放80和443端口</p>\n<p>由于是非加密的访问，建议开放的服务都配置账号密码</p>\n<h3 id=\"需要HTTPS加密访问，托管到Cloudflare并部署证书\"><a href=\"#需要HTTPS加密访问，托管到Cloudflare并部署证书\" class=\"headerlink\" title=\"需要HTTPS加密访问，托管到Cloudflare并部署证书\"></a>需要HTTPS加密访问，托管到Cloudflare并部署证书</h3><h4 id=\"域名托管到Cloudflare\"><a href=\"#域名托管到Cloudflare\" class=\"headerlink\" title=\"域名托管到Cloudflare\"></a>域名托管到Cloudflare</h4><p><a href=\"dash.cloudflare.com\">Cloudflare官网</a></p>\n<p>进入后登录</p>\n<p>填写要托管的域名</p>\n<p>下一步</p>\n<p>如果可以选择套餐了就说明可以托管</p>\n<p>接着下一步</p>\n<p>会出现两个NS用的服务器</p>\n<p>记录下来</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011500179.png\" alt=\"image-20260117011500179\"></p>\n<p>点左侧SSL&#x2F;TLS Origin Server</p>\n<p>创建证书</p>\n<p>记录两串字符</p>\n<p>上面的保存为  .pem后缀文件</p>\n<p>下面的保存为  .key后缀文件</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011540956.png\" alt=\"image-20260117011540956\"></p>\n<p>接着获取全局密钥</p>\n<p>全局密钥在Cloudflare右上角个人中心</p>\n<p>左侧API令牌</p>\n<p>下方API密钥Global API KEY</p>\n<p>需要收邮箱验证码查看 </p>\n<p>保留好全局密钥</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012257481.png\" alt=\"image-20260117012257481\"></p>\n<h4 id=\"DNSHE网页端配置\"><a href=\"#DNSHE网页端配置\" class=\"headerlink\" title=\"DNSHE网页端配置\"></a>DNSHE网页端配置</h4><p>找到要托管的域名</p>\n<p>点击对应域名的右侧DNS服务器</p>\n<p>设置NS服务器列表</p>\n<p>填入Cloudflare给的两个Cloudflare NameServers</p>\n<p>相应每行填入一个</p>\n<p>勾选强制替换</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011644759.png\" alt=\"image-20260117011644759\"></p>\n<p>保存后如下所示</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011734330.png\" alt=\"image-20260117011734330\"></p>\n<h4 id=\"Openwrt端配置\"><a href=\"#Openwrt端配置\" class=\"headerlink\" title=\"Openwrt端配置\"></a>Openwrt端配置</h4><p>路由器安装ddns配套cloudflare插件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\">opkg install ddns-scripts-cloudflare luci-app-ddns</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">上下域名一致</span><br><span class=\"line\">IP地址版本IPv6</span><br><span class=\"line\">DDNS服务提供商cloudflare.com-v4</span><br><span class=\"line\">用户名填写Cloudflare登录邮箱</span><br><span class=\"line\">密码填写Cloudflare全局密钥</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011822347.png\" alt=\"image-20260117011822347\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011909465.png\" alt=\"image-20260117011909465\"></p>\n<h4 id=\"Lucky端配置\"><a href=\"#Lucky端配置\" class=\"headerlink\" title=\"Lucky端配置\"></a>Lucky端配置</h4><p>自行安装Lucky</p>\n<p>进入后禁用安全入口设置检查</p>\n<p>设置好用户名密码</p>\n<p>打开防火墙自动放行</p>\n<p>下面保存</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012041843.png\" alt=\"image-20260117012041843\"></p>\n<p>点击左侧SSL&#x2F;TLS证书</p>\n<p>添加证书</p>\n<p>证书备注随意</p>\n<p>添加方式选文件</p>\n<p>证书一栏上传前面保存的.pem后缀的文件</p>\n<p>Key一栏上传前面保存的.key后缀的文件</p>\n<p>点击添加即可</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012048140.png\" alt=\"image-20260117012048140\"></p>\n<p>点击左侧Web服务</p>\n<p>添加Web服务规则</p>\n<p>规则名称随意</p>\n<p>规则开关启用</p>\n<p>操作模式 简易模式</p>\n<p>监听类型必须打开IPv6，IPv4随意</p>\n<p>监听端口填想通过域名加端口形式访问的端口</p>\n<p>打开防火墙自动放行</p>\n<p>启用TLS 版本限制TLS1.2</p>\n<p>默认规则部分</p>\n<p>默认标记关</p>\n<p>服务类型反向代理</p>\n<p>默认目标地址 127.0.0.1:端口号</p>\n<p>该端口号为服务部署实际占用端口，即想代理出去的服务端口号</p>\n<p>打开万事大吉</p>\n<p>忽略后端TLS证书验证</p>\n<p>打开自动反代重定向</p>\n<p>默认记录访问日志</p>\n<p>点击修改WEB服务规则</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012100674.png\" alt=\"image-20260117012100674\"></p>\n<h4 id=\"此时外网就可以通过HTTPS安全访问了\"><a href=\"#此时外网就可以通过HTTPS安全访问了\" class=\"headerlink\" title=\"此时外网就可以通过HTTPS安全访问了\"></a>此时外网就可以通过HTTPS安全访问了</h4>","excerpt":"","more":"<h2 id=\"分为两种情况\"><a href=\"#分为两种情况\" class=\"headerlink\" title=\"分为两种情况\"></a>分为两种情况</h2><p><strong>只需要HTTP基础访问功能</strong><br><strong>需要HTTPS加密访问</strong></p>\n<h3 id=\"只需要HTTP访问（非加密）\"><a href=\"#只需要HTTP访问（非加密）\" class=\"headerlink\" title=\"只需要HTTP访问（非加密）\"></a>只需要HTTP访问（非加密）</h3><h4 id=\"注册免费域名\"><a href=\"#注册免费域名\" class=\"headerlink\" title=\"注册免费域名\"></a>注册免费域名</h4><p><a href=\"my.dnshe.com\">免费域名注册</a></p>\n<p>默认可免费注册三个</p>\n<p>如果只需要HTTP访问则需要拿到API</p>\n<p>API要求有五个免费域名</p>\n<p>需要要求两个好友才能拿到五个</p>\n<p>记录下API Key和API Secret</p>\n<h4 id=\"Openwrt安装动态DNS\"><a href=\"#Openwrt安装动态DNS\" class=\"headerlink\" title=\"Openwrt安装动态DNS\"></a>Openwrt安装动态DNS</h4><p>在系统 软件包 查找<strong>luci-app-ddns、luci-i18n-ddns-zh-cn</strong>安装</p>\n<p>安装好后刷新页面</p>\n<p>登录到路由器的 SSH（或使用 TTYD 终端），输入下面命令一键部署脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ===================== 第一步：更新opkg源 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;==== 开始更新opkg软件源 ====&quot;</span></span><br><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第二步：安装DDNS核心插件及中文语言包 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 开始安装luci-app-ddns及中文语言包 ====&quot;</span></span><br><span class=\"line\">opkg install luci-app-ddns luci-i18n-ddns-zh-cn</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第三步：创建DDNS脚本目录并写入自定义脚本 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 开始创建并写入DNSHE DDNS脚本 ====&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 确保脚本目录存在</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /usr/lib/ddns</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 写入自定义脚本（用户配置区置顶，日志位置说明紧随其后）</span></span><br><span class=\"line\"><span class=\"built_in\">cat</span> &gt; /usr/lib/ddns/dnshe-update.sh &lt;&lt; <span class=\"string\">&#x27;EOF&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#!/bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># OpenWrt Production DDNS Script for dnshe.com</span></span><br><span class=\"line\"><span class=\"comment\"># 功能：1. 兼容DNSHE的name存储规则（完整域名）；2. 根域名匹配@和完整域名；</span></span><br><span class=\"line\"><span class=\"comment\">#       3. 子域名匹配拆分后的记录名和完整域名；4. 不做IP优化，保留完整IPv6；</span></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --- [用户配置区] ---</span></span><br><span class=\"line\">DDNS_SERVICE_NAME=<span class=\"string\">&quot;myddns_ipv6&quot;</span>  <span class=\"comment\"># UCI ddns服务名称（必须与DDNS Luci界面一致）</span></span><br><span class=\"line\">API_URL=<span class=\"string\">&quot;https://api005.dnshe.com/index.php?m=domain_hub&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [环境初始化] ---</span></span><br><span class=\"line\">. /lib/functions.sh</span><br><span class=\"line\">. /lib/functions/network.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 工具路径</span></span><br><span class=\"line\">CURL=<span class=\"string\">&quot;/usr/bin/curl&quot;</span></span><br><span class=\"line\">JSONFILTER=<span class=\"string\">&quot;/usr/bin/jsonfilter&quot;</span></span><br><span class=\"line\">LOGGER=<span class=\"string\">&quot;/usr/bin/logger&quot;</span></span><br><span class=\"line\">MKDIR=<span class=\"string\">&quot;/bin/mkdir&quot;</span></span><br><span class=\"line\">DATE=<span class=\"string\">&quot;/bin/date&quot;</span></span><br><span class=\"line\">RM=<span class=\"string\">&quot;/bin/rm&quot;</span></span><br><span class=\"line\">MV=<span class=\"string\">&quot;/bin/mv&quot;</span></span><br><span class=\"line\">AWK=<span class=\"string\">&quot;/usr/bin/awk&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志配置</span></span><br><span class=\"line\">SCRIPT_NAME=$(<span class=\"built_in\">basename</span> <span class=\"string\">&quot;<span class=\"variable\">$0</span>&quot;</span>)</span><br><span class=\"line\">SCRIPT_BASE=<span class=\"string\">&quot;<span class=\"variable\">$&#123;SCRIPT_NAME%.*&#125;</span>&quot;</span></span><br><span class=\"line\">LOG_DIR=<span class=\"string\">&quot;/var/log/ddns&quot;</span></span><br><span class=\"line\">LOG_FILE_PERSIST=<span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>/<span class=\"variable\">$&#123;SCRIPT_BASE&#125;</span>.log&quot;</span></span><br><span class=\"line\">LOG_FILE_TMP=<span class=\"string\">&quot;/tmp/<span class=\"variable\">$&#123;SCRIPT_BASE&#125;</span>_last_run.log&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志轮转</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">rotate_logs</span></span>() &#123;</span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span> ] &amp;&amp; <span class=\"variable\">$RM</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span></span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span> ] &amp;&amp; <span class=\"variable\">$MV</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.2&quot;</span></span><br><span class=\"line\">    [ -f <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>&quot;</span> ]   &amp;&amp; <span class=\"variable\">$MV</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$&#123;LOG_FILE_PERSIST&#125;</span>.1&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;=== [<span class=\"subst\">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span>] 新的执行开始 ===&quot;</span> &gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_PERSIST</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;=== [<span class=\"subst\">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span>] 新的执行开始 ===&quot;</span> &gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_TMP</span>&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">write_log</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> timestamp=$(<span class=\"variable\">$DATE</span> <span class=\"string\">&#x27;+%H:%M:%S&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">local</span> msg=<span class=\"string\">&quot;[<span class=\"variable\">$timestamp</span>] <span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"variable\">$LOGGER</span> -t <span class=\"string\">&quot;ddns-<span class=\"variable\">$SCRIPT_BASE</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span> &gt;&gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_PERSIST</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span> &gt;&gt; <span class=\"string\">&quot;<span class=\"variable\">$LOG_FILE_TMP</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$msg</span>&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [核心：自动拆分域名（子域名→实例+记录名）] ---</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">split_domain</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> input_domain=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span>  <span class=\"comment\"># 传入的完整域名（如zby.shyhome.cc.cd/shyhome.cc.cd）</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤1：获取DNSHE后台所有subdomain实例</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> subdomains_res=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=subdomains&amp;action=list&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤2：遍历所有实例，匹配input_domain所属的根实例</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> subdomain_list=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$subdomains_res</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.subdomains[*].full_domain&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> instance <span class=\"keyword\">in</span> <span class=\"variable\">$subdomain_list</span>; <span class=\"keyword\">do</span></span><br><span class=\"line\">        <span class=\"comment\"># 匹配规则：input_domain以instance结尾（如zby.shyhome.cc.cd 以 shyhome.cc.cd 结尾）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span> | grep -q <span class=\"string\">&quot;\\.$instance$&quot;</span>; <span class=\"keyword\">then</span></span><br><span class=\"line\">            SUBDOMAIN_INSTANCE=<span class=\"string\">&quot;<span class=\"variable\">$instance</span>&quot;</span>  <span class=\"comment\"># 根实例（如shyhome.cc.cd）</span></span><br><span class=\"line\">            <span class=\"comment\"># 拆分记录名（zby.shyhome.cc.cd → zby）</span></span><br><span class=\"line\">            RECORD_NAME=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span> | sed <span class=\"string\">&quot;s/\\.<span class=\"variable\">$&#123;instance&#125;</span>$//&quot;</span>)</span><br><span class=\"line\">            TARGET_FULL_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span>  <span class=\"comment\"># 子域名完整域名</span></span><br><span class=\"line\">            write_log <span class=\"string\">&quot;  域名拆分成功: 根实例[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>] | 记录名[<span class=\"variable\">$RECORD_NAME</span>] | 完整域名[<span class=\"variable\">$TARGET_FULL_DOMAIN</span>]&quot;</span></span><br><span class=\"line\">            <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\">    <span class=\"keyword\">done</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 步骤3：如果是根域名（无匹配则input_domain本身就是实例）</span></span><br><span class=\"line\">    SUBDOMAIN_INSTANCE=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span></span><br><span class=\"line\">    RECORD_NAME=<span class=\"string\">&quot;@&quot;</span></span><br><span class=\"line\">    TARGET_FULL_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$input_domain</span>&quot;</span>  <span class=\"comment\"># 根域名完整域名</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;  检测到根域名: 根实例[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>] | 记录名[<span class=\"variable\">$RECORD_NAME</span>] | 完整域名[<span class=\"variable\">$TARGET_FULL_DOMAIN</span>]&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [匹配Record ID（兼容DNSHE的name存储规则）] ---</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">get_target_record_id</span></span>() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">local</span> records_json=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> record_name=<span class=\"string\">&quot;<span class=\"variable\">$2</span>&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">local</span> full_domain=<span class=\"string\">&quot;<span class=\"variable\">$3</span>&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 初始化Record ID</span></span><br><span class=\"line\">    RECORD_ID=<span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第一步：匹配记录名=record_name（如zby/@）</span></span><br><span class=\"line\">    RECORD_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$records_json</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.records[@.type=&#x27;AAAA&#x27; &amp;&amp; @.name=&#x27;<span class=\"variable\">$record_name</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;  匹配到记录名=<span class=\"variable\">$record_name</span>的记录，ID: <span class=\"variable\">$RECORD_ID</span>&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第二步：匹配记录名=完整域名（DNSHE实际存储的格式）</span></span><br><span class=\"line\">    RECORD_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$records_json</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.records[@.type=&#x27;AAAA&#x27; &amp;&amp; @.name=&#x27;<span class=\"variable\">$full_domain</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;  匹配到记录名=<span class=\"variable\">$full_domain</span>的记录（DNSHE存储格式），ID: <span class=\"variable\">$RECORD_ID</span>&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 第三步：未匹配到</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;  未发现目标记录（记录名=<span class=\"variable\">$record_name</span> 或 <span class=\"variable\">$full_domain</span>），准备新建&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [初始化] ---</span></span><br><span class=\"line\">[ ! -d <span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>&quot;</span> ] &amp;&amp; <span class=\"variable\">$MKDIR</span> -p <span class=\"string\">&quot;<span class=\"variable\">$LOG_DIR</span>&quot;</span></span><br><span class=\"line\">rotate_logs</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [核心逻辑] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 1: 环境检查与工具验证...&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ ! -x <span class=\"string\">&quot;<span class=\"variable\">$CURL</span>&quot;</span> ]; <span class=\"keyword\">then</span> write_log <span class=\"string\">&quot;错误: 找不到 curl 工具&quot;</span>; <span class=\"built_in\">exit</span> 1; <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ ! -x <span class=\"string\">&quot;<span class=\"variable\">$JSONFILTER</span>&quot;</span> ]; <span class=\"keyword\">then</span> write_log <span class=\"string\">&quot;错误: 找不到 jsonfilter 工具&quot;</span>; <span class=\"built_in\">exit</span> 1; <span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 2: 获取参数...&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 优先从环境变量获取（DDNS传参：$1=KEY, $2=SECRET, $3=DOMAIN, $4=IP）</span></span><br><span class=\"line\">MY_KEY=<span class=\"string\">&quot;<span class=\"variable\">$&#123;username:-<span class=\"variable\">$__USERNAME</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> ] &amp;&amp; MY_KEY=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_SECRET=<span class=\"string\">&quot;<span class=\"variable\">$&#123;password:-<span class=\"variable\">$__PASSWORD</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_SECRET</span>&quot;</span> ] &amp;&amp; MY_SECRET=<span class=\"string\">&quot;<span class=\"variable\">$2</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$&#123;domain:-<span class=\"variable\">$__DOMAIN</span>&#125;</span>&quot;</span></span><br><span class=\"line\">[ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span> ] &amp;&amp; MY_DOMAIN=<span class=\"string\">&quot;<span class=\"variable\">$3</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">MY_IP=<span class=\"string\">&quot;<span class=\"variable\">$&#123;__IP:-<span class=\"variable\">$4</span>&#125;</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 灾难恢复机制</span></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    *:*|*.*) </span><br><span class=\"line\">        write_log <span class=\"string\">&quot;警告: 检测到参数错乱 (Key 似 IP)，启动灾难恢复机制...&quot;</span></span><br><span class=\"line\">        write_log <span class=\"string\">&quot;正在从 UCI 配置 &#x27;ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>&#x27; 强制读取参数...&quot;</span></span><br><span class=\"line\">        MY_KEY=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.username 2&gt;/dev/null)</span><br><span class=\"line\">        MY_SECRET=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.password 2&gt;/dev/null)</span><br><span class=\"line\">        MY_DOMAIN=$(uci get ddns.<span class=\"variable\">$DDNS_SERVICE_NAME</span>.domain 2&gt;/dev/null)</span><br><span class=\"line\">        ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 仅清洗IP格式（去除换行符），不做任何前缀提取/优化</span></span><br><span class=\"line\">MY_IP=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> | <span class=\"built_in\">tr</span> -d <span class=\"string\">&#x27;\\n\\r&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 二次补救 IP</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span> <span class=\"keyword\">in</span> *:*) MY_IP=<span class=\"string\">&quot;<span class=\"variable\">$1</span>&quot;</span> ;; <span class=\"keyword\">esac</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 记录参数 (敏感信息打码)</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;参数确认:&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - API Key: <span class=\"variable\">$&#123;MY_KEY:0:6&#125;</span>******&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - 目标域名 : <span class=\"variable\">$MY_DOMAIN</span>&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  - Target IP: <span class=\"variable\">$MY_IP</span>&quot;</span> <span class=\"comment\"># 完整保留获取到的IPv6地址</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_KEY</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_SECRET</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span> ] || [ -z <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;致命错误: 必要参数缺失&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [自动拆分域名] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 3: 自动拆分域名...&quot;</span></span><br><span class=\"line\">split_domain <span class=\"string\">&quot;<span class=\"variable\">$MY_DOMAIN</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取根实例的Subdomain ID</span></span><br><span class=\"line\">SUBDOMAIN_RES=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=subdomains&amp;action=list&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">SUBDOMAIN_ID=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_RES</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.subdomains[@.full_domain=&#x27;<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>&#x27;].id&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;错误: 未能提取 Subdomain ID，请检查域名[<span class=\"variable\">$SUBDOMAIN_INSTANCE</span>]是否在账号下&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  获取成功，Subdomain ID: <span class=\"variable\">$SUBDOMAIN_ID</span> | 根实例: <span class=\"variable\">$SUBDOMAIN_INSTANCE</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [获取Record ID（兼容DNSHE存储规则）] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 4: 获取 Record ID (现有记录)...&quot;</span></span><br><span class=\"line\">RECORDS_RES=$(<span class=\"variable\">$CURL</span> -k -s -X GET <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=list&amp;subdomain_id=<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span>)</span><br><span class=\"line\">write_log <span class=\"string\">&quot;  API 响应: <span class=\"variable\">$RECORDS_RES</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 匹配Record ID（兼容DNSHE的name存储规则）</span></span><br><span class=\"line\">get_target_record_id <span class=\"string\">&quot;<span class=\"variable\">$RECORDS_RES</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$TARGET_FULL_DOMAIN</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    ACTION_TYPE=<span class=\"string\">&quot;update&quot;</span> <span class=\"comment\"># 更新现有记录</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    ACTION_TYPE=<span class=\"string\">&quot;create&quot;</span> <span class=\"comment\"># 新建记录</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [执行更新/创建] ---</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;步骤 5: 执行操作 (<span class=\"variable\">$ACTION_TYPE</span>)...&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">&quot;<span class=\"variable\">$ACTION_TYPE</span>&quot;</span> = <span class=\"string\">&quot;update&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"comment\"># 更新现有记录（覆盖旧IP）</span></span><br><span class=\"line\">    JSON_PAYLOAD=$(<span class=\"built_in\">printf</span> <span class=\"string\">&#x27;&#123;&quot;record_id&quot;: %d, &quot;name&quot;: &quot;%s&quot;, &quot;content&quot;: &quot;%s&quot;, &quot;ttl&quot;: 600&#125;&#x27;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_ID</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span>)</span><br><span class=\"line\">    FINAL_RES=$(<span class=\"variable\">$CURL</span> -k -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=update&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">      -d <span class=\"string\">&quot;<span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    <span class=\"comment\"># 新建记录（使用拆分后的记录名）</span></span><br><span class=\"line\">    JSON_PAYLOAD=$(<span class=\"built_in\">printf</span> <span class=\"string\">&#x27;&#123;&quot;subdomain_id&quot;: %d, &quot;type&quot;: &quot;AAAA&quot;, &quot;name&quot;: &quot;%s&quot;, &quot;content&quot;: &quot;%s&quot;, &quot;ttl&quot;: 600&#125;&#x27;</span> <span class=\"string\">&quot;<span class=\"variable\">$SUBDOMAIN_ID</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$RECORD_NAME</span>&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$MY_IP</span>&quot;</span>)</span><br><span class=\"line\">    FINAL_RES=$(<span class=\"variable\">$CURL</span> -k -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$API_URL</span>&amp;endpoint=dns_records&amp;action=create&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Key: <span class=\"variable\">$MY_KEY</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;X-API-Secret: <span class=\"variable\">$MY_SECRET</span>&quot;</span> \\</span><br><span class=\"line\">      -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">      -d <span class=\"string\">&quot;<span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  Payload: <span class=\"variable\">$JSON_PAYLOAD</span>&quot;</span></span><br><span class=\"line\">write_log <span class=\"string\">&quot;  API 最终响应: <span class=\"variable\">$FINAL_RES</span>&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># --- [结果判定] ---</span></span><br><span class=\"line\">IS_SUCCESS=$(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$FINAL_RES</span>&quot;</span> | <span class=\"variable\">$JSONFILTER</span> -e <span class=\"string\">&quot;@.success&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">&quot;<span class=\"variable\">$IS_SUCCESS</span>&quot;</span> = <span class=\"string\">&quot;true&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;步骤 6: 结果判定 -&gt; 成功！&quot;</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;=== 脚本执行结束 (Success) ===&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 0</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;步骤 6: 结果判定 -&gt; 失败！错误信息: <span class=\"variable\">$FINAL_RES</span>&quot;</span></span><br><span class=\"line\">    write_log <span class=\"string\">&quot;=== 脚本执行结束 (Failed) ===&quot;</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\">EOF</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第四步：给脚本添加可执行权限 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 给DNSHE DDNS脚本添加执行权限 ====&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">chmod</span> +x /usr/lib/ddns/dnshe-update.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ===================== 第五步：验证安装和脚本创建结果 =====================</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 验证结果 ====&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;1. DDNS插件安装状态：&quot;</span></span><br><span class=\"line\">opkg list-installed | grep ddns</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n2. 脚本文件及权限：&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">ls</span> -l /usr/lib/ddns/dnshe-update.sh</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;\\n==== 所有操作完成！====</span></span><br><span class=\"line\"><span class=\"string\">- DDNS插件已安装并支持中文</span></span><br><span class=\"line\"><span class=\"string\">- DNSHE自定义脚本已创建：/usr/lib/ddns/dnshe-update.sh</span></span><br><span class=\"line\"><span class=\"string\">- 脚本已赋予执行权限</span></span><br><span class=\"line\"><span class=\"string\">- 日志文件位置：/var/log/ddns/dnshe-update.log（持久）/tmp/dnshe-update_last_run.log（临时）&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置-LuCI-界面\"><a href=\"#配置-LuCI-界面\" class=\"headerlink\" title=\"配置 LuCI 界面\"></a>配置 LuCI 界面</h4><p>回到 OpenWrt 界面（<code>服务项 » 动态DNS  » myddns_ipv6</code>），按照以下方式填空：</p>\n<p><strong>基础设置</strong></p>\n<ul>\n<li><strong>勾选已启用</strong></li>\n<li><strong>域名</strong>: <code>yourhost.example.com</code> (填写你的实际完整域名，必须要在你的 API 账号里已经存在)</li>\n<li><strong>IP 地址版本</strong>: <code>IPv6</code></li>\n<li><strong>DDNS 服务提供商 [IPv4&#x2F;IPv6]</strong>: 选择 <code>自定义</code> </li>\n<li><strong>自定义更新 URL</strong>: (留空，不要填)</li>\n<li><strong>自定义更新脚本</strong>: <code>/etc/ddns/update_dnshe_ipv6.sh</code></li>\n<li><strong>用户名</strong>: 填写你的 <strong>API Key</strong></li>\n<li><strong>密码</strong>:  填写你的 <strong>API Secret</strong></li>\n<li><strong>使用 HTTPS</strong>: (如果脚本不工作，可以尝试取消勾选，但在脚本模式下这个选项通常只影响 wget&#x2F;curl 库的选择，脚本里我们强制用了 curl，所以这个选项影响不大，建议勾选)</li>\n<li><strong>CA证书路径:</strong> 默认留空，会自动填入IGNORE</li>\n</ul>\n<p><strong>高级设置</strong></p>\n<ul>\n<li><strong>IP地址来源：</strong>网络</li>\n<li><strong>网络：</strong>wan6（有ipv6的）</li>\n<li><strong>勾选记录日志到文件</strong></li>\n<li>其余默认</li>\n</ul>\n<p><strong>定时器设定</strong></p>\n<ul>\n<li><strong>检查间隔：</strong>10</li>\n<li><strong>检查间隔单位：</strong>分钟</li>\n<li><strong>强制更新间隔：</strong>3</li>\n<li><strong>强制更新间隔单位</strong>：天</li>\n<li>其余默认</li>\n</ul>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011037150.png\" alt=\"image-20260117011037150\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011055652.png\" alt=\"image-20260117011055652\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011116952.png\" alt=\"image-20260117011116952\"></p>\n<p>防火墙区域设置</p>\n<p>常规设置全部接受</p>\n<p>下方区域全部接受</p>\n<p>通信规则页可再配置WAN到本设备接受入站、WAN到LAN接受转发</p>\n<p><strong>注意，这样谁都可以访问进入你的局域网，极其危险！！！</strong></p>\n<p><strong>如需精细化管理，可单独只开部分端口</strong></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011217372.png\" alt=\"image-20260117011217372\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011231365.png\" alt=\"image-20260117011231365\"></p>\n<h4 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h4><p>以上配置好后，就可以通过域名加端口形式访问路由器部署的服务</p>\n<p>如果像访问内部局域网设备，则需要配置相应端口转发</p>\n<p>家庭宽带默认不开放80和443端口</p>\n<p>由于是非加密的访问，建议开放的服务都配置账号密码</p>\n<h3 id=\"需要HTTPS加密访问，托管到Cloudflare并部署证书\"><a href=\"#需要HTTPS加密访问，托管到Cloudflare并部署证书\" class=\"headerlink\" title=\"需要HTTPS加密访问，托管到Cloudflare并部署证书\"></a>需要HTTPS加密访问，托管到Cloudflare并部署证书</h3><h4 id=\"域名托管到Cloudflare\"><a href=\"#域名托管到Cloudflare\" class=\"headerlink\" title=\"域名托管到Cloudflare\"></a>域名托管到Cloudflare</h4><p><a href=\"dash.cloudflare.com\">Cloudflare官网</a></p>\n<p>进入后登录</p>\n<p>填写要托管的域名</p>\n<p>下一步</p>\n<p>如果可以选择套餐了就说明可以托管</p>\n<p>接着下一步</p>\n<p>会出现两个NS用的服务器</p>\n<p>记录下来</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011500179.png\" alt=\"image-20260117011500179\"></p>\n<p>点左侧SSL&#x2F;TLS Origin Server</p>\n<p>创建证书</p>\n<p>记录两串字符</p>\n<p>上面的保存为  .pem后缀文件</p>\n<p>下面的保存为  .key后缀文件</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011540956.png\" alt=\"image-20260117011540956\"></p>\n<p>接着获取全局密钥</p>\n<p>全局密钥在Cloudflare右上角个人中心</p>\n<p>左侧API令牌</p>\n<p>下方API密钥Global API KEY</p>\n<p>需要收邮箱验证码查看 </p>\n<p>保留好全局密钥</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012257481.png\" alt=\"image-20260117012257481\"></p>\n<h4 id=\"DNSHE网页端配置\"><a href=\"#DNSHE网页端配置\" class=\"headerlink\" title=\"DNSHE网页端配置\"></a>DNSHE网页端配置</h4><p>找到要托管的域名</p>\n<p>点击对应域名的右侧DNS服务器</p>\n<p>设置NS服务器列表</p>\n<p>填入Cloudflare给的两个Cloudflare NameServers</p>\n<p>相应每行填入一个</p>\n<p>勾选强制替换</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011644759.png\" alt=\"image-20260117011644759\"></p>\n<p>保存后如下所示</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011734330.png\" alt=\"image-20260117011734330\"></p>\n<h4 id=\"Openwrt端配置\"><a href=\"#Openwrt端配置\" class=\"headerlink\" title=\"Openwrt端配置\"></a>Openwrt端配置</h4><p>路由器安装ddns配套cloudflare插件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\">opkg install ddns-scripts-cloudflare luci-app-ddns</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">上下域名一致</span><br><span class=\"line\">IP地址版本IPv6</span><br><span class=\"line\">DDNS服务提供商cloudflare.com-v4</span><br><span class=\"line\">用户名填写Cloudflare登录邮箱</span><br><span class=\"line\">密码填写Cloudflare全局密钥</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011822347.png\" alt=\"image-20260117011822347\"></p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117011909465.png\" alt=\"image-20260117011909465\"></p>\n<h4 id=\"Lucky端配置\"><a href=\"#Lucky端配置\" class=\"headerlink\" title=\"Lucky端配置\"></a>Lucky端配置</h4><p>自行安装Lucky</p>\n<p>进入后禁用安全入口设置检查</p>\n<p>设置好用户名密码</p>\n<p>打开防火墙自动放行</p>\n<p>下面保存</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012041843.png\" alt=\"image-20260117012041843\"></p>\n<p>点击左侧SSL&#x2F;TLS证书</p>\n<p>添加证书</p>\n<p>证书备注随意</p>\n<p>添加方式选文件</p>\n<p>证书一栏上传前面保存的.pem后缀的文件</p>\n<p>Key一栏上传前面保存的.key后缀的文件</p>\n<p>点击添加即可</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012048140.png\" alt=\"image-20260117012048140\"></p>\n<p>点击左侧Web服务</p>\n<p>添加Web服务规则</p>\n<p>规则名称随意</p>\n<p>规则开关启用</p>\n<p>操作模式 简易模式</p>\n<p>监听类型必须打开IPv6，IPv4随意</p>\n<p>监听端口填想通过域名加端口形式访问的端口</p>\n<p>打开防火墙自动放行</p>\n<p>启用TLS 版本限制TLS1.2</p>\n<p>默认规则部分</p>\n<p>默认标记关</p>\n<p>服务类型反向代理</p>\n<p>默认目标地址 127.0.0.1:端口号</p>\n<p>该端口号为服务部署实际占用端口，即想代理出去的服务端口号</p>\n<p>打开万事大吉</p>\n<p>忽略后端TLS证书验证</p>\n<p>打开自动反代重定向</p>\n<p>默认记录访问日志</p>\n<p>点击修改WEB服务规则</p>\n<p><img src=\"/images/DDNS%E5%88%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%85%A8%E6%B5%81%E7%A8%8B.assets/image-20260117012100674.png\" alt=\"image-20260117012100674\"></p>\n<h4 id=\"此时外网就可以通过HTTPS安全访问了\"><a href=\"#此时外网就可以通过HTTPS安全访问了\" class=\"headerlink\" title=\"此时外网就可以通过HTTPS安全访问了\"></a>此时外网就可以通过HTTPS安全访问了</h4>"},{"title":"二级路由公网IPv6再分配","date":"2026-01-15T14:59:00.000Z","_content":"\n\n**记录时间：** 2026-01-15\n**环境标签：** OpenWrt 22.03+、IPv6、Prefix Delegation(PD)、多级路由、桥接模式\n**核心价值：** 解析 IPv6 前缀委派底层逻辑，解决二级路由下设备无法获取公网 IPv6 的核心痛点，附带技术原理解析与避坑指南\n\n---\n\n## 背景与网络拓扑\n\n### 网络架构\n\n![image-20260115233010932](/images/二级路由公网IPv6再分配.assets/image-20260115233010932.png)\n\n- **光猫**：工作在桥接模式，仅负责光电转换，不参与路由与 DHCP 分配\n- **A 路由器（主路由）**：\n  - 系统：OpenWrt 软路由\n  - WAN 口：PPPoE 拨号，从 ISP 获取 `/60` 长度的 IPv6 公网前缀\n  - LAN 网段：`192.168.2.1/24`（已稳定运行，不改动）\n- **B 路由器（二级路由）**：\n  - 系统：OpenWrt 软路由\n  - 连接方式：WAN 口直连 A 路由器 LAN 口\n  - LAN 网段：`192.168.6.1/24`（核心约束：必须保留独立网段，不允许改为 AP 模式或合并网段）\n- **终端设备**：需通过 任意A、B 路由器获取 **全球唯一、可公网路由的 IPv6 地址**（非 ULA 私有地址、非 NAT66 转换地址）\n\n```mermaid\ngraph TD\n    光猫[\"光猫 - 桥接模式\"] --> A路由[\"A路由器（主路由）\"]\n    A路由 -->|LAN→WAN| B路由[\"B路由器（二级路由）\"]\n    B路由 --> 终端设备[\"PC/手机/IoT设备\"]\n    \n\n```\n\n```mermaid\ngraph TD\n\tsubgraph \"A路由配置（Qihoo 360T7）\"\n        A_HW[\"硬件：Qihoo 360T7/ARMv8\"]\n        A_SYS[\"系统：ImmortalWrt 24.10-SNAPSHOT/内核6.6.95\"]\n        A_WAN[\"WAN：PPPoE拨号\"]\n        A_LAN[\"LAN：192.168.2.1/24\"]\n    end\n```\n\n```mermaid\ngraph TD\n    subgraph \"B路由配置（JDCloud RE-CS-02）\"\n        B_HW[\"硬件：JDCloud RE-CS-02 AX6600/ARMv8\"]\n        B_SYS[\"系统：BleachWrt Docker 20251212/内核6.12.61\"]\n        B_WAN[\"WAN：DHCP\"]\n        B_LAN[\"LAN：192.168.6.1/24\"]\n    end\n```\n\n\n\n### 核心需求与约束\n\n- **功能需求：**A、B 路由下设备获取 **全球唯一公网 IPv6 地址**（非 ULA 私有地址、非 NAT66 转换）\n- **禁止操作：**不合并网段、不修改 A/B 路由 IPv4 网段、B 路由不切换 AP 模式。\n\n### 初始故障现象\n\n**核心故障：B 路由器无法获取 IPv6 前缀委派（PD），其 LAN 口仅分配 `fde8::` 开头的 ULA 私有地址，导致下联设备无法访问 IPv6 公网**\n\n| 设备/接口       | IPv6 状态                                                    | 异常点分析                       |\n| --------------- | ------------------------------------------------------------ | -------------------------------- |\n| A 路由 LAN 设备 | 正常获取公网 IPv6（2409::/60 网段），可访问 IPv6 公网资源 | -                                |\n| B 路由 WAN6 口  | 获得公网 IPv6 地址（2409::/64） | **仅获取地址，未获取 PD 前缀池** |\n| B 路由 LAN 口   | 仅分配 ULA 地址（fde8:::1/64），无公网 IPv6 前缀    | **PD 未穿透，无法分发公网地址**  |\n| B 下终端设备    | 仅获取 fde8:: 私有地址，部分设备偶然出现非 A 路由网段公网 IPv6| **地址来源异常，不可靠**         |\n\n---\n\n## 核心技术概念解析（先懂原理再配置）\n\n### 什么是 IPv6 前缀委派（Prefix Delegation, PD）？\n\nIPv6 前缀委派是 DHCPv6 协议的核心扩展功能，用于 **多级路由场景下的前缀分配与管理**。简单说：\n\n- ISP 向主路由（A）分配一个大的 IPv6 前缀（如本文 `/60`），相当于给主路由分配了一个\"地址池\"\n- 主路由（A）通过 PD 机制，将这个大前缀拆分成多个小前缀（如 `/64`），分发给下游路由（B）\n- 下游路由（B）再用分到的小前缀，为自己 LAN 下的设备分配独立公网 IPv6 地址\n\n**类比理解**：ISP 给你家（A 路由）分配了一栋 16 层的楼（`/60` 前缀，可拆 16 个 `/64` 子网），PD 就是你把其中一层（如第 4 层，`/64` 子网）分配给租客（B 路由），租客再把这一层的房间（独立 IPv6 地址）分配给家人（终端设备）。\n\n### IPv6 PD 协议交互流程\n\nPD 并非简单的\"地址分配\"，而是 **DHCPv6 协议簇的 IA_PD（Identity Association for Prefix Delegation）交互过程**，核心流程如下：\n\n1. **A 路由拨号阶段**：A 路由通过 PPPoE 发送 DHCPv6 Solicit 报文，携带 IA_PD 请求选项，ISP 回应 Advertise 报文，分配 /60 前缀（2409:8a38:1422:4cxx::/60）\n2. **B 路由请求阶段**：B 路由 WAN6 口发送 DHCPv6 Solicit 报文，携带 IA_PD（请求 /64 前缀）和 IA_NA（请求自身 IPv6 地址）选项\n3. **A 路由分配阶段**：A 路由的 odhcpd 服务接收请求，从 /60 前缀池中拆分出一个 /64 子前缀（如 2409:8a38:1422:4cyy::/64），通过 Reply 报文返回给 B 路由\n4. **B 路由分发阶段**：B 路由将获得的 /64 前缀配置到 br-lan 接口，通过 RA 报文通告给终端，同时 DHCPv6 服务器补充 DNS 等配置\n\n### 为什么 IPv6 最小子网必须是 `/64`？\n\n这是 IPv6 协议设计的硬性规范，核心原因有三：\n\n1. **SLAAC 地址自动配置需求**：IPv6 无状态地址自动配置（SLAAC）依赖 EUI-64 格式生成地址，SLAAC 协议要求接口标识字段为 64 位（通过 MAC 地址转换生成），因此子网前缀必须为 /64（网络位 64 + 接口位 64 = 128 位完整地址）\n\n2. **协议兼容性**：几乎所有 IPv6 设备（电脑、手机、IoT 设备）仅支持 `/64` 子网，非 `/64` 子网（如 `/63`、`/65`）会导致设备无法自动获取地址或通信异常\n\n   > RFC 4291 明确规定，除点对点链路外，所有 IPv6 子网必须使用 /64 前缀，非 /64 子网（如 /63、/65）会导致设备拒绝接收 RA 报文\n\n3. **路由标准化**：ISP 分配的公网前缀（如 `/56`、`/60`）均为 `/64` 的整数倍（`/56` 可拆 256 个 `/64`，`/60` 可拆 16 个 `/64`），确保多级分配无浪费\n\n### 前缀委派成功的三大核心条件\n\n1. **上游路由（A）**：\n   - 已从 ISP 获取合法公网前缀（如 `/60`）\n   - 启用 DHCPv6 服务器与 RA（路由通告）服务\n   - 允许向下游路由分发子前缀（PD 分发权限开启）\n2. **下游路由（B）**：\n   - WAN6 口启用 DHCPv6 客户端，且显式请求前缀委派\n   - LAN 口配置为从 PD 前缀自动获取地址，启用 RA/DHCPv6 服务\n3. **通信链路**：\n   - 两级路由之间允许 DHCPv6 协议（UDP 546/547 端口）与 ICMPv6 协议（RS/RA/NS/NA 类型）通行\n\n---\n\n## 根本故障原因\n\n**B 路由未获取 PD 前缀，A 路由 odhcpd 服务因配置限制，未响应 B 路由的 IA_PD 请求。**\n\n### 核心误区：对 \"PD 最小长度\" 的理解错误\n\nA 路由器 Web UI（LuCI）中，DHCPv6 服务器有一个关键选项 **\"PD 最小长度（Minimum Prefix Delegation Length）\"**，这是本次踩坑的核心陷阱：\n\n| 错误认知                               | 正确逻辑                                             | 底层原理                                                     |\n| -------------------------------------- | ---------------------------------------------------- | ------------------------------------------------------------ |\n| \"要分给 B 路由 `/64` 子网，所以填 64\"  | \"PD 最小长度 = 上游获取的前缀长度（如 `/60`）\"       | 该字段实际含义是 **\"允许向下游分配的最长前缀长度下限\"**，填 `/60` 表示\"允许分配 `/60` 及更长的前缀（如 `/61`、`/62`、`/64`）\" |\n| \"UI 限制 1-62，无法填 64 就是配置不了\" | \"UI 限制是 Bug，填 `/60` 即可触发底层自动分配 `/64`\" | OpenWrt 底层 odhcpd 服务支持从 `/60` 拆分 `/64`，LuCI 前端硬编码输入范围，与底层 odhcpd 服务支持冲突，UI 输入限制仅为前端逻辑，不影响底层功能 |\n\n### 故障点\n\n- B 路由器 WAN6 口未显式配置 `reqprefix='auto'`，仅请求了 IPv6 地址，未请求前缀委派\n- 初始配置中 A 路由器错配未勾选 \"将委派前缀60并分配给下游\"，导致 B 路由的 PD 请求被拒绝\n\n---\n\n## 分步解决方案（按优先级排序）\n\n### 4.1 A 路由器（上游主路由PD分发端）配置\n\n#### 让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求\n\n1. **WAN 接口配置**：\n\n   - 协议：PPPoEc\n   - 勾选：`请求 IPv6 前缀委派（Request IPv6 prefix delegation）`\n   - 高级设置：`使用默认网关，自动获取DNS服务器，开启IPv6源路由，委托IPv6前缀，禁用IPv6分配长度，其余默认`\n   - `使用对等 DNS` 勾选（若有）\n   - DHCP服务器：`常规设置 忽略此接口，指定的主接口默认关闭，IPv6设置全部禁用`\n   - 确认：已获取 `/60` 前缀（如 `2409:8a38:1422:4c20::/60`）\n\n2. **LAN 接口 → DHCP 服务器 → IPv6 设置**：\n\n   - 高级设置：`开启委托IPv6前缀，IPv6分配长度设置为64，其余默认`\n\n   - DHCP服务器：\n\n     - `高级设置动态DHCP开启`\n\n     - `IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认`\n\n       >  RA 服务：`服务器模式`（必须，用于向 B 路由通告路由信息）\n       >\n       > DHCPv6 服务：`服务器模式`（必须，用于分配 DNS 等配置信息）\n       >\n       > NDP 代理：`禁用`（默认禁用，无需改动）\n\n     - `IPv6 RA设置 启用SLAAC RA标记改为其他配置 DHCPv6模式改为无状态+有状态的 其余默认`\n\n3. **保存配置并应用**\n\n### B 路由器（下游二级路由）配置\n\n#### 让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发\n\n1. **WAN6 接口配置**（关键：请求 PD 而非仅请求地址）：\n\n   - 协议：DHCPv6 客户端\n   - 请求 IPv6 地址：`try`（尝试获取，不强制，避免拨号失败）\n   - 请求指定长度的 IPv6 前缀：`自动（auto）`（告诉 A 路由\"我需要一个子前缀\"）\n   - 高级设置：勾选 `使用默认网关 使用对等通告的DNS服务器` 其余默认（从 A 路由获取 IPv6 DNS 服务器）\n\n2. **LAN 接口 → DHCP 服务器 → IPv6 设置**：\n\n   - RA 服务：`服务器模式`（向下游设备通告路由）\n\n   - 基本设置：`IPv6分配长度改为64`\n\n   - DHCP服务器：\n\n     - `高级设置动态DHCP开启`\n\n     - `IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认`\n\n       >  RA路由通告服务：`服务器模式`\n       >\n       > DHCPv6 服务：`服务器模式`\n       >\n       > NDP 代理：`禁用`（默认禁用，无需改动）\n       >\n       > IPv6 RA设置 启用SLAAC RA标记改为其他配置（若有）\n       >\n       > DHCPv6模式改为无状态+有状态的\n       >\n       > 勾选：`总是通告默认路由`\n       >\n       > 其余默认\n\n3. **保存配置并应用**\n\n### 防火墙配置（默认已兼容，异常时检查）\n\nIPv6 通信依赖 ICMPv6 与 DHCPv6 协议，确保 A/B 路由防火墙未拦截：\n\n- 允许 UDP 546/547 端口（DHCPv6 客户端/服务器端口）\n- 允许 ICMPv6 类型 133（RS 路由请求）、134（RA 路由通告）、135（NS 邻居请求）、136（NA 邻居通告）\n- OpenWrt 默认防火墙规则已放行上述流量，无需额外配置，除非手动修改过默认规则\n\n- 命令行放行（若默认规则被修改）：\n\n  ```bash\n  # A/B 路由均执行\n  uci add firewall rule\n  uci set firewall.@rule[-1].name='Allow-DHCPv6'\n  uci set firewall.@rule[-1].proto='udp'\n  uci set firewall.@rule[-1].src='lan'\n  uci set firewall.@rule[-1].dest_port='546-547'\n  uci set firewall.@rule[-1].target='ACCEPT'\n  \n  uci add firewall rule\n  uci set firewall.@rule[-1].name='Allow-ICMPv6'\n  uci set firewall.@rule[-1].proto='icmpv6'\n  uci set firewall.@rule[-1].src='lan'\n  uci set firewall.@rule[-1].icmp_type='133 134 135 136'\n  uci set firewall.@rule[-1].target='ACCEPT'\n  \n  uci commit firewall\n  /etc/init.d/firewall restart\n  ```\n\n---\n\n## 修改后状态验证\n\n### B 路由器状态验证\n\n1. **Web UI 验证**：\n\n   - WAN6 接口：显示 `IPv6-PD` 字段（如 `2409:xxyy:xxyy:xxyy::/62`），表示成功获取子前缀池\n   - LAN 接口（br-lan）：显示公网 IPv6 地址（如 `2409:xxyy:xxyy:xxyy::1/64`），同时可能存在 `fde8::` 开头的 ULA 地址（可忽略，不影响使用）\n\n2. **SSH 命令验证**：\n\n   ```bash\n   # 查看 PD 获取状态\n   ubus call network.interface.wan6 status | grep -A6 \"ipv6-prefix\"\n   # 成功输出示例\n   \"ipv6-prefix\": [\n     {\n       \"address\": \"2409:xxyy:xxyy:xxyy::\",\n       \"mask\": 62,  # 显示 /62 是正常的，底层会自动拆分 /64 子网\n       \"preferred\": 86400,\n       \"valid\": 172800\n     }\n   ]\n   ```\n\n   - 查看 LAN 口 IPv6 地址：`ip -6 addr show br-lan`，需存在 `scope global` 类型的公网地址（非 `fe80::` 链路本地地址）\n\n3. **终端设备验证（Windows/macOS/Linux）**：\n\n   - Windows：`ipconfig /all` 应显示 2409:xxyy:xxyy:xxyy 地址\n\n   - macOS/Linux：`ip -6 addr` 应显示 scope global 类型的  2409:xxyy:xxyy:xxyy开头地址\n\n   - 连通性测试：访问 `https://test-ipv6.com/`，得分 10/10 表示配置完全正确\n\n     ```bash\n     # 命令行\n     ping6 ipv6.google.com  # 通表示路由正常\n     curl -6 https://api6.ipify.org  # 返回公网 IPv6 地址表示成功\n     ```\n\n## 排错工具链（从日志到抓包）\n\n### 常见误区原因\n\n1. **误区 1**：PD 最小长度填 `64` → 正确做法：填上游获取的前缀长度（如 `/60`）\n   - 原因：UI 显示\"最小长度\"实为\"最长前缀允许下限\"，填 `/60` 才能让系统拆分 `/64` 子前缀\n2. **误区 2**：B 路由 WAN6 仅请求地址，未请求 PD → 正确做法：必须设置 `reqprefix='auto'`\n   - 原因：仅请求地址会导致 B 路由只有自身 IPv6 地址，没有子前缀池，无法分给下游设备\n3. **误区 3**：手动给 B 路由 LAN 口指定静态 IPv6 地址 → 正确做法：留空，让系统从 PD 自动获取\n   - 原因：手动指定会导致地址与 PD 前缀不匹配，下游设备无法获取有效地址\n\n### 常见故障排查\n\n| 故障现象                   | 排查步骤                                                     | 解决方案                                                     |\n| -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| B 路由 WAN6 无 IPv6-PD     | 1. 检查 A 路由是否勾选\"分配 PD 给下游\"；2. 检查 B 路由 reqprefix 是否为 auto；3. 查看 A 路由日志 `logread | grep dhcpv6` | 1. 勾选 A 路由 PD 分发选项；2. 配置 B 路由 reqprefix=auto；3. 重启 A 路由 odhcpd 服务 |\n| B 路由 LAN 口无公网 IPv6   | 1. 检查 B 路由 LAN 分配长度是否为 64；2. 查看 PD 是否获取成功；3. 重启 B 路由网络服务 | 1. 设为 64 子网；2. 重新请求 PD；3. 执行 `/etc/init.d/network restart` |\n| 终端有公网 IPv6 但无法上网 | 1. 检查是否为 ULA 地址（fd 开头）；2. 验证默认路由是否存在；3. 测试 DNS 解析 `nslookup -type=AAAA ipv6.google.com` | 1. 确保获取公网前缀（2409: 等）；2. 确认 RA 已通告默认路由；3. 检查 DNS 配置是否正确 |\n\n### **日志分析（SSH）**：\n\n- 查看 A 路由 PD 分配日志：`logread | grep odhcpd | grep -E 'prefix|delegate'`\n- 查看 B 路由 PD 请求日志：`logread | grep dhcp6c | grep -E 'IA_PD|prefix'`\n- 关键成功日志：`dhcp6c: client6_recvreply: reply received from fe80::e2ef:2ff:fed0:ac01%wan, pending IAID 0`\n\n### **抓包验证（需安装 tcpdump）**：\n\n```bash\n# B 路由安装 tcpdump\nopkg update && opkg install tcpdump\n# 抓取 WAN6 口 DHCPv6 报文\ntcpdump -i wan6 port 546 or port 547 -vvv\n# 成功标志：存在 DHCPv6 Reply 报文，携带 IA_PD 选项（前缀 2409:8a38:1422:4cyy::/64）\n```\n\n## 总结\n\n### 协议本质\n\nIPv6 PD 穿透的核心是 **\"请求-分配-分发\"的 DHCPv6 交互闭环**，OpenWrt/ImmortalWrt 的 UI 限制只是表象，通过 SSH 命令行可直接操作底层配置文件，突破前端限制。对于无独立 RA 配置的机型，记住\"DHCPv6 服务器模式=RA 服务器模式\"的等效关系，即可实现功能全覆盖。\n\n本方案已在 Qihoo 360T7（ImmortalWrt 24.10）+ JDCloud RE-CS-02 AX6600（BleachWrt 25.10.10）环境验证通过，适用于所有 OpenWrt 22.03+ 衍生版本，以及 ISP 提供 /56、/60 前缀的场景。\n\n\n\n","source":"_posts/二级路由公网IPv6再分配.md","raw":"---\ntitle: 二级路由公网IPv6再分配\ndate: 2026-01-15 22:59\ncategories: 学习笔记\ntags: [技术, 教程, Openwrt]\n---\n\n\n**记录时间：** 2026-01-15\n**环境标签：** OpenWrt 22.03+、IPv6、Prefix Delegation(PD)、多级路由、桥接模式\n**核心价值：** 解析 IPv6 前缀委派底层逻辑，解决二级路由下设备无法获取公网 IPv6 的核心痛点，附带技术原理解析与避坑指南\n\n---\n\n## 背景与网络拓扑\n\n### 网络架构\n\n![image-20260115233010932](/images/二级路由公网IPv6再分配.assets/image-20260115233010932.png)\n\n- **光猫**：工作在桥接模式，仅负责光电转换，不参与路由与 DHCP 分配\n- **A 路由器（主路由）**：\n  - 系统：OpenWrt 软路由\n  - WAN 口：PPPoE 拨号，从 ISP 获取 `/60` 长度的 IPv6 公网前缀\n  - LAN 网段：`192.168.2.1/24`（已稳定运行，不改动）\n- **B 路由器（二级路由）**：\n  - 系统：OpenWrt 软路由\n  - 连接方式：WAN 口直连 A 路由器 LAN 口\n  - LAN 网段：`192.168.6.1/24`（核心约束：必须保留独立网段，不允许改为 AP 模式或合并网段）\n- **终端设备**：需通过 任意A、B 路由器获取 **全球唯一、可公网路由的 IPv6 地址**（非 ULA 私有地址、非 NAT66 转换地址）\n\n```mermaid\ngraph TD\n    光猫[\"光猫 - 桥接模式\"] --> A路由[\"A路由器（主路由）\"]\n    A路由 -->|LAN→WAN| B路由[\"B路由器（二级路由）\"]\n    B路由 --> 终端设备[\"PC/手机/IoT设备\"]\n    \n\n```\n\n```mermaid\ngraph TD\n\tsubgraph \"A路由配置（Qihoo 360T7）\"\n        A_HW[\"硬件：Qihoo 360T7/ARMv8\"]\n        A_SYS[\"系统：ImmortalWrt 24.10-SNAPSHOT/内核6.6.95\"]\n        A_WAN[\"WAN：PPPoE拨号\"]\n        A_LAN[\"LAN：192.168.2.1/24\"]\n    end\n```\n\n```mermaid\ngraph TD\n    subgraph \"B路由配置（JDCloud RE-CS-02）\"\n        B_HW[\"硬件：JDCloud RE-CS-02 AX6600/ARMv8\"]\n        B_SYS[\"系统：BleachWrt Docker 20251212/内核6.12.61\"]\n        B_WAN[\"WAN：DHCP\"]\n        B_LAN[\"LAN：192.168.6.1/24\"]\n    end\n```\n\n\n\n### 核心需求与约束\n\n- **功能需求：**A、B 路由下设备获取 **全球唯一公网 IPv6 地址**（非 ULA 私有地址、非 NAT66 转换）\n- **禁止操作：**不合并网段、不修改 A/B 路由 IPv4 网段、B 路由不切换 AP 模式。\n\n### 初始故障现象\n\n**核心故障：B 路由器无法获取 IPv6 前缀委派（PD），其 LAN 口仅分配 `fde8::` 开头的 ULA 私有地址，导致下联设备无法访问 IPv6 公网**\n\n| 设备/接口       | IPv6 状态                                                    | 异常点分析                       |\n| --------------- | ------------------------------------------------------------ | -------------------------------- |\n| A 路由 LAN 设备 | 正常获取公网 IPv6（2409::/60 网段），可访问 IPv6 公网资源 | -                                |\n| B 路由 WAN6 口  | 获得公网 IPv6 地址（2409::/64） | **仅获取地址，未获取 PD 前缀池** |\n| B 路由 LAN 口   | 仅分配 ULA 地址（fde8:::1/64），无公网 IPv6 前缀    | **PD 未穿透，无法分发公网地址**  |\n| B 下终端设备    | 仅获取 fde8:: 私有地址，部分设备偶然出现非 A 路由网段公网 IPv6| **地址来源异常，不可靠**         |\n\n---\n\n## 核心技术概念解析（先懂原理再配置）\n\n### 什么是 IPv6 前缀委派（Prefix Delegation, PD）？\n\nIPv6 前缀委派是 DHCPv6 协议的核心扩展功能，用于 **多级路由场景下的前缀分配与管理**。简单说：\n\n- ISP 向主路由（A）分配一个大的 IPv6 前缀（如本文 `/60`），相当于给主路由分配了一个\"地址池\"\n- 主路由（A）通过 PD 机制，将这个大前缀拆分成多个小前缀（如 `/64`），分发给下游路由（B）\n- 下游路由（B）再用分到的小前缀，为自己 LAN 下的设备分配独立公网 IPv6 地址\n\n**类比理解**：ISP 给你家（A 路由）分配了一栋 16 层的楼（`/60` 前缀，可拆 16 个 `/64` 子网），PD 就是你把其中一层（如第 4 层，`/64` 子网）分配给租客（B 路由），租客再把这一层的房间（独立 IPv6 地址）分配给家人（终端设备）。\n\n### IPv6 PD 协议交互流程\n\nPD 并非简单的\"地址分配\"，而是 **DHCPv6 协议簇的 IA_PD（Identity Association for Prefix Delegation）交互过程**，核心流程如下：\n\n1. **A 路由拨号阶段**：A 路由通过 PPPoE 发送 DHCPv6 Solicit 报文，携带 IA_PD 请求选项，ISP 回应 Advertise 报文，分配 /60 前缀（2409:8a38:1422:4cxx::/60）\n2. **B 路由请求阶段**：B 路由 WAN6 口发送 DHCPv6 Solicit 报文，携带 IA_PD（请求 /64 前缀）和 IA_NA（请求自身 IPv6 地址）选项\n3. **A 路由分配阶段**：A 路由的 odhcpd 服务接收请求，从 /60 前缀池中拆分出一个 /64 子前缀（如 2409:8a38:1422:4cyy::/64），通过 Reply 报文返回给 B 路由\n4. **B 路由分发阶段**：B 路由将获得的 /64 前缀配置到 br-lan 接口，通过 RA 报文通告给终端，同时 DHCPv6 服务器补充 DNS 等配置\n\n### 为什么 IPv6 最小子网必须是 `/64`？\n\n这是 IPv6 协议设计的硬性规范，核心原因有三：\n\n1. **SLAAC 地址自动配置需求**：IPv6 无状态地址自动配置（SLAAC）依赖 EUI-64 格式生成地址，SLAAC 协议要求接口标识字段为 64 位（通过 MAC 地址转换生成），因此子网前缀必须为 /64（网络位 64 + 接口位 64 = 128 位完整地址）\n\n2. **协议兼容性**：几乎所有 IPv6 设备（电脑、手机、IoT 设备）仅支持 `/64` 子网，非 `/64` 子网（如 `/63`、`/65`）会导致设备无法自动获取地址或通信异常\n\n   > RFC 4291 明确规定，除点对点链路外，所有 IPv6 子网必须使用 /64 前缀，非 /64 子网（如 /63、/65）会导致设备拒绝接收 RA 报文\n\n3. **路由标准化**：ISP 分配的公网前缀（如 `/56`、`/60`）均为 `/64` 的整数倍（`/56` 可拆 256 个 `/64`，`/60` 可拆 16 个 `/64`），确保多级分配无浪费\n\n### 前缀委派成功的三大核心条件\n\n1. **上游路由（A）**：\n   - 已从 ISP 获取合法公网前缀（如 `/60`）\n   - 启用 DHCPv6 服务器与 RA（路由通告）服务\n   - 允许向下游路由分发子前缀（PD 分发权限开启）\n2. **下游路由（B）**：\n   - WAN6 口启用 DHCPv6 客户端，且显式请求前缀委派\n   - LAN 口配置为从 PD 前缀自动获取地址，启用 RA/DHCPv6 服务\n3. **通信链路**：\n   - 两级路由之间允许 DHCPv6 协议（UDP 546/547 端口）与 ICMPv6 协议（RS/RA/NS/NA 类型）通行\n\n---\n\n## 根本故障原因\n\n**B 路由未获取 PD 前缀，A 路由 odhcpd 服务因配置限制，未响应 B 路由的 IA_PD 请求。**\n\n### 核心误区：对 \"PD 最小长度\" 的理解错误\n\nA 路由器 Web UI（LuCI）中，DHCPv6 服务器有一个关键选项 **\"PD 最小长度（Minimum Prefix Delegation Length）\"**，这是本次踩坑的核心陷阱：\n\n| 错误认知                               | 正确逻辑                                             | 底层原理                                                     |\n| -------------------------------------- | ---------------------------------------------------- | ------------------------------------------------------------ |\n| \"要分给 B 路由 `/64` 子网，所以填 64\"  | \"PD 最小长度 = 上游获取的前缀长度（如 `/60`）\"       | 该字段实际含义是 **\"允许向下游分配的最长前缀长度下限\"**，填 `/60` 表示\"允许分配 `/60` 及更长的前缀（如 `/61`、`/62`、`/64`）\" |\n| \"UI 限制 1-62，无法填 64 就是配置不了\" | \"UI 限制是 Bug，填 `/60` 即可触发底层自动分配 `/64`\" | OpenWrt 底层 odhcpd 服务支持从 `/60` 拆分 `/64`，LuCI 前端硬编码输入范围，与底层 odhcpd 服务支持冲突，UI 输入限制仅为前端逻辑，不影响底层功能 |\n\n### 故障点\n\n- B 路由器 WAN6 口未显式配置 `reqprefix='auto'`，仅请求了 IPv6 地址，未请求前缀委派\n- 初始配置中 A 路由器错配未勾选 \"将委派前缀60并分配给下游\"，导致 B 路由的 PD 请求被拒绝\n\n---\n\n## 分步解决方案（按优先级排序）\n\n### 4.1 A 路由器（上游主路由PD分发端）配置\n\n#### 让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求\n\n1. **WAN 接口配置**：\n\n   - 协议：PPPoEc\n   - 勾选：`请求 IPv6 前缀委派（Request IPv6 prefix delegation）`\n   - 高级设置：`使用默认网关，自动获取DNS服务器，开启IPv6源路由，委托IPv6前缀，禁用IPv6分配长度，其余默认`\n   - `使用对等 DNS` 勾选（若有）\n   - DHCP服务器：`常规设置 忽略此接口，指定的主接口默认关闭，IPv6设置全部禁用`\n   - 确认：已获取 `/60` 前缀（如 `2409:8a38:1422:4c20::/60`）\n\n2. **LAN 接口 → DHCP 服务器 → IPv6 设置**：\n\n   - 高级设置：`开启委托IPv6前缀，IPv6分配长度设置为64，其余默认`\n\n   - DHCP服务器：\n\n     - `高级设置动态DHCP开启`\n\n     - `IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认`\n\n       >  RA 服务：`服务器模式`（必须，用于向 B 路由通告路由信息）\n       >\n       > DHCPv6 服务：`服务器模式`（必须，用于分配 DNS 等配置信息）\n       >\n       > NDP 代理：`禁用`（默认禁用，无需改动）\n\n     - `IPv6 RA设置 启用SLAAC RA标记改为其他配置 DHCPv6模式改为无状态+有状态的 其余默认`\n\n3. **保存配置并应用**\n\n### B 路由器（下游二级路由）配置\n\n#### 让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发\n\n1. **WAN6 接口配置**（关键：请求 PD 而非仅请求地址）：\n\n   - 协议：DHCPv6 客户端\n   - 请求 IPv6 地址：`try`（尝试获取，不强制，避免拨号失败）\n   - 请求指定长度的 IPv6 前缀：`自动（auto）`（告诉 A 路由\"我需要一个子前缀\"）\n   - 高级设置：勾选 `使用默认网关 使用对等通告的DNS服务器` 其余默认（从 A 路由获取 IPv6 DNS 服务器）\n\n2. **LAN 接口 → DHCP 服务器 → IPv6 设置**：\n\n   - RA 服务：`服务器模式`（向下游设备通告路由）\n\n   - 基本设置：`IPv6分配长度改为64`\n\n   - DHCP服务器：\n\n     - `高级设置动态DHCP开启`\n\n     - `IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认`\n\n       >  RA路由通告服务：`服务器模式`\n       >\n       > DHCPv6 服务：`服务器模式`\n       >\n       > NDP 代理：`禁用`（默认禁用，无需改动）\n       >\n       > IPv6 RA设置 启用SLAAC RA标记改为其他配置（若有）\n       >\n       > DHCPv6模式改为无状态+有状态的\n       >\n       > 勾选：`总是通告默认路由`\n       >\n       > 其余默认\n\n3. **保存配置并应用**\n\n### 防火墙配置（默认已兼容，异常时检查）\n\nIPv6 通信依赖 ICMPv6 与 DHCPv6 协议，确保 A/B 路由防火墙未拦截：\n\n- 允许 UDP 546/547 端口（DHCPv6 客户端/服务器端口）\n- 允许 ICMPv6 类型 133（RS 路由请求）、134（RA 路由通告）、135（NS 邻居请求）、136（NA 邻居通告）\n- OpenWrt 默认防火墙规则已放行上述流量，无需额外配置，除非手动修改过默认规则\n\n- 命令行放行（若默认规则被修改）：\n\n  ```bash\n  # A/B 路由均执行\n  uci add firewall rule\n  uci set firewall.@rule[-1].name='Allow-DHCPv6'\n  uci set firewall.@rule[-1].proto='udp'\n  uci set firewall.@rule[-1].src='lan'\n  uci set firewall.@rule[-1].dest_port='546-547'\n  uci set firewall.@rule[-1].target='ACCEPT'\n  \n  uci add firewall rule\n  uci set firewall.@rule[-1].name='Allow-ICMPv6'\n  uci set firewall.@rule[-1].proto='icmpv6'\n  uci set firewall.@rule[-1].src='lan'\n  uci set firewall.@rule[-1].icmp_type='133 134 135 136'\n  uci set firewall.@rule[-1].target='ACCEPT'\n  \n  uci commit firewall\n  /etc/init.d/firewall restart\n  ```\n\n---\n\n## 修改后状态验证\n\n### B 路由器状态验证\n\n1. **Web UI 验证**：\n\n   - WAN6 接口：显示 `IPv6-PD` 字段（如 `2409:xxyy:xxyy:xxyy::/62`），表示成功获取子前缀池\n   - LAN 接口（br-lan）：显示公网 IPv6 地址（如 `2409:xxyy:xxyy:xxyy::1/64`），同时可能存在 `fde8::` 开头的 ULA 地址（可忽略，不影响使用）\n\n2. **SSH 命令验证**：\n\n   ```bash\n   # 查看 PD 获取状态\n   ubus call network.interface.wan6 status | grep -A6 \"ipv6-prefix\"\n   # 成功输出示例\n   \"ipv6-prefix\": [\n     {\n       \"address\": \"2409:xxyy:xxyy:xxyy::\",\n       \"mask\": 62,  # 显示 /62 是正常的，底层会自动拆分 /64 子网\n       \"preferred\": 86400,\n       \"valid\": 172800\n     }\n   ]\n   ```\n\n   - 查看 LAN 口 IPv6 地址：`ip -6 addr show br-lan`，需存在 `scope global` 类型的公网地址（非 `fe80::` 链路本地地址）\n\n3. **终端设备验证（Windows/macOS/Linux）**：\n\n   - Windows：`ipconfig /all` 应显示 2409:xxyy:xxyy:xxyy 地址\n\n   - macOS/Linux：`ip -6 addr` 应显示 scope global 类型的  2409:xxyy:xxyy:xxyy开头地址\n\n   - 连通性测试：访问 `https://test-ipv6.com/`，得分 10/10 表示配置完全正确\n\n     ```bash\n     # 命令行\n     ping6 ipv6.google.com  # 通表示路由正常\n     curl -6 https://api6.ipify.org  # 返回公网 IPv6 地址表示成功\n     ```\n\n## 排错工具链（从日志到抓包）\n\n### 常见误区原因\n\n1. **误区 1**：PD 最小长度填 `64` → 正确做法：填上游获取的前缀长度（如 `/60`）\n   - 原因：UI 显示\"最小长度\"实为\"最长前缀允许下限\"，填 `/60` 才能让系统拆分 `/64` 子前缀\n2. **误区 2**：B 路由 WAN6 仅请求地址，未请求 PD → 正确做法：必须设置 `reqprefix='auto'`\n   - 原因：仅请求地址会导致 B 路由只有自身 IPv6 地址，没有子前缀池，无法分给下游设备\n3. **误区 3**：手动给 B 路由 LAN 口指定静态 IPv6 地址 → 正确做法：留空，让系统从 PD 自动获取\n   - 原因：手动指定会导致地址与 PD 前缀不匹配，下游设备无法获取有效地址\n\n### 常见故障排查\n\n| 故障现象                   | 排查步骤                                                     | 解决方案                                                     |\n| -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| B 路由 WAN6 无 IPv6-PD     | 1. 检查 A 路由是否勾选\"分配 PD 给下游\"；2. 检查 B 路由 reqprefix 是否为 auto；3. 查看 A 路由日志 `logread | grep dhcpv6` | 1. 勾选 A 路由 PD 分发选项；2. 配置 B 路由 reqprefix=auto；3. 重启 A 路由 odhcpd 服务 |\n| B 路由 LAN 口无公网 IPv6   | 1. 检查 B 路由 LAN 分配长度是否为 64；2. 查看 PD 是否获取成功；3. 重启 B 路由网络服务 | 1. 设为 64 子网；2. 重新请求 PD；3. 执行 `/etc/init.d/network restart` |\n| 终端有公网 IPv6 但无法上网 | 1. 检查是否为 ULA 地址（fd 开头）；2. 验证默认路由是否存在；3. 测试 DNS 解析 `nslookup -type=AAAA ipv6.google.com` | 1. 确保获取公网前缀（2409: 等）；2. 确认 RA 已通告默认路由；3. 检查 DNS 配置是否正确 |\n\n### **日志分析（SSH）**：\n\n- 查看 A 路由 PD 分配日志：`logread | grep odhcpd | grep -E 'prefix|delegate'`\n- 查看 B 路由 PD 请求日志：`logread | grep dhcp6c | grep -E 'IA_PD|prefix'`\n- 关键成功日志：`dhcp6c: client6_recvreply: reply received from fe80::e2ef:2ff:fed0:ac01%wan, pending IAID 0`\n\n### **抓包验证（需安装 tcpdump）**：\n\n```bash\n# B 路由安装 tcpdump\nopkg update && opkg install tcpdump\n# 抓取 WAN6 口 DHCPv6 报文\ntcpdump -i wan6 port 546 or port 547 -vvv\n# 成功标志：存在 DHCPv6 Reply 报文，携带 IA_PD 选项（前缀 2409:8a38:1422:4cyy::/64）\n```\n\n## 总结\n\n### 协议本质\n\nIPv6 PD 穿透的核心是 **\"请求-分配-分发\"的 DHCPv6 交互闭环**，OpenWrt/ImmortalWrt 的 UI 限制只是表象，通过 SSH 命令行可直接操作底层配置文件，突破前端限制。对于无独立 RA 配置的机型，记住\"DHCPv6 服务器模式=RA 服务器模式\"的等效关系，即可实现功能全覆盖。\n\n本方案已在 Qihoo 360T7（ImmortalWrt 24.10）+ JDCloud RE-CS-02 AX6600（BleachWrt 25.10.10）环境验证通过，适用于所有 OpenWrt 22.03+ 衍生版本，以及 ISP 提供 /56、/60 前缀的场景。\n\n\n\n","slug":"二级路由公网IPv6再分配","published":1,"updated":"2026-01-15T15:32:18.889Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivk000124j3fxf58sat","content":"<p><strong>记录时间：</strong> 2026-01-15<br><strong>环境标签：</strong> OpenWrt 22.03+、IPv6、Prefix Delegation(PD)、多级路由、桥接模式<br><strong>核心价值：</strong> 解析 IPv6 前缀委派底层逻辑，解决二级路由下设备无法获取公网 IPv6 的核心痛点，附带技术原理解析与避坑指南</p>\n<hr>\n<h2 id=\"背景与网络拓扑\"><a href=\"#背景与网络拓扑\" class=\"headerlink\" title=\"背景与网络拓扑\"></a>背景与网络拓扑</h2><h3 id=\"网络架构\"><a href=\"#网络架构\" class=\"headerlink\" title=\"网络架构\"></a>网络架构</h3><p><img src=\"/images/%E4%BA%8C%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%85%AC%E7%BD%91IPv6%E5%86%8D%E5%88%86%E9%85%8D.assets/image-20260115233010932.png\" alt=\"image-20260115233010932\"></p>\n<ul>\n<li><strong>光猫</strong>：工作在桥接模式，仅负责光电转换，不参与路由与 DHCP 分配</li>\n<li><strong>A 路由器（主路由）</strong>：<ul>\n<li>系统：OpenWrt 软路由</li>\n<li>WAN 口：PPPoE 拨号，从 ISP 获取 <code>/60</code> 长度的 IPv6 公网前缀</li>\n<li>LAN 网段：<code>192.168.2.1/24</code>（已稳定运行，不改动）</li>\n</ul>\n</li>\n<li><strong>B 路由器（二级路由）</strong>：<ul>\n<li>系统：OpenWrt 软路由</li>\n<li>连接方式：WAN 口直连 A 路由器 LAN 口</li>\n<li>LAN 网段：<code>192.168.6.1/24</code>（核心约束：必须保留独立网段，不允许改为 AP 模式或合并网段）</li>\n</ul>\n</li>\n<li><strong>终端设备</strong>：需通过 任意A、B 路由器获取 <strong>全球唯一、可公网路由的 IPv6 地址</strong>（非 ULA 私有地址、非 NAT66 转换地址）</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">    光猫[&quot;光猫 - 桥接模式&quot;] --&gt; A路由[&quot;A路由器（主路由）&quot;]</span><br><span class=\"line\">    A路由 --&gt;|LAN→WAN| B路由[&quot;B路由器（二级路由）&quot;]</span><br><span class=\"line\">    B路由 --&gt; 终端设备[&quot;PC/手机/IoT设备&quot;]</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">\tsubgraph &quot;A路由配置（Qihoo 360T7）&quot;</span><br><span class=\"line\">        A_HW[&quot;硬件：Qihoo 360T7/ARMv8&quot;]</span><br><span class=\"line\">        A_SYS[&quot;系统：ImmortalWrt 24.10-SNAPSHOT/内核6.6.95&quot;]</span><br><span class=\"line\">        A_WAN[&quot;WAN：PPPoE拨号&quot;]</span><br><span class=\"line\">        A_LAN[&quot;LAN：192.168.2.1/24&quot;]</span><br><span class=\"line\">    end</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">    subgraph &quot;B路由配置（JDCloud RE-CS-02）&quot;</span><br><span class=\"line\">        B_HW[&quot;硬件：JDCloud RE-CS-02 AX6600/ARMv8&quot;]</span><br><span class=\"line\">        B_SYS[&quot;系统：BleachWrt Docker 20251212/内核6.12.61&quot;]</span><br><span class=\"line\">        B_WAN[&quot;WAN：DHCP&quot;]</span><br><span class=\"line\">        B_LAN[&quot;LAN：192.168.6.1/24&quot;]</span><br><span class=\"line\">    end</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"核心需求与约束\"><a href=\"#核心需求与约束\" class=\"headerlink\" title=\"核心需求与约束\"></a>核心需求与约束</h3><ul>\n<li><strong>功能需求：</strong>A、B 路由下设备获取 <strong>全球唯一公网 IPv6 地址</strong>（非 ULA 私有地址、非 NAT66 转换）</li>\n<li><strong>禁止操作：</strong>不合并网段、不修改 A&#x2F;B 路由 IPv4 网段、B 路由不切换 AP 模式。</li>\n</ul>\n<h3 id=\"初始故障现象\"><a href=\"#初始故障现象\" class=\"headerlink\" title=\"初始故障现象\"></a>初始故障现象</h3><p><strong>核心故障：B 路由器无法获取 IPv6 前缀委派（PD），其 LAN 口仅分配 <code>fde8::</code> 开头的 ULA 私有地址，导致下联设备无法访问 IPv6 公网</strong></p>\n<table>\n<thead>\n<tr>\n<th>设备&#x2F;接口</th>\n<th>IPv6 状态</th>\n<th>异常点分析</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>A 路由 LAN 设备</td>\n<td>正常获取公网 IPv6（2409::&#x2F;60 网段），可访问 IPv6 公网资源</td>\n<td>-</td>\n</tr>\n<tr>\n<td>B 路由 WAN6 口</td>\n<td>获得公网 IPv6 地址（2409::&#x2F;64）</td>\n<td><strong>仅获取地址，未获取 PD 前缀池</strong></td>\n</tr>\n<tr>\n<td>B 路由 LAN 口</td>\n<td>仅分配 ULA 地址（fde8:::1&#x2F;64），无公网 IPv6 前缀</td>\n<td><strong>PD 未穿透，无法分发公网地址</strong></td>\n</tr>\n<tr>\n<td>B 下终端设备</td>\n<td>仅获取 fde8:: 私有地址，部分设备偶然出现非 A 路由网段公网 IPv6</td>\n<td><strong>地址来源异常，不可靠</strong></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"核心技术概念解析（先懂原理再配置）\"><a href=\"#核心技术概念解析（先懂原理再配置）\" class=\"headerlink\" title=\"核心技术概念解析（先懂原理再配置）\"></a>核心技术概念解析（先懂原理再配置）</h2><h3 id=\"什么是-IPv6-前缀委派（Prefix-Delegation-PD）？\"><a href=\"#什么是-IPv6-前缀委派（Prefix-Delegation-PD）？\" class=\"headerlink\" title=\"什么是 IPv6 前缀委派（Prefix Delegation, PD）？\"></a>什么是 IPv6 前缀委派（Prefix Delegation, PD）？</h3><p>IPv6 前缀委派是 DHCPv6 协议的核心扩展功能，用于 <strong>多级路由场景下的前缀分配与管理</strong>。简单说：</p>\n<ul>\n<li>ISP 向主路由（A）分配一个大的 IPv6 前缀（如本文 <code>/60</code>），相当于给主路由分配了一个”地址池”</li>\n<li>主路由（A）通过 PD 机制，将这个大前缀拆分成多个小前缀（如 <code>/64</code>），分发给下游路由（B）</li>\n<li>下游路由（B）再用分到的小前缀，为自己 LAN 下的设备分配独立公网 IPv6 地址</li>\n</ul>\n<p><strong>类比理解</strong>：ISP 给你家（A 路由）分配了一栋 16 层的楼（<code>/60</code> 前缀，可拆 16 个 <code>/64</code> 子网），PD 就是你把其中一层（如第 4 层，<code>/64</code> 子网）分配给租客（B 路由），租客再把这一层的房间（独立 IPv6 地址）分配给家人（终端设备）。</p>\n<h3 id=\"IPv6-PD-协议交互流程\"><a href=\"#IPv6-PD-协议交互流程\" class=\"headerlink\" title=\"IPv6 PD 协议交互流程\"></a>IPv6 PD 协议交互流程</h3><p>PD 并非简单的”地址分配”，而是 <strong>DHCPv6 协议簇的 IA_PD（Identity Association for Prefix Delegation）交互过程</strong>，核心流程如下：</p>\n<ol>\n<li><strong>A 路由拨号阶段</strong>：A 路由通过 PPPoE 发送 DHCPv6 Solicit 报文，携带 IA_PD 请求选项，ISP 回应 Advertise 报文，分配 &#x2F;60 前缀（2409:8a38:1422:4cxx::&#x2F;60）</li>\n<li><strong>B 路由请求阶段</strong>：B 路由 WAN6 口发送 DHCPv6 Solicit 报文，携带 IA_PD（请求 &#x2F;64 前缀）和 IA_NA（请求自身 IPv6 地址）选项</li>\n<li><strong>A 路由分配阶段</strong>：A 路由的 odhcpd 服务接收请求，从 &#x2F;60 前缀池中拆分出一个 &#x2F;64 子前缀（如 2409:8a38:1422:4cyy::&#x2F;64），通过 Reply 报文返回给 B 路由</li>\n<li><strong>B 路由分发阶段</strong>：B 路由将获得的 &#x2F;64 前缀配置到 br-lan 接口，通过 RA 报文通告给终端，同时 DHCPv6 服务器补充 DNS 等配置</li>\n</ol>\n<h3 id=\"为什么-IPv6-最小子网必须是-64？\"><a href=\"#为什么-IPv6-最小子网必须是-64？\" class=\"headerlink\" title=\"为什么 IPv6 最小子网必须是 /64？\"></a>为什么 IPv6 最小子网必须是 <code>/64</code>？</h3><p>这是 IPv6 协议设计的硬性规范，核心原因有三：</p>\n<ol>\n<li><p><strong>SLAAC 地址自动配置需求</strong>：IPv6 无状态地址自动配置（SLAAC）依赖 EUI-64 格式生成地址，SLAAC 协议要求接口标识字段为 64 位（通过 MAC 地址转换生成），因此子网前缀必须为 &#x2F;64（网络位 64 + 接口位 64 &#x3D; 128 位完整地址）</p>\n</li>\n<li><p><strong>协议兼容性</strong>：几乎所有 IPv6 设备（电脑、手机、IoT 设备）仅支持 <code>/64</code> 子网，非 <code>/64</code> 子网（如 <code>/63</code>、<code>/65</code>）会导致设备无法自动获取地址或通信异常</p>\n<blockquote>\n<p>RFC 4291 明确规定，除点对点链路外，所有 IPv6 子网必须使用 &#x2F;64 前缀，非 &#x2F;64 子网（如 &#x2F;63、&#x2F;65）会导致设备拒绝接收 RA 报文</p>\n</blockquote>\n</li>\n<li><p><strong>路由标准化</strong>：ISP 分配的公网前缀（如 <code>/56</code>、<code>/60</code>）均为 <code>/64</code> 的整数倍（<code>/56</code> 可拆 256 个 <code>/64</code>，<code>/60</code> 可拆 16 个 <code>/64</code>），确保多级分配无浪费</p>\n</li>\n</ol>\n<h3 id=\"前缀委派成功的三大核心条件\"><a href=\"#前缀委派成功的三大核心条件\" class=\"headerlink\" title=\"前缀委派成功的三大核心条件\"></a>前缀委派成功的三大核心条件</h3><ol>\n<li><strong>上游路由（A）</strong>：<ul>\n<li>已从 ISP 获取合法公网前缀（如 <code>/60</code>）</li>\n<li>启用 DHCPv6 服务器与 RA（路由通告）服务</li>\n<li>允许向下游路由分发子前缀（PD 分发权限开启）</li>\n</ul>\n</li>\n<li><strong>下游路由（B）</strong>：<ul>\n<li>WAN6 口启用 DHCPv6 客户端，且显式请求前缀委派</li>\n<li>LAN 口配置为从 PD 前缀自动获取地址，启用 RA&#x2F;DHCPv6 服务</li>\n</ul>\n</li>\n<li><strong>通信链路</strong>：<ul>\n<li>两级路由之间允许 DHCPv6 协议（UDP 546&#x2F;547 端口）与 ICMPv6 协议（RS&#x2F;RA&#x2F;NS&#x2F;NA 类型）通行</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"根本故障原因\"><a href=\"#根本故障原因\" class=\"headerlink\" title=\"根本故障原因\"></a>根本故障原因</h2><p><strong>B 路由未获取 PD 前缀，A 路由 odhcpd 服务因配置限制，未响应 B 路由的 IA_PD 请求。</strong></p>\n<h3 id=\"核心误区：对-“PD-最小长度”-的理解错误\"><a href=\"#核心误区：对-“PD-最小长度”-的理解错误\" class=\"headerlink\" title=\"核心误区：对 “PD 最小长度” 的理解错误\"></a>核心误区：对 “PD 最小长度” 的理解错误</h3><p>A 路由器 Web UI（LuCI）中，DHCPv6 服务器有一个关键选项 **”PD 最小长度（Minimum Prefix Delegation Length）”**，这是本次踩坑的核心陷阱：</p>\n<table>\n<thead>\n<tr>\n<th>错误认知</th>\n<th>正确逻辑</th>\n<th>底层原理</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>“要分给 B 路由 <code>/64</code> 子网，所以填 64”</td>\n<td>“PD 最小长度 &#x3D; 上游获取的前缀长度（如 <code>/60</code>）”</td>\n<td>该字段实际含义是 **”允许向下游分配的最长前缀长度下限”**，填 <code>/60</code> 表示”允许分配 <code>/60</code> 及更长的前缀（如 <code>/61</code>、<code>/62</code>、<code>/64</code>）”</td>\n</tr>\n<tr>\n<td>“UI 限制 1-62，无法填 64 就是配置不了”</td>\n<td>“UI 限制是 Bug，填 <code>/60</code> 即可触发底层自动分配 <code>/64</code>“</td>\n<td>OpenWrt 底层 odhcpd 服务支持从 <code>/60</code> 拆分 <code>/64</code>，LuCI 前端硬编码输入范围，与底层 odhcpd 服务支持冲突，UI 输入限制仅为前端逻辑，不影响底层功能</td>\n</tr>\n</tbody></table>\n<h3 id=\"故障点\"><a href=\"#故障点\" class=\"headerlink\" title=\"故障点\"></a>故障点</h3><ul>\n<li>B 路由器 WAN6 口未显式配置 <code>reqprefix=&#39;auto&#39;</code>，仅请求了 IPv6 地址，未请求前缀委派</li>\n<li>初始配置中 A 路由器错配未勾选 “将委派前缀60并分配给下游”，导致 B 路由的 PD 请求被拒绝</li>\n</ul>\n<hr>\n<h2 id=\"分步解决方案（按优先级排序）\"><a href=\"#分步解决方案（按优先级排序）\" class=\"headerlink\" title=\"分步解决方案（按优先级排序）\"></a>分步解决方案（按优先级排序）</h2><h3 id=\"4-1-A-路由器（上游主路由PD分发端）配置\"><a href=\"#4-1-A-路由器（上游主路由PD分发端）配置\" class=\"headerlink\" title=\"4.1 A 路由器（上游主路由PD分发端）配置\"></a>4.1 A 路由器（上游主路由PD分发端）配置</h3><h4 id=\"让-A路由器的odhcpd-服务正确响应-B-路由的-PD-请求\"><a href=\"#让-A路由器的odhcpd-服务正确响应-B-路由的-PD-请求\" class=\"headerlink\" title=\"让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求\"></a>让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求</h4><ol>\n<li><p><strong>WAN 接口配置</strong>：</p>\n<ul>\n<li>协议：PPPoEc</li>\n<li>勾选：<code>请求 IPv6 前缀委派（Request IPv6 prefix delegation）</code></li>\n<li>高级设置：<code>使用默认网关，自动获取DNS服务器，开启IPv6源路由，委托IPv6前缀，禁用IPv6分配长度，其余默认</code></li>\n<li><code>使用对等 DNS</code> 勾选（若有）</li>\n<li>DHCP服务器：<code>常规设置 忽略此接口，指定的主接口默认关闭，IPv6设置全部禁用</code></li>\n<li>确认：已获取 <code>/60</code> 前缀（如 <code>2409:8a38:1422:4c20::/60</code>）</li>\n</ul>\n</li>\n<li><p><strong>LAN 接口 → DHCP 服务器 → IPv6 设置</strong>：</p>\n<ul>\n<li><p>高级设置：<code>开启委托IPv6前缀，IPv6分配长度设置为64，其余默认</code></p>\n</li>\n<li><p>DHCP服务器：</p>\n<ul>\n<li><p><code>高级设置动态DHCP开启</code></p>\n</li>\n<li><p><code>IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认</code></p>\n<blockquote>\n<p> RA 服务：<code>服务器模式</code>（必须，用于向 B 路由通告路由信息）</p>\n<p>DHCPv6 服务：<code>服务器模式</code>（必须，用于分配 DNS 等配置信息）</p>\n<p>NDP 代理：<code>禁用</code>（默认禁用，无需改动）</p>\n</blockquote>\n</li>\n<li><p><code>IPv6 RA设置 启用SLAAC RA标记改为其他配置 DHCPv6模式改为无状态+有状态的 其余默认</code></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>保存配置并应用</strong></p>\n</li>\n</ol>\n<h3 id=\"B-路由器（下游二级路由）配置\"><a href=\"#B-路由器（下游二级路由）配置\" class=\"headerlink\" title=\"B 路由器（下游二级路由）配置\"></a>B 路由器（下游二级路由）配置</h3><h4 id=\"让-B-路由正确请求-PD-并应用到-LAN通过-br-lan-分发\"><a href=\"#让-B-路由正确请求-PD-并应用到-LAN通过-br-lan-分发\" class=\"headerlink\" title=\"让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发\"></a>让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发</h4><ol>\n<li><p><strong>WAN6 接口配置</strong>（关键：请求 PD 而非仅请求地址）：</p>\n<ul>\n<li>协议：DHCPv6 客户端</li>\n<li>请求 IPv6 地址：<code>try</code>（尝试获取，不强制，避免拨号失败）</li>\n<li>请求指定长度的 IPv6 前缀：<code>自动（auto）</code>（告诉 A 路由”我需要一个子前缀”）</li>\n<li>高级设置：勾选 <code>使用默认网关 使用对等通告的DNS服务器</code> 其余默认（从 A 路由获取 IPv6 DNS 服务器）</li>\n</ul>\n</li>\n<li><p><strong>LAN 接口 → DHCP 服务器 → IPv6 设置</strong>：</p>\n<ul>\n<li><p>RA 服务：<code>服务器模式</code>（向下游设备通告路由）</p>\n</li>\n<li><p>基本设置：<code>IPv6分配长度改为64</code></p>\n</li>\n<li><p>DHCP服务器：</p>\n<ul>\n<li><p><code>高级设置动态DHCP开启</code></p>\n</li>\n<li><p><code>IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认</code></p>\n<blockquote>\n<p> RA路由通告服务：<code>服务器模式</code></p>\n<p>DHCPv6 服务：<code>服务器模式</code></p>\n<p>NDP 代理：<code>禁用</code>（默认禁用，无需改动）</p>\n<p>IPv6 RA设置 启用SLAAC RA标记改为其他配置（若有）</p>\n<p>DHCPv6模式改为无状态+有状态的</p>\n<p>勾选：<code>总是通告默认路由</code></p>\n<p>其余默认</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>保存配置并应用</strong></p>\n</li>\n</ol>\n<h3 id=\"防火墙配置（默认已兼容，异常时检查）\"><a href=\"#防火墙配置（默认已兼容，异常时检查）\" class=\"headerlink\" title=\"防火墙配置（默认已兼容，异常时检查）\"></a>防火墙配置（默认已兼容，异常时检查）</h3><p>IPv6 通信依赖 ICMPv6 与 DHCPv6 协议，确保 A&#x2F;B 路由防火墙未拦截：</p>\n<ul>\n<li><p>允许 UDP 546&#x2F;547 端口（DHCPv6 客户端&#x2F;服务器端口）</p>\n</li>\n<li><p>允许 ICMPv6 类型 133（RS 路由请求）、134（RA 路由通告）、135（NS 邻居请求）、136（NA 邻居通告）</p>\n</li>\n<li><p>OpenWrt 默认防火墙规则已放行上述流量，无需额外配置，除非手动修改过默认规则</p>\n</li>\n<li><p>命令行放行（若默认规则被修改）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># A/B 路由均执行</span></span><br><span class=\"line\">uci add firewall rule</span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].name=<span class=\"string\">&#x27;Allow-DHCPv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].proto=<span class=\"string\">&#x27;udp&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].src=<span class=\"string\">&#x27;lan&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].dest_port=<span class=\"string\">&#x27;546-547&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].target=<span class=\"string\">&#x27;ACCEPT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">uci add firewall rule</span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].name=<span class=\"string\">&#x27;Allow-ICMPv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].proto=<span class=\"string\">&#x27;icmpv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].src=<span class=\"string\">&#x27;lan&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].icmp_type=<span class=\"string\">&#x27;133 134 135 136&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].target=<span class=\"string\">&#x27;ACCEPT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">uci commit firewall</span><br><span class=\"line\">/etc/init.d/firewall restart</span><br></pre></td></tr></table></figure></li>\n</ul>\n<hr>\n<h2 id=\"修改后状态验证\"><a href=\"#修改后状态验证\" class=\"headerlink\" title=\"修改后状态验证\"></a>修改后状态验证</h2><h3 id=\"B-路由器状态验证\"><a href=\"#B-路由器状态验证\" class=\"headerlink\" title=\"B 路由器状态验证\"></a>B 路由器状态验证</h3><ol>\n<li><p><strong>Web UI 验证</strong>：</p>\n<ul>\n<li>WAN6 接口：显示 <code>IPv6-PD</code> 字段（如 <code>2409:xxyy:xxyy:xxyy::/62</code>），表示成功获取子前缀池</li>\n<li>LAN 接口（br-lan）：显示公网 IPv6 地址（如 <code>2409:xxyy:xxyy:xxyy::1/64</code>），同时可能存在 <code>fde8::</code> 开头的 ULA 地址（可忽略，不影响使用）</li>\n</ul>\n</li>\n<li><p><strong>SSH 命令验证</strong>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看 PD 获取状态</span></span><br><span class=\"line\">ubus call network.interface.wan6 status | grep -A6 <span class=\"string\">&quot;ipv6-prefix&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 成功输出示例</span></span><br><span class=\"line\"><span class=\"string\">&quot;ipv6-prefix&quot;</span>: [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;address&quot;</span>: <span class=\"string\">&quot;2409:xxyy:xxyy:xxyy::&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;mask&quot;</span>: 62,  <span class=\"comment\"># 显示 /62 是正常的，底层会自动拆分 /64 子网</span></span><br><span class=\"line\">    <span class=\"string\">&quot;preferred&quot;</span>: 86400,</span><br><span class=\"line\">    <span class=\"string\">&quot;valid&quot;</span>: 172800</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查看 LAN 口 IPv6 地址：<code>ip -6 addr show br-lan</code>，需存在 <code>scope global</code> 类型的公网地址（非 <code>fe80::</code> 链路本地地址）</li>\n</ul>\n</li>\n<li><p><strong>终端设备验证（Windows&#x2F;macOS&#x2F;Linux）</strong>：</p>\n<ul>\n<li><p>Windows：<code>ipconfig /all</code> 应显示 2409:xxyy:xxyy:xxyy 地址</p>\n</li>\n<li><p>macOS&#x2F;Linux：<code>ip -6 addr</code> 应显示 scope global 类型的  2409:xxyy:xxyy:xxyy开头地址</p>\n</li>\n<li><p>连通性测试：访问 <code>https://test-ipv6.com/</code>，得分 10&#x2F;10 表示配置完全正确</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 命令行</span></span><br><span class=\"line\">ping6 ipv6.google.com  <span class=\"comment\"># 通表示路由正常</span></span><br><span class=\"line\">curl -6 https://api6.ipify.org  <span class=\"comment\"># 返回公网 IPv6 地址表示成功</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"排错工具链（从日志到抓包）\"><a href=\"#排错工具链（从日志到抓包）\" class=\"headerlink\" title=\"排错工具链（从日志到抓包）\"></a>排错工具链（从日志到抓包）</h2><h3 id=\"常见误区原因\"><a href=\"#常见误区原因\" class=\"headerlink\" title=\"常见误区原因\"></a>常见误区原因</h3><ol>\n<li><strong>误区 1</strong>：PD 最小长度填 <code>64</code> → 正确做法：填上游获取的前缀长度（如 <code>/60</code>）<ul>\n<li>原因：UI 显示”最小长度”实为”最长前缀允许下限”，填 <code>/60</code> 才能让系统拆分 <code>/64</code> 子前缀</li>\n</ul>\n</li>\n<li><strong>误区 2</strong>：B 路由 WAN6 仅请求地址，未请求 PD → 正确做法：必须设置 <code>reqprefix=&#39;auto&#39;</code><ul>\n<li>原因：仅请求地址会导致 B 路由只有自身 IPv6 地址，没有子前缀池，无法分给下游设备</li>\n</ul>\n</li>\n<li><strong>误区 3</strong>：手动给 B 路由 LAN 口指定静态 IPv6 地址 → 正确做法：留空，让系统从 PD 自动获取<ul>\n<li>原因：手动指定会导致地址与 PD 前缀不匹配，下游设备无法获取有效地址</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"常见故障排查\"><a href=\"#常见故障排查\" class=\"headerlink\" title=\"常见故障排查\"></a>常见故障排查</h3><table>\n<thead>\n<tr>\n<th>故障现象</th>\n<th>排查步骤</th>\n<th>解决方案</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>B 路由 WAN6 无 IPv6-PD</td>\n<td>1. 检查 A 路由是否勾选”分配 PD 给下游”；2. 检查 B 路由 reqprefix 是否为 auto；3. 查看 A 路由日志 &#96;logread</td>\n<td>grep dhcpv6&#96;</td>\n</tr>\n<tr>\n<td>B 路由 LAN 口无公网 IPv6</td>\n<td>1. 检查 B 路由 LAN 分配长度是否为 64；2. 查看 PD 是否获取成功；3. 重启 B 路由网络服务</td>\n<td>1. 设为 64 子网；2. 重新请求 PD；3. 执行 <code>/etc/init.d/network restart</code></td>\n</tr>\n<tr>\n<td>终端有公网 IPv6 但无法上网</td>\n<td>1. 检查是否为 ULA 地址（fd 开头）；2. 验证默认路由是否存在；3. 测试 DNS 解析 <code>nslookup -type=AAAA ipv6.google.com</code></td>\n<td>1. 确保获取公网前缀（2409: 等）；2. 确认 RA 已通告默认路由；3. 检查 DNS 配置是否正确</td>\n</tr>\n</tbody></table>\n<h3 id=\"日志分析（SSH）：\"><a href=\"#日志分析（SSH）：\" class=\"headerlink\" title=\"日志分析（SSH）：\"></a><strong>日志分析（SSH）</strong>：</h3><ul>\n<li>查看 A 路由 PD 分配日志：<code>logread | grep odhcpd | grep -E &#39;prefix|delegate&#39;</code></li>\n<li>查看 B 路由 PD 请求日志：<code>logread | grep dhcp6c | grep -E &#39;IA_PD|prefix&#39;</code></li>\n<li>关键成功日志：<code>dhcp6c: client6_recvreply: reply received from fe80::e2ef:2ff:fed0:ac01%wan, pending IAID 0</code></li>\n</ul>\n<h3 id=\"抓包验证（需安装-tcpdump）：\"><a href=\"#抓包验证（需安装-tcpdump）：\" class=\"headerlink\" title=\"抓包验证（需安装 tcpdump）：\"></a><strong>抓包验证（需安装 tcpdump）</strong>：</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># B 路由安装 tcpdump</span></span><br><span class=\"line\">opkg update &amp;&amp; opkg install tcpdump</span><br><span class=\"line\"><span class=\"comment\"># 抓取 WAN6 口 DHCPv6 报文</span></span><br><span class=\"line\">tcpdump -i wan6 port 546 or port 547 -vvv</span><br><span class=\"line\"><span class=\"comment\"># 成功标志：存在 DHCPv6 Reply 报文，携带 IA_PD 选项（前缀 2409:8a38:1422:4cyy::/64）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><h3 id=\"协议本质\"><a href=\"#协议本质\" class=\"headerlink\" title=\"协议本质\"></a>协议本质</h3><p>IPv6 PD 穿透的核心是 <strong>“请求-分配-分发”的 DHCPv6 交互闭环</strong>，OpenWrt&#x2F;ImmortalWrt 的 UI 限制只是表象，通过 SSH 命令行可直接操作底层配置文件，突破前端限制。对于无独立 RA 配置的机型，记住”DHCPv6 服务器模式&#x3D;RA 服务器模式”的等效关系，即可实现功能全覆盖。</p>\n<p>本方案已在 Qihoo 360T7（ImmortalWrt 24.10）+ JDCloud RE-CS-02 AX6600（BleachWrt 25.10.10）环境验证通过，适用于所有 OpenWrt 22.03+ 衍生版本，以及 ISP 提供 &#x2F;56、&#x2F;60 前缀的场景。</p>\n","excerpt":"","more":"<p><strong>记录时间：</strong> 2026-01-15<br><strong>环境标签：</strong> OpenWrt 22.03+、IPv6、Prefix Delegation(PD)、多级路由、桥接模式<br><strong>核心价值：</strong> 解析 IPv6 前缀委派底层逻辑，解决二级路由下设备无法获取公网 IPv6 的核心痛点，附带技术原理解析与避坑指南</p>\n<hr>\n<h2 id=\"背景与网络拓扑\"><a href=\"#背景与网络拓扑\" class=\"headerlink\" title=\"背景与网络拓扑\"></a>背景与网络拓扑</h2><h3 id=\"网络架构\"><a href=\"#网络架构\" class=\"headerlink\" title=\"网络架构\"></a>网络架构</h3><p><img src=\"/images/%E4%BA%8C%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%85%AC%E7%BD%91IPv6%E5%86%8D%E5%88%86%E9%85%8D.assets/image-20260115233010932.png\" alt=\"image-20260115233010932\"></p>\n<ul>\n<li><strong>光猫</strong>：工作在桥接模式，仅负责光电转换，不参与路由与 DHCP 分配</li>\n<li><strong>A 路由器（主路由）</strong>：<ul>\n<li>系统：OpenWrt 软路由</li>\n<li>WAN 口：PPPoE 拨号，从 ISP 获取 <code>/60</code> 长度的 IPv6 公网前缀</li>\n<li>LAN 网段：<code>192.168.2.1/24</code>（已稳定运行，不改动）</li>\n</ul>\n</li>\n<li><strong>B 路由器（二级路由）</strong>：<ul>\n<li>系统：OpenWrt 软路由</li>\n<li>连接方式：WAN 口直连 A 路由器 LAN 口</li>\n<li>LAN 网段：<code>192.168.6.1/24</code>（核心约束：必须保留独立网段，不允许改为 AP 模式或合并网段）</li>\n</ul>\n</li>\n<li><strong>终端设备</strong>：需通过 任意A、B 路由器获取 <strong>全球唯一、可公网路由的 IPv6 地址</strong>（非 ULA 私有地址、非 NAT66 转换地址）</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">    光猫[&quot;光猫 - 桥接模式&quot;] --&gt; A路由[&quot;A路由器（主路由）&quot;]</span><br><span class=\"line\">    A路由 --&gt;|LAN→WAN| B路由[&quot;B路由器（二级路由）&quot;]</span><br><span class=\"line\">    B路由 --&gt; 终端设备[&quot;PC/手机/IoT设备&quot;]</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">\tsubgraph &quot;A路由配置（Qihoo 360T7）&quot;</span><br><span class=\"line\">        A_HW[&quot;硬件：Qihoo 360T7/ARMv8&quot;]</span><br><span class=\"line\">        A_SYS[&quot;系统：ImmortalWrt 24.10-SNAPSHOT/内核6.6.95&quot;]</span><br><span class=\"line\">        A_WAN[&quot;WAN：PPPoE拨号&quot;]</span><br><span class=\"line\">        A_LAN[&quot;LAN：192.168.2.1/24&quot;]</span><br><span class=\"line\">    end</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">    subgraph &quot;B路由配置（JDCloud RE-CS-02）&quot;</span><br><span class=\"line\">        B_HW[&quot;硬件：JDCloud RE-CS-02 AX6600/ARMv8&quot;]</span><br><span class=\"line\">        B_SYS[&quot;系统：BleachWrt Docker 20251212/内核6.12.61&quot;]</span><br><span class=\"line\">        B_WAN[&quot;WAN：DHCP&quot;]</span><br><span class=\"line\">        B_LAN[&quot;LAN：192.168.6.1/24&quot;]</span><br><span class=\"line\">    end</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"核心需求与约束\"><a href=\"#核心需求与约束\" class=\"headerlink\" title=\"核心需求与约束\"></a>核心需求与约束</h3><ul>\n<li><strong>功能需求：</strong>A、B 路由下设备获取 <strong>全球唯一公网 IPv6 地址</strong>（非 ULA 私有地址、非 NAT66 转换）</li>\n<li><strong>禁止操作：</strong>不合并网段、不修改 A&#x2F;B 路由 IPv4 网段、B 路由不切换 AP 模式。</li>\n</ul>\n<h3 id=\"初始故障现象\"><a href=\"#初始故障现象\" class=\"headerlink\" title=\"初始故障现象\"></a>初始故障现象</h3><p><strong>核心故障：B 路由器无法获取 IPv6 前缀委派（PD），其 LAN 口仅分配 <code>fde8::</code> 开头的 ULA 私有地址，导致下联设备无法访问 IPv6 公网</strong></p>\n<table>\n<thead>\n<tr>\n<th>设备&#x2F;接口</th>\n<th>IPv6 状态</th>\n<th>异常点分析</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>A 路由 LAN 设备</td>\n<td>正常获取公网 IPv6（2409::&#x2F;60 网段），可访问 IPv6 公网资源</td>\n<td>-</td>\n</tr>\n<tr>\n<td>B 路由 WAN6 口</td>\n<td>获得公网 IPv6 地址（2409::&#x2F;64）</td>\n<td><strong>仅获取地址，未获取 PD 前缀池</strong></td>\n</tr>\n<tr>\n<td>B 路由 LAN 口</td>\n<td>仅分配 ULA 地址（fde8:::1&#x2F;64），无公网 IPv6 前缀</td>\n<td><strong>PD 未穿透，无法分发公网地址</strong></td>\n</tr>\n<tr>\n<td>B 下终端设备</td>\n<td>仅获取 fde8:: 私有地址，部分设备偶然出现非 A 路由网段公网 IPv6</td>\n<td><strong>地址来源异常，不可靠</strong></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"核心技术概念解析（先懂原理再配置）\"><a href=\"#核心技术概念解析（先懂原理再配置）\" class=\"headerlink\" title=\"核心技术概念解析（先懂原理再配置）\"></a>核心技术概念解析（先懂原理再配置）</h2><h3 id=\"什么是-IPv6-前缀委派（Prefix-Delegation-PD）？\"><a href=\"#什么是-IPv6-前缀委派（Prefix-Delegation-PD）？\" class=\"headerlink\" title=\"什么是 IPv6 前缀委派（Prefix Delegation, PD）？\"></a>什么是 IPv6 前缀委派（Prefix Delegation, PD）？</h3><p>IPv6 前缀委派是 DHCPv6 协议的核心扩展功能，用于 <strong>多级路由场景下的前缀分配与管理</strong>。简单说：</p>\n<ul>\n<li>ISP 向主路由（A）分配一个大的 IPv6 前缀（如本文 <code>/60</code>），相当于给主路由分配了一个”地址池”</li>\n<li>主路由（A）通过 PD 机制，将这个大前缀拆分成多个小前缀（如 <code>/64</code>），分发给下游路由（B）</li>\n<li>下游路由（B）再用分到的小前缀，为自己 LAN 下的设备分配独立公网 IPv6 地址</li>\n</ul>\n<p><strong>类比理解</strong>：ISP 给你家（A 路由）分配了一栋 16 层的楼（<code>/60</code> 前缀，可拆 16 个 <code>/64</code> 子网），PD 就是你把其中一层（如第 4 层，<code>/64</code> 子网）分配给租客（B 路由），租客再把这一层的房间（独立 IPv6 地址）分配给家人（终端设备）。</p>\n<h3 id=\"IPv6-PD-协议交互流程\"><a href=\"#IPv6-PD-协议交互流程\" class=\"headerlink\" title=\"IPv6 PD 协议交互流程\"></a>IPv6 PD 协议交互流程</h3><p>PD 并非简单的”地址分配”，而是 <strong>DHCPv6 协议簇的 IA_PD（Identity Association for Prefix Delegation）交互过程</strong>，核心流程如下：</p>\n<ol>\n<li><strong>A 路由拨号阶段</strong>：A 路由通过 PPPoE 发送 DHCPv6 Solicit 报文，携带 IA_PD 请求选项，ISP 回应 Advertise 报文，分配 &#x2F;60 前缀（2409:8a38:1422:4cxx::&#x2F;60）</li>\n<li><strong>B 路由请求阶段</strong>：B 路由 WAN6 口发送 DHCPv6 Solicit 报文，携带 IA_PD（请求 &#x2F;64 前缀）和 IA_NA（请求自身 IPv6 地址）选项</li>\n<li><strong>A 路由分配阶段</strong>：A 路由的 odhcpd 服务接收请求，从 &#x2F;60 前缀池中拆分出一个 &#x2F;64 子前缀（如 2409:8a38:1422:4cyy::&#x2F;64），通过 Reply 报文返回给 B 路由</li>\n<li><strong>B 路由分发阶段</strong>：B 路由将获得的 &#x2F;64 前缀配置到 br-lan 接口，通过 RA 报文通告给终端，同时 DHCPv6 服务器补充 DNS 等配置</li>\n</ol>\n<h3 id=\"为什么-IPv6-最小子网必须是-64？\"><a href=\"#为什么-IPv6-最小子网必须是-64？\" class=\"headerlink\" title=\"为什么 IPv6 最小子网必须是 /64？\"></a>为什么 IPv6 最小子网必须是 <code>/64</code>？</h3><p>这是 IPv6 协议设计的硬性规范，核心原因有三：</p>\n<ol>\n<li><p><strong>SLAAC 地址自动配置需求</strong>：IPv6 无状态地址自动配置（SLAAC）依赖 EUI-64 格式生成地址，SLAAC 协议要求接口标识字段为 64 位（通过 MAC 地址转换生成），因此子网前缀必须为 &#x2F;64（网络位 64 + 接口位 64 &#x3D; 128 位完整地址）</p>\n</li>\n<li><p><strong>协议兼容性</strong>：几乎所有 IPv6 设备（电脑、手机、IoT 设备）仅支持 <code>/64</code> 子网，非 <code>/64</code> 子网（如 <code>/63</code>、<code>/65</code>）会导致设备无法自动获取地址或通信异常</p>\n<blockquote>\n<p>RFC 4291 明确规定，除点对点链路外，所有 IPv6 子网必须使用 &#x2F;64 前缀，非 &#x2F;64 子网（如 &#x2F;63、&#x2F;65）会导致设备拒绝接收 RA 报文</p>\n</blockquote>\n</li>\n<li><p><strong>路由标准化</strong>：ISP 分配的公网前缀（如 <code>/56</code>、<code>/60</code>）均为 <code>/64</code> 的整数倍（<code>/56</code> 可拆 256 个 <code>/64</code>，<code>/60</code> 可拆 16 个 <code>/64</code>），确保多级分配无浪费</p>\n</li>\n</ol>\n<h3 id=\"前缀委派成功的三大核心条件\"><a href=\"#前缀委派成功的三大核心条件\" class=\"headerlink\" title=\"前缀委派成功的三大核心条件\"></a>前缀委派成功的三大核心条件</h3><ol>\n<li><strong>上游路由（A）</strong>：<ul>\n<li>已从 ISP 获取合法公网前缀（如 <code>/60</code>）</li>\n<li>启用 DHCPv6 服务器与 RA（路由通告）服务</li>\n<li>允许向下游路由分发子前缀（PD 分发权限开启）</li>\n</ul>\n</li>\n<li><strong>下游路由（B）</strong>：<ul>\n<li>WAN6 口启用 DHCPv6 客户端，且显式请求前缀委派</li>\n<li>LAN 口配置为从 PD 前缀自动获取地址，启用 RA&#x2F;DHCPv6 服务</li>\n</ul>\n</li>\n<li><strong>通信链路</strong>：<ul>\n<li>两级路由之间允许 DHCPv6 协议（UDP 546&#x2F;547 端口）与 ICMPv6 协议（RS&#x2F;RA&#x2F;NS&#x2F;NA 类型）通行</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"根本故障原因\"><a href=\"#根本故障原因\" class=\"headerlink\" title=\"根本故障原因\"></a>根本故障原因</h2><p><strong>B 路由未获取 PD 前缀，A 路由 odhcpd 服务因配置限制，未响应 B 路由的 IA_PD 请求。</strong></p>\n<h3 id=\"核心误区：对-“PD-最小长度”-的理解错误\"><a href=\"#核心误区：对-“PD-最小长度”-的理解错误\" class=\"headerlink\" title=\"核心误区：对 “PD 最小长度” 的理解错误\"></a>核心误区：对 “PD 最小长度” 的理解错误</h3><p>A 路由器 Web UI（LuCI）中，DHCPv6 服务器有一个关键选项 **”PD 最小长度（Minimum Prefix Delegation Length）”**，这是本次踩坑的核心陷阱：</p>\n<table>\n<thead>\n<tr>\n<th>错误认知</th>\n<th>正确逻辑</th>\n<th>底层原理</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>“要分给 B 路由 <code>/64</code> 子网，所以填 64”</td>\n<td>“PD 最小长度 &#x3D; 上游获取的前缀长度（如 <code>/60</code>）”</td>\n<td>该字段实际含义是 **”允许向下游分配的最长前缀长度下限”**，填 <code>/60</code> 表示”允许分配 <code>/60</code> 及更长的前缀（如 <code>/61</code>、<code>/62</code>、<code>/64</code>）”</td>\n</tr>\n<tr>\n<td>“UI 限制 1-62，无法填 64 就是配置不了”</td>\n<td>“UI 限制是 Bug，填 <code>/60</code> 即可触发底层自动分配 <code>/64</code>“</td>\n<td>OpenWrt 底层 odhcpd 服务支持从 <code>/60</code> 拆分 <code>/64</code>，LuCI 前端硬编码输入范围，与底层 odhcpd 服务支持冲突，UI 输入限制仅为前端逻辑，不影响底层功能</td>\n</tr>\n</tbody></table>\n<h3 id=\"故障点\"><a href=\"#故障点\" class=\"headerlink\" title=\"故障点\"></a>故障点</h3><ul>\n<li>B 路由器 WAN6 口未显式配置 <code>reqprefix=&#39;auto&#39;</code>，仅请求了 IPv6 地址，未请求前缀委派</li>\n<li>初始配置中 A 路由器错配未勾选 “将委派前缀60并分配给下游”，导致 B 路由的 PD 请求被拒绝</li>\n</ul>\n<hr>\n<h2 id=\"分步解决方案（按优先级排序）\"><a href=\"#分步解决方案（按优先级排序）\" class=\"headerlink\" title=\"分步解决方案（按优先级排序）\"></a>分步解决方案（按优先级排序）</h2><h3 id=\"4-1-A-路由器（上游主路由PD分发端）配置\"><a href=\"#4-1-A-路由器（上游主路由PD分发端）配置\" class=\"headerlink\" title=\"4.1 A 路由器（上游主路由PD分发端）配置\"></a>4.1 A 路由器（上游主路由PD分发端）配置</h3><h4 id=\"让-A路由器的odhcpd-服务正确响应-B-路由的-PD-请求\"><a href=\"#让-A路由器的odhcpd-服务正确响应-B-路由的-PD-请求\" class=\"headerlink\" title=\"让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求\"></a>让 A路由器的odhcpd 服务正确响应 B 路由的 PD 请求</h4><ol>\n<li><p><strong>WAN 接口配置</strong>：</p>\n<ul>\n<li>协议：PPPoEc</li>\n<li>勾选：<code>请求 IPv6 前缀委派（Request IPv6 prefix delegation）</code></li>\n<li>高级设置：<code>使用默认网关，自动获取DNS服务器，开启IPv6源路由，委托IPv6前缀，禁用IPv6分配长度，其余默认</code></li>\n<li><code>使用对等 DNS</code> 勾选（若有）</li>\n<li>DHCP服务器：<code>常规设置 忽略此接口，指定的主接口默认关闭，IPv6设置全部禁用</code></li>\n<li>确认：已获取 <code>/60</code> 前缀（如 <code>2409:8a38:1422:4c20::/60</code>）</li>\n</ul>\n</li>\n<li><p><strong>LAN 接口 → DHCP 服务器 → IPv6 设置</strong>：</p>\n<ul>\n<li><p>高级设置：<code>开启委托IPv6前缀，IPv6分配长度设置为64，其余默认</code></p>\n</li>\n<li><p>DHCP服务器：</p>\n<ul>\n<li><p><code>高级设置动态DHCP开启</code></p>\n</li>\n<li><p><code>IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认</code></p>\n<blockquote>\n<p> RA 服务：<code>服务器模式</code>（必须，用于向 B 路由通告路由信息）</p>\n<p>DHCPv6 服务：<code>服务器模式</code>（必须，用于分配 DNS 等配置信息）</p>\n<p>NDP 代理：<code>禁用</code>（默认禁用，无需改动）</p>\n</blockquote>\n</li>\n<li><p><code>IPv6 RA设置 启用SLAAC RA标记改为其他配置 DHCPv6模式改为无状态+有状态的 其余默认</code></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>保存配置并应用</strong></p>\n</li>\n</ol>\n<h3 id=\"B-路由器（下游二级路由）配置\"><a href=\"#B-路由器（下游二级路由）配置\" class=\"headerlink\" title=\"B 路由器（下游二级路由）配置\"></a>B 路由器（下游二级路由）配置</h3><h4 id=\"让-B-路由正确请求-PD-并应用到-LAN通过-br-lan-分发\"><a href=\"#让-B-路由正确请求-PD-并应用到-LAN通过-br-lan-分发\" class=\"headerlink\" title=\"让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发\"></a>让 B 路由正确请求 PD 并应用到 LAN通过 br-lan 分发</h4><ol>\n<li><p><strong>WAN6 接口配置</strong>（关键：请求 PD 而非仅请求地址）：</p>\n<ul>\n<li>协议：DHCPv6 客户端</li>\n<li>请求 IPv6 地址：<code>try</code>（尝试获取，不强制，避免拨号失败）</li>\n<li>请求指定长度的 IPv6 前缀：<code>自动（auto）</code>（告诉 A 路由”我需要一个子前缀”）</li>\n<li>高级设置：勾选 <code>使用默认网关 使用对等通告的DNS服务器</code> 其余默认（从 A 路由获取 IPv6 DNS 服务器）</li>\n</ul>\n</li>\n<li><p><strong>LAN 接口 → DHCP 服务器 → IPv6 设置</strong>：</p>\n<ul>\n<li><p>RA 服务：<code>服务器模式</code>（向下游设备通告路由）</p>\n</li>\n<li><p>基本设置：<code>IPv6分配长度改为64</code></p>\n</li>\n<li><p>DHCP服务器：</p>\n<ul>\n<li><p><code>高级设置动态DHCP开启</code></p>\n</li>\n<li><p><code>IPv6设置 RA DHCPv6服务均设置服务器模式 PD最小长度60 其余默认</code></p>\n<blockquote>\n<p> RA路由通告服务：<code>服务器模式</code></p>\n<p>DHCPv6 服务：<code>服务器模式</code></p>\n<p>NDP 代理：<code>禁用</code>（默认禁用，无需改动）</p>\n<p>IPv6 RA设置 启用SLAAC RA标记改为其他配置（若有）</p>\n<p>DHCPv6模式改为无状态+有状态的</p>\n<p>勾选：<code>总是通告默认路由</code></p>\n<p>其余默认</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>保存配置并应用</strong></p>\n</li>\n</ol>\n<h3 id=\"防火墙配置（默认已兼容，异常时检查）\"><a href=\"#防火墙配置（默认已兼容，异常时检查）\" class=\"headerlink\" title=\"防火墙配置（默认已兼容，异常时检查）\"></a>防火墙配置（默认已兼容，异常时检查）</h3><p>IPv6 通信依赖 ICMPv6 与 DHCPv6 协议，确保 A&#x2F;B 路由防火墙未拦截：</p>\n<ul>\n<li><p>允许 UDP 546&#x2F;547 端口（DHCPv6 客户端&#x2F;服务器端口）</p>\n</li>\n<li><p>允许 ICMPv6 类型 133（RS 路由请求）、134（RA 路由通告）、135（NS 邻居请求）、136（NA 邻居通告）</p>\n</li>\n<li><p>OpenWrt 默认防火墙规则已放行上述流量，无需额外配置，除非手动修改过默认规则</p>\n</li>\n<li><p>命令行放行（若默认规则被修改）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># A/B 路由均执行</span></span><br><span class=\"line\">uci add firewall rule</span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].name=<span class=\"string\">&#x27;Allow-DHCPv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].proto=<span class=\"string\">&#x27;udp&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].src=<span class=\"string\">&#x27;lan&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].dest_port=<span class=\"string\">&#x27;546-547&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].target=<span class=\"string\">&#x27;ACCEPT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">uci add firewall rule</span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].name=<span class=\"string\">&#x27;Allow-ICMPv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].proto=<span class=\"string\">&#x27;icmpv6&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].src=<span class=\"string\">&#x27;lan&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].icmp_type=<span class=\"string\">&#x27;133 134 135 136&#x27;</span></span><br><span class=\"line\">uci <span class=\"built_in\">set</span> firewall.@rule[-1].target=<span class=\"string\">&#x27;ACCEPT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">uci commit firewall</span><br><span class=\"line\">/etc/init.d/firewall restart</span><br></pre></td></tr></table></figure></li>\n</ul>\n<hr>\n<h2 id=\"修改后状态验证\"><a href=\"#修改后状态验证\" class=\"headerlink\" title=\"修改后状态验证\"></a>修改后状态验证</h2><h3 id=\"B-路由器状态验证\"><a href=\"#B-路由器状态验证\" class=\"headerlink\" title=\"B 路由器状态验证\"></a>B 路由器状态验证</h3><ol>\n<li><p><strong>Web UI 验证</strong>：</p>\n<ul>\n<li>WAN6 接口：显示 <code>IPv6-PD</code> 字段（如 <code>2409:xxyy:xxyy:xxyy::/62</code>），表示成功获取子前缀池</li>\n<li>LAN 接口（br-lan）：显示公网 IPv6 地址（如 <code>2409:xxyy:xxyy:xxyy::1/64</code>），同时可能存在 <code>fde8::</code> 开头的 ULA 地址（可忽略，不影响使用）</li>\n</ul>\n</li>\n<li><p><strong>SSH 命令验证</strong>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看 PD 获取状态</span></span><br><span class=\"line\">ubus call network.interface.wan6 status | grep -A6 <span class=\"string\">&quot;ipv6-prefix&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 成功输出示例</span></span><br><span class=\"line\"><span class=\"string\">&quot;ipv6-prefix&quot;</span>: [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;address&quot;</span>: <span class=\"string\">&quot;2409:xxyy:xxyy:xxyy::&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;mask&quot;</span>: 62,  <span class=\"comment\"># 显示 /62 是正常的，底层会自动拆分 /64 子网</span></span><br><span class=\"line\">    <span class=\"string\">&quot;preferred&quot;</span>: 86400,</span><br><span class=\"line\">    <span class=\"string\">&quot;valid&quot;</span>: 172800</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查看 LAN 口 IPv6 地址：<code>ip -6 addr show br-lan</code>，需存在 <code>scope global</code> 类型的公网地址（非 <code>fe80::</code> 链路本地地址）</li>\n</ul>\n</li>\n<li><p><strong>终端设备验证（Windows&#x2F;macOS&#x2F;Linux）</strong>：</p>\n<ul>\n<li><p>Windows：<code>ipconfig /all</code> 应显示 2409:xxyy:xxyy:xxyy 地址</p>\n</li>\n<li><p>macOS&#x2F;Linux：<code>ip -6 addr</code> 应显示 scope global 类型的  2409:xxyy:xxyy:xxyy开头地址</p>\n</li>\n<li><p>连通性测试：访问 <code>https://test-ipv6.com/</code>，得分 10&#x2F;10 表示配置完全正确</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 命令行</span></span><br><span class=\"line\">ping6 ipv6.google.com  <span class=\"comment\"># 通表示路由正常</span></span><br><span class=\"line\">curl -6 https://api6.ipify.org  <span class=\"comment\"># 返回公网 IPv6 地址表示成功</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"排错工具链（从日志到抓包）\"><a href=\"#排错工具链（从日志到抓包）\" class=\"headerlink\" title=\"排错工具链（从日志到抓包）\"></a>排错工具链（从日志到抓包）</h2><h3 id=\"常见误区原因\"><a href=\"#常见误区原因\" class=\"headerlink\" title=\"常见误区原因\"></a>常见误区原因</h3><ol>\n<li><strong>误区 1</strong>：PD 最小长度填 <code>64</code> → 正确做法：填上游获取的前缀长度（如 <code>/60</code>）<ul>\n<li>原因：UI 显示”最小长度”实为”最长前缀允许下限”，填 <code>/60</code> 才能让系统拆分 <code>/64</code> 子前缀</li>\n</ul>\n</li>\n<li><strong>误区 2</strong>：B 路由 WAN6 仅请求地址，未请求 PD → 正确做法：必须设置 <code>reqprefix=&#39;auto&#39;</code><ul>\n<li>原因：仅请求地址会导致 B 路由只有自身 IPv6 地址，没有子前缀池，无法分给下游设备</li>\n</ul>\n</li>\n<li><strong>误区 3</strong>：手动给 B 路由 LAN 口指定静态 IPv6 地址 → 正确做法：留空，让系统从 PD 自动获取<ul>\n<li>原因：手动指定会导致地址与 PD 前缀不匹配，下游设备无法获取有效地址</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"常见故障排查\"><a href=\"#常见故障排查\" class=\"headerlink\" title=\"常见故障排查\"></a>常见故障排查</h3><table>\n<thead>\n<tr>\n<th>故障现象</th>\n<th>排查步骤</th>\n<th>解决方案</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>B 路由 WAN6 无 IPv6-PD</td>\n<td>1. 检查 A 路由是否勾选”分配 PD 给下游”；2. 检查 B 路由 reqprefix 是否为 auto；3. 查看 A 路由日志 &#96;logread</td>\n<td>grep dhcpv6&#96;</td>\n</tr>\n<tr>\n<td>B 路由 LAN 口无公网 IPv6</td>\n<td>1. 检查 B 路由 LAN 分配长度是否为 64；2. 查看 PD 是否获取成功；3. 重启 B 路由网络服务</td>\n<td>1. 设为 64 子网；2. 重新请求 PD；3. 执行 <code>/etc/init.d/network restart</code></td>\n</tr>\n<tr>\n<td>终端有公网 IPv6 但无法上网</td>\n<td>1. 检查是否为 ULA 地址（fd 开头）；2. 验证默认路由是否存在；3. 测试 DNS 解析 <code>nslookup -type=AAAA ipv6.google.com</code></td>\n<td>1. 确保获取公网前缀（2409: 等）；2. 确认 RA 已通告默认路由；3. 检查 DNS 配置是否正确</td>\n</tr>\n</tbody></table>\n<h3 id=\"日志分析（SSH）：\"><a href=\"#日志分析（SSH）：\" class=\"headerlink\" title=\"日志分析（SSH）：\"></a><strong>日志分析（SSH）</strong>：</h3><ul>\n<li>查看 A 路由 PD 分配日志：<code>logread | grep odhcpd | grep -E &#39;prefix|delegate&#39;</code></li>\n<li>查看 B 路由 PD 请求日志：<code>logread | grep dhcp6c | grep -E &#39;IA_PD|prefix&#39;</code></li>\n<li>关键成功日志：<code>dhcp6c: client6_recvreply: reply received from fe80::e2ef:2ff:fed0:ac01%wan, pending IAID 0</code></li>\n</ul>\n<h3 id=\"抓包验证（需安装-tcpdump）：\"><a href=\"#抓包验证（需安装-tcpdump）：\" class=\"headerlink\" title=\"抓包验证（需安装 tcpdump）：\"></a><strong>抓包验证（需安装 tcpdump）</strong>：</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># B 路由安装 tcpdump</span></span><br><span class=\"line\">opkg update &amp;&amp; opkg install tcpdump</span><br><span class=\"line\"><span class=\"comment\"># 抓取 WAN6 口 DHCPv6 报文</span></span><br><span class=\"line\">tcpdump -i wan6 port 546 or port 547 -vvv</span><br><span class=\"line\"><span class=\"comment\"># 成功标志：存在 DHCPv6 Reply 报文，携带 IA_PD 选项（前缀 2409:8a38:1422:4cyy::/64）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><h3 id=\"协议本质\"><a href=\"#协议本质\" class=\"headerlink\" title=\"协议本质\"></a>协议本质</h3><p>IPv6 PD 穿透的核心是 <strong>“请求-分配-分发”的 DHCPv6 交互闭环</strong>，OpenWrt&#x2F;ImmortalWrt 的 UI 限制只是表象，通过 SSH 命令行可直接操作底层配置文件，突破前端限制。对于无独立 RA 配置的机型，记住”DHCPv6 服务器模式&#x3D;RA 服务器模式”的等效关系，即可实现功能全覆盖。</p>\n<p>本方案已在 Qihoo 360T7（ImmortalWrt 24.10）+ JDCloud RE-CS-02 AX6600（BleachWrt 25.10.10）环境验证通过，适用于所有 OpenWrt 22.03+ 衍生版本，以及 ISP 提供 &#x2F;56、&#x2F;60 前缀的场景。</p>\n"},{"title":"test","date":"2025-08-04T10:02:12.000Z","_content":"# First\n## Test\n- 1\n- 2\n- 3\n- 4\n\n> 你好\n> 你好","source":"_posts/test.md","raw":"---\ntitle: test\ndate: 2025-08-04 18:02:12\ntags:\n- Hexo\n- 博客\ncategories:\n- 学习笔记\n---\n# First\n## Test\n- 1\n- 2\n- 3\n- 4\n\n> 你好\n> 你好","slug":"test","published":1,"updated":"2026-01-15T15:29:27.955Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivm000424j3cr6u8ta9","content":"<h1 id=\"First\"><a href=\"#First\" class=\"headerlink\" title=\"First\"></a>First</h1><h2 id=\"Test\"><a href=\"#Test\" class=\"headerlink\" title=\"Test\"></a>Test</h2><ul>\n<li>1</li>\n<li>2</li>\n<li>3</li>\n<li>4</li>\n</ul>\n<blockquote>\n<p>你好<br>你好</p>\n</blockquote>\n","excerpt":"","more":"<h1 id=\"First\"><a href=\"#First\" class=\"headerlink\" title=\"First\"></a>First</h1><h2 id=\"Test\"><a href=\"#Test\" class=\"headerlink\" title=\"Test\"></a>Test</h2><ul>\n<li>1</li>\n<li>2</li>\n<li>3</li>\n<li>4</li>\n</ul>\n<blockquote>\n<p>你好<br>你好</p>\n</blockquote>\n"},{"title":"数据备份策略","date":"2025-08-04T15:33:36.000Z","_content":"\n\n\n\n\n\n\n\n# 最终备份方案\n\n## 🧭 备份策略总览\n\n为了确保个人数据的**安全性、可恢复性与使用便捷性**，本方案制定如下总目标：\n\n### 🎯 目标原则\n\n1. ✅ **Free 优先 / 极力节省成本**\n   - 优先使用免费工具与服务（如夸克网盘、FreeFileSync、GitHub 私有仓库等）。\n   - 如遇容量/功能限制，可在关键场景下考虑“轻量付费”。\n2. 🧊🔥 **冷备份 + 热备份并存**\n   - **冷备份**（如外置硬盘、月度虚拟机镜像）：面向大规模恢复与长期留存。\n   - **热备份**（如夸克同步文件夹、WebDAV）：用于日常使用/误删恢复。\n3. ✌️ **双重备份**\n   - 所有重要数据均至少存在两份：本地一份 + 云端一份。\n   - 特别关键数据可建立“三重冗余”（如代码库、密码数据库）。\n4. 🔐 **安全、便携、实用**\n   - 所有备份路径可在新设备/系统中快速恢复（不依赖某一单一设备）。\n   - 敏感文件使用 `.gitignore` / 加密等方式保障隐私。\n   - 所用工具应支持主流系统（Windows/macOS/Linux/手机）。\n5. 🌀 **热备尽量做到“无感备份”，自动化脚本**\n   - 使用同步客户端（夸克、天翼）或脚本（FreeFileSync + 定时任务）实现定时自动化。\n   - 避免手动操作，提高容错率。\n6. 📖 **编写《恢复手册.md》**\n   - 文档中将详细记录：\n     - 所有数据来源位置（路径 / 网盘）\n     - 对应恢复方式与工具\n     - 账号密码管理器路径\n     - 依赖的插件/脚本清单\n   - 保证任何时候数据在 24 小时内可通过登录账户 + 同步脚本 + 手动恢复操作，实现完整数据还原。\n\n### 备份设备\n\n#### 本地\n\n- 手机\n- 电脑\n- 软路由\n- U盘\n\n#### 云端\n\n- 夸克网盘\n- 坚果云（免费轻量云端Webdav）\n- 谷歌相册\n- 一刻相册\n\n## 备份内容类别\n\n- 照片/视频\n- 影视\n- 音乐\n- 代码工作区\n- QQ/微信聊天记录\n- 浏览器书签\n- 椒盐笔记\n- 文档素材\n- 虚拟机\n- 密码管理器\n- 输入法词库\n\n\n\n### **照片/视频**\n\n- **云端**：Google Photos（免费原图备份，已启用）+ 一刻相册。\n- **本地**：暂缓，后续可考虑NAS+易有云。\n\n#### 🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？\n\n##### ✅ 1. Google Photos（谷歌相册）\n\n- 我已搭建软路由，家中设备默认处于“魔法环境”，**Google Photos 可实现无感自动同步**。\n\n- **优点**：\n  - **无限容量优势**：Google 官方承诺 **Pixel 1 机型享有永久、无损、无限量照片与视频备份**。\n  - **技术绕过可实现“伪Pixel”特权**：通过 Root 的手机设备 + Magisk 模块，可模拟为 Pixel 1，激活无限备份策略。\n  - **自动分类、搜索强大**：Google Photos 提供 **AI 智能识别、人脸聚合、地图定位、关键词搜索** 等强大功能，方便管理海量照片。\n- **缺点**：\n  - Google 在中国大陆无法直接访问，**必须依赖稳定 VPN 或旁路代理环境**。\n\n##### ✅ 2. 一刻相册（作为国产补充方案）\n\n- **优点**：\n  - 理论无限空间、界面友好。\n  - 适合中国用户使用。\n- **缺点**：\n  - 备份大视频、批量恢复需开通会员。\n  - 卡顿，使用体验并不好，自动备份实测耗电情况严重。\n\n##### ✅ 3. 本地备份（未来补充方案）\n\n- 本地方案，计划后续部署 **NAS + 易有云** 搭建家庭私有云，实现本地备份、快速访问和远程同步。\n- 配合 Google Photos 可形成「冷 + 热备份」组合，提高数据安全性和可恢复性。\n\n------\n\n### 🎬 影视\n\n#### ☁️ 云端备份策略\n\n- **115 网盘**（主力推荐）\n  - ✅ 稳定性高，上传/下载/播放速度极佳。\n  - ✅ 支持 WebDAV 协议，可被 Jellyfin、Infuse、nPlayer 等播放器远程挂载使用。\n  - ✅ 支持在线播放，大视频兼容性强。\n  - ⚠️ **需付费会员才能正常使用**，非会员限速严重，功能大幅受限。\n  - ⚠️ 分享功能有限制，建议搭配 AList 或其他工具使用。\n- **天翼云盘**（适合电信用户）\n  - ✅ **永久免费扩容活动多**（绑定手机号后空间可达 6TB+）。\n  - ✅ 上传/下载速度快，支持自动备份监控文件夹。\n  - ✅ 适合作为长期备份盘，配合自动化工具使用更佳。\n  - ⚠️ 播放器兼容性一般，不支持 WebDAV，适合作为存储盘而非播放源。\n- **移动云盘**（适合移动用户）\n  - ✅ 与天翼云盘类似，用户活跃度高时也有较大空间赠送。\n  - ✅ 上传/下载体验不错，适合作为副备份盘。\n  - ⚠️ 播放体验一般，不支持 WebDAV。\n- **夸克网盘**（次级推荐）\n  - ✅ 支持在线播放、AI字幕识别、自动分类等功能。\n  - ✅ 可通过淘宝88VIP（88元/年）获得夸克会员，**相当于“白嫖”会员体验**。\n  - ⚠️ 免费用户限速严重，长时间使用必须配合会员。\n  - ⚠️ 分享和下载频率受限，适合当临时备份盘。\n- **123 网盘**（备用方案）\n  - ✅ 上传/下载/在线播放体验优秀，客户端简洁无广告。\n  - ✅ 分享功能较开放，支持大文件外链。\n  - ✅ 官方有 Web API 支持，可接入 AList 或自建下载脚本。\n  - ⚠️ **无会员使用体验较差**，限速较严重，上传大文件基本不可行。\n  - ⚠️ 存储安全性有待考察，**适合短期转存或资源中转**。\n\n------\n\n#### 🧩 聚合播放方案：小雅 AList\n\n- AList 是聚合网盘的 Web 文件浏览器，可统一访问多个云盘资源。\n- 支持网盘包括：**阿里云盘、115、123、坚果云、天翼云盘（部分支持）、WebDAV、自建服务等**。\n- 可配置为 WebDAV 网关，与 Jellyfin、Infuse、Kodi、nPlayer 等播放器联动使用，实现局域网或远程无感播放。\n- 推荐搭配方案：\n  - 小雅 AList 公共节点（alist.xiaoya.pro）→ 挂载 115 / 123 网盘 → Infuse / nPlayer 播放器观看。\n  - 自建 AList 实例（Docker / 本地）+ Token 授权更安全稳定。\n\n------\n\n#### 🖥️ 本地方案规划：Jellyfin + NAS（后续）\n\n虽然当前未考虑，但未来部署仍具备价值，作为云端存储的**本地冷备+家庭影院**方案：\n\n- **Jellyfin**：免费开源媒体中心，自动整理影视资源，支持多平台客户端。\n- **NAS（当前为软路由）**：集中存储、远程访问、播放高清无压力。\n- **自动化工具搭配**：\n  - `rclone` 同步网盘内容至本地。\n  - `aria2 / qBittorrent` 搭建自动下载中心。\n  - AList + Jellyfin 构建本地 + 云端混合播放环境。\n\n------\n\n#### 📊 云盘对比汇总（影视适用性）\n\n| 云盘平台     | 是否限速           | 播放支持 | WebDAV 支持     | 是否需要会员       | 适合场景                    |\n| ------------ | ------------------ | -------- | --------------- | ------------------ | --------------------------- |\n| **115 网盘** | 免费限速，会员不限 | ✅ 强     | ✅（需配置）     | **需要付费**       | 主力备份 + 播放 + AList挂载 |\n| **天翼云盘** | 不限速             | 一般     | ❌               | **免费**           | 大容量备份（电信优选）      |\n| **移动云盘** | 不限速             | 一般     | ❌               | **免费**           | 大容量备份（移动用户）      |\n| **夸克网盘** | 免费限速，会员快   | ✅ 中等   | ❌               | **88VIP 白嫖会员** | 临时转存 / 播放             |\n| **123 网盘** | 免费限速，会员快   | ✅ 中等   | ⚠️（API 或绕过） | **基本需付费**     | 中转下载 / 资源分享         |\n\n\n\n------\n\n### 音乐\n\n**本地**：当前占用约10GB，统一存放于固定路径（`E:/音乐/`），冷备份至U盘及软路由存储中，确保本地多设备冗余。\n\n- **本地播放/管理方案**：采用 **Navidrome + NAS** 组合或 **Jellyfin + NAS**，搭建私人音乐服务器，实现跨设备在线播放、管理和元数据同步。\n  - **Navidrome**：轻量级音乐服务器，支持多用户、Web和手机客户端，兼容多种音频格式，适合个人或小团队使用。\n  - **Jellyfin**：功能更强大，支持多媒体统一管理（音乐、电影、电视），支持DLNA、Chromecast等多种播放协议，适合更丰富的多媒体需求。\n\n**云端同步**：\n\n- 夸克网盘：启用“同步文件夹”功能，将`D:/Music/`设为同步目录热备份（需确保夸克客户端常驻后台）。\n\n**歌单与播放列表管理**：\n\n- 使用 **歌单无界** 等工具，能有效匹配和同步歌单排序，实现云端与本地播放列表的无缝衔接，避免歌单乱序问题，提升听歌体验。\n\n#### 🧐 为什么选择夸克网盘作为音乐备份平台？\n\n##### ✅ 多平台支持，使用体验优秀\n\n- 支持 **Android / iOS / Web / Windows / Mac** 等主流平台。\n- 无论是手机、平板、电脑均可便捷访问、播放与下载音频文件。\n- 网页端支持50MB以内单文件下载，**无需额外客户端**。\n\n##### ✅ 存储空间充足，价格极低\n\n- 通过 **88VIP 赠送的夸克会员权益（价值5元一年）**，可获得至少 **6TB 超大云盘容量**。\n\n- 适合长期保存大量高质量无损音乐、专辑、母带文件。\n\n- **性价比极高**，几乎免费获得专业级云盘体验。\n\n##### ✅ 上传/下载速度优秀\n\n- 会员上传、下载稳定在 **50MB/s 以上**，支持单文件最大100GB上传。\n- 支持断点续传，保障长时间上传的稳定性。\n\n##### ✅ 原文件存储，不转码不压缩\n\n- 音频文件 **不会被转码或重命名**，保留完整元数据。\n- 适合储存音乐资料库、专辑封面、歌词、Cue 文件等文件结构较复杂的音乐归档。\n\n##### ✅ 文件结构清晰，支持批量管理\n\n- 支持自定义目录层级，如 `音乐归档/无损合集/年代/艺术家/`，便于分类和查找。\n- PC客户端支持拖拽和批量上传，简化管理流程。\n- 支持文件重命名规则插件，保持命名规范。\n\n##### ✅ 分享与恢复便捷\n\n- 支持生成带有效期的分享链接，方便与朋友共享音乐。\n- 设备更换或损坏后，登录账号即可无缝恢复全库，免除手动迁移烦恼。\n\n------\n\n### 代码工作区（`F:/Workspace/`）\n\n#### 本地备份\n\n##### 当前状态\n\n- 主要代码工作区位于F盘本地磁盘。\n\n##### 未来规划\n\n- 计划部署 **NAS 设备**，实现自动定时快照和备份。\n- NAS结合版本控制或增量备份方案，可大幅提升数据安全性和多设备访问便利。\n\n#### 云端同步\n\n##### Git + GitHub 私有仓库（适合核心代码版本控制）\n\n###### 注册与创建仓库\n\n- 注册GitHub账号（https://github.com/）。\n- 创建私有仓库（例如 `my-workspace`）。\n- **创建时避免勾选“Initialize with README”**，防止初始化文件与本地冲突。\n\n###### 初始化本地仓库并关联远程\n\n- 在目标项目目录（如`F:/Workspace/project1/`）打开 **Git Bash Here**，依次执行：\n\n  ```bash\n  git init\n  git remote add origin https://github.com/你的用户名/my-workspace.git\n  git add .\n  git commit -m \"Initial commit\"\n  git push -u origin main\n  ```\n\n###### 日常更新流程\n\n- 每次代码修改完成后，执行：\n\n  ```bash\n  git add .\n  git commit -m \"简短描述本次修改\"\n  git push\n  ```\n\n###### 多设备恢复\n\n- 在新设备或工作环境，执行克隆操作：\n\n  ```bash\n  git clone https://github.com/你的用户名/my-workspace.git\n  ```\n\n###### 建议辅助工具\n\n- 推荐使用 VSCode 等支持Git的编辑器，内置Git插件使操作更直观便捷。\n\n###### 注意事项\n\n- 避免提交大文件或敏感信息。\n- 可通过 `.gitignore` 文件排除不需要同步的文件。\n\n##### 夸克网盘（适合非版本控制的备份）\n\n###### 适用范围\n\n- 备份无需版本控制的代码副本、资料文件、配置文件或二进制资源。\n\n###### 备份方法\n\n- 在夸克网盘创建同步文件夹（如 `Workspace_Backup`）。\n- 将本地目录 `F:/Workspace/` 拖入同步文件夹，实现自动热备份。\n- 保证夸克客户端常驻后台以确保同步稳定及时。\n\n#### 补充建议\n\n##### 自动备份脚本\n\n- 可编写定时任务脚本，自动复制代码工作区至NAS或备份目录。\n- 结合增量备份工具，如Linux的 `rsync`，Windows下推荐使用 `DeltaCopy`，提高备份效率。\n\n##### 多版本备份策略\n\n- 利用Git的版本管理优势管理代码历史。\n- 结合NAS快照功能，实现数据误删、误覆盖的快速恢复。\n\n##### 安全性建议\n\n- 私有仓库不宜存储明文密码或敏感密钥。\n- 建议使用环境变量或专门的安全管理工具处理敏感信息。\n\n------\n\n### QQ/微信聊天记录\n\n#### 手机 → 电脑备份\n\n##### 微信备份\n\n- 通过电脑版微信“备份与恢复”功能，连接手机和电脑，选择“备份聊天记录至电脑”操作（需同一局域网）。\n- 可备份聊天文本、图片、语音等内容，需手动操作。\n\n##### QQ备份\n\n- 进入手机QQ“设置 → 通用 → 聊天记录备份与恢复”，选择“备份聊天记录到电脑QQ”，手机与电脑需联网且在同一网络。\n\n#### 电脑 → 本地存储\n\n##### 默认存储路径\n\n- 微信聊天记录路径为：\n   `C:/Users/<用户名>/Documents/WeChat Files/<微信号>/`\n- QQ聊天记录路径为：\n   `C:/Users/<用户名>/Documents/Tencent Files/<QQ号>/`\n\n##### 备份文件管理\n\n- 建议定期将聊天记录目录压缩成 `DataBackup.zip` 方便管理和迁移。\n- 压缩包可存储于U盘、NAS或上传至云盘（如夸克网盘）实现多重备份。\n\n#### Root手机完整备份（推荐第三方工具“数据备份”）\n\n##### 为什么推荐“数据备份”\n\n- 经多次测试，手机官方微信和QQ备份功能**容易遗漏大量图片和视频**，导致备份不完整。\n- “数据备份”作为Root权限工具，能**完整导出所有QQ和微信数据**，包括聊天记录、图片、视频、数据库和缓存文件。\n\n##### 备份流程\n\n- 在Root的手机设备上运行“数据备份”软件，进行完整数据导出。\n- 备份数据压缩成 `DataBackup.zip` 文件，方便保存与传输。\n- 上传压缩文件到夸克网盘或其他云盘，实现安全、长期存储。\n\n##### 优势说明\n\n- 该备份方式全面且数据完整，适合设备更换、系统重装时恢复使用。\n- 极大减少因官方备份功能不足造成的数据丢失风险。\n\n#### 自动化备份建议\n\n##### Windows定时压缩\n\n- 利用任务计划结合批处理脚本，定期压缩本地聊天记录文件夹，减轻手动备份负担。\n\n##### 多层备份架构\n\n- 结合软路由与NAS，定期同步聊天数据，实现本地与网络的多层冗余备份。\n\n#### 安全与隐私\n\n##### 数据加密\n\n- 聊天记录包含个人隐私，建议使用7-Zip等工具对压缩包设置密码保护。\n\n##### 云盘权限控制\n\n- 上传云盘后，务必设置访问权限，避免数据泄露风险。\n\n##### Root权限风险\n\n- Root操作存在一定风险，务必保证备份工具来源正规可靠。\n\n#### 恢复方法\n\n##### 官方恢复途径\n\n- 电脑版微信和QQ支持“备份与恢复”功能，可恢复聊天记录（需确保备份文件完整且版本匹配）。\n\n##### Root备份恢复\n\n- 需借助相应的手机恢复工具，将完整备份数据导入手机，恢复聊天内容、图片和视频。\n\n##### 手动恢复\n\n- 关闭对应客户端后，手动复制聊天记录文件夹到原路径，实现基础数据恢复。\n\n------\n\n### 浏览器书签（Chrome）\n\n- **本地备份**：可通过 Chrome 自带的导出功能，定期导出为 `.html` 文件保存到本地。\n- **云端同步**：\n  - 使用 **Floccus 浏览器插件**，配置 WebDAV（推荐坚果云）后，可实现自动同步浏览器书签到云端。\n  - 也可手动导出书签 `.html` 文件，存入夸克网盘等云服务。\n\n------\n\n#### 🧐 为什么选择坚果云作为同步平台？\n\n##### ✅ 完全支持 WebDAV 协议\n\n- 坚果云提供长期稳定的 WebDAV 接口。\n- 与 Floccus 等插件完美兼容，无需额外脚本或服务端配置。\n\n##### ✅ 安装简便、自动同步\n\n- 配置一次即可后台自动同步书签文件，无需手动导出。\n- 支持多浏览器、多设备自动保持书签一致。\n\n##### ✅ 空间充足，传输速度快\n\n- 免费版即提供 1GB 存储，书签数据占用极小。\n- 中国大陆服务器，上传/同步速度快、延迟低。\n\n##### ✅ 安全性强\n\n- 传输使用 HTTPS 加密。\n\n- 可为 Floccus 单独生成 **应用专用授权码**：\n\n  > 即便泄露也可随时吊销，确保主账户安全。\n\n------\n\n#### 🧩 第一步：注册坚果云并启用 WebDAV 功能\n\n1. 访问官网：https://www.jianguoyun.com\n2. 注册新账户（推荐使用邮箱）\n3. 登录后，进入「设置」页面 → 进入「**第三方应用管理**」\n4. 点击「添加应用」→ 输入名称（如：Floccus 书签同步）\n5. 系统生成一个「**应用专用授权码**」\n\n> ⚠️ 请妥善保存该授权码，稍后配置 WebDAV 时将用到\n\n------\n\n#### 🌐 第二步：获取 WebDAV 配置信息\n\n| 参数   | 内容                              |\n| ------ | --------------------------------- |\n| 地址   | `https://dav.jianguoyun.com/dav/` |\n| 用户名 | 你的坚果云注册邮箱                |\n| 密码   | 应用专用授权码（非登录密码）      |\n\n**注意！需要创建一个文件夹(如/Bookmarks)**\n\n------\n\n#### 🧩 第三步：在 Chrome 中配置 Floccus 插件\n\n1. 前往 [Github主页](https://github.com/floccusaddon/floccus) 或[软件官网](https://floccus.org/)安装 **Floccus** 插件\n\n2. 安装后点击插件图标 → 选择「**添加配置**」→ 选择「**WebDAV分享**」\n\n3. 填写以下信息：\n\n   | 项目       | 内容                                   |\n   | ---------- | -------------------------------------- |\n   | 服务器地址 | `https://dav.jianguoyun.com/dav/`      |\n   | 用户名     | 你的坚果云注册邮箱                     |\n   | 密码       | 应用专用授权码                         |\n   | 同步文件名 | `/Bookmarks/bookmarks.html` 或默认设置 |\n\n4. 设置同步频率\n\n5. 成功后，你可以在坚果云的 `/bookmarks/` 路径中看到同步生成的 bookmarks.html 文件\n\n------\n\n#### 💾 第四步：恢复或迁移书签数据\n\n1. 在新设备安装 Chrome 与 Floccus 插件\n2. 使用相同 WebDAV 信息创建同步账户\n3. 点击「Sync」按钮 → 即可从云端恢复书签数据\n4. **也可手动导入坚果云保存的bookmarks `.html` 文件**\n\n### 椒盐笔记\n\n- **本地备份**：已自动保存到手机`/Documents/SaltNote/`（确认路径无误）。\n- **云端备份**：\n  - 通过椒盐笔记的WebDAV功能备份到支持WebDAV的网盘（如坚果云、Nextcloud）。\n  - 或手动定期导出Markdown文件到云盘（如夸克/百度网盘）。\n\n\n\n#### 🧐 为什么选择坚果云作为备份平台？\n\n##### ✅ 完全支持 WebDAV 协议\n\n- 坚果云是国内极少数长期稳定支持 WebDAV 的云服务，兼容性好。\n- 与椒盐笔记等支持 WebDAV 的应用完美配合，几乎零配置可同步。\n\n##### ✅ 免费也够用\n\n- 免费账户提供 **1GB 空间**，Markdown 纯文本笔记占用极小。\n- 同步数据流量极低，基本可实现**长期免费使用**。\n\n##### ✅ 安全性高\n\n- 全程 HTTPS 加密传输，支持两步验证。\n\n- 支持每个应用生成独立的授权码：\n\n  > 泄露后可随时吊销，不影响主账户安全。\n\n##### ✅ 服务稳定、速度优秀\n\n- 拥有中国大陆服务器，同步速度快、延迟低。\n- 多年稳定运营，无大规模中断记录。\n\n##### ✅ 可拓展用途\n\n- 除椒盐笔记，还可用于：\n  - Obsidian、Joplin 等 WebDAV 应用\n  - FreeFileSync、rclone、Python 脚本工具等\n  - 批量同步文档、PDF、代码片段等轻量资料\n\n------\n\n#### 🧩 第一步：注册坚果云并启用 WebDAV 功能\n\n1. 访问官网：https://www.jianguoyun.com\n\n2. 点击「注册」，推荐使用邮箱注册账号\n\n3. 登录后，点击右上角头像 → 进入「设置」\n\n4. 打开「**第三方应用管理**」菜单\n\n5. 点击「添加应用」，输入自定义应用名（如：椒盐笔记备份）\n\n6. 系统生成一个「应用授权码」：\n\n   > **请复制并妥善保存**，稍后配置 WebDAV 会使用\n\n------\n\n#### 🌐 第二步：获取 WebDAV 配置信息\n\n- WebDAV 地址：`https://dav.jianguoyun.com/dav/`\n- 用户名：你的坚果云注册邮箱\n- 密码：上一步生成的「**应用授权码**」（**不是登录密码**）\n\n------\n\n#### 📱 第三步：在椒盐笔记中配置 WebDAV 自动同步\n\n1. 打开椒盐笔记（SaltNote）App\n\n2. 点击右上角齿轮图标，进入设置页面\n\n3. 选择「**WebDAV 同步**」\n\n4. 填写以下信息：\n\n   | 项目     | 内容                                          |\n   | -------- | --------------------------------------------- |\n   | 地址     | `https://dav.jianguoyun.com/dav/`             |\n   | 用户名   | 注册邮箱                                      |\n   | 密码     | 应用授权码                                    |\n   | 同步路径 | 推荐使用 `/saltnote/`，网盘中将自动创建此目录 |\n\n   \n\n5. 启用「自动同步」功能\n\n6. 第一次同步完成后，坚果云网页端将出现 `/saltnote/` 文件夹\n\n   > 内含 `.md` 文件与 PepperNote 设置数据，后续将持续自动更新\n\n------\n\n#### 💾 第四步：恢复笔记数据流程（换手机 / 重装 App）\n\n1. 在新设备上安装椒盐笔记 App\n\n2. 进入设置 → WebDAV 同步，填写相同信息（地址、邮箱、授权码、路径）\n\n3. 等待连接成功\n\n4. 点击「设置 → 备份与恢复 → 恢复备份」\n\n5. 稍候几秒，历史笔记将自动恢复\n\n   > 无需手动导入，云端会同步所有内容与配置\n\n### 文档素材（`E盘/F盘`分散文件夹）\n\n- **本地备份**：已存在原位置，考虑NAS。\n- **云端同步**：\n  - 夸克网盘：添加多个文件夹到同步列表（注意单个文件大小限制）。\n  - 天翼云盘？\n\n### 虚拟机（VMware）\n\n- **备份建议**：\n  - **方案1**：关闭VMware后，直接复制整个虚拟机文件夹（默认路径：`C:/Users/<用户名>/Documents/Virtual Machines/`），需包含`.vmx`（配置文件）和`.vmdk`（虚拟磁盘文件）。\n  - **方案2**：VMware自带“快照”功能（临时备份，占用空间大）。\n- **推荐**：每月一次完整备份+每周快照。\n\n### 密码管理器\n\n- **推荐工具**：\n  - **Bitwarden**（免费开源，支持WebDAV同步，加密备份到网盘）。\n  - **KeePassXC**（本地存储，数据库文件可同步到云盘）。\n- **迁移建议**：将微信收藏的密码整理到Bitwarden，启用自动填充功能。\n\n### 百度输入法词库\n\n- **暂缓**，但记录路径：\n  - Windows：`%APPDATA%\\Baidu\\BaiduPinyin\\UserData\\`（如`C:/Users/<用户名>/AppData/Roaming/Baidu/BaiduPinyin/UserData/`）。\n  - 备份时复制整个`UserData`文件夹。\n\n---\n\n## 自动化工具整合\n\n1. **FreeFileSync**（核心工具）：\n   - 配置任务：\n     - 同步`D:/Music/`→夸克网盘音乐文件夹。\n     - 同步`F:/Workspace/`（非Git子文件夹）→夸克网盘代码文件夹。\n     - 同步`E:/文档素材/`→夸克网盘文档文件夹。\n   - 设置定时任务（通过Windows任务计划程序每天触发）。\n\n2. **插件/脚本**：\n   - Chrome书签：\n   - 密码管理：迁移到Bitwarden并启用WebDAV同步。\n\n---\n\n### 🛠 自动化备份与脚本整合\n\n#### 🔄 自动化备份流程\n\n为了实现备份的“无人值守、自动执行”，以下是推荐的自动化流程与工具：\n\n##### ✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步\n\n1. 安装 FreeFileSync\n\n2. 新建“同步任务”（Batch Job），每个任务可指定如下内容：\n\n   - 源文件夹 → 目标文件夹（如 `F:/Workspace/` → `夸克同步文件夹/Workspace/`）\n   - 选择同步方式：**镜像同步（Mirror）** 或 **更新同步（Update）**\n   - 排除无关内容（如 `.git/`、临时文件夹、系统隐藏目录）\n   - 勾选：同步后发送通知 / 日志记录\n   - 保存为 `.ffs_batch` 文件\n\n3. 打开 Windows“任务计划程序”：\n\n   - 新建基本任务 → 设置触发时间（如“每天 9:00”）\n\n   - 动作选择“启动程序”，指向 FreeFileSync 的可执行文件，并附上参数：\n\n     ```\n     FreeFileSync.exe \"C:\\路径\\to\\sync_task.ffs_batch\"\n     ```\n\n4. 重复以上步骤，可对多个同步项目（音乐、代码、文档）设定不同计划任务。\n\n5. 可勾选“开机自启 + 错过任务立即执行”选项，保障离线时也不会丢同步任务。\n\n##### ✅ 可选增强工具：Rclone + 脚本\n\n- 对于不支持同步客户端的云平台（如坚果云 WebDAV），可使用 Rclone 工具进行自动同步：\n\n1. 下载并配置 Rclone：https://rclone.org/downloads/\n\n2. 执行配置命令：\n\n   ```\n   rclone config\n   ```\n\n   - 输入 `n` 新建配置 → 输入名称（如 `jianguo`）\n   - 类型选择 `WebDAV`\n   - 填入坚果云信息：地址、用户名（邮箱）、密码（应用授权码）\n\n3. 编写自动同步脚本 `saltnote_sync.bat`：\n\n   ```\n   @echo off\n   rclone sync \"C:\\Users\\你的用户名\\Documents\\SaltNote\" jianguo:/saltnote/ --update --copy-links --log-file=sync.log\n   ```\n\n4. 将脚本添加至“任务计划程序”，设定定时执行。\n\n5. 亦可设置为“系统启动时执行”。\n\n##### ✅ 脚本增强建议\n\n- 增加错误提示与日志保存功能（`--log-file`）\n\n- 可配合 Telegram Bot 或邮件推送异常信息（需额外脚本集成）\n\n- 添加网络检查逻辑，避免断网时执行失败：\n\n  ```\n  ping www.baidu.com -n 2\n  if errorlevel 1 exit\n  ```\n\n### ✅ 汇总：当前自动备份任务表（建议表格打印）\n\n| 类型        | 工具/平台               | 同步频率 | 同步方式          | 说明                        |\n| ----------- | ----------------------- | -------- | ----------------- | --------------------------- |\n| 音乐        | FreeFileSync + 夸克网盘 | 每日     | 本地 → 云端热备份 | 夸克客户端需保持后台运行    |\n| 代码仓库    | GitHub                  | 实时     | Git push/pull     | 含版本控制                  |\n| 代码文档    | FreeFileSync            | 每日     | 本地 → 夸克文件夹 | 非Git部分直接同步           |\n| 椒盐笔记    | WebDAV (坚果云)         | 实时     | App自动同步       | 基于 WebDAV，免脚本         |\n| 文档资料    | FreeFileSync            | 每日     | 多路径同步        | `E:/素材` → 夸克同步        |\n| QQ/微信备份 | 手动导出 → 云盘         | 每周     | Zip 压缩手动上传  | 可用计划任务自动移动 + 上传 |\n| 虚拟机镜像  | 手动拷贝                | 每月     | 拷贝整个目录      | `.vmx` + `.vmdk` 需完整     |\n\n### ✅ 后续可扩展方向\n\n1. ✅ 使用 Syncthing 实现跨设备局域网同步\n   - 将手机 / 平板与 PC 形成自动同步\n2. ✅ 部署本地 NAS + 易有云\n   - 使用手机访问 NAS 内容 + 做本地冷备份\n3. ✅ 定期生成恢复文档/索引清单\n   - 每月导出当前所有文件目录结构清单 `.tree`\n   - 生成存储路径快照，帮助恢复\n4. ✅ 加入异常提醒机制\n   - 如某路径三天无更新 → 通过 Telegram/邮件提醒\n   - 如某文件夹容量超过阈值 → 发出警报\n\n","source":"_posts/数据备份策略.md","raw":"---\ntitle: 数据备份策略\ndate: 2025-08-04 23:33:36\ncategories: 学习笔记\ntags: 技术\n---\n\n\n\n\n\n\n\n\n# 最终备份方案\n\n## 🧭 备份策略总览\n\n为了确保个人数据的**安全性、可恢复性与使用便捷性**，本方案制定如下总目标：\n\n### 🎯 目标原则\n\n1. ✅ **Free 优先 / 极力节省成本**\n   - 优先使用免费工具与服务（如夸克网盘、FreeFileSync、GitHub 私有仓库等）。\n   - 如遇容量/功能限制，可在关键场景下考虑“轻量付费”。\n2. 🧊🔥 **冷备份 + 热备份并存**\n   - **冷备份**（如外置硬盘、月度虚拟机镜像）：面向大规模恢复与长期留存。\n   - **热备份**（如夸克同步文件夹、WebDAV）：用于日常使用/误删恢复。\n3. ✌️ **双重备份**\n   - 所有重要数据均至少存在两份：本地一份 + 云端一份。\n   - 特别关键数据可建立“三重冗余”（如代码库、密码数据库）。\n4. 🔐 **安全、便携、实用**\n   - 所有备份路径可在新设备/系统中快速恢复（不依赖某一单一设备）。\n   - 敏感文件使用 `.gitignore` / 加密等方式保障隐私。\n   - 所用工具应支持主流系统（Windows/macOS/Linux/手机）。\n5. 🌀 **热备尽量做到“无感备份”，自动化脚本**\n   - 使用同步客户端（夸克、天翼）或脚本（FreeFileSync + 定时任务）实现定时自动化。\n   - 避免手动操作，提高容错率。\n6. 📖 **编写《恢复手册.md》**\n   - 文档中将详细记录：\n     - 所有数据来源位置（路径 / 网盘）\n     - 对应恢复方式与工具\n     - 账号密码管理器路径\n     - 依赖的插件/脚本清单\n   - 保证任何时候数据在 24 小时内可通过登录账户 + 同步脚本 + 手动恢复操作，实现完整数据还原。\n\n### 备份设备\n\n#### 本地\n\n- 手机\n- 电脑\n- 软路由\n- U盘\n\n#### 云端\n\n- 夸克网盘\n- 坚果云（免费轻量云端Webdav）\n- 谷歌相册\n- 一刻相册\n\n## 备份内容类别\n\n- 照片/视频\n- 影视\n- 音乐\n- 代码工作区\n- QQ/微信聊天记录\n- 浏览器书签\n- 椒盐笔记\n- 文档素材\n- 虚拟机\n- 密码管理器\n- 输入法词库\n\n\n\n### **照片/视频**\n\n- **云端**：Google Photos（免费原图备份，已启用）+ 一刻相册。\n- **本地**：暂缓，后续可考虑NAS+易有云。\n\n#### 🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？\n\n##### ✅ 1. Google Photos（谷歌相册）\n\n- 我已搭建软路由，家中设备默认处于“魔法环境”，**Google Photos 可实现无感自动同步**。\n\n- **优点**：\n  - **无限容量优势**：Google 官方承诺 **Pixel 1 机型享有永久、无损、无限量照片与视频备份**。\n  - **技术绕过可实现“伪Pixel”特权**：通过 Root 的手机设备 + Magisk 模块，可模拟为 Pixel 1，激活无限备份策略。\n  - **自动分类、搜索强大**：Google Photos 提供 **AI 智能识别、人脸聚合、地图定位、关键词搜索** 等强大功能，方便管理海量照片。\n- **缺点**：\n  - Google 在中国大陆无法直接访问，**必须依赖稳定 VPN 或旁路代理环境**。\n\n##### ✅ 2. 一刻相册（作为国产补充方案）\n\n- **优点**：\n  - 理论无限空间、界面友好。\n  - 适合中国用户使用。\n- **缺点**：\n  - 备份大视频、批量恢复需开通会员。\n  - 卡顿，使用体验并不好，自动备份实测耗电情况严重。\n\n##### ✅ 3. 本地备份（未来补充方案）\n\n- 本地方案，计划后续部署 **NAS + 易有云** 搭建家庭私有云，实现本地备份、快速访问和远程同步。\n- 配合 Google Photos 可形成「冷 + 热备份」组合，提高数据安全性和可恢复性。\n\n------\n\n### 🎬 影视\n\n#### ☁️ 云端备份策略\n\n- **115 网盘**（主力推荐）\n  - ✅ 稳定性高，上传/下载/播放速度极佳。\n  - ✅ 支持 WebDAV 协议，可被 Jellyfin、Infuse、nPlayer 等播放器远程挂载使用。\n  - ✅ 支持在线播放，大视频兼容性强。\n  - ⚠️ **需付费会员才能正常使用**，非会员限速严重，功能大幅受限。\n  - ⚠️ 分享功能有限制，建议搭配 AList 或其他工具使用。\n- **天翼云盘**（适合电信用户）\n  - ✅ **永久免费扩容活动多**（绑定手机号后空间可达 6TB+）。\n  - ✅ 上传/下载速度快，支持自动备份监控文件夹。\n  - ✅ 适合作为长期备份盘，配合自动化工具使用更佳。\n  - ⚠️ 播放器兼容性一般，不支持 WebDAV，适合作为存储盘而非播放源。\n- **移动云盘**（适合移动用户）\n  - ✅ 与天翼云盘类似，用户活跃度高时也有较大空间赠送。\n  - ✅ 上传/下载体验不错，适合作为副备份盘。\n  - ⚠️ 播放体验一般，不支持 WebDAV。\n- **夸克网盘**（次级推荐）\n  - ✅ 支持在线播放、AI字幕识别、自动分类等功能。\n  - ✅ 可通过淘宝88VIP（88元/年）获得夸克会员，**相当于“白嫖”会员体验**。\n  - ⚠️ 免费用户限速严重，长时间使用必须配合会员。\n  - ⚠️ 分享和下载频率受限，适合当临时备份盘。\n- **123 网盘**（备用方案）\n  - ✅ 上传/下载/在线播放体验优秀，客户端简洁无广告。\n  - ✅ 分享功能较开放，支持大文件外链。\n  - ✅ 官方有 Web API 支持，可接入 AList 或自建下载脚本。\n  - ⚠️ **无会员使用体验较差**，限速较严重，上传大文件基本不可行。\n  - ⚠️ 存储安全性有待考察，**适合短期转存或资源中转**。\n\n------\n\n#### 🧩 聚合播放方案：小雅 AList\n\n- AList 是聚合网盘的 Web 文件浏览器，可统一访问多个云盘资源。\n- 支持网盘包括：**阿里云盘、115、123、坚果云、天翼云盘（部分支持）、WebDAV、自建服务等**。\n- 可配置为 WebDAV 网关，与 Jellyfin、Infuse、Kodi、nPlayer 等播放器联动使用，实现局域网或远程无感播放。\n- 推荐搭配方案：\n  - 小雅 AList 公共节点（alist.xiaoya.pro）→ 挂载 115 / 123 网盘 → Infuse / nPlayer 播放器观看。\n  - 自建 AList 实例（Docker / 本地）+ Token 授权更安全稳定。\n\n------\n\n#### 🖥️ 本地方案规划：Jellyfin + NAS（后续）\n\n虽然当前未考虑，但未来部署仍具备价值，作为云端存储的**本地冷备+家庭影院**方案：\n\n- **Jellyfin**：免费开源媒体中心，自动整理影视资源，支持多平台客户端。\n- **NAS（当前为软路由）**：集中存储、远程访问、播放高清无压力。\n- **自动化工具搭配**：\n  - `rclone` 同步网盘内容至本地。\n  - `aria2 / qBittorrent` 搭建自动下载中心。\n  - AList + Jellyfin 构建本地 + 云端混合播放环境。\n\n------\n\n#### 📊 云盘对比汇总（影视适用性）\n\n| 云盘平台     | 是否限速           | 播放支持 | WebDAV 支持     | 是否需要会员       | 适合场景                    |\n| ------------ | ------------------ | -------- | --------------- | ------------------ | --------------------------- |\n| **115 网盘** | 免费限速，会员不限 | ✅ 强     | ✅（需配置）     | **需要付费**       | 主力备份 + 播放 + AList挂载 |\n| **天翼云盘** | 不限速             | 一般     | ❌               | **免费**           | 大容量备份（电信优选）      |\n| **移动云盘** | 不限速             | 一般     | ❌               | **免费**           | 大容量备份（移动用户）      |\n| **夸克网盘** | 免费限速，会员快   | ✅ 中等   | ❌               | **88VIP 白嫖会员** | 临时转存 / 播放             |\n| **123 网盘** | 免费限速，会员快   | ✅ 中等   | ⚠️（API 或绕过） | **基本需付费**     | 中转下载 / 资源分享         |\n\n\n\n------\n\n### 音乐\n\n**本地**：当前占用约10GB，统一存放于固定路径（`E:/音乐/`），冷备份至U盘及软路由存储中，确保本地多设备冗余。\n\n- **本地播放/管理方案**：采用 **Navidrome + NAS** 组合或 **Jellyfin + NAS**，搭建私人音乐服务器，实现跨设备在线播放、管理和元数据同步。\n  - **Navidrome**：轻量级音乐服务器，支持多用户、Web和手机客户端，兼容多种音频格式，适合个人或小团队使用。\n  - **Jellyfin**：功能更强大，支持多媒体统一管理（音乐、电影、电视），支持DLNA、Chromecast等多种播放协议，适合更丰富的多媒体需求。\n\n**云端同步**：\n\n- 夸克网盘：启用“同步文件夹”功能，将`D:/Music/`设为同步目录热备份（需确保夸克客户端常驻后台）。\n\n**歌单与播放列表管理**：\n\n- 使用 **歌单无界** 等工具，能有效匹配和同步歌单排序，实现云端与本地播放列表的无缝衔接，避免歌单乱序问题，提升听歌体验。\n\n#### 🧐 为什么选择夸克网盘作为音乐备份平台？\n\n##### ✅ 多平台支持，使用体验优秀\n\n- 支持 **Android / iOS / Web / Windows / Mac** 等主流平台。\n- 无论是手机、平板、电脑均可便捷访问、播放与下载音频文件。\n- 网页端支持50MB以内单文件下载，**无需额外客户端**。\n\n##### ✅ 存储空间充足，价格极低\n\n- 通过 **88VIP 赠送的夸克会员权益（价值5元一年）**，可获得至少 **6TB 超大云盘容量**。\n\n- 适合长期保存大量高质量无损音乐、专辑、母带文件。\n\n- **性价比极高**，几乎免费获得专业级云盘体验。\n\n##### ✅ 上传/下载速度优秀\n\n- 会员上传、下载稳定在 **50MB/s 以上**，支持单文件最大100GB上传。\n- 支持断点续传，保障长时间上传的稳定性。\n\n##### ✅ 原文件存储，不转码不压缩\n\n- 音频文件 **不会被转码或重命名**，保留完整元数据。\n- 适合储存音乐资料库、专辑封面、歌词、Cue 文件等文件结构较复杂的音乐归档。\n\n##### ✅ 文件结构清晰，支持批量管理\n\n- 支持自定义目录层级，如 `音乐归档/无损合集/年代/艺术家/`，便于分类和查找。\n- PC客户端支持拖拽和批量上传，简化管理流程。\n- 支持文件重命名规则插件，保持命名规范。\n\n##### ✅ 分享与恢复便捷\n\n- 支持生成带有效期的分享链接，方便与朋友共享音乐。\n- 设备更换或损坏后，登录账号即可无缝恢复全库，免除手动迁移烦恼。\n\n------\n\n### 代码工作区（`F:/Workspace/`）\n\n#### 本地备份\n\n##### 当前状态\n\n- 主要代码工作区位于F盘本地磁盘。\n\n##### 未来规划\n\n- 计划部署 **NAS 设备**，实现自动定时快照和备份。\n- NAS结合版本控制或增量备份方案，可大幅提升数据安全性和多设备访问便利。\n\n#### 云端同步\n\n##### Git + GitHub 私有仓库（适合核心代码版本控制）\n\n###### 注册与创建仓库\n\n- 注册GitHub账号（https://github.com/）。\n- 创建私有仓库（例如 `my-workspace`）。\n- **创建时避免勾选“Initialize with README”**，防止初始化文件与本地冲突。\n\n###### 初始化本地仓库并关联远程\n\n- 在目标项目目录（如`F:/Workspace/project1/`）打开 **Git Bash Here**，依次执行：\n\n  ```bash\n  git init\n  git remote add origin https://github.com/你的用户名/my-workspace.git\n  git add .\n  git commit -m \"Initial commit\"\n  git push -u origin main\n  ```\n\n###### 日常更新流程\n\n- 每次代码修改完成后，执行：\n\n  ```bash\n  git add .\n  git commit -m \"简短描述本次修改\"\n  git push\n  ```\n\n###### 多设备恢复\n\n- 在新设备或工作环境，执行克隆操作：\n\n  ```bash\n  git clone https://github.com/你的用户名/my-workspace.git\n  ```\n\n###### 建议辅助工具\n\n- 推荐使用 VSCode 等支持Git的编辑器，内置Git插件使操作更直观便捷。\n\n###### 注意事项\n\n- 避免提交大文件或敏感信息。\n- 可通过 `.gitignore` 文件排除不需要同步的文件。\n\n##### 夸克网盘（适合非版本控制的备份）\n\n###### 适用范围\n\n- 备份无需版本控制的代码副本、资料文件、配置文件或二进制资源。\n\n###### 备份方法\n\n- 在夸克网盘创建同步文件夹（如 `Workspace_Backup`）。\n- 将本地目录 `F:/Workspace/` 拖入同步文件夹，实现自动热备份。\n- 保证夸克客户端常驻后台以确保同步稳定及时。\n\n#### 补充建议\n\n##### 自动备份脚本\n\n- 可编写定时任务脚本，自动复制代码工作区至NAS或备份目录。\n- 结合增量备份工具，如Linux的 `rsync`，Windows下推荐使用 `DeltaCopy`，提高备份效率。\n\n##### 多版本备份策略\n\n- 利用Git的版本管理优势管理代码历史。\n- 结合NAS快照功能，实现数据误删、误覆盖的快速恢复。\n\n##### 安全性建议\n\n- 私有仓库不宜存储明文密码或敏感密钥。\n- 建议使用环境变量或专门的安全管理工具处理敏感信息。\n\n------\n\n### QQ/微信聊天记录\n\n#### 手机 → 电脑备份\n\n##### 微信备份\n\n- 通过电脑版微信“备份与恢复”功能，连接手机和电脑，选择“备份聊天记录至电脑”操作（需同一局域网）。\n- 可备份聊天文本、图片、语音等内容，需手动操作。\n\n##### QQ备份\n\n- 进入手机QQ“设置 → 通用 → 聊天记录备份与恢复”，选择“备份聊天记录到电脑QQ”，手机与电脑需联网且在同一网络。\n\n#### 电脑 → 本地存储\n\n##### 默认存储路径\n\n- 微信聊天记录路径为：\n   `C:/Users/<用户名>/Documents/WeChat Files/<微信号>/`\n- QQ聊天记录路径为：\n   `C:/Users/<用户名>/Documents/Tencent Files/<QQ号>/`\n\n##### 备份文件管理\n\n- 建议定期将聊天记录目录压缩成 `DataBackup.zip` 方便管理和迁移。\n- 压缩包可存储于U盘、NAS或上传至云盘（如夸克网盘）实现多重备份。\n\n#### Root手机完整备份（推荐第三方工具“数据备份”）\n\n##### 为什么推荐“数据备份”\n\n- 经多次测试，手机官方微信和QQ备份功能**容易遗漏大量图片和视频**，导致备份不完整。\n- “数据备份”作为Root权限工具，能**完整导出所有QQ和微信数据**，包括聊天记录、图片、视频、数据库和缓存文件。\n\n##### 备份流程\n\n- 在Root的手机设备上运行“数据备份”软件，进行完整数据导出。\n- 备份数据压缩成 `DataBackup.zip` 文件，方便保存与传输。\n- 上传压缩文件到夸克网盘或其他云盘，实现安全、长期存储。\n\n##### 优势说明\n\n- 该备份方式全面且数据完整，适合设备更换、系统重装时恢复使用。\n- 极大减少因官方备份功能不足造成的数据丢失风险。\n\n#### 自动化备份建议\n\n##### Windows定时压缩\n\n- 利用任务计划结合批处理脚本，定期压缩本地聊天记录文件夹，减轻手动备份负担。\n\n##### 多层备份架构\n\n- 结合软路由与NAS，定期同步聊天数据，实现本地与网络的多层冗余备份。\n\n#### 安全与隐私\n\n##### 数据加密\n\n- 聊天记录包含个人隐私，建议使用7-Zip等工具对压缩包设置密码保护。\n\n##### 云盘权限控制\n\n- 上传云盘后，务必设置访问权限，避免数据泄露风险。\n\n##### Root权限风险\n\n- Root操作存在一定风险，务必保证备份工具来源正规可靠。\n\n#### 恢复方法\n\n##### 官方恢复途径\n\n- 电脑版微信和QQ支持“备份与恢复”功能，可恢复聊天记录（需确保备份文件完整且版本匹配）。\n\n##### Root备份恢复\n\n- 需借助相应的手机恢复工具，将完整备份数据导入手机，恢复聊天内容、图片和视频。\n\n##### 手动恢复\n\n- 关闭对应客户端后，手动复制聊天记录文件夹到原路径，实现基础数据恢复。\n\n------\n\n### 浏览器书签（Chrome）\n\n- **本地备份**：可通过 Chrome 自带的导出功能，定期导出为 `.html` 文件保存到本地。\n- **云端同步**：\n  - 使用 **Floccus 浏览器插件**，配置 WebDAV（推荐坚果云）后，可实现自动同步浏览器书签到云端。\n  - 也可手动导出书签 `.html` 文件，存入夸克网盘等云服务。\n\n------\n\n#### 🧐 为什么选择坚果云作为同步平台？\n\n##### ✅ 完全支持 WebDAV 协议\n\n- 坚果云提供长期稳定的 WebDAV 接口。\n- 与 Floccus 等插件完美兼容，无需额外脚本或服务端配置。\n\n##### ✅ 安装简便、自动同步\n\n- 配置一次即可后台自动同步书签文件，无需手动导出。\n- 支持多浏览器、多设备自动保持书签一致。\n\n##### ✅ 空间充足，传输速度快\n\n- 免费版即提供 1GB 存储，书签数据占用极小。\n- 中国大陆服务器，上传/同步速度快、延迟低。\n\n##### ✅ 安全性强\n\n- 传输使用 HTTPS 加密。\n\n- 可为 Floccus 单独生成 **应用专用授权码**：\n\n  > 即便泄露也可随时吊销，确保主账户安全。\n\n------\n\n#### 🧩 第一步：注册坚果云并启用 WebDAV 功能\n\n1. 访问官网：https://www.jianguoyun.com\n2. 注册新账户（推荐使用邮箱）\n3. 登录后，进入「设置」页面 → 进入「**第三方应用管理**」\n4. 点击「添加应用」→ 输入名称（如：Floccus 书签同步）\n5. 系统生成一个「**应用专用授权码**」\n\n> ⚠️ 请妥善保存该授权码，稍后配置 WebDAV 时将用到\n\n------\n\n#### 🌐 第二步：获取 WebDAV 配置信息\n\n| 参数   | 内容                              |\n| ------ | --------------------------------- |\n| 地址   | `https://dav.jianguoyun.com/dav/` |\n| 用户名 | 你的坚果云注册邮箱                |\n| 密码   | 应用专用授权码（非登录密码）      |\n\n**注意！需要创建一个文件夹(如/Bookmarks)**\n\n------\n\n#### 🧩 第三步：在 Chrome 中配置 Floccus 插件\n\n1. 前往 [Github主页](https://github.com/floccusaddon/floccus) 或[软件官网](https://floccus.org/)安装 **Floccus** 插件\n\n2. 安装后点击插件图标 → 选择「**添加配置**」→ 选择「**WebDAV分享**」\n\n3. 填写以下信息：\n\n   | 项目       | 内容                                   |\n   | ---------- | -------------------------------------- |\n   | 服务器地址 | `https://dav.jianguoyun.com/dav/`      |\n   | 用户名     | 你的坚果云注册邮箱                     |\n   | 密码       | 应用专用授权码                         |\n   | 同步文件名 | `/Bookmarks/bookmarks.html` 或默认设置 |\n\n4. 设置同步频率\n\n5. 成功后，你可以在坚果云的 `/bookmarks/` 路径中看到同步生成的 bookmarks.html 文件\n\n------\n\n#### 💾 第四步：恢复或迁移书签数据\n\n1. 在新设备安装 Chrome 与 Floccus 插件\n2. 使用相同 WebDAV 信息创建同步账户\n3. 点击「Sync」按钮 → 即可从云端恢复书签数据\n4. **也可手动导入坚果云保存的bookmarks `.html` 文件**\n\n### 椒盐笔记\n\n- **本地备份**：已自动保存到手机`/Documents/SaltNote/`（确认路径无误）。\n- **云端备份**：\n  - 通过椒盐笔记的WebDAV功能备份到支持WebDAV的网盘（如坚果云、Nextcloud）。\n  - 或手动定期导出Markdown文件到云盘（如夸克/百度网盘）。\n\n\n\n#### 🧐 为什么选择坚果云作为备份平台？\n\n##### ✅ 完全支持 WebDAV 协议\n\n- 坚果云是国内极少数长期稳定支持 WebDAV 的云服务，兼容性好。\n- 与椒盐笔记等支持 WebDAV 的应用完美配合，几乎零配置可同步。\n\n##### ✅ 免费也够用\n\n- 免费账户提供 **1GB 空间**，Markdown 纯文本笔记占用极小。\n- 同步数据流量极低，基本可实现**长期免费使用**。\n\n##### ✅ 安全性高\n\n- 全程 HTTPS 加密传输，支持两步验证。\n\n- 支持每个应用生成独立的授权码：\n\n  > 泄露后可随时吊销，不影响主账户安全。\n\n##### ✅ 服务稳定、速度优秀\n\n- 拥有中国大陆服务器，同步速度快、延迟低。\n- 多年稳定运营，无大规模中断记录。\n\n##### ✅ 可拓展用途\n\n- 除椒盐笔记，还可用于：\n  - Obsidian、Joplin 等 WebDAV 应用\n  - FreeFileSync、rclone、Python 脚本工具等\n  - 批量同步文档、PDF、代码片段等轻量资料\n\n------\n\n#### 🧩 第一步：注册坚果云并启用 WebDAV 功能\n\n1. 访问官网：https://www.jianguoyun.com\n\n2. 点击「注册」，推荐使用邮箱注册账号\n\n3. 登录后，点击右上角头像 → 进入「设置」\n\n4. 打开「**第三方应用管理**」菜单\n\n5. 点击「添加应用」，输入自定义应用名（如：椒盐笔记备份）\n\n6. 系统生成一个「应用授权码」：\n\n   > **请复制并妥善保存**，稍后配置 WebDAV 会使用\n\n------\n\n#### 🌐 第二步：获取 WebDAV 配置信息\n\n- WebDAV 地址：`https://dav.jianguoyun.com/dav/`\n- 用户名：你的坚果云注册邮箱\n- 密码：上一步生成的「**应用授权码**」（**不是登录密码**）\n\n------\n\n#### 📱 第三步：在椒盐笔记中配置 WebDAV 自动同步\n\n1. 打开椒盐笔记（SaltNote）App\n\n2. 点击右上角齿轮图标，进入设置页面\n\n3. 选择「**WebDAV 同步**」\n\n4. 填写以下信息：\n\n   | 项目     | 内容                                          |\n   | -------- | --------------------------------------------- |\n   | 地址     | `https://dav.jianguoyun.com/dav/`             |\n   | 用户名   | 注册邮箱                                      |\n   | 密码     | 应用授权码                                    |\n   | 同步路径 | 推荐使用 `/saltnote/`，网盘中将自动创建此目录 |\n\n   \n\n5. 启用「自动同步」功能\n\n6. 第一次同步完成后，坚果云网页端将出现 `/saltnote/` 文件夹\n\n   > 内含 `.md` 文件与 PepperNote 设置数据，后续将持续自动更新\n\n------\n\n#### 💾 第四步：恢复笔记数据流程（换手机 / 重装 App）\n\n1. 在新设备上安装椒盐笔记 App\n\n2. 进入设置 → WebDAV 同步，填写相同信息（地址、邮箱、授权码、路径）\n\n3. 等待连接成功\n\n4. 点击「设置 → 备份与恢复 → 恢复备份」\n\n5. 稍候几秒，历史笔记将自动恢复\n\n   > 无需手动导入，云端会同步所有内容与配置\n\n### 文档素材（`E盘/F盘`分散文件夹）\n\n- **本地备份**：已存在原位置，考虑NAS。\n- **云端同步**：\n  - 夸克网盘：添加多个文件夹到同步列表（注意单个文件大小限制）。\n  - 天翼云盘？\n\n### 虚拟机（VMware）\n\n- **备份建议**：\n  - **方案1**：关闭VMware后，直接复制整个虚拟机文件夹（默认路径：`C:/Users/<用户名>/Documents/Virtual Machines/`），需包含`.vmx`（配置文件）和`.vmdk`（虚拟磁盘文件）。\n  - **方案2**：VMware自带“快照”功能（临时备份，占用空间大）。\n- **推荐**：每月一次完整备份+每周快照。\n\n### 密码管理器\n\n- **推荐工具**：\n  - **Bitwarden**（免费开源，支持WebDAV同步，加密备份到网盘）。\n  - **KeePassXC**（本地存储，数据库文件可同步到云盘）。\n- **迁移建议**：将微信收藏的密码整理到Bitwarden，启用自动填充功能。\n\n### 百度输入法词库\n\n- **暂缓**，但记录路径：\n  - Windows：`%APPDATA%\\Baidu\\BaiduPinyin\\UserData\\`（如`C:/Users/<用户名>/AppData/Roaming/Baidu/BaiduPinyin/UserData/`）。\n  - 备份时复制整个`UserData`文件夹。\n\n---\n\n## 自动化工具整合\n\n1. **FreeFileSync**（核心工具）：\n   - 配置任务：\n     - 同步`D:/Music/`→夸克网盘音乐文件夹。\n     - 同步`F:/Workspace/`（非Git子文件夹）→夸克网盘代码文件夹。\n     - 同步`E:/文档素材/`→夸克网盘文档文件夹。\n   - 设置定时任务（通过Windows任务计划程序每天触发）。\n\n2. **插件/脚本**：\n   - Chrome书签：\n   - 密码管理：迁移到Bitwarden并启用WebDAV同步。\n\n---\n\n### 🛠 自动化备份与脚本整合\n\n#### 🔄 自动化备份流程\n\n为了实现备份的“无人值守、自动执行”，以下是推荐的自动化流程与工具：\n\n##### ✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步\n\n1. 安装 FreeFileSync\n\n2. 新建“同步任务”（Batch Job），每个任务可指定如下内容：\n\n   - 源文件夹 → 目标文件夹（如 `F:/Workspace/` → `夸克同步文件夹/Workspace/`）\n   - 选择同步方式：**镜像同步（Mirror）** 或 **更新同步（Update）**\n   - 排除无关内容（如 `.git/`、临时文件夹、系统隐藏目录）\n   - 勾选：同步后发送通知 / 日志记录\n   - 保存为 `.ffs_batch` 文件\n\n3. 打开 Windows“任务计划程序”：\n\n   - 新建基本任务 → 设置触发时间（如“每天 9:00”）\n\n   - 动作选择“启动程序”，指向 FreeFileSync 的可执行文件，并附上参数：\n\n     ```\n     FreeFileSync.exe \"C:\\路径\\to\\sync_task.ffs_batch\"\n     ```\n\n4. 重复以上步骤，可对多个同步项目（音乐、代码、文档）设定不同计划任务。\n\n5. 可勾选“开机自启 + 错过任务立即执行”选项，保障离线时也不会丢同步任务。\n\n##### ✅ 可选增强工具：Rclone + 脚本\n\n- 对于不支持同步客户端的云平台（如坚果云 WebDAV），可使用 Rclone 工具进行自动同步：\n\n1. 下载并配置 Rclone：https://rclone.org/downloads/\n\n2. 执行配置命令：\n\n   ```\n   rclone config\n   ```\n\n   - 输入 `n` 新建配置 → 输入名称（如 `jianguo`）\n   - 类型选择 `WebDAV`\n   - 填入坚果云信息：地址、用户名（邮箱）、密码（应用授权码）\n\n3. 编写自动同步脚本 `saltnote_sync.bat`：\n\n   ```\n   @echo off\n   rclone sync \"C:\\Users\\你的用户名\\Documents\\SaltNote\" jianguo:/saltnote/ --update --copy-links --log-file=sync.log\n   ```\n\n4. 将脚本添加至“任务计划程序”，设定定时执行。\n\n5. 亦可设置为“系统启动时执行”。\n\n##### ✅ 脚本增强建议\n\n- 增加错误提示与日志保存功能（`--log-file`）\n\n- 可配合 Telegram Bot 或邮件推送异常信息（需额外脚本集成）\n\n- 添加网络检查逻辑，避免断网时执行失败：\n\n  ```\n  ping www.baidu.com -n 2\n  if errorlevel 1 exit\n  ```\n\n### ✅ 汇总：当前自动备份任务表（建议表格打印）\n\n| 类型        | 工具/平台               | 同步频率 | 同步方式          | 说明                        |\n| ----------- | ----------------------- | -------- | ----------------- | --------------------------- |\n| 音乐        | FreeFileSync + 夸克网盘 | 每日     | 本地 → 云端热备份 | 夸克客户端需保持后台运行    |\n| 代码仓库    | GitHub                  | 实时     | Git push/pull     | 含版本控制                  |\n| 代码文档    | FreeFileSync            | 每日     | 本地 → 夸克文件夹 | 非Git部分直接同步           |\n| 椒盐笔记    | WebDAV (坚果云)         | 实时     | App自动同步       | 基于 WebDAV，免脚本         |\n| 文档资料    | FreeFileSync            | 每日     | 多路径同步        | `E:/素材` → 夸克同步        |\n| QQ/微信备份 | 手动导出 → 云盘         | 每周     | Zip 压缩手动上传  | 可用计划任务自动移动 + 上传 |\n| 虚拟机镜像  | 手动拷贝                | 每月     | 拷贝整个目录      | `.vmx` + `.vmdk` 需完整     |\n\n### ✅ 后续可扩展方向\n\n1. ✅ 使用 Syncthing 实现跨设备局域网同步\n   - 将手机 / 平板与 PC 形成自动同步\n2. ✅ 部署本地 NAS + 易有云\n   - 使用手机访问 NAS 内容 + 做本地冷备份\n3. ✅ 定期生成恢复文档/索引清单\n   - 每月导出当前所有文件目录结构清单 `.tree`\n   - 生成存储路径快照，帮助恢复\n4. ✅ 加入异常提醒机制\n   - 如某路径三天无更新 → 通过 Telegram/邮件提醒\n   - 如某文件夹容量超过阈值 → 发出警报\n\n","slug":"数据备份策略","published":1,"updated":"2025-10-17T03:24:38.156Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivn000524j37nt6ep1s","content":"<h1 id=\"最终备份方案\"><a href=\"#最终备份方案\" class=\"headerlink\" title=\"最终备份方案\"></a>最终备份方案</h1><h2 id=\"🧭-备份策略总览\"><a href=\"#🧭-备份策略总览\" class=\"headerlink\" title=\"🧭 备份策略总览\"></a>🧭 备份策略总览</h2><p>为了确保个人数据的<strong>安全性、可恢复性与使用便捷性</strong>，本方案制定如下总目标：</p>\n<h3 id=\"🎯-目标原则\"><a href=\"#🎯-目标原则\" class=\"headerlink\" title=\"🎯 目标原则\"></a>🎯 目标原则</h3><ol>\n<li>✅ <strong>Free 优先 &#x2F; 极力节省成本</strong><ul>\n<li>优先使用免费工具与服务（如夸克网盘、FreeFileSync、GitHub 私有仓库等）。</li>\n<li>如遇容量&#x2F;功能限制，可在关键场景下考虑“轻量付费”。</li>\n</ul>\n</li>\n<li>🧊🔥 <strong>冷备份 + 热备份并存</strong><ul>\n<li><strong>冷备份</strong>（如外置硬盘、月度虚拟机镜像）：面向大规模恢复与长期留存。</li>\n<li><strong>热备份</strong>（如夸克同步文件夹、WebDAV）：用于日常使用&#x2F;误删恢复。</li>\n</ul>\n</li>\n<li>✌️ <strong>双重备份</strong><ul>\n<li>所有重要数据均至少存在两份：本地一份 + 云端一份。</li>\n<li>特别关键数据可建立“三重冗余”（如代码库、密码数据库）。</li>\n</ul>\n</li>\n<li>🔐 <strong>安全、便携、实用</strong><ul>\n<li>所有备份路径可在新设备&#x2F;系统中快速恢复（不依赖某一单一设备）。</li>\n<li>敏感文件使用 <code>.gitignore</code> &#x2F; 加密等方式保障隐私。</li>\n<li>所用工具应支持主流系统（Windows&#x2F;macOS&#x2F;Linux&#x2F;手机）。</li>\n</ul>\n</li>\n<li>🌀 <strong>热备尽量做到“无感备份”，自动化脚本</strong><ul>\n<li>使用同步客户端（夸克、天翼）或脚本（FreeFileSync + 定时任务）实现定时自动化。</li>\n<li>避免手动操作，提高容错率。</li>\n</ul>\n</li>\n<li>📖 <strong>编写《恢复手册.md》</strong><ul>\n<li>文档中将详细记录：<ul>\n<li>所有数据来源位置（路径 &#x2F; 网盘）</li>\n<li>对应恢复方式与工具</li>\n<li>账号密码管理器路径</li>\n<li>依赖的插件&#x2F;脚本清单</li>\n</ul>\n</li>\n<li>保证任何时候数据在 24 小时内可通过登录账户 + 同步脚本 + 手动恢复操作，实现完整数据还原。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"备份设备\"><a href=\"#备份设备\" class=\"headerlink\" title=\"备份设备\"></a>备份设备</h3><h4 id=\"本地\"><a href=\"#本地\" class=\"headerlink\" title=\"本地\"></a>本地</h4><ul>\n<li>手机</li>\n<li>电脑</li>\n<li>软路由</li>\n<li>U盘</li>\n</ul>\n<h4 id=\"云端\"><a href=\"#云端\" class=\"headerlink\" title=\"云端\"></a>云端</h4><ul>\n<li>夸克网盘</li>\n<li>坚果云（免费轻量云端Webdav）</li>\n<li>谷歌相册</li>\n<li>一刻相册</li>\n</ul>\n<h2 id=\"备份内容类别\"><a href=\"#备份内容类别\" class=\"headerlink\" title=\"备份内容类别\"></a>备份内容类别</h2><ul>\n<li>照片&#x2F;视频</li>\n<li>影视</li>\n<li>音乐</li>\n<li>代码工作区</li>\n<li>QQ&#x2F;微信聊天记录</li>\n<li>浏览器书签</li>\n<li>椒盐笔记</li>\n<li>文档素材</li>\n<li>虚拟机</li>\n<li>密码管理器</li>\n<li>输入法词库</li>\n</ul>\n<h3 id=\"照片-视频\"><a href=\"#照片-视频\" class=\"headerlink\" title=\"照片&#x2F;视频\"></a><strong>照片&#x2F;视频</strong></h3><ul>\n<li><strong>云端</strong>：Google Photos（免费原图备份，已启用）+ 一刻相册。</li>\n<li><strong>本地</strong>：暂缓，后续可考虑NAS+易有云。</li>\n</ul>\n<h4 id=\"🧐-为什么选择-Google-Photos-一刻相册作为主力云端备份方案？\"><a href=\"#🧐-为什么选择-Google-Photos-一刻相册作为主力云端备份方案？\" class=\"headerlink\" title=\"🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？\"></a>🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？</h4><h5 id=\"✅-1-Google-Photos（谷歌相册）\"><a href=\"#✅-1-Google-Photos（谷歌相册）\" class=\"headerlink\" title=\"✅ 1. Google Photos（谷歌相册）\"></a>✅ 1. Google Photos（谷歌相册）</h5><ul>\n<li><p>我已搭建软路由，家中设备默认处于“魔法环境”，<strong>Google Photos 可实现无感自动同步</strong>。</p>\n</li>\n<li><p><strong>优点</strong>：</p>\n<ul>\n<li><strong>无限容量优势</strong>：Google 官方承诺 <strong>Pixel 1 机型享有永久、无损、无限量照片与视频备份</strong>。</li>\n<li><strong>技术绕过可实现“伪Pixel”特权</strong>：通过 Root 的手机设备 + Magisk 模块，可模拟为 Pixel 1，激活无限备份策略。</li>\n<li><strong>自动分类、搜索强大</strong>：Google Photos 提供 <strong>AI 智能识别、人脸聚合、地图定位、关键词搜索</strong> 等强大功能，方便管理海量照片。</li>\n</ul>\n</li>\n<li><p><strong>缺点</strong>：</p>\n<ul>\n<li>Google 在中国大陆无法直接访问，<strong>必须依赖稳定 VPN 或旁路代理环境</strong>。</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"✅-2-一刻相册（作为国产补充方案）\"><a href=\"#✅-2-一刻相册（作为国产补充方案）\" class=\"headerlink\" title=\"✅ 2. 一刻相册（作为国产补充方案）\"></a>✅ 2. 一刻相册（作为国产补充方案）</h5><ul>\n<li><strong>优点</strong>：<ul>\n<li>理论无限空间、界面友好。</li>\n<li>适合中国用户使用。</li>\n</ul>\n</li>\n<li><strong>缺点</strong>：<ul>\n<li>备份大视频、批量恢复需开通会员。</li>\n<li>卡顿，使用体验并不好，自动备份实测耗电情况严重。</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"✅-3-本地备份（未来补充方案）\"><a href=\"#✅-3-本地备份（未来补充方案）\" class=\"headerlink\" title=\"✅ 3. 本地备份（未来补充方案）\"></a>✅ 3. 本地备份（未来补充方案）</h5><ul>\n<li>本地方案，计划后续部署 <strong>NAS + 易有云</strong> 搭建家庭私有云，实现本地备份、快速访问和远程同步。</li>\n<li>配合 Google Photos 可形成「冷 + 热备份」组合，提高数据安全性和可恢复性。</li>\n</ul>\n<hr>\n<h3 id=\"🎬-影视\"><a href=\"#🎬-影视\" class=\"headerlink\" title=\"🎬 影视\"></a>🎬 影视</h3><h4 id=\"☁️-云端备份策略\"><a href=\"#☁️-云端备份策略\" class=\"headerlink\" title=\"☁️ 云端备份策略\"></a>☁️ 云端备份策略</h4><ul>\n<li><strong>115 网盘</strong>（主力推荐）<ul>\n<li>✅ 稳定性高，上传&#x2F;下载&#x2F;播放速度极佳。</li>\n<li>✅ 支持 WebDAV 协议，可被 Jellyfin、Infuse、nPlayer 等播放器远程挂载使用。</li>\n<li>✅ 支持在线播放，大视频兼容性强。</li>\n<li>⚠️ <strong>需付费会员才能正常使用</strong>，非会员限速严重，功能大幅受限。</li>\n<li>⚠️ 分享功能有限制，建议搭配 AList 或其他工具使用。</li>\n</ul>\n</li>\n<li><strong>天翼云盘</strong>（适合电信用户）<ul>\n<li>✅ <strong>永久免费扩容活动多</strong>（绑定手机号后空间可达 6TB+）。</li>\n<li>✅ 上传&#x2F;下载速度快，支持自动备份监控文件夹。</li>\n<li>✅ 适合作为长期备份盘，配合自动化工具使用更佳。</li>\n<li>⚠️ 播放器兼容性一般，不支持 WebDAV，适合作为存储盘而非播放源。</li>\n</ul>\n</li>\n<li><strong>移动云盘</strong>（适合移动用户）<ul>\n<li>✅ 与天翼云盘类似，用户活跃度高时也有较大空间赠送。</li>\n<li>✅ 上传&#x2F;下载体验不错，适合作为副备份盘。</li>\n<li>⚠️ 播放体验一般，不支持 WebDAV。</li>\n</ul>\n</li>\n<li><strong>夸克网盘</strong>（次级推荐）<ul>\n<li>✅ 支持在线播放、AI字幕识别、自动分类等功能。</li>\n<li>✅ 可通过淘宝88VIP（88元&#x2F;年）获得夸克会员，<strong>相当于“白嫖”会员体验</strong>。</li>\n<li>⚠️ 免费用户限速严重，长时间使用必须配合会员。</li>\n<li>⚠️ 分享和下载频率受限，适合当临时备份盘。</li>\n</ul>\n</li>\n<li><strong>123 网盘</strong>（备用方案）<ul>\n<li>✅ 上传&#x2F;下载&#x2F;在线播放体验优秀，客户端简洁无广告。</li>\n<li>✅ 分享功能较开放，支持大文件外链。</li>\n<li>✅ 官方有 Web API 支持，可接入 AList 或自建下载脚本。</li>\n<li>⚠️ <strong>无会员使用体验较差</strong>，限速较严重，上传大文件基本不可行。</li>\n<li>⚠️ 存储安全性有待考察，<strong>适合短期转存或资源中转</strong>。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-聚合播放方案：小雅-AList\"><a href=\"#🧩-聚合播放方案：小雅-AList\" class=\"headerlink\" title=\"🧩 聚合播放方案：小雅 AList\"></a>🧩 聚合播放方案：小雅 AList</h4><ul>\n<li>AList 是聚合网盘的 Web 文件浏览器，可统一访问多个云盘资源。</li>\n<li>支持网盘包括：<strong>阿里云盘、115、123、坚果云、天翼云盘（部分支持）、WebDAV、自建服务等</strong>。</li>\n<li>可配置为 WebDAV 网关，与 Jellyfin、Infuse、Kodi、nPlayer 等播放器联动使用，实现局域网或远程无感播放。</li>\n<li>推荐搭配方案：<ul>\n<li>小雅 AList 公共节点（alist.xiaoya.pro）→ 挂载 115 &#x2F; 123 网盘 → Infuse &#x2F; nPlayer 播放器观看。</li>\n<li>自建 AList 实例（Docker &#x2F; 本地）+ Token 授权更安全稳定。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🖥️-本地方案规划：Jellyfin-NAS（后续）\"><a href=\"#🖥️-本地方案规划：Jellyfin-NAS（后续）\" class=\"headerlink\" title=\"🖥️ 本地方案规划：Jellyfin + NAS（后续）\"></a>🖥️ 本地方案规划：Jellyfin + NAS（后续）</h4><p>虽然当前未考虑，但未来部署仍具备价值，作为云端存储的<strong>本地冷备+家庭影院</strong>方案：</p>\n<ul>\n<li><strong>Jellyfin</strong>：免费开源媒体中心，自动整理影视资源，支持多平台客户端。</li>\n<li><strong>NAS（当前为软路由）</strong>：集中存储、远程访问、播放高清无压力。</li>\n<li><strong>自动化工具搭配</strong>：<ul>\n<li><code>rclone</code> 同步网盘内容至本地。</li>\n<li><code>aria2 / qBittorrent</code> 搭建自动下载中心。</li>\n<li>AList + Jellyfin 构建本地 + 云端混合播放环境。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"📊-云盘对比汇总（影视适用性）\"><a href=\"#📊-云盘对比汇总（影视适用性）\" class=\"headerlink\" title=\"📊 云盘对比汇总（影视适用性）\"></a>📊 云盘对比汇总（影视适用性）</h4><table>\n<thead>\n<tr>\n<th>云盘平台</th>\n<th>是否限速</th>\n<th>播放支持</th>\n<th>WebDAV 支持</th>\n<th>是否需要会员</th>\n<th>适合场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>115 网盘</strong></td>\n<td>免费限速，会员不限</td>\n<td>✅ 强</td>\n<td>✅（需配置）</td>\n<td><strong>需要付费</strong></td>\n<td>主力备份 + 播放 + AList挂载</td>\n</tr>\n<tr>\n<td><strong>天翼云盘</strong></td>\n<td>不限速</td>\n<td>一般</td>\n<td>❌</td>\n<td><strong>免费</strong></td>\n<td>大容量备份（电信优选）</td>\n</tr>\n<tr>\n<td><strong>移动云盘</strong></td>\n<td>不限速</td>\n<td>一般</td>\n<td>❌</td>\n<td><strong>免费</strong></td>\n<td>大容量备份（移动用户）</td>\n</tr>\n<tr>\n<td><strong>夸克网盘</strong></td>\n<td>免费限速，会员快</td>\n<td>✅ 中等</td>\n<td>❌</td>\n<td><strong>88VIP 白嫖会员</strong></td>\n<td>临时转存 &#x2F; 播放</td>\n</tr>\n<tr>\n<td><strong>123 网盘</strong></td>\n<td>免费限速，会员快</td>\n<td>✅ 中等</td>\n<td>⚠️（API 或绕过）</td>\n<td><strong>基本需付费</strong></td>\n<td>中转下载 &#x2F; 资源分享</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"音乐\"><a href=\"#音乐\" class=\"headerlink\" title=\"音乐\"></a>音乐</h3><p><strong>本地</strong>：当前占用约10GB，统一存放于固定路径（<code>E:/音乐/</code>），冷备份至U盘及软路由存储中，确保本地多设备冗余。</p>\n<ul>\n<li><strong>本地播放&#x2F;管理方案</strong>：采用 <strong>Navidrome + NAS</strong> 组合或 <strong>Jellyfin + NAS</strong>，搭建私人音乐服务器，实现跨设备在线播放、管理和元数据同步。<ul>\n<li><strong>Navidrome</strong>：轻量级音乐服务器，支持多用户、Web和手机客户端，兼容多种音频格式，适合个人或小团队使用。</li>\n<li><strong>Jellyfin</strong>：功能更强大，支持多媒体统一管理（音乐、电影、电视），支持DLNA、Chromecast等多种播放协议，适合更丰富的多媒体需求。</li>\n</ul>\n</li>\n</ul>\n<p><strong>云端同步</strong>：</p>\n<ul>\n<li>夸克网盘：启用“同步文件夹”功能，将<code>D:/Music/</code>设为同步目录热备份（需确保夸克客户端常驻后台）。</li>\n</ul>\n<p><strong>歌单与播放列表管理</strong>：</p>\n<ul>\n<li>使用 <strong>歌单无界</strong> 等工具，能有效匹配和同步歌单排序，实现云端与本地播放列表的无缝衔接，避免歌单乱序问题，提升听歌体验。</li>\n</ul>\n<h4 id=\"🧐-为什么选择夸克网盘作为音乐备份平台？\"><a href=\"#🧐-为什么选择夸克网盘作为音乐备份平台？\" class=\"headerlink\" title=\"🧐 为什么选择夸克网盘作为音乐备份平台？\"></a>🧐 为什么选择夸克网盘作为音乐备份平台？</h4><h5 id=\"✅-多平台支持，使用体验优秀\"><a href=\"#✅-多平台支持，使用体验优秀\" class=\"headerlink\" title=\"✅ 多平台支持，使用体验优秀\"></a>✅ 多平台支持，使用体验优秀</h5><ul>\n<li>支持 <strong>Android &#x2F; iOS &#x2F; Web &#x2F; Windows &#x2F; Mac</strong> 等主流平台。</li>\n<li>无论是手机、平板、电脑均可便捷访问、播放与下载音频文件。</li>\n<li>网页端支持50MB以内单文件下载，<strong>无需额外客户端</strong>。</li>\n</ul>\n<h5 id=\"✅-存储空间充足，价格极低\"><a href=\"#✅-存储空间充足，价格极低\" class=\"headerlink\" title=\"✅ 存储空间充足，价格极低\"></a>✅ 存储空间充足，价格极低</h5><ul>\n<li><p>通过 <strong>88VIP 赠送的夸克会员权益（价值5元一年）</strong>，可获得至少 <strong>6TB 超大云盘容量</strong>。</p>\n</li>\n<li><p>适合长期保存大量高质量无损音乐、专辑、母带文件。</p>\n</li>\n<li><p><strong>性价比极高</strong>，几乎免费获得专业级云盘体验。</p>\n</li>\n</ul>\n<h5 id=\"✅-上传-下载速度优秀\"><a href=\"#✅-上传-下载速度优秀\" class=\"headerlink\" title=\"✅ 上传&#x2F;下载速度优秀\"></a>✅ 上传&#x2F;下载速度优秀</h5><ul>\n<li>会员上传、下载稳定在 <strong>50MB&#x2F;s 以上</strong>，支持单文件最大100GB上传。</li>\n<li>支持断点续传，保障长时间上传的稳定性。</li>\n</ul>\n<h5 id=\"✅-原文件存储，不转码不压缩\"><a href=\"#✅-原文件存储，不转码不压缩\" class=\"headerlink\" title=\"✅ 原文件存储，不转码不压缩\"></a>✅ 原文件存储，不转码不压缩</h5><ul>\n<li>音频文件 <strong>不会被转码或重命名</strong>，保留完整元数据。</li>\n<li>适合储存音乐资料库、专辑封面、歌词、Cue 文件等文件结构较复杂的音乐归档。</li>\n</ul>\n<h5 id=\"✅-文件结构清晰，支持批量管理\"><a href=\"#✅-文件结构清晰，支持批量管理\" class=\"headerlink\" title=\"✅ 文件结构清晰，支持批量管理\"></a>✅ 文件结构清晰，支持批量管理</h5><ul>\n<li>支持自定义目录层级，如 <code>音乐归档/无损合集/年代/艺术家/</code>，便于分类和查找。</li>\n<li>PC客户端支持拖拽和批量上传，简化管理流程。</li>\n<li>支持文件重命名规则插件，保持命名规范。</li>\n</ul>\n<h5 id=\"✅-分享与恢复便捷\"><a href=\"#✅-分享与恢复便捷\" class=\"headerlink\" title=\"✅ 分享与恢复便捷\"></a>✅ 分享与恢复便捷</h5><ul>\n<li>支持生成带有效期的分享链接，方便与朋友共享音乐。</li>\n<li>设备更换或损坏后，登录账号即可无缝恢复全库，免除手动迁移烦恼。</li>\n</ul>\n<hr>\n<h3 id=\"代码工作区（F-Workspace-）\"><a href=\"#代码工作区（F-Workspace-）\" class=\"headerlink\" title=\"代码工作区（F:/Workspace/）\"></a>代码工作区（<code>F:/Workspace/</code>）</h3><h4 id=\"本地备份\"><a href=\"#本地备份\" class=\"headerlink\" title=\"本地备份\"></a>本地备份</h4><h5 id=\"当前状态\"><a href=\"#当前状态\" class=\"headerlink\" title=\"当前状态\"></a>当前状态</h5><ul>\n<li>主要代码工作区位于F盘本地磁盘。</li>\n</ul>\n<h5 id=\"未来规划\"><a href=\"#未来规划\" class=\"headerlink\" title=\"未来规划\"></a>未来规划</h5><ul>\n<li>计划部署 <strong>NAS 设备</strong>，实现自动定时快照和备份。</li>\n<li>NAS结合版本控制或增量备份方案，可大幅提升数据安全性和多设备访问便利。</li>\n</ul>\n<h4 id=\"云端同步\"><a href=\"#云端同步\" class=\"headerlink\" title=\"云端同步\"></a>云端同步</h4><h5 id=\"Git-GitHub-私有仓库（适合核心代码版本控制）\"><a href=\"#Git-GitHub-私有仓库（适合核心代码版本控制）\" class=\"headerlink\" title=\"Git + GitHub 私有仓库（适合核心代码版本控制）\"></a>Git + GitHub 私有仓库（适合核心代码版本控制）</h5><h6 id=\"注册与创建仓库\"><a href=\"#注册与创建仓库\" class=\"headerlink\" title=\"注册与创建仓库\"></a>注册与创建仓库</h6><ul>\n<li>注册GitHub账号（<a href=\"https://github.com/%EF%BC%89%E3%80%82\">https://github.com/）。</a></li>\n<li>创建私有仓库（例如 <code>my-workspace</code>）。</li>\n<li><strong>创建时避免勾选“Initialize with README”</strong>，防止初始化文件与本地冲突。</li>\n</ul>\n<h6 id=\"初始化本地仓库并关联远程\"><a href=\"#初始化本地仓库并关联远程\" class=\"headerlink\" title=\"初始化本地仓库并关联远程\"></a>初始化本地仓库并关联远程</h6><ul>\n<li><p>在目标项目目录（如<code>F:/Workspace/project1/</code>）打开 <strong>Git Bash Here</strong>，依次执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git remote add origin https://github.com/你的用户名/my-workspace.git</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;Initial commit&quot;</span></span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"日常更新流程\"><a href=\"#日常更新流程\" class=\"headerlink\" title=\"日常更新流程\"></a>日常更新流程</h6><ul>\n<li><p>每次代码修改完成后，执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;简短描述本次修改&quot;</span></span><br><span class=\"line\">git push</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"多设备恢复\"><a href=\"#多设备恢复\" class=\"headerlink\" title=\"多设备恢复\"></a>多设备恢复</h6><ul>\n<li><p>在新设备或工作环境，执行克隆操作：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/你的用户名/my-workspace.git</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"建议辅助工具\"><a href=\"#建议辅助工具\" class=\"headerlink\" title=\"建议辅助工具\"></a>建议辅助工具</h6><ul>\n<li>推荐使用 VSCode 等支持Git的编辑器，内置Git插件使操作更直观便捷。</li>\n</ul>\n<h6 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h6><ul>\n<li>避免提交大文件或敏感信息。</li>\n<li>可通过 <code>.gitignore</code> 文件排除不需要同步的文件。</li>\n</ul>\n<h5 id=\"夸克网盘（适合非版本控制的备份）\"><a href=\"#夸克网盘（适合非版本控制的备份）\" class=\"headerlink\" title=\"夸克网盘（适合非版本控制的备份）\"></a>夸克网盘（适合非版本控制的备份）</h5><h6 id=\"适用范围\"><a href=\"#适用范围\" class=\"headerlink\" title=\"适用范围\"></a>适用范围</h6><ul>\n<li>备份无需版本控制的代码副本、资料文件、配置文件或二进制资源。</li>\n</ul>\n<h6 id=\"备份方法\"><a href=\"#备份方法\" class=\"headerlink\" title=\"备份方法\"></a>备份方法</h6><ul>\n<li>在夸克网盘创建同步文件夹（如 <code>Workspace_Backup</code>）。</li>\n<li>将本地目录 <code>F:/Workspace/</code> 拖入同步文件夹，实现自动热备份。</li>\n<li>保证夸克客户端常驻后台以确保同步稳定及时。</li>\n</ul>\n<h4 id=\"补充建议\"><a href=\"#补充建议\" class=\"headerlink\" title=\"补充建议\"></a>补充建议</h4><h5 id=\"自动备份脚本\"><a href=\"#自动备份脚本\" class=\"headerlink\" title=\"自动备份脚本\"></a>自动备份脚本</h5><ul>\n<li>可编写定时任务脚本，自动复制代码工作区至NAS或备份目录。</li>\n<li>结合增量备份工具，如Linux的 <code>rsync</code>，Windows下推荐使用 <code>DeltaCopy</code>，提高备份效率。</li>\n</ul>\n<h5 id=\"多版本备份策略\"><a href=\"#多版本备份策略\" class=\"headerlink\" title=\"多版本备份策略\"></a>多版本备份策略</h5><ul>\n<li>利用Git的版本管理优势管理代码历史。</li>\n<li>结合NAS快照功能，实现数据误删、误覆盖的快速恢复。</li>\n</ul>\n<h5 id=\"安全性建议\"><a href=\"#安全性建议\" class=\"headerlink\" title=\"安全性建议\"></a>安全性建议</h5><ul>\n<li>私有仓库不宜存储明文密码或敏感密钥。</li>\n<li>建议使用环境变量或专门的安全管理工具处理敏感信息。</li>\n</ul>\n<hr>\n<h3 id=\"QQ-微信聊天记录\"><a href=\"#QQ-微信聊天记录\" class=\"headerlink\" title=\"QQ&#x2F;微信聊天记录\"></a>QQ&#x2F;微信聊天记录</h3><h4 id=\"手机-→-电脑备份\"><a href=\"#手机-→-电脑备份\" class=\"headerlink\" title=\"手机 → 电脑备份\"></a>手机 → 电脑备份</h4><h5 id=\"微信备份\"><a href=\"#微信备份\" class=\"headerlink\" title=\"微信备份\"></a>微信备份</h5><ul>\n<li>通过电脑版微信“备份与恢复”功能，连接手机和电脑，选择“备份聊天记录至电脑”操作（需同一局域网）。</li>\n<li>可备份聊天文本、图片、语音等内容，需手动操作。</li>\n</ul>\n<h5 id=\"QQ备份\"><a href=\"#QQ备份\" class=\"headerlink\" title=\"QQ备份\"></a>QQ备份</h5><ul>\n<li>进入手机QQ“设置 → 通用 → 聊天记录备份与恢复”，选择“备份聊天记录到电脑QQ”，手机与电脑需联网且在同一网络。</li>\n</ul>\n<h4 id=\"电脑-→-本地存储\"><a href=\"#电脑-→-本地存储\" class=\"headerlink\" title=\"电脑 → 本地存储\"></a>电脑 → 本地存储</h4><h5 id=\"默认存储路径\"><a href=\"#默认存储路径\" class=\"headerlink\" title=\"默认存储路径\"></a>默认存储路径</h5><ul>\n<li>微信聊天记录路径为：<br> <code>C:/Users/&lt;用户名&gt;/Documents/WeChat Files/&lt;微信号&gt;/</code></li>\n<li>QQ聊天记录路径为：<br> <code>C:/Users/&lt;用户名&gt;/Documents/Tencent Files/&lt;QQ号&gt;/</code></li>\n</ul>\n<h5 id=\"备份文件管理\"><a href=\"#备份文件管理\" class=\"headerlink\" title=\"备份文件管理\"></a>备份文件管理</h5><ul>\n<li>建议定期将聊天记录目录压缩成 <code>DataBackup.zip</code> 方便管理和迁移。</li>\n<li>压缩包可存储于U盘、NAS或上传至云盘（如夸克网盘）实现多重备份。</li>\n</ul>\n<h4 id=\"Root手机完整备份（推荐第三方工具“数据备份”）\"><a href=\"#Root手机完整备份（推荐第三方工具“数据备份”）\" class=\"headerlink\" title=\"Root手机完整备份（推荐第三方工具“数据备份”）\"></a>Root手机完整备份（推荐第三方工具“数据备份”）</h4><h5 id=\"为什么推荐“数据备份”\"><a href=\"#为什么推荐“数据备份”\" class=\"headerlink\" title=\"为什么推荐“数据备份”\"></a>为什么推荐“数据备份”</h5><ul>\n<li>经多次测试，手机官方微信和QQ备份功能<strong>容易遗漏大量图片和视频</strong>，导致备份不完整。</li>\n<li>“数据备份”作为Root权限工具，能<strong>完整导出所有QQ和微信数据</strong>，包括聊天记录、图片、视频、数据库和缓存文件。</li>\n</ul>\n<h5 id=\"备份流程\"><a href=\"#备份流程\" class=\"headerlink\" title=\"备份流程\"></a>备份流程</h5><ul>\n<li>在Root的手机设备上运行“数据备份”软件，进行完整数据导出。</li>\n<li>备份数据压缩成 <code>DataBackup.zip</code> 文件，方便保存与传输。</li>\n<li>上传压缩文件到夸克网盘或其他云盘，实现安全、长期存储。</li>\n</ul>\n<h5 id=\"优势说明\"><a href=\"#优势说明\" class=\"headerlink\" title=\"优势说明\"></a>优势说明</h5><ul>\n<li>该备份方式全面且数据完整，适合设备更换、系统重装时恢复使用。</li>\n<li>极大减少因官方备份功能不足造成的数据丢失风险。</li>\n</ul>\n<h4 id=\"自动化备份建议\"><a href=\"#自动化备份建议\" class=\"headerlink\" title=\"自动化备份建议\"></a>自动化备份建议</h4><h5 id=\"Windows定时压缩\"><a href=\"#Windows定时压缩\" class=\"headerlink\" title=\"Windows定时压缩\"></a>Windows定时压缩</h5><ul>\n<li>利用任务计划结合批处理脚本，定期压缩本地聊天记录文件夹，减轻手动备份负担。</li>\n</ul>\n<h5 id=\"多层备份架构\"><a href=\"#多层备份架构\" class=\"headerlink\" title=\"多层备份架构\"></a>多层备份架构</h5><ul>\n<li>结合软路由与NAS，定期同步聊天数据，实现本地与网络的多层冗余备份。</li>\n</ul>\n<h4 id=\"安全与隐私\"><a href=\"#安全与隐私\" class=\"headerlink\" title=\"安全与隐私\"></a>安全与隐私</h4><h5 id=\"数据加密\"><a href=\"#数据加密\" class=\"headerlink\" title=\"数据加密\"></a>数据加密</h5><ul>\n<li>聊天记录包含个人隐私，建议使用7-Zip等工具对压缩包设置密码保护。</li>\n</ul>\n<h5 id=\"云盘权限控制\"><a href=\"#云盘权限控制\" class=\"headerlink\" title=\"云盘权限控制\"></a>云盘权限控制</h5><ul>\n<li>上传云盘后，务必设置访问权限，避免数据泄露风险。</li>\n</ul>\n<h5 id=\"Root权限风险\"><a href=\"#Root权限风险\" class=\"headerlink\" title=\"Root权限风险\"></a>Root权限风险</h5><ul>\n<li>Root操作存在一定风险，务必保证备份工具来源正规可靠。</li>\n</ul>\n<h4 id=\"恢复方法\"><a href=\"#恢复方法\" class=\"headerlink\" title=\"恢复方法\"></a>恢复方法</h4><h5 id=\"官方恢复途径\"><a href=\"#官方恢复途径\" class=\"headerlink\" title=\"官方恢复途径\"></a>官方恢复途径</h5><ul>\n<li>电脑版微信和QQ支持“备份与恢复”功能，可恢复聊天记录（需确保备份文件完整且版本匹配）。</li>\n</ul>\n<h5 id=\"Root备份恢复\"><a href=\"#Root备份恢复\" class=\"headerlink\" title=\"Root备份恢复\"></a>Root备份恢复</h5><ul>\n<li>需借助相应的手机恢复工具，将完整备份数据导入手机，恢复聊天内容、图片和视频。</li>\n</ul>\n<h5 id=\"手动恢复\"><a href=\"#手动恢复\" class=\"headerlink\" title=\"手动恢复\"></a>手动恢复</h5><ul>\n<li>关闭对应客户端后，手动复制聊天记录文件夹到原路径，实现基础数据恢复。</li>\n</ul>\n<hr>\n<h3 id=\"浏览器书签（Chrome）\"><a href=\"#浏览器书签（Chrome）\" class=\"headerlink\" title=\"浏览器书签（Chrome）\"></a>浏览器书签（Chrome）</h3><ul>\n<li><strong>本地备份</strong>：可通过 Chrome 自带的导出功能，定期导出为 <code>.html</code> 文件保存到本地。</li>\n<li><strong>云端同步</strong>：<ul>\n<li>使用 <strong>Floccus 浏览器插件</strong>，配置 WebDAV（推荐坚果云）后，可实现自动同步浏览器书签到云端。</li>\n<li>也可手动导出书签 <code>.html</code> 文件，存入夸克网盘等云服务。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧐-为什么选择坚果云作为同步平台？\"><a href=\"#🧐-为什么选择坚果云作为同步平台？\" class=\"headerlink\" title=\"🧐 为什么选择坚果云作为同步平台？\"></a>🧐 为什么选择坚果云作为同步平台？</h4><h5 id=\"✅-完全支持-WebDAV-协议\"><a href=\"#✅-完全支持-WebDAV-协议\" class=\"headerlink\" title=\"✅ 完全支持 WebDAV 协议\"></a>✅ 完全支持 WebDAV 协议</h5><ul>\n<li>坚果云提供长期稳定的 WebDAV 接口。</li>\n<li>与 Floccus 等插件完美兼容，无需额外脚本或服务端配置。</li>\n</ul>\n<h5 id=\"✅-安装简便、自动同步\"><a href=\"#✅-安装简便、自动同步\" class=\"headerlink\" title=\"✅ 安装简便、自动同步\"></a>✅ 安装简便、自动同步</h5><ul>\n<li>配置一次即可后台自动同步书签文件，无需手动导出。</li>\n<li>支持多浏览器、多设备自动保持书签一致。</li>\n</ul>\n<h5 id=\"✅-空间充足，传输速度快\"><a href=\"#✅-空间充足，传输速度快\" class=\"headerlink\" title=\"✅ 空间充足，传输速度快\"></a>✅ 空间充足，传输速度快</h5><ul>\n<li>免费版即提供 1GB 存储，书签数据占用极小。</li>\n<li>中国大陆服务器，上传&#x2F;同步速度快、延迟低。</li>\n</ul>\n<h5 id=\"✅-安全性强\"><a href=\"#✅-安全性强\" class=\"headerlink\" title=\"✅ 安全性强\"></a>✅ 安全性强</h5><ul>\n<li><p>传输使用 HTTPS 加密。</p>\n</li>\n<li><p>可为 Floccus 单独生成 <strong>应用专用授权码</strong>：</p>\n<blockquote>\n<p>即便泄露也可随时吊销，确保主账户安全。</p>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-第一步：注册坚果云并启用-WebDAV-功能\"><a href=\"#🧩-第一步：注册坚果云并启用-WebDAV-功能\" class=\"headerlink\" title=\"🧩 第一步：注册坚果云并启用 WebDAV 功能\"></a>🧩 第一步：注册坚果云并启用 WebDAV 功能</h4><ol>\n<li>访问官网：<a href=\"https://www.jianguoyun.com/\">https://www.jianguoyun.com</a></li>\n<li>注册新账户（推荐使用邮箱）</li>\n<li>登录后，进入「设置」页面 → 进入「<strong>第三方应用管理</strong>」</li>\n<li>点击「添加应用」→ 输入名称（如：Floccus 书签同步）</li>\n<li>系统生成一个「<strong>应用专用授权码</strong>」</li>\n</ol>\n<blockquote>\n<p>⚠️ 请妥善保存该授权码，稍后配置 WebDAV 时将用到</p>\n</blockquote>\n<hr>\n<h4 id=\"🌐-第二步：获取-WebDAV-配置信息\"><a href=\"#🌐-第二步：获取-WebDAV-配置信息\" class=\"headerlink\" title=\"🌐 第二步：获取 WebDAV 配置信息\"></a>🌐 第二步：获取 WebDAV 配置信息</h4><table>\n<thead>\n<tr>\n<th>参数</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>你的坚果云注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用专用授权码（非登录密码）</td>\n</tr>\n</tbody></table>\n<p><strong>注意！需要创建一个文件夹(如&#x2F;Bookmarks)</strong></p>\n<hr>\n<h4 id=\"🧩-第三步：在-Chrome-中配置-Floccus-插件\"><a href=\"#🧩-第三步：在-Chrome-中配置-Floccus-插件\" class=\"headerlink\" title=\"🧩 第三步：在 Chrome 中配置 Floccus 插件\"></a>🧩 第三步：在 Chrome 中配置 Floccus 插件</h4><ol>\n<li><p>前往 <a href=\"https://github.com/floccusaddon/floccus\">Github主页</a> 或<a href=\"https://floccus.org/\">软件官网</a>安装 <strong>Floccus</strong> 插件</p>\n</li>\n<li><p>安装后点击插件图标 → 选择「<strong>添加配置</strong>」→ 选择「<strong>WebDAV分享</strong>」</p>\n</li>\n<li><p>填写以下信息：</p>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>服务器地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>你的坚果云注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用专用授权码</td>\n</tr>\n<tr>\n<td>同步文件名</td>\n<td><code>/Bookmarks/bookmarks.html</code> 或默认设置</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>设置同步频率</p>\n</li>\n<li><p>成功后，你可以在坚果云的 <code>/bookmarks/</code> 路径中看到同步生成的 bookmarks.html 文件</p>\n</li>\n</ol>\n<hr>\n<h4 id=\"💾-第四步：恢复或迁移书签数据\"><a href=\"#💾-第四步：恢复或迁移书签数据\" class=\"headerlink\" title=\"💾 第四步：恢复或迁移书签数据\"></a>💾 第四步：恢复或迁移书签数据</h4><ol>\n<li>在新设备安装 Chrome 与 Floccus 插件</li>\n<li>使用相同 WebDAV 信息创建同步账户</li>\n<li>点击「Sync」按钮 → 即可从云端恢复书签数据</li>\n<li><strong>也可手动导入坚果云保存的bookmarks <code>.html</code> 文件</strong></li>\n</ol>\n<h3 id=\"椒盐笔记\"><a href=\"#椒盐笔记\" class=\"headerlink\" title=\"椒盐笔记\"></a>椒盐笔记</h3><ul>\n<li><strong>本地备份</strong>：已自动保存到手机<code>/Documents/SaltNote/</code>（确认路径无误）。</li>\n<li><strong>云端备份</strong>：<ul>\n<li>通过椒盐笔记的WebDAV功能备份到支持WebDAV的网盘（如坚果云、Nextcloud）。</li>\n<li>或手动定期导出Markdown文件到云盘（如夸克&#x2F;百度网盘）。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"🧐-为什么选择坚果云作为备份平台？\"><a href=\"#🧐-为什么选择坚果云作为备份平台？\" class=\"headerlink\" title=\"🧐 为什么选择坚果云作为备份平台？\"></a>🧐 为什么选择坚果云作为备份平台？</h4><h5 id=\"✅-完全支持-WebDAV-协议-1\"><a href=\"#✅-完全支持-WebDAV-协议-1\" class=\"headerlink\" title=\"✅ 完全支持 WebDAV 协议\"></a>✅ 完全支持 WebDAV 协议</h5><ul>\n<li>坚果云是国内极少数长期稳定支持 WebDAV 的云服务，兼容性好。</li>\n<li>与椒盐笔记等支持 WebDAV 的应用完美配合，几乎零配置可同步。</li>\n</ul>\n<h5 id=\"✅-免费也够用\"><a href=\"#✅-免费也够用\" class=\"headerlink\" title=\"✅ 免费也够用\"></a>✅ 免费也够用</h5><ul>\n<li>免费账户提供 <strong>1GB 空间</strong>，Markdown 纯文本笔记占用极小。</li>\n<li>同步数据流量极低，基本可实现<strong>长期免费使用</strong>。</li>\n</ul>\n<h5 id=\"✅-安全性高\"><a href=\"#✅-安全性高\" class=\"headerlink\" title=\"✅ 安全性高\"></a>✅ 安全性高</h5><ul>\n<li><p>全程 HTTPS 加密传输，支持两步验证。</p>\n</li>\n<li><p>支持每个应用生成独立的授权码：</p>\n<blockquote>\n<p>泄露后可随时吊销，不影响主账户安全。</p>\n</blockquote>\n</li>\n</ul>\n<h5 id=\"✅-服务稳定、速度优秀\"><a href=\"#✅-服务稳定、速度优秀\" class=\"headerlink\" title=\"✅ 服务稳定、速度优秀\"></a>✅ 服务稳定、速度优秀</h5><ul>\n<li>拥有中国大陆服务器，同步速度快、延迟低。</li>\n<li>多年稳定运营，无大规模中断记录。</li>\n</ul>\n<h5 id=\"✅-可拓展用途\"><a href=\"#✅-可拓展用途\" class=\"headerlink\" title=\"✅ 可拓展用途\"></a>✅ 可拓展用途</h5><ul>\n<li>除椒盐笔记，还可用于：<ul>\n<li>Obsidian、Joplin 等 WebDAV 应用</li>\n<li>FreeFileSync、rclone、Python 脚本工具等</li>\n<li>批量同步文档、PDF、代码片段等轻量资料</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-第一步：注册坚果云并启用-WebDAV-功能-1\"><a href=\"#🧩-第一步：注册坚果云并启用-WebDAV-功能-1\" class=\"headerlink\" title=\"🧩 第一步：注册坚果云并启用 WebDAV 功能\"></a>🧩 第一步：注册坚果云并启用 WebDAV 功能</h4><ol>\n<li><p>访问官网：<a href=\"https://www.jianguoyun.com/\">https://www.jianguoyun.com</a></p>\n</li>\n<li><p>点击「注册」，推荐使用邮箱注册账号</p>\n</li>\n<li><p>登录后，点击右上角头像 → 进入「设置」</p>\n</li>\n<li><p>打开「<strong>第三方应用管理</strong>」菜单</p>\n</li>\n<li><p>点击「添加应用」，输入自定义应用名（如：椒盐笔记备份）</p>\n</li>\n<li><p>系统生成一个「应用授权码」：</p>\n<blockquote>\n<p><strong>请复制并妥善保存</strong>，稍后配置 WebDAV 会使用</p>\n</blockquote>\n</li>\n</ol>\n<hr>\n<h4 id=\"🌐-第二步：获取-WebDAV-配置信息-1\"><a href=\"#🌐-第二步：获取-WebDAV-配置信息-1\" class=\"headerlink\" title=\"🌐 第二步：获取 WebDAV 配置信息\"></a>🌐 第二步：获取 WebDAV 配置信息</h4><ul>\n<li>WebDAV 地址：<code>https://dav.jianguoyun.com/dav/</code></li>\n<li>用户名：你的坚果云注册邮箱</li>\n<li>密码：上一步生成的「<strong>应用授权码</strong>」（<strong>不是登录密码</strong>）</li>\n</ul>\n<hr>\n<h4 id=\"📱-第三步：在椒盐笔记中配置-WebDAV-自动同步\"><a href=\"#📱-第三步：在椒盐笔记中配置-WebDAV-自动同步\" class=\"headerlink\" title=\"📱 第三步：在椒盐笔记中配置 WebDAV 自动同步\"></a>📱 第三步：在椒盐笔记中配置 WebDAV 自动同步</h4><ol>\n<li><p>打开椒盐笔记（SaltNote）App</p>\n</li>\n<li><p>点击右上角齿轮图标，进入设置页面</p>\n</li>\n<li><p>选择「<strong>WebDAV 同步</strong>」</p>\n</li>\n<li><p>填写以下信息：</p>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用授权码</td>\n</tr>\n<tr>\n<td>同步路径</td>\n<td>推荐使用 <code>/saltnote/</code>，网盘中将自动创建此目录</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>启用「自动同步」功能</p>\n</li>\n<li><p>第一次同步完成后，坚果云网页端将出现 <code>/saltnote/</code> 文件夹</p>\n<blockquote>\n<p>内含 <code>.md</code> 文件与 PepperNote 设置数据，后续将持续自动更新</p>\n</blockquote>\n</li>\n</ol>\n<hr>\n<h4 id=\"💾-第四步：恢复笔记数据流程（换手机-重装-App）\"><a href=\"#💾-第四步：恢复笔记数据流程（换手机-重装-App）\" class=\"headerlink\" title=\"💾 第四步：恢复笔记数据流程（换手机 &#x2F; 重装 App）\"></a>💾 第四步：恢复笔记数据流程（换手机 &#x2F; 重装 App）</h4><ol>\n<li><p>在新设备上安装椒盐笔记 App</p>\n</li>\n<li><p>进入设置 → WebDAV 同步，填写相同信息（地址、邮箱、授权码、路径）</p>\n</li>\n<li><p>等待连接成功</p>\n</li>\n<li><p>点击「设置 → 备份与恢复 → 恢复备份」</p>\n</li>\n<li><p>稍候几秒，历史笔记将自动恢复</p>\n<blockquote>\n<p>无需手动导入，云端会同步所有内容与配置</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"文档素材（E盘-F盘分散文件夹）\"><a href=\"#文档素材（E盘-F盘分散文件夹）\" class=\"headerlink\" title=\"文档素材（E盘/F盘分散文件夹）\"></a>文档素材（<code>E盘/F盘</code>分散文件夹）</h3><ul>\n<li><strong>本地备份</strong>：已存在原位置，考虑NAS。</li>\n<li><strong>云端同步</strong>：<ul>\n<li>夸克网盘：添加多个文件夹到同步列表（注意单个文件大小限制）。</li>\n<li>天翼云盘？</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"虚拟机（VMware）\"><a href=\"#虚拟机（VMware）\" class=\"headerlink\" title=\"虚拟机（VMware）\"></a>虚拟机（VMware）</h3><ul>\n<li><strong>备份建议</strong>：<ul>\n<li><strong>方案1</strong>：关闭VMware后，直接复制整个虚拟机文件夹（默认路径：<code>C:/Users/&lt;用户名&gt;/Documents/Virtual Machines/</code>），需包含<code>.vmx</code>（配置文件）和<code>.vmdk</code>（虚拟磁盘文件）。</li>\n<li><strong>方案2</strong>：VMware自带“快照”功能（临时备份，占用空间大）。</li>\n</ul>\n</li>\n<li><strong>推荐</strong>：每月一次完整备份+每周快照。</li>\n</ul>\n<h3 id=\"密码管理器\"><a href=\"#密码管理器\" class=\"headerlink\" title=\"密码管理器\"></a>密码管理器</h3><ul>\n<li><strong>推荐工具</strong>：<ul>\n<li><strong>Bitwarden</strong>（免费开源，支持WebDAV同步，加密备份到网盘）。</li>\n<li><strong>KeePassXC</strong>（本地存储，数据库文件可同步到云盘）。</li>\n</ul>\n</li>\n<li><strong>迁移建议</strong>：将微信收藏的密码整理到Bitwarden，启用自动填充功能。</li>\n</ul>\n<h3 id=\"百度输入法词库\"><a href=\"#百度输入法词库\" class=\"headerlink\" title=\"百度输入法词库\"></a>百度输入法词库</h3><ul>\n<li><strong>暂缓</strong>，但记录路径：<ul>\n<li>Windows：<code>%APPDATA%\\Baidu\\BaiduPinyin\\UserData\\</code>（如<code>C:/Users/&lt;用户名&gt;/AppData/Roaming/Baidu/BaiduPinyin/UserData/</code>）。</li>\n<li>备份时复制整个<code>UserData</code>文件夹。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"自动化工具整合\"><a href=\"#自动化工具整合\" class=\"headerlink\" title=\"自动化工具整合\"></a>自动化工具整合</h2><ol>\n<li><p><strong>FreeFileSync</strong>（核心工具）：</p>\n<ul>\n<li>配置任务：<ul>\n<li>同步<code>D:/Music/</code>→夸克网盘音乐文件夹。</li>\n<li>同步<code>F:/Workspace/</code>（非Git子文件夹）→夸克网盘代码文件夹。</li>\n<li>同步<code>E:/文档素材/</code>→夸克网盘文档文件夹。</li>\n</ul>\n</li>\n<li>设置定时任务（通过Windows任务计划程序每天触发）。</li>\n</ul>\n</li>\n<li><p><strong>插件&#x2F;脚本</strong>：</p>\n<ul>\n<li>Chrome书签：</li>\n<li>密码管理：迁移到Bitwarden并启用WebDAV同步。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"🛠-自动化备份与脚本整合\"><a href=\"#🛠-自动化备份与脚本整合\" class=\"headerlink\" title=\"🛠 自动化备份与脚本整合\"></a>🛠 自动化备份与脚本整合</h3><h4 id=\"🔄-自动化备份流程\"><a href=\"#🔄-自动化备份流程\" class=\"headerlink\" title=\"🔄 自动化备份流程\"></a>🔄 自动化备份流程</h4><p>为了实现备份的“无人值守、自动执行”，以下是推荐的自动化流程与工具：</p>\n<h5 id=\"✅-使用-FreeFileSync-Windows-任务计划程序-实现本地同步\"><a href=\"#✅-使用-FreeFileSync-Windows-任务计划程序-实现本地同步\" class=\"headerlink\" title=\"✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步\"></a>✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步</h5><ol>\n<li><p>安装 FreeFileSync</p>\n</li>\n<li><p>新建“同步任务”（Batch Job），每个任务可指定如下内容：</p>\n<ul>\n<li>源文件夹 → 目标文件夹（如 <code>F:/Workspace/</code> → <code>夸克同步文件夹/Workspace/</code>）</li>\n<li>选择同步方式：<strong>镜像同步（Mirror）</strong> 或 <strong>更新同步（Update）</strong></li>\n<li>排除无关内容（如 <code>.git/</code>、临时文件夹、系统隐藏目录）</li>\n<li>勾选：同步后发送通知 &#x2F; 日志记录</li>\n<li>保存为 <code>.ffs_batch</code> 文件</li>\n</ul>\n</li>\n<li><p>打开 Windows“任务计划程序”：</p>\n<ul>\n<li><p>新建基本任务 → 设置触发时间（如“每天 9:00”）</p>\n</li>\n<li><p>动作选择“启动程序”，指向 FreeFileSync 的可执行文件，并附上参数：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FreeFileSync.exe &quot;C:\\路径\\to\\sync_task.ffs_batch&quot;</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p>重复以上步骤，可对多个同步项目（音乐、代码、文档）设定不同计划任务。</p>\n</li>\n<li><p>可勾选“开机自启 + 错过任务立即执行”选项，保障离线时也不会丢同步任务。</p>\n</li>\n</ol>\n<h5 id=\"✅-可选增强工具：Rclone-脚本\"><a href=\"#✅-可选增强工具：Rclone-脚本\" class=\"headerlink\" title=\"✅ 可选增强工具：Rclone + 脚本\"></a>✅ 可选增强工具：Rclone + 脚本</h5><ul>\n<li>对于不支持同步客户端的云平台（如坚果云 WebDAV），可使用 Rclone 工具进行自动同步：</li>\n</ul>\n<ol>\n<li><p>下载并配置 Rclone：<a href=\"https://rclone.org/downloads/\">https://rclone.org/downloads/</a></p>\n</li>\n<li><p>执行配置命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rclone config</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>输入 <code>n</code> 新建配置 → 输入名称（如 <code>jianguo</code>）</li>\n<li>类型选择 <code>WebDAV</code></li>\n<li>填入坚果云信息：地址、用户名（邮箱）、密码（应用授权码）</li>\n</ul>\n</li>\n<li><p>编写自动同步脚本 <code>saltnote_sync.bat</code>：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@echo off</span><br><span class=\"line\">rclone sync &quot;C:\\Users\\你的用户名\\Documents\\SaltNote&quot; jianguo:/saltnote/ --update --copy-links --log-file=sync.log</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>将脚本添加至“任务计划程序”，设定定时执行。</p>\n</li>\n<li><p>亦可设置为“系统启动时执行”。</p>\n</li>\n</ol>\n<h5 id=\"✅-脚本增强建议\"><a href=\"#✅-脚本增强建议\" class=\"headerlink\" title=\"✅ 脚本增强建议\"></a>✅ 脚本增强建议</h5><ul>\n<li><p>增加错误提示与日志保存功能（<code>--log-file</code>）</p>\n</li>\n<li><p>可配合 Telegram Bot 或邮件推送异常信息（需额外脚本集成）</p>\n</li>\n<li><p>添加网络检查逻辑，避免断网时执行失败：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping www.baidu.com -n 2</span><br><span class=\"line\">if errorlevel 1 exit</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"✅-汇总：当前自动备份任务表（建议表格打印）\"><a href=\"#✅-汇总：当前自动备份任务表（建议表格打印）\" class=\"headerlink\" title=\"✅ 汇总：当前自动备份任务表（建议表格打印）\"></a>✅ 汇总：当前自动备份任务表（建议表格打印）</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>工具&#x2F;平台</th>\n<th>同步频率</th>\n<th>同步方式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>音乐</td>\n<td>FreeFileSync + 夸克网盘</td>\n<td>每日</td>\n<td>本地 → 云端热备份</td>\n<td>夸克客户端需保持后台运行</td>\n</tr>\n<tr>\n<td>代码仓库</td>\n<td>GitHub</td>\n<td>实时</td>\n<td>Git push&#x2F;pull</td>\n<td>含版本控制</td>\n</tr>\n<tr>\n<td>代码文档</td>\n<td>FreeFileSync</td>\n<td>每日</td>\n<td>本地 → 夸克文件夹</td>\n<td>非Git部分直接同步</td>\n</tr>\n<tr>\n<td>椒盐笔记</td>\n<td>WebDAV (坚果云)</td>\n<td>实时</td>\n<td>App自动同步</td>\n<td>基于 WebDAV，免脚本</td>\n</tr>\n<tr>\n<td>文档资料</td>\n<td>FreeFileSync</td>\n<td>每日</td>\n<td>多路径同步</td>\n<td><code>E:/素材</code> → 夸克同步</td>\n</tr>\n<tr>\n<td>QQ&#x2F;微信备份</td>\n<td>手动导出 → 云盘</td>\n<td>每周</td>\n<td>Zip 压缩手动上传</td>\n<td>可用计划任务自动移动 + 上传</td>\n</tr>\n<tr>\n<td>虚拟机镜像</td>\n<td>手动拷贝</td>\n<td>每月</td>\n<td>拷贝整个目录</td>\n<td><code>.vmx</code> + <code>.vmdk</code> 需完整</td>\n</tr>\n</tbody></table>\n<h3 id=\"✅-后续可扩展方向\"><a href=\"#✅-后续可扩展方向\" class=\"headerlink\" title=\"✅ 后续可扩展方向\"></a>✅ 后续可扩展方向</h3><ol>\n<li>✅ 使用 Syncthing 实现跨设备局域网同步<ul>\n<li>将手机 &#x2F; 平板与 PC 形成自动同步</li>\n</ul>\n</li>\n<li>✅ 部署本地 NAS + 易有云<ul>\n<li>使用手机访问 NAS 内容 + 做本地冷备份</li>\n</ul>\n</li>\n<li>✅ 定期生成恢复文档&#x2F;索引清单<ul>\n<li>每月导出当前所有文件目录结构清单 <code>.tree</code></li>\n<li>生成存储路径快照，帮助恢复</li>\n</ul>\n</li>\n<li>✅ 加入异常提醒机制<ul>\n<li>如某路径三天无更新 → 通过 Telegram&#x2F;邮件提醒</li>\n<li>如某文件夹容量超过阈值 → 发出警报</li>\n</ul>\n</li>\n</ol>\n","excerpt":"","more":"<h1 id=\"最终备份方案\"><a href=\"#最终备份方案\" class=\"headerlink\" title=\"最终备份方案\"></a>最终备份方案</h1><h2 id=\"🧭-备份策略总览\"><a href=\"#🧭-备份策略总览\" class=\"headerlink\" title=\"🧭 备份策略总览\"></a>🧭 备份策略总览</h2><p>为了确保个人数据的<strong>安全性、可恢复性与使用便捷性</strong>，本方案制定如下总目标：</p>\n<h3 id=\"🎯-目标原则\"><a href=\"#🎯-目标原则\" class=\"headerlink\" title=\"🎯 目标原则\"></a>🎯 目标原则</h3><ol>\n<li>✅ <strong>Free 优先 &#x2F; 极力节省成本</strong><ul>\n<li>优先使用免费工具与服务（如夸克网盘、FreeFileSync、GitHub 私有仓库等）。</li>\n<li>如遇容量&#x2F;功能限制，可在关键场景下考虑“轻量付费”。</li>\n</ul>\n</li>\n<li>🧊🔥 <strong>冷备份 + 热备份并存</strong><ul>\n<li><strong>冷备份</strong>（如外置硬盘、月度虚拟机镜像）：面向大规模恢复与长期留存。</li>\n<li><strong>热备份</strong>（如夸克同步文件夹、WebDAV）：用于日常使用&#x2F;误删恢复。</li>\n</ul>\n</li>\n<li>✌️ <strong>双重备份</strong><ul>\n<li>所有重要数据均至少存在两份：本地一份 + 云端一份。</li>\n<li>特别关键数据可建立“三重冗余”（如代码库、密码数据库）。</li>\n</ul>\n</li>\n<li>🔐 <strong>安全、便携、实用</strong><ul>\n<li>所有备份路径可在新设备&#x2F;系统中快速恢复（不依赖某一单一设备）。</li>\n<li>敏感文件使用 <code>.gitignore</code> &#x2F; 加密等方式保障隐私。</li>\n<li>所用工具应支持主流系统（Windows&#x2F;macOS&#x2F;Linux&#x2F;手机）。</li>\n</ul>\n</li>\n<li>🌀 <strong>热备尽量做到“无感备份”，自动化脚本</strong><ul>\n<li>使用同步客户端（夸克、天翼）或脚本（FreeFileSync + 定时任务）实现定时自动化。</li>\n<li>避免手动操作，提高容错率。</li>\n</ul>\n</li>\n<li>📖 <strong>编写《恢复手册.md》</strong><ul>\n<li>文档中将详细记录：<ul>\n<li>所有数据来源位置（路径 &#x2F; 网盘）</li>\n<li>对应恢复方式与工具</li>\n<li>账号密码管理器路径</li>\n<li>依赖的插件&#x2F;脚本清单</li>\n</ul>\n</li>\n<li>保证任何时候数据在 24 小时内可通过登录账户 + 同步脚本 + 手动恢复操作，实现完整数据还原。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"备份设备\"><a href=\"#备份设备\" class=\"headerlink\" title=\"备份设备\"></a>备份设备</h3><h4 id=\"本地\"><a href=\"#本地\" class=\"headerlink\" title=\"本地\"></a>本地</h4><ul>\n<li>手机</li>\n<li>电脑</li>\n<li>软路由</li>\n<li>U盘</li>\n</ul>\n<h4 id=\"云端\"><a href=\"#云端\" class=\"headerlink\" title=\"云端\"></a>云端</h4><ul>\n<li>夸克网盘</li>\n<li>坚果云（免费轻量云端Webdav）</li>\n<li>谷歌相册</li>\n<li>一刻相册</li>\n</ul>\n<h2 id=\"备份内容类别\"><a href=\"#备份内容类别\" class=\"headerlink\" title=\"备份内容类别\"></a>备份内容类别</h2><ul>\n<li>照片&#x2F;视频</li>\n<li>影视</li>\n<li>音乐</li>\n<li>代码工作区</li>\n<li>QQ&#x2F;微信聊天记录</li>\n<li>浏览器书签</li>\n<li>椒盐笔记</li>\n<li>文档素材</li>\n<li>虚拟机</li>\n<li>密码管理器</li>\n<li>输入法词库</li>\n</ul>\n<h3 id=\"照片-视频\"><a href=\"#照片-视频\" class=\"headerlink\" title=\"照片&#x2F;视频\"></a><strong>照片&#x2F;视频</strong></h3><ul>\n<li><strong>云端</strong>：Google Photos（免费原图备份，已启用）+ 一刻相册。</li>\n<li><strong>本地</strong>：暂缓，后续可考虑NAS+易有云。</li>\n</ul>\n<h4 id=\"🧐-为什么选择-Google-Photos-一刻相册作为主力云端备份方案？\"><a href=\"#🧐-为什么选择-Google-Photos-一刻相册作为主力云端备份方案？\" class=\"headerlink\" title=\"🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？\"></a>🧐 为什么选择 Google Photos + 一刻相册作为主力云端备份方案？</h4><h5 id=\"✅-1-Google-Photos（谷歌相册）\"><a href=\"#✅-1-Google-Photos（谷歌相册）\" class=\"headerlink\" title=\"✅ 1. Google Photos（谷歌相册）\"></a>✅ 1. Google Photos（谷歌相册）</h5><ul>\n<li><p>我已搭建软路由，家中设备默认处于“魔法环境”，<strong>Google Photos 可实现无感自动同步</strong>。</p>\n</li>\n<li><p><strong>优点</strong>：</p>\n<ul>\n<li><strong>无限容量优势</strong>：Google 官方承诺 <strong>Pixel 1 机型享有永久、无损、无限量照片与视频备份</strong>。</li>\n<li><strong>技术绕过可实现“伪Pixel”特权</strong>：通过 Root 的手机设备 + Magisk 模块，可模拟为 Pixel 1，激活无限备份策略。</li>\n<li><strong>自动分类、搜索强大</strong>：Google Photos 提供 <strong>AI 智能识别、人脸聚合、地图定位、关键词搜索</strong> 等强大功能，方便管理海量照片。</li>\n</ul>\n</li>\n<li><p><strong>缺点</strong>：</p>\n<ul>\n<li>Google 在中国大陆无法直接访问，<strong>必须依赖稳定 VPN 或旁路代理环境</strong>。</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"✅-2-一刻相册（作为国产补充方案）\"><a href=\"#✅-2-一刻相册（作为国产补充方案）\" class=\"headerlink\" title=\"✅ 2. 一刻相册（作为国产补充方案）\"></a>✅ 2. 一刻相册（作为国产补充方案）</h5><ul>\n<li><strong>优点</strong>：<ul>\n<li>理论无限空间、界面友好。</li>\n<li>适合中国用户使用。</li>\n</ul>\n</li>\n<li><strong>缺点</strong>：<ul>\n<li>备份大视频、批量恢复需开通会员。</li>\n<li>卡顿，使用体验并不好，自动备份实测耗电情况严重。</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"✅-3-本地备份（未来补充方案）\"><a href=\"#✅-3-本地备份（未来补充方案）\" class=\"headerlink\" title=\"✅ 3. 本地备份（未来补充方案）\"></a>✅ 3. 本地备份（未来补充方案）</h5><ul>\n<li>本地方案，计划后续部署 <strong>NAS + 易有云</strong> 搭建家庭私有云，实现本地备份、快速访问和远程同步。</li>\n<li>配合 Google Photos 可形成「冷 + 热备份」组合，提高数据安全性和可恢复性。</li>\n</ul>\n<hr>\n<h3 id=\"🎬-影视\"><a href=\"#🎬-影视\" class=\"headerlink\" title=\"🎬 影视\"></a>🎬 影视</h3><h4 id=\"☁️-云端备份策略\"><a href=\"#☁️-云端备份策略\" class=\"headerlink\" title=\"☁️ 云端备份策略\"></a>☁️ 云端备份策略</h4><ul>\n<li><strong>115 网盘</strong>（主力推荐）<ul>\n<li>✅ 稳定性高，上传&#x2F;下载&#x2F;播放速度极佳。</li>\n<li>✅ 支持 WebDAV 协议，可被 Jellyfin、Infuse、nPlayer 等播放器远程挂载使用。</li>\n<li>✅ 支持在线播放，大视频兼容性强。</li>\n<li>⚠️ <strong>需付费会员才能正常使用</strong>，非会员限速严重，功能大幅受限。</li>\n<li>⚠️ 分享功能有限制，建议搭配 AList 或其他工具使用。</li>\n</ul>\n</li>\n<li><strong>天翼云盘</strong>（适合电信用户）<ul>\n<li>✅ <strong>永久免费扩容活动多</strong>（绑定手机号后空间可达 6TB+）。</li>\n<li>✅ 上传&#x2F;下载速度快，支持自动备份监控文件夹。</li>\n<li>✅ 适合作为长期备份盘，配合自动化工具使用更佳。</li>\n<li>⚠️ 播放器兼容性一般，不支持 WebDAV，适合作为存储盘而非播放源。</li>\n</ul>\n</li>\n<li><strong>移动云盘</strong>（适合移动用户）<ul>\n<li>✅ 与天翼云盘类似，用户活跃度高时也有较大空间赠送。</li>\n<li>✅ 上传&#x2F;下载体验不错，适合作为副备份盘。</li>\n<li>⚠️ 播放体验一般，不支持 WebDAV。</li>\n</ul>\n</li>\n<li><strong>夸克网盘</strong>（次级推荐）<ul>\n<li>✅ 支持在线播放、AI字幕识别、自动分类等功能。</li>\n<li>✅ 可通过淘宝88VIP（88元&#x2F;年）获得夸克会员，<strong>相当于“白嫖”会员体验</strong>。</li>\n<li>⚠️ 免费用户限速严重，长时间使用必须配合会员。</li>\n<li>⚠️ 分享和下载频率受限，适合当临时备份盘。</li>\n</ul>\n</li>\n<li><strong>123 网盘</strong>（备用方案）<ul>\n<li>✅ 上传&#x2F;下载&#x2F;在线播放体验优秀，客户端简洁无广告。</li>\n<li>✅ 分享功能较开放，支持大文件外链。</li>\n<li>✅ 官方有 Web API 支持，可接入 AList 或自建下载脚本。</li>\n<li>⚠️ <strong>无会员使用体验较差</strong>，限速较严重，上传大文件基本不可行。</li>\n<li>⚠️ 存储安全性有待考察，<strong>适合短期转存或资源中转</strong>。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-聚合播放方案：小雅-AList\"><a href=\"#🧩-聚合播放方案：小雅-AList\" class=\"headerlink\" title=\"🧩 聚合播放方案：小雅 AList\"></a>🧩 聚合播放方案：小雅 AList</h4><ul>\n<li>AList 是聚合网盘的 Web 文件浏览器，可统一访问多个云盘资源。</li>\n<li>支持网盘包括：<strong>阿里云盘、115、123、坚果云、天翼云盘（部分支持）、WebDAV、自建服务等</strong>。</li>\n<li>可配置为 WebDAV 网关，与 Jellyfin、Infuse、Kodi、nPlayer 等播放器联动使用，实现局域网或远程无感播放。</li>\n<li>推荐搭配方案：<ul>\n<li>小雅 AList 公共节点（alist.xiaoya.pro）→ 挂载 115 &#x2F; 123 网盘 → Infuse &#x2F; nPlayer 播放器观看。</li>\n<li>自建 AList 实例（Docker &#x2F; 本地）+ Token 授权更安全稳定。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🖥️-本地方案规划：Jellyfin-NAS（后续）\"><a href=\"#🖥️-本地方案规划：Jellyfin-NAS（后续）\" class=\"headerlink\" title=\"🖥️ 本地方案规划：Jellyfin + NAS（后续）\"></a>🖥️ 本地方案规划：Jellyfin + NAS（后续）</h4><p>虽然当前未考虑，但未来部署仍具备价值，作为云端存储的<strong>本地冷备+家庭影院</strong>方案：</p>\n<ul>\n<li><strong>Jellyfin</strong>：免费开源媒体中心，自动整理影视资源，支持多平台客户端。</li>\n<li><strong>NAS（当前为软路由）</strong>：集中存储、远程访问、播放高清无压力。</li>\n<li><strong>自动化工具搭配</strong>：<ul>\n<li><code>rclone</code> 同步网盘内容至本地。</li>\n<li><code>aria2 / qBittorrent</code> 搭建自动下载中心。</li>\n<li>AList + Jellyfin 构建本地 + 云端混合播放环境。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"📊-云盘对比汇总（影视适用性）\"><a href=\"#📊-云盘对比汇总（影视适用性）\" class=\"headerlink\" title=\"📊 云盘对比汇总（影视适用性）\"></a>📊 云盘对比汇总（影视适用性）</h4><table>\n<thead>\n<tr>\n<th>云盘平台</th>\n<th>是否限速</th>\n<th>播放支持</th>\n<th>WebDAV 支持</th>\n<th>是否需要会员</th>\n<th>适合场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>115 网盘</strong></td>\n<td>免费限速，会员不限</td>\n<td>✅ 强</td>\n<td>✅（需配置）</td>\n<td><strong>需要付费</strong></td>\n<td>主力备份 + 播放 + AList挂载</td>\n</tr>\n<tr>\n<td><strong>天翼云盘</strong></td>\n<td>不限速</td>\n<td>一般</td>\n<td>❌</td>\n<td><strong>免费</strong></td>\n<td>大容量备份（电信优选）</td>\n</tr>\n<tr>\n<td><strong>移动云盘</strong></td>\n<td>不限速</td>\n<td>一般</td>\n<td>❌</td>\n<td><strong>免费</strong></td>\n<td>大容量备份（移动用户）</td>\n</tr>\n<tr>\n<td><strong>夸克网盘</strong></td>\n<td>免费限速，会员快</td>\n<td>✅ 中等</td>\n<td>❌</td>\n<td><strong>88VIP 白嫖会员</strong></td>\n<td>临时转存 &#x2F; 播放</td>\n</tr>\n<tr>\n<td><strong>123 网盘</strong></td>\n<td>免费限速，会员快</td>\n<td>✅ 中等</td>\n<td>⚠️（API 或绕过）</td>\n<td><strong>基本需付费</strong></td>\n<td>中转下载 &#x2F; 资源分享</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"音乐\"><a href=\"#音乐\" class=\"headerlink\" title=\"音乐\"></a>音乐</h3><p><strong>本地</strong>：当前占用约10GB，统一存放于固定路径（<code>E:/音乐/</code>），冷备份至U盘及软路由存储中，确保本地多设备冗余。</p>\n<ul>\n<li><strong>本地播放&#x2F;管理方案</strong>：采用 <strong>Navidrome + NAS</strong> 组合或 <strong>Jellyfin + NAS</strong>，搭建私人音乐服务器，实现跨设备在线播放、管理和元数据同步。<ul>\n<li><strong>Navidrome</strong>：轻量级音乐服务器，支持多用户、Web和手机客户端，兼容多种音频格式，适合个人或小团队使用。</li>\n<li><strong>Jellyfin</strong>：功能更强大，支持多媒体统一管理（音乐、电影、电视），支持DLNA、Chromecast等多种播放协议，适合更丰富的多媒体需求。</li>\n</ul>\n</li>\n</ul>\n<p><strong>云端同步</strong>：</p>\n<ul>\n<li>夸克网盘：启用“同步文件夹”功能，将<code>D:/Music/</code>设为同步目录热备份（需确保夸克客户端常驻后台）。</li>\n</ul>\n<p><strong>歌单与播放列表管理</strong>：</p>\n<ul>\n<li>使用 <strong>歌单无界</strong> 等工具，能有效匹配和同步歌单排序，实现云端与本地播放列表的无缝衔接，避免歌单乱序问题，提升听歌体验。</li>\n</ul>\n<h4 id=\"🧐-为什么选择夸克网盘作为音乐备份平台？\"><a href=\"#🧐-为什么选择夸克网盘作为音乐备份平台？\" class=\"headerlink\" title=\"🧐 为什么选择夸克网盘作为音乐备份平台？\"></a>🧐 为什么选择夸克网盘作为音乐备份平台？</h4><h5 id=\"✅-多平台支持，使用体验优秀\"><a href=\"#✅-多平台支持，使用体验优秀\" class=\"headerlink\" title=\"✅ 多平台支持，使用体验优秀\"></a>✅ 多平台支持，使用体验优秀</h5><ul>\n<li>支持 <strong>Android &#x2F; iOS &#x2F; Web &#x2F; Windows &#x2F; Mac</strong> 等主流平台。</li>\n<li>无论是手机、平板、电脑均可便捷访问、播放与下载音频文件。</li>\n<li>网页端支持50MB以内单文件下载，<strong>无需额外客户端</strong>。</li>\n</ul>\n<h5 id=\"✅-存储空间充足，价格极低\"><a href=\"#✅-存储空间充足，价格极低\" class=\"headerlink\" title=\"✅ 存储空间充足，价格极低\"></a>✅ 存储空间充足，价格极低</h5><ul>\n<li><p>通过 <strong>88VIP 赠送的夸克会员权益（价值5元一年）</strong>，可获得至少 <strong>6TB 超大云盘容量</strong>。</p>\n</li>\n<li><p>适合长期保存大量高质量无损音乐、专辑、母带文件。</p>\n</li>\n<li><p><strong>性价比极高</strong>，几乎免费获得专业级云盘体验。</p>\n</li>\n</ul>\n<h5 id=\"✅-上传-下载速度优秀\"><a href=\"#✅-上传-下载速度优秀\" class=\"headerlink\" title=\"✅ 上传&#x2F;下载速度优秀\"></a>✅ 上传&#x2F;下载速度优秀</h5><ul>\n<li>会员上传、下载稳定在 <strong>50MB&#x2F;s 以上</strong>，支持单文件最大100GB上传。</li>\n<li>支持断点续传，保障长时间上传的稳定性。</li>\n</ul>\n<h5 id=\"✅-原文件存储，不转码不压缩\"><a href=\"#✅-原文件存储，不转码不压缩\" class=\"headerlink\" title=\"✅ 原文件存储，不转码不压缩\"></a>✅ 原文件存储，不转码不压缩</h5><ul>\n<li>音频文件 <strong>不会被转码或重命名</strong>，保留完整元数据。</li>\n<li>适合储存音乐资料库、专辑封面、歌词、Cue 文件等文件结构较复杂的音乐归档。</li>\n</ul>\n<h5 id=\"✅-文件结构清晰，支持批量管理\"><a href=\"#✅-文件结构清晰，支持批量管理\" class=\"headerlink\" title=\"✅ 文件结构清晰，支持批量管理\"></a>✅ 文件结构清晰，支持批量管理</h5><ul>\n<li>支持自定义目录层级，如 <code>音乐归档/无损合集/年代/艺术家/</code>，便于分类和查找。</li>\n<li>PC客户端支持拖拽和批量上传，简化管理流程。</li>\n<li>支持文件重命名规则插件，保持命名规范。</li>\n</ul>\n<h5 id=\"✅-分享与恢复便捷\"><a href=\"#✅-分享与恢复便捷\" class=\"headerlink\" title=\"✅ 分享与恢复便捷\"></a>✅ 分享与恢复便捷</h5><ul>\n<li>支持生成带有效期的分享链接，方便与朋友共享音乐。</li>\n<li>设备更换或损坏后，登录账号即可无缝恢复全库，免除手动迁移烦恼。</li>\n</ul>\n<hr>\n<h3 id=\"代码工作区（F-Workspace-）\"><a href=\"#代码工作区（F-Workspace-）\" class=\"headerlink\" title=\"代码工作区（F:/Workspace/）\"></a>代码工作区（<code>F:/Workspace/</code>）</h3><h4 id=\"本地备份\"><a href=\"#本地备份\" class=\"headerlink\" title=\"本地备份\"></a>本地备份</h4><h5 id=\"当前状态\"><a href=\"#当前状态\" class=\"headerlink\" title=\"当前状态\"></a>当前状态</h5><ul>\n<li>主要代码工作区位于F盘本地磁盘。</li>\n</ul>\n<h5 id=\"未来规划\"><a href=\"#未来规划\" class=\"headerlink\" title=\"未来规划\"></a>未来规划</h5><ul>\n<li>计划部署 <strong>NAS 设备</strong>，实现自动定时快照和备份。</li>\n<li>NAS结合版本控制或增量备份方案，可大幅提升数据安全性和多设备访问便利。</li>\n</ul>\n<h4 id=\"云端同步\"><a href=\"#云端同步\" class=\"headerlink\" title=\"云端同步\"></a>云端同步</h4><h5 id=\"Git-GitHub-私有仓库（适合核心代码版本控制）\"><a href=\"#Git-GitHub-私有仓库（适合核心代码版本控制）\" class=\"headerlink\" title=\"Git + GitHub 私有仓库（适合核心代码版本控制）\"></a>Git + GitHub 私有仓库（适合核心代码版本控制）</h5><h6 id=\"注册与创建仓库\"><a href=\"#注册与创建仓库\" class=\"headerlink\" title=\"注册与创建仓库\"></a>注册与创建仓库</h6><ul>\n<li>注册GitHub账号（<a href=\"https://github.com/%EF%BC%89%E3%80%82\">https://github.com/）。</a></li>\n<li>创建私有仓库（例如 <code>my-workspace</code>）。</li>\n<li><strong>创建时避免勾选“Initialize with README”</strong>，防止初始化文件与本地冲突。</li>\n</ul>\n<h6 id=\"初始化本地仓库并关联远程\"><a href=\"#初始化本地仓库并关联远程\" class=\"headerlink\" title=\"初始化本地仓库并关联远程\"></a>初始化本地仓库并关联远程</h6><ul>\n<li><p>在目标项目目录（如<code>F:/Workspace/project1/</code>）打开 <strong>Git Bash Here</strong>，依次执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git remote add origin https://github.com/你的用户名/my-workspace.git</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;Initial commit&quot;</span></span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"日常更新流程\"><a href=\"#日常更新流程\" class=\"headerlink\" title=\"日常更新流程\"></a>日常更新流程</h6><ul>\n<li><p>每次代码修改完成后，执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;简短描述本次修改&quot;</span></span><br><span class=\"line\">git push</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"多设备恢复\"><a href=\"#多设备恢复\" class=\"headerlink\" title=\"多设备恢复\"></a>多设备恢复</h6><ul>\n<li><p>在新设备或工作环境，执行克隆操作：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/你的用户名/my-workspace.git</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"建议辅助工具\"><a href=\"#建议辅助工具\" class=\"headerlink\" title=\"建议辅助工具\"></a>建议辅助工具</h6><ul>\n<li>推荐使用 VSCode 等支持Git的编辑器，内置Git插件使操作更直观便捷。</li>\n</ul>\n<h6 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h6><ul>\n<li>避免提交大文件或敏感信息。</li>\n<li>可通过 <code>.gitignore</code> 文件排除不需要同步的文件。</li>\n</ul>\n<h5 id=\"夸克网盘（适合非版本控制的备份）\"><a href=\"#夸克网盘（适合非版本控制的备份）\" class=\"headerlink\" title=\"夸克网盘（适合非版本控制的备份）\"></a>夸克网盘（适合非版本控制的备份）</h5><h6 id=\"适用范围\"><a href=\"#适用范围\" class=\"headerlink\" title=\"适用范围\"></a>适用范围</h6><ul>\n<li>备份无需版本控制的代码副本、资料文件、配置文件或二进制资源。</li>\n</ul>\n<h6 id=\"备份方法\"><a href=\"#备份方法\" class=\"headerlink\" title=\"备份方法\"></a>备份方法</h6><ul>\n<li>在夸克网盘创建同步文件夹（如 <code>Workspace_Backup</code>）。</li>\n<li>将本地目录 <code>F:/Workspace/</code> 拖入同步文件夹，实现自动热备份。</li>\n<li>保证夸克客户端常驻后台以确保同步稳定及时。</li>\n</ul>\n<h4 id=\"补充建议\"><a href=\"#补充建议\" class=\"headerlink\" title=\"补充建议\"></a>补充建议</h4><h5 id=\"自动备份脚本\"><a href=\"#自动备份脚本\" class=\"headerlink\" title=\"自动备份脚本\"></a>自动备份脚本</h5><ul>\n<li>可编写定时任务脚本，自动复制代码工作区至NAS或备份目录。</li>\n<li>结合增量备份工具，如Linux的 <code>rsync</code>，Windows下推荐使用 <code>DeltaCopy</code>，提高备份效率。</li>\n</ul>\n<h5 id=\"多版本备份策略\"><a href=\"#多版本备份策略\" class=\"headerlink\" title=\"多版本备份策略\"></a>多版本备份策略</h5><ul>\n<li>利用Git的版本管理优势管理代码历史。</li>\n<li>结合NAS快照功能，实现数据误删、误覆盖的快速恢复。</li>\n</ul>\n<h5 id=\"安全性建议\"><a href=\"#安全性建议\" class=\"headerlink\" title=\"安全性建议\"></a>安全性建议</h5><ul>\n<li>私有仓库不宜存储明文密码或敏感密钥。</li>\n<li>建议使用环境变量或专门的安全管理工具处理敏感信息。</li>\n</ul>\n<hr>\n<h3 id=\"QQ-微信聊天记录\"><a href=\"#QQ-微信聊天记录\" class=\"headerlink\" title=\"QQ&#x2F;微信聊天记录\"></a>QQ&#x2F;微信聊天记录</h3><h4 id=\"手机-→-电脑备份\"><a href=\"#手机-→-电脑备份\" class=\"headerlink\" title=\"手机 → 电脑备份\"></a>手机 → 电脑备份</h4><h5 id=\"微信备份\"><a href=\"#微信备份\" class=\"headerlink\" title=\"微信备份\"></a>微信备份</h5><ul>\n<li>通过电脑版微信“备份与恢复”功能，连接手机和电脑，选择“备份聊天记录至电脑”操作（需同一局域网）。</li>\n<li>可备份聊天文本、图片、语音等内容，需手动操作。</li>\n</ul>\n<h5 id=\"QQ备份\"><a href=\"#QQ备份\" class=\"headerlink\" title=\"QQ备份\"></a>QQ备份</h5><ul>\n<li>进入手机QQ“设置 → 通用 → 聊天记录备份与恢复”，选择“备份聊天记录到电脑QQ”，手机与电脑需联网且在同一网络。</li>\n</ul>\n<h4 id=\"电脑-→-本地存储\"><a href=\"#电脑-→-本地存储\" class=\"headerlink\" title=\"电脑 → 本地存储\"></a>电脑 → 本地存储</h4><h5 id=\"默认存储路径\"><a href=\"#默认存储路径\" class=\"headerlink\" title=\"默认存储路径\"></a>默认存储路径</h5><ul>\n<li>微信聊天记录路径为：<br> <code>C:/Users/&lt;用户名&gt;/Documents/WeChat Files/&lt;微信号&gt;/</code></li>\n<li>QQ聊天记录路径为：<br> <code>C:/Users/&lt;用户名&gt;/Documents/Tencent Files/&lt;QQ号&gt;/</code></li>\n</ul>\n<h5 id=\"备份文件管理\"><a href=\"#备份文件管理\" class=\"headerlink\" title=\"备份文件管理\"></a>备份文件管理</h5><ul>\n<li>建议定期将聊天记录目录压缩成 <code>DataBackup.zip</code> 方便管理和迁移。</li>\n<li>压缩包可存储于U盘、NAS或上传至云盘（如夸克网盘）实现多重备份。</li>\n</ul>\n<h4 id=\"Root手机完整备份（推荐第三方工具“数据备份”）\"><a href=\"#Root手机完整备份（推荐第三方工具“数据备份”）\" class=\"headerlink\" title=\"Root手机完整备份（推荐第三方工具“数据备份”）\"></a>Root手机完整备份（推荐第三方工具“数据备份”）</h4><h5 id=\"为什么推荐“数据备份”\"><a href=\"#为什么推荐“数据备份”\" class=\"headerlink\" title=\"为什么推荐“数据备份”\"></a>为什么推荐“数据备份”</h5><ul>\n<li>经多次测试，手机官方微信和QQ备份功能<strong>容易遗漏大量图片和视频</strong>，导致备份不完整。</li>\n<li>“数据备份”作为Root权限工具，能<strong>完整导出所有QQ和微信数据</strong>，包括聊天记录、图片、视频、数据库和缓存文件。</li>\n</ul>\n<h5 id=\"备份流程\"><a href=\"#备份流程\" class=\"headerlink\" title=\"备份流程\"></a>备份流程</h5><ul>\n<li>在Root的手机设备上运行“数据备份”软件，进行完整数据导出。</li>\n<li>备份数据压缩成 <code>DataBackup.zip</code> 文件，方便保存与传输。</li>\n<li>上传压缩文件到夸克网盘或其他云盘，实现安全、长期存储。</li>\n</ul>\n<h5 id=\"优势说明\"><a href=\"#优势说明\" class=\"headerlink\" title=\"优势说明\"></a>优势说明</h5><ul>\n<li>该备份方式全面且数据完整，适合设备更换、系统重装时恢复使用。</li>\n<li>极大减少因官方备份功能不足造成的数据丢失风险。</li>\n</ul>\n<h4 id=\"自动化备份建议\"><a href=\"#自动化备份建议\" class=\"headerlink\" title=\"自动化备份建议\"></a>自动化备份建议</h4><h5 id=\"Windows定时压缩\"><a href=\"#Windows定时压缩\" class=\"headerlink\" title=\"Windows定时压缩\"></a>Windows定时压缩</h5><ul>\n<li>利用任务计划结合批处理脚本，定期压缩本地聊天记录文件夹，减轻手动备份负担。</li>\n</ul>\n<h5 id=\"多层备份架构\"><a href=\"#多层备份架构\" class=\"headerlink\" title=\"多层备份架构\"></a>多层备份架构</h5><ul>\n<li>结合软路由与NAS，定期同步聊天数据，实现本地与网络的多层冗余备份。</li>\n</ul>\n<h4 id=\"安全与隐私\"><a href=\"#安全与隐私\" class=\"headerlink\" title=\"安全与隐私\"></a>安全与隐私</h4><h5 id=\"数据加密\"><a href=\"#数据加密\" class=\"headerlink\" title=\"数据加密\"></a>数据加密</h5><ul>\n<li>聊天记录包含个人隐私，建议使用7-Zip等工具对压缩包设置密码保护。</li>\n</ul>\n<h5 id=\"云盘权限控制\"><a href=\"#云盘权限控制\" class=\"headerlink\" title=\"云盘权限控制\"></a>云盘权限控制</h5><ul>\n<li>上传云盘后，务必设置访问权限，避免数据泄露风险。</li>\n</ul>\n<h5 id=\"Root权限风险\"><a href=\"#Root权限风险\" class=\"headerlink\" title=\"Root权限风险\"></a>Root权限风险</h5><ul>\n<li>Root操作存在一定风险，务必保证备份工具来源正规可靠。</li>\n</ul>\n<h4 id=\"恢复方法\"><a href=\"#恢复方法\" class=\"headerlink\" title=\"恢复方法\"></a>恢复方法</h4><h5 id=\"官方恢复途径\"><a href=\"#官方恢复途径\" class=\"headerlink\" title=\"官方恢复途径\"></a>官方恢复途径</h5><ul>\n<li>电脑版微信和QQ支持“备份与恢复”功能，可恢复聊天记录（需确保备份文件完整且版本匹配）。</li>\n</ul>\n<h5 id=\"Root备份恢复\"><a href=\"#Root备份恢复\" class=\"headerlink\" title=\"Root备份恢复\"></a>Root备份恢复</h5><ul>\n<li>需借助相应的手机恢复工具，将完整备份数据导入手机，恢复聊天内容、图片和视频。</li>\n</ul>\n<h5 id=\"手动恢复\"><a href=\"#手动恢复\" class=\"headerlink\" title=\"手动恢复\"></a>手动恢复</h5><ul>\n<li>关闭对应客户端后，手动复制聊天记录文件夹到原路径，实现基础数据恢复。</li>\n</ul>\n<hr>\n<h3 id=\"浏览器书签（Chrome）\"><a href=\"#浏览器书签（Chrome）\" class=\"headerlink\" title=\"浏览器书签（Chrome）\"></a>浏览器书签（Chrome）</h3><ul>\n<li><strong>本地备份</strong>：可通过 Chrome 自带的导出功能，定期导出为 <code>.html</code> 文件保存到本地。</li>\n<li><strong>云端同步</strong>：<ul>\n<li>使用 <strong>Floccus 浏览器插件</strong>，配置 WebDAV（推荐坚果云）后，可实现自动同步浏览器书签到云端。</li>\n<li>也可手动导出书签 <code>.html</code> 文件，存入夸克网盘等云服务。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧐-为什么选择坚果云作为同步平台？\"><a href=\"#🧐-为什么选择坚果云作为同步平台？\" class=\"headerlink\" title=\"🧐 为什么选择坚果云作为同步平台？\"></a>🧐 为什么选择坚果云作为同步平台？</h4><h5 id=\"✅-完全支持-WebDAV-协议\"><a href=\"#✅-完全支持-WebDAV-协议\" class=\"headerlink\" title=\"✅ 完全支持 WebDAV 协议\"></a>✅ 完全支持 WebDAV 协议</h5><ul>\n<li>坚果云提供长期稳定的 WebDAV 接口。</li>\n<li>与 Floccus 等插件完美兼容，无需额外脚本或服务端配置。</li>\n</ul>\n<h5 id=\"✅-安装简便、自动同步\"><a href=\"#✅-安装简便、自动同步\" class=\"headerlink\" title=\"✅ 安装简便、自动同步\"></a>✅ 安装简便、自动同步</h5><ul>\n<li>配置一次即可后台自动同步书签文件，无需手动导出。</li>\n<li>支持多浏览器、多设备自动保持书签一致。</li>\n</ul>\n<h5 id=\"✅-空间充足，传输速度快\"><a href=\"#✅-空间充足，传输速度快\" class=\"headerlink\" title=\"✅ 空间充足，传输速度快\"></a>✅ 空间充足，传输速度快</h5><ul>\n<li>免费版即提供 1GB 存储，书签数据占用极小。</li>\n<li>中国大陆服务器，上传&#x2F;同步速度快、延迟低。</li>\n</ul>\n<h5 id=\"✅-安全性强\"><a href=\"#✅-安全性强\" class=\"headerlink\" title=\"✅ 安全性强\"></a>✅ 安全性强</h5><ul>\n<li><p>传输使用 HTTPS 加密。</p>\n</li>\n<li><p>可为 Floccus 单独生成 <strong>应用专用授权码</strong>：</p>\n<blockquote>\n<p>即便泄露也可随时吊销，确保主账户安全。</p>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-第一步：注册坚果云并启用-WebDAV-功能\"><a href=\"#🧩-第一步：注册坚果云并启用-WebDAV-功能\" class=\"headerlink\" title=\"🧩 第一步：注册坚果云并启用 WebDAV 功能\"></a>🧩 第一步：注册坚果云并启用 WebDAV 功能</h4><ol>\n<li>访问官网：<a href=\"https://www.jianguoyun.com/\">https://www.jianguoyun.com</a></li>\n<li>注册新账户（推荐使用邮箱）</li>\n<li>登录后，进入「设置」页面 → 进入「<strong>第三方应用管理</strong>」</li>\n<li>点击「添加应用」→ 输入名称（如：Floccus 书签同步）</li>\n<li>系统生成一个「<strong>应用专用授权码</strong>」</li>\n</ol>\n<blockquote>\n<p>⚠️ 请妥善保存该授权码，稍后配置 WebDAV 时将用到</p>\n</blockquote>\n<hr>\n<h4 id=\"🌐-第二步：获取-WebDAV-配置信息\"><a href=\"#🌐-第二步：获取-WebDAV-配置信息\" class=\"headerlink\" title=\"🌐 第二步：获取 WebDAV 配置信息\"></a>🌐 第二步：获取 WebDAV 配置信息</h4><table>\n<thead>\n<tr>\n<th>参数</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>你的坚果云注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用专用授权码（非登录密码）</td>\n</tr>\n</tbody></table>\n<p><strong>注意！需要创建一个文件夹(如&#x2F;Bookmarks)</strong></p>\n<hr>\n<h4 id=\"🧩-第三步：在-Chrome-中配置-Floccus-插件\"><a href=\"#🧩-第三步：在-Chrome-中配置-Floccus-插件\" class=\"headerlink\" title=\"🧩 第三步：在 Chrome 中配置 Floccus 插件\"></a>🧩 第三步：在 Chrome 中配置 Floccus 插件</h4><ol>\n<li><p>前往 <a href=\"https://github.com/floccusaddon/floccus\">Github主页</a> 或<a href=\"https://floccus.org/\">软件官网</a>安装 <strong>Floccus</strong> 插件</p>\n</li>\n<li><p>安装后点击插件图标 → 选择「<strong>添加配置</strong>」→ 选择「<strong>WebDAV分享</strong>」</p>\n</li>\n<li><p>填写以下信息：</p>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>服务器地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>你的坚果云注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用专用授权码</td>\n</tr>\n<tr>\n<td>同步文件名</td>\n<td><code>/Bookmarks/bookmarks.html</code> 或默认设置</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>设置同步频率</p>\n</li>\n<li><p>成功后，你可以在坚果云的 <code>/bookmarks/</code> 路径中看到同步生成的 bookmarks.html 文件</p>\n</li>\n</ol>\n<hr>\n<h4 id=\"💾-第四步：恢复或迁移书签数据\"><a href=\"#💾-第四步：恢复或迁移书签数据\" class=\"headerlink\" title=\"💾 第四步：恢复或迁移书签数据\"></a>💾 第四步：恢复或迁移书签数据</h4><ol>\n<li>在新设备安装 Chrome 与 Floccus 插件</li>\n<li>使用相同 WebDAV 信息创建同步账户</li>\n<li>点击「Sync」按钮 → 即可从云端恢复书签数据</li>\n<li><strong>也可手动导入坚果云保存的bookmarks <code>.html</code> 文件</strong></li>\n</ol>\n<h3 id=\"椒盐笔记\"><a href=\"#椒盐笔记\" class=\"headerlink\" title=\"椒盐笔记\"></a>椒盐笔记</h3><ul>\n<li><strong>本地备份</strong>：已自动保存到手机<code>/Documents/SaltNote/</code>（确认路径无误）。</li>\n<li><strong>云端备份</strong>：<ul>\n<li>通过椒盐笔记的WebDAV功能备份到支持WebDAV的网盘（如坚果云、Nextcloud）。</li>\n<li>或手动定期导出Markdown文件到云盘（如夸克&#x2F;百度网盘）。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"🧐-为什么选择坚果云作为备份平台？\"><a href=\"#🧐-为什么选择坚果云作为备份平台？\" class=\"headerlink\" title=\"🧐 为什么选择坚果云作为备份平台？\"></a>🧐 为什么选择坚果云作为备份平台？</h4><h5 id=\"✅-完全支持-WebDAV-协议-1\"><a href=\"#✅-完全支持-WebDAV-协议-1\" class=\"headerlink\" title=\"✅ 完全支持 WebDAV 协议\"></a>✅ 完全支持 WebDAV 协议</h5><ul>\n<li>坚果云是国内极少数长期稳定支持 WebDAV 的云服务，兼容性好。</li>\n<li>与椒盐笔记等支持 WebDAV 的应用完美配合，几乎零配置可同步。</li>\n</ul>\n<h5 id=\"✅-免费也够用\"><a href=\"#✅-免费也够用\" class=\"headerlink\" title=\"✅ 免费也够用\"></a>✅ 免费也够用</h5><ul>\n<li>免费账户提供 <strong>1GB 空间</strong>，Markdown 纯文本笔记占用极小。</li>\n<li>同步数据流量极低，基本可实现<strong>长期免费使用</strong>。</li>\n</ul>\n<h5 id=\"✅-安全性高\"><a href=\"#✅-安全性高\" class=\"headerlink\" title=\"✅ 安全性高\"></a>✅ 安全性高</h5><ul>\n<li><p>全程 HTTPS 加密传输，支持两步验证。</p>\n</li>\n<li><p>支持每个应用生成独立的授权码：</p>\n<blockquote>\n<p>泄露后可随时吊销，不影响主账户安全。</p>\n</blockquote>\n</li>\n</ul>\n<h5 id=\"✅-服务稳定、速度优秀\"><a href=\"#✅-服务稳定、速度优秀\" class=\"headerlink\" title=\"✅ 服务稳定、速度优秀\"></a>✅ 服务稳定、速度优秀</h5><ul>\n<li>拥有中国大陆服务器，同步速度快、延迟低。</li>\n<li>多年稳定运营，无大规模中断记录。</li>\n</ul>\n<h5 id=\"✅-可拓展用途\"><a href=\"#✅-可拓展用途\" class=\"headerlink\" title=\"✅ 可拓展用途\"></a>✅ 可拓展用途</h5><ul>\n<li>除椒盐笔记，还可用于：<ul>\n<li>Obsidian、Joplin 等 WebDAV 应用</li>\n<li>FreeFileSync、rclone、Python 脚本工具等</li>\n<li>批量同步文档、PDF、代码片段等轻量资料</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h4 id=\"🧩-第一步：注册坚果云并启用-WebDAV-功能-1\"><a href=\"#🧩-第一步：注册坚果云并启用-WebDAV-功能-1\" class=\"headerlink\" title=\"🧩 第一步：注册坚果云并启用 WebDAV 功能\"></a>🧩 第一步：注册坚果云并启用 WebDAV 功能</h4><ol>\n<li><p>访问官网：<a href=\"https://www.jianguoyun.com/\">https://www.jianguoyun.com</a></p>\n</li>\n<li><p>点击「注册」，推荐使用邮箱注册账号</p>\n</li>\n<li><p>登录后，点击右上角头像 → 进入「设置」</p>\n</li>\n<li><p>打开「<strong>第三方应用管理</strong>」菜单</p>\n</li>\n<li><p>点击「添加应用」，输入自定义应用名（如：椒盐笔记备份）</p>\n</li>\n<li><p>系统生成一个「应用授权码」：</p>\n<blockquote>\n<p><strong>请复制并妥善保存</strong>，稍后配置 WebDAV 会使用</p>\n</blockquote>\n</li>\n</ol>\n<hr>\n<h4 id=\"🌐-第二步：获取-WebDAV-配置信息-1\"><a href=\"#🌐-第二步：获取-WebDAV-配置信息-1\" class=\"headerlink\" title=\"🌐 第二步：获取 WebDAV 配置信息\"></a>🌐 第二步：获取 WebDAV 配置信息</h4><ul>\n<li>WebDAV 地址：<code>https://dav.jianguoyun.com/dav/</code></li>\n<li>用户名：你的坚果云注册邮箱</li>\n<li>密码：上一步生成的「<strong>应用授权码</strong>」（<strong>不是登录密码</strong>）</li>\n</ul>\n<hr>\n<h4 id=\"📱-第三步：在椒盐笔记中配置-WebDAV-自动同步\"><a href=\"#📱-第三步：在椒盐笔记中配置-WebDAV-自动同步\" class=\"headerlink\" title=\"📱 第三步：在椒盐笔记中配置 WebDAV 自动同步\"></a>📱 第三步：在椒盐笔记中配置 WebDAV 自动同步</h4><ol>\n<li><p>打开椒盐笔记（SaltNote）App</p>\n</li>\n<li><p>点击右上角齿轮图标，进入设置页面</p>\n</li>\n<li><p>选择「<strong>WebDAV 同步</strong>」</p>\n</li>\n<li><p>填写以下信息：</p>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>地址</td>\n<td><code>https://dav.jianguoyun.com/dav/</code></td>\n</tr>\n<tr>\n<td>用户名</td>\n<td>注册邮箱</td>\n</tr>\n<tr>\n<td>密码</td>\n<td>应用授权码</td>\n</tr>\n<tr>\n<td>同步路径</td>\n<td>推荐使用 <code>/saltnote/</code>，网盘中将自动创建此目录</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>启用「自动同步」功能</p>\n</li>\n<li><p>第一次同步完成后，坚果云网页端将出现 <code>/saltnote/</code> 文件夹</p>\n<blockquote>\n<p>内含 <code>.md</code> 文件与 PepperNote 设置数据，后续将持续自动更新</p>\n</blockquote>\n</li>\n</ol>\n<hr>\n<h4 id=\"💾-第四步：恢复笔记数据流程（换手机-重装-App）\"><a href=\"#💾-第四步：恢复笔记数据流程（换手机-重装-App）\" class=\"headerlink\" title=\"💾 第四步：恢复笔记数据流程（换手机 &#x2F; 重装 App）\"></a>💾 第四步：恢复笔记数据流程（换手机 &#x2F; 重装 App）</h4><ol>\n<li><p>在新设备上安装椒盐笔记 App</p>\n</li>\n<li><p>进入设置 → WebDAV 同步，填写相同信息（地址、邮箱、授权码、路径）</p>\n</li>\n<li><p>等待连接成功</p>\n</li>\n<li><p>点击「设置 → 备份与恢复 → 恢复备份」</p>\n</li>\n<li><p>稍候几秒，历史笔记将自动恢复</p>\n<blockquote>\n<p>无需手动导入，云端会同步所有内容与配置</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"文档素材（E盘-F盘分散文件夹）\"><a href=\"#文档素材（E盘-F盘分散文件夹）\" class=\"headerlink\" title=\"文档素材（E盘/F盘分散文件夹）\"></a>文档素材（<code>E盘/F盘</code>分散文件夹）</h3><ul>\n<li><strong>本地备份</strong>：已存在原位置，考虑NAS。</li>\n<li><strong>云端同步</strong>：<ul>\n<li>夸克网盘：添加多个文件夹到同步列表（注意单个文件大小限制）。</li>\n<li>天翼云盘？</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"虚拟机（VMware）\"><a href=\"#虚拟机（VMware）\" class=\"headerlink\" title=\"虚拟机（VMware）\"></a>虚拟机（VMware）</h3><ul>\n<li><strong>备份建议</strong>：<ul>\n<li><strong>方案1</strong>：关闭VMware后，直接复制整个虚拟机文件夹（默认路径：<code>C:/Users/&lt;用户名&gt;/Documents/Virtual Machines/</code>），需包含<code>.vmx</code>（配置文件）和<code>.vmdk</code>（虚拟磁盘文件）。</li>\n<li><strong>方案2</strong>：VMware自带“快照”功能（临时备份，占用空间大）。</li>\n</ul>\n</li>\n<li><strong>推荐</strong>：每月一次完整备份+每周快照。</li>\n</ul>\n<h3 id=\"密码管理器\"><a href=\"#密码管理器\" class=\"headerlink\" title=\"密码管理器\"></a>密码管理器</h3><ul>\n<li><strong>推荐工具</strong>：<ul>\n<li><strong>Bitwarden</strong>（免费开源，支持WebDAV同步，加密备份到网盘）。</li>\n<li><strong>KeePassXC</strong>（本地存储，数据库文件可同步到云盘）。</li>\n</ul>\n</li>\n<li><strong>迁移建议</strong>：将微信收藏的密码整理到Bitwarden，启用自动填充功能。</li>\n</ul>\n<h3 id=\"百度输入法词库\"><a href=\"#百度输入法词库\" class=\"headerlink\" title=\"百度输入法词库\"></a>百度输入法词库</h3><ul>\n<li><strong>暂缓</strong>，但记录路径：<ul>\n<li>Windows：<code>%APPDATA%\\Baidu\\BaiduPinyin\\UserData\\</code>（如<code>C:/Users/&lt;用户名&gt;/AppData/Roaming/Baidu/BaiduPinyin/UserData/</code>）。</li>\n<li>备份时复制整个<code>UserData</code>文件夹。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"自动化工具整合\"><a href=\"#自动化工具整合\" class=\"headerlink\" title=\"自动化工具整合\"></a>自动化工具整合</h2><ol>\n<li><p><strong>FreeFileSync</strong>（核心工具）：</p>\n<ul>\n<li>配置任务：<ul>\n<li>同步<code>D:/Music/</code>→夸克网盘音乐文件夹。</li>\n<li>同步<code>F:/Workspace/</code>（非Git子文件夹）→夸克网盘代码文件夹。</li>\n<li>同步<code>E:/文档素材/</code>→夸克网盘文档文件夹。</li>\n</ul>\n</li>\n<li>设置定时任务（通过Windows任务计划程序每天触发）。</li>\n</ul>\n</li>\n<li><p><strong>插件&#x2F;脚本</strong>：</p>\n<ul>\n<li>Chrome书签：</li>\n<li>密码管理：迁移到Bitwarden并启用WebDAV同步。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"🛠-自动化备份与脚本整合\"><a href=\"#🛠-自动化备份与脚本整合\" class=\"headerlink\" title=\"🛠 自动化备份与脚本整合\"></a>🛠 自动化备份与脚本整合</h3><h4 id=\"🔄-自动化备份流程\"><a href=\"#🔄-自动化备份流程\" class=\"headerlink\" title=\"🔄 自动化备份流程\"></a>🔄 自动化备份流程</h4><p>为了实现备份的“无人值守、自动执行”，以下是推荐的自动化流程与工具：</p>\n<h5 id=\"✅-使用-FreeFileSync-Windows-任务计划程序-实现本地同步\"><a href=\"#✅-使用-FreeFileSync-Windows-任务计划程序-实现本地同步\" class=\"headerlink\" title=\"✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步\"></a>✅ 使用 FreeFileSync + Windows 任务计划程序 实现本地同步</h5><ol>\n<li><p>安装 FreeFileSync</p>\n</li>\n<li><p>新建“同步任务”（Batch Job），每个任务可指定如下内容：</p>\n<ul>\n<li>源文件夹 → 目标文件夹（如 <code>F:/Workspace/</code> → <code>夸克同步文件夹/Workspace/</code>）</li>\n<li>选择同步方式：<strong>镜像同步（Mirror）</strong> 或 <strong>更新同步（Update）</strong></li>\n<li>排除无关内容（如 <code>.git/</code>、临时文件夹、系统隐藏目录）</li>\n<li>勾选：同步后发送通知 &#x2F; 日志记录</li>\n<li>保存为 <code>.ffs_batch</code> 文件</li>\n</ul>\n</li>\n<li><p>打开 Windows“任务计划程序”：</p>\n<ul>\n<li><p>新建基本任务 → 设置触发时间（如“每天 9:00”）</p>\n</li>\n<li><p>动作选择“启动程序”，指向 FreeFileSync 的可执行文件，并附上参数：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FreeFileSync.exe &quot;C:\\路径\\to\\sync_task.ffs_batch&quot;</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p>重复以上步骤，可对多个同步项目（音乐、代码、文档）设定不同计划任务。</p>\n</li>\n<li><p>可勾选“开机自启 + 错过任务立即执行”选项，保障离线时也不会丢同步任务。</p>\n</li>\n</ol>\n<h5 id=\"✅-可选增强工具：Rclone-脚本\"><a href=\"#✅-可选增强工具：Rclone-脚本\" class=\"headerlink\" title=\"✅ 可选增强工具：Rclone + 脚本\"></a>✅ 可选增强工具：Rclone + 脚本</h5><ul>\n<li>对于不支持同步客户端的云平台（如坚果云 WebDAV），可使用 Rclone 工具进行自动同步：</li>\n</ul>\n<ol>\n<li><p>下载并配置 Rclone：<a href=\"https://rclone.org/downloads/\">https://rclone.org/downloads/</a></p>\n</li>\n<li><p>执行配置命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rclone config</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>输入 <code>n</code> 新建配置 → 输入名称（如 <code>jianguo</code>）</li>\n<li>类型选择 <code>WebDAV</code></li>\n<li>填入坚果云信息：地址、用户名（邮箱）、密码（应用授权码）</li>\n</ul>\n</li>\n<li><p>编写自动同步脚本 <code>saltnote_sync.bat</code>：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@echo off</span><br><span class=\"line\">rclone sync &quot;C:\\Users\\你的用户名\\Documents\\SaltNote&quot; jianguo:/saltnote/ --update --copy-links --log-file=sync.log</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>将脚本添加至“任务计划程序”，设定定时执行。</p>\n</li>\n<li><p>亦可设置为“系统启动时执行”。</p>\n</li>\n</ol>\n<h5 id=\"✅-脚本增强建议\"><a href=\"#✅-脚本增强建议\" class=\"headerlink\" title=\"✅ 脚本增强建议\"></a>✅ 脚本增强建议</h5><ul>\n<li><p>增加错误提示与日志保存功能（<code>--log-file</code>）</p>\n</li>\n<li><p>可配合 Telegram Bot 或邮件推送异常信息（需额外脚本集成）</p>\n</li>\n<li><p>添加网络检查逻辑，避免断网时执行失败：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping www.baidu.com -n 2</span><br><span class=\"line\">if errorlevel 1 exit</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"✅-汇总：当前自动备份任务表（建议表格打印）\"><a href=\"#✅-汇总：当前自动备份任务表（建议表格打印）\" class=\"headerlink\" title=\"✅ 汇总：当前自动备份任务表（建议表格打印）\"></a>✅ 汇总：当前自动备份任务表（建议表格打印）</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>工具&#x2F;平台</th>\n<th>同步频率</th>\n<th>同步方式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>音乐</td>\n<td>FreeFileSync + 夸克网盘</td>\n<td>每日</td>\n<td>本地 → 云端热备份</td>\n<td>夸克客户端需保持后台运行</td>\n</tr>\n<tr>\n<td>代码仓库</td>\n<td>GitHub</td>\n<td>实时</td>\n<td>Git push&#x2F;pull</td>\n<td>含版本控制</td>\n</tr>\n<tr>\n<td>代码文档</td>\n<td>FreeFileSync</td>\n<td>每日</td>\n<td>本地 → 夸克文件夹</td>\n<td>非Git部分直接同步</td>\n</tr>\n<tr>\n<td>椒盐笔记</td>\n<td>WebDAV (坚果云)</td>\n<td>实时</td>\n<td>App自动同步</td>\n<td>基于 WebDAV，免脚本</td>\n</tr>\n<tr>\n<td>文档资料</td>\n<td>FreeFileSync</td>\n<td>每日</td>\n<td>多路径同步</td>\n<td><code>E:/素材</code> → 夸克同步</td>\n</tr>\n<tr>\n<td>QQ&#x2F;微信备份</td>\n<td>手动导出 → 云盘</td>\n<td>每周</td>\n<td>Zip 压缩手动上传</td>\n<td>可用计划任务自动移动 + 上传</td>\n</tr>\n<tr>\n<td>虚拟机镜像</td>\n<td>手动拷贝</td>\n<td>每月</td>\n<td>拷贝整个目录</td>\n<td><code>.vmx</code> + <code>.vmdk</code> 需完整</td>\n</tr>\n</tbody></table>\n<h3 id=\"✅-后续可扩展方向\"><a href=\"#✅-后续可扩展方向\" class=\"headerlink\" title=\"✅ 后续可扩展方向\"></a>✅ 后续可扩展方向</h3><ol>\n<li>✅ 使用 Syncthing 实现跨设备局域网同步<ul>\n<li>将手机 &#x2F; 平板与 PC 形成自动同步</li>\n</ul>\n</li>\n<li>✅ 部署本地 NAS + 易有云<ul>\n<li>使用手机访问 NAS 内容 + 做本地冷备份</li>\n</ul>\n</li>\n<li>✅ 定期生成恢复文档&#x2F;索引清单<ul>\n<li>每月导出当前所有文件目录结构清单 <code>.tree</code></li>\n<li>生成存储路径快照，帮助恢复</li>\n</ul>\n</li>\n<li>✅ 加入异常提醒机制<ul>\n<li>如某路径三天无更新 → 通过 Telegram&#x2F;邮件提醒</li>\n<li>如某文件夹容量超过阈值 → 发出警报</li>\n</ul>\n</li>\n</ol>\n"},{"title":"网规论文","date":"2025-11-04T14:06:00.000Z","_content":"\n\n\n\n# 基于国产化设备的园区物联网建设方案研究\n# ——以某企业园区物联网建设为例\n## 摘要\n\n随着 5G、Wi-Fi 6/7 的发展，边缘计算与工业物联网迅速兴起，园区级物联网成为保障生产安全、提高运维效率与推进智能制造的关键基础设施。本文以 2023 年 3 月由本人牵头在某企业园区实施的物联网建设项目为例，系统阐述了政策背景与调研判断、分层网络与设备选型、存储与容灾备份策略，以及基于等保 2.0 的安全体制与信创兼容体系建设。工程采用国产化软硬件平台与虚拟化融合架构，安全体系覆盖物理、身份、准入、传输、审计与漏洞管理，SIEM/态势感知与 SOAR 联动实现主动防护。经联调与测试，项目于 2023 年 9 月顺利通过交付验收并投入运行；整体稳定，仅个别远端室外监测点的电源与光纤冗余需在后续建设中补强。本人作为本项目的网络规划与总体设计负责人，负责拓扑方案制定、信创兼容性验证及安全体系规划。\n\n## 正文\n\n### 引言：背景与政策支持与项目总体说明\n\n国家推动制造业智能化与信息化的政策导向， 为园区物联网建设提供了清晰指引。 自2015 年提出《中国制造2025》的智能制造愿景以 来， 政策体系持续深化： 工业和信息化部于 2016年发布《智能制造发展规划（2016—2020 年）》，并在此后数年密集出台配套文件，强调并着力推动工业互联网、5G、边缘计算及数据平台在制造业的深度融合与应用。且为保障产业链安全与供应链稳定，本项目经充分评估后，决定全面采用国产化设备，规避潜在断供风险。\n基于上述政策背景和企业数字化转型的内在需求，我单位于 2023 年 3 月立项开展园区物联网与网络升级改造工作。项目目标是通过国产化设备与分层架构，实现环境与设备的统一感知、生产过程的在线可视化、运维流程的自动化与合规审计能力，从而保障业务连续性并提升安全可控性，提升智能感知与数据决策能力。试点验证成功后，项目迅速推广至全园区，并于 2023 年 9 月完成交付验收并进入稳定运行阶段。\n\n### 调研与需求分析\n\n为保证设计方案切实满足业务需求并具备工程可落地性，项目前期历时约 3 周开展了系统调研工作，涵盖现场勘察、关键岗位访谈、历史故障与事故统计、网络与流量测量、射频扫描及安全评估等内容。\n（1）现网问题分析\n调研结果表明，现有园区网络架构陈旧、资源分配不均、安全能力不足，主要存在以下问题：\n老旧设备占比高（约 40%）：核心与汇聚设备仍为 2014 年前型号，无法支持 VXLAN、堆叠及能源管理模块，导致维护风险高、兼容性差、能耗大；\n链路利用率严重不均：部分生产区汇聚端口平均利用率长期低于 20%，而视频监控区端口峰值带宽利用率高达 95%，存在明显的带宽瓶颈与局部拥塞风险；\n无线信号盲区与同频干扰：射频扫描结果显示，厂区北区平均 RSSI −75 dBm 以下区域占比约 18%，部分高密环境存在同频干扰，影响终端漫游体验与稳定性；\n安全审计缺失：现网仅具备基础防火墙日志，缺乏终端准入、身份追溯与集中审计机制，无法满足等保 2.0 对访问控制与安全监测的要求。\n综上所述，系统性升级与重新规划势在必行，以支撑园区后续的智能制造与物联网业务发展。\n（2）业务与功能性需求\n结合园区业务特征与未来发展目标，主要需求集中在以下几个方面：\n生产与安全监测：需实现温湿度、烟感、漏水、粉尘等关键参数的实时采集、毫秒级上报与联动控制；\n设备可用性与实时控制：生产控制环节对时延、抖动和丢包敏感，需以有线方式保障稳定性；\n视频与带宽负载：高清视频回传与存储需高带宽与中心统一归档分级管理机制，以提升分析效率并降低成本；\n终端接入与安全合规：系统需承载万级传感器与千级移动终端并发接入，具备QoS优先级调度与无线侧快速漫游能力。\n合规与审计要求：满足等保2.0设计，包括设备身份认证、网络分区隔离、日志审计、态势感知等。\n据此确立总体设计思路为 “分层架构 + 混合接入 + 中心化治理 + 信创合规 + 等保防护”。\n\n### 设备选型与总体分层架构\n\n在明确总体建设思路后，项目在网络架构设计阶段遵循“分层、模块化与国产化优先”原则，形成了可扩展、可演进的园区物联网网络体系，具体架构如下：\n分层架构概览（实施情况）\n核心层采用两台华为 S12700E 系列设备作为园区核心交换机，配置双引擎、双电源、双交换版，实现单设备冗余，并通过 CSS2 实现控制与转发平面融合备份。任何一台设备出现故障都不影响业务正常运行，显著提升了网络可靠性，也简化网络管理。核心侧与数据中心互联采用双上行高可用设计，实现控制平面与数据平面的双机冗余，彻底消除核心单点故障。\n汇聚层采用华为 S6730-H 系列堆叠交换机，两两堆叠，通过多模光模块上行至核心层，构建 40G 高速骨干链路，从而在保持高带宽的同时实现多链路冗余。该设备还原生支持100G模块和VXLAN硬件转发能力，并保留丰富扩展槽位，支持未来带宽平滑升级与园区虚拟化扩展需求。\n接入层：接入交换机采用华为 S5735-S，支持PoE++（单端口90W），为 AP、摄像头与传感器提供电力与接入。接入交换机双上行到不同汇聚以避免单链路与单设备故障。考虑到不同区域需求，本次部署多种类型的无线AP。其中室外园区采用华为防护型 AP7060DN，具备防水防尘功能，适应室外恶劣环境，支持远距离覆盖；室内高密度会议室采用华为高密AP，配置智能天线，支持100人接入，能有效减少AP部署数量，防止同频干扰；室内小办公室采用墙面AP，保障每个角落信号无死角覆盖。厂区采用华为 AirEngine 6761‑22T 瘦 AP，该型号支持室内定位、资产盘点与 BLE 实时位置服务（RTLS），在物联网场景中支撑移动资产管理与人员定位。 并使用iMaster NCE‑WLAN 的 AC 功能对所有AP进行统一管理、配置下发，实现快速漫游与策略一致性,也能保障无线用户在整个园区网实现无缝漫游。\n边缘层部署 Huawei IoT Edge网关与FusionServer边缘计算节点。由边缘网关完成协议聚合、边缘节点统一由Atlas AI 模块，通过 iMaster NCE orchestrator 编排部署轻量化AI算法镜像，实现算力与任务调度的可视化管理 ，负责本地规则引擎与阈值告警，对视频流及传感信息时序流进行实时分析，识别安全生产风险事件（如人员闯入、未戴安全帽、烟火）与设备异常状态，确保本地检测毫秒级响应，并提取疑似异常特征数据，实时上传至中心平台进行深度AI分析，并在网络质量受限时，可保证本地事件上报的可靠排队与重发机制，确保极端网络中断下关键告警不丢失。\n该架构在保证“控制平面高可靠、数据平面高吞吐、管理平面可审计”的同时，通过虚拟化技术提升资源利用率，也为上层网络的虚拟化与精细化安全隔离提供了坚实的 Underlay 基础。并为未来园区的云边协同与AI推理提供良好支撑。\n\n### 存储选型与容灾备份策略\n\n为支撑园区海量的异构数据，存储方案的设计必须兼顾性能、成本、扩展性与数据安全。我们首先对项目核心数据类型进行了特征分析：\n视频录像：非结构化数据，容量大，写入频繁，读取较少，对成本敏感。\n系统日志：半结构化数据，持续生成，需支持快速检索与长期归档。\n物联传感数据：典型的时序数据，具备高并发写入、低延迟查询和高压缩比的特性。\n基于上述分析，并对比了 FC-SAN、iSCSI 等方案后，我们认为单一存储架构无法高效满足所有需求。因此，我们确立了“基于数据特性的分层混合存储”策略：\n针对视频与日志，采用华为 OceanStor NAS 与对象存储的组合。NAS 承载近期视频与热日志，提供高性价比的在线访问；对象存储则作为冷数据归档层，通过其优秀的扩展性和成本优势，满足长期留存（6个月以上）的合规要求。\n针对万级传感器毫秒级上报的并发压力，我们选用国产华为openGemini 高性能时序数据库存储。其高吞吐、低延迟的特性完美匹配传感数据的实时处理与查询需求，为上层AI分析提供有力支撑。\n同时，为保障业务连续性与数据可信，我们构建了多层次的容灾与安全机制：\n数据冗余：启用日级快照与异地异步复制，确保关键数据具备RPO/RTO分钟级的恢复能力。\n数据防篡改：采用“SHA-256 + SM3”双算法校验数据完整性，签名则使用“RSA-2048 + SM2”国密算法，并对传输与静态数据强制加密及细粒度访问审计。\n生态兼容：所有关键元数据统一同步至信创数据库（GaussDB），确保与国产软件生态的无缝对接。\n该架构不仅实现了对不同数据生命周期的精细化管理，优化了TCO（总体拥有成本），更在满足等保2.0要求的同时，为未来对接云上大数据平台奠定了坚实基础。`\n\n### 安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）\n\n我们的安全体系围绕这些威胁展开设计。\n为满足等保 2.0 在物联网场景下的合规要求，并确保信创环境下的安全可控，考虑到园区物联网面临的三大典型威胁：轻量级终端易被仿冒接入；东西向流量（如摄像头到存储）可能被窃听；供应链投毒风险。我们的安全体系围绕这些威胁展开设计。本项目安全体系以“纵深防御 + 零信任 + 信创可信计算”为核心理念，形成覆盖制度、技术与运行的三层体系。\n1. 在 身份与准入控制 方面，系统基于国产密码算法实现 PKI 体系，采用 PKI 与 802.1X的EAPTLS认证方式，实现端口级访问控制与身份可信，确保设备与运维人员的身份可验证、通信可加密；对无法证书化的轻量终端，采用网关代理与白名单方式实现受控接入，同时符合等保 2.0 “身份鉴别最小化”原则。\n2. 在 网络安全与虚拟化防护 方面，园区网络实施 IT/OT/DMZ/访客 四区隔离，并在边界部署 NGFW、IDS/IPS 与流量镜像探针。核心层 CSS2 虚拟化系统通过 VRF + VXLAN 技术实现逻辑多租户隔离，防止虚拟化平面攻击扩散。关键链路启用 MACsec 与 IPsec 双层加密，控制面采用国密隧道协议确保通信机密性与完整性。\n3. 在 审计与态势感知 层面，项目建立基于 国产 SIEM 平台，华为 iMaster SecoManager作为集中日志与事件分析中心，融合 UEBA 与威胁情报（CTI）进行异常检测。通过 SOAR 自动化响应体系，可实现事件自动隔离、工单触发与恢复闭环，将平均响应时间从人工 3 小时缩短至 15 分钟以内。\n4. 此外，系统构建了覆盖漏洞扫描、灰度补丁发布、固件签名验证及设备退役销毁的全生命周期可信管理机制，从设计源头防止供应链攻击，形成了“信创可信 + 虚拟化隔离 + 主动感知”的国产化安全体系。\n\n### 管理与运维（自动化与可审计）\n\n资产与配置管理方面，构建了 NAC 与 CMDB 联动机制，实现设备接入即登记、变更即备案，覆盖设备属性、证书、固件版本与责任人等关键信息；所有入网与变更操作均纳入审批流程并留痕。\n为降低人工错误并提升变更效率，运维采用模板化配置与脚本化发布，借助 Ansible 与自动化流水线实现批量下发、补丁发布与快速回滚，且所有变更均通过审批并记录审计日志，确保配置一致性与可追溯性。\n在日常运维中，我们建立了明确的监控职责与响应流程。由NMS平台实时监控网络性能与可用性，任何故障告警将触发运维工单；而所有安全事件则统一由SIEM平台聚合分析，并根据预设剧本（Playbook）自动触发SOAR执行响应，或在需要人工研判时，生成安全事件工单，交由值班团队处置。\n为保障运行韧性与持续改进，建立了明确的值班机制与 RTO/RPO 指标，定期开展等保自查、容灾演练和红蓝攻防演练；同时完善知识库与故障手册，组织定期运维与安全培训，确保制度与技术同频落地。\n\n### 结论与展望\n\n系统已按设计完成部署并通过专家组与用户验收。上线运行后满足既定 KPI（关键区域无线覆盖≥99.9%、关键控制消息端到端延迟<50ms、漫游切换<50ms、系统可用率≥99.95%）与合规要求，安全体系通过等保2.0三级测评，实现安全事件平均响应时间（MTTR）<30分钟。\n不过，仍存在不足：个别远端室外监测点因初期预算限制采用临时供电方案，极端天气下需人工干预。建议下阶段实施双路供电+光纤冗余改造并预留专项资金。\n综上所述，本项目成功验证了在 国产化与虚拟化融合环境 下构建高可靠园区物联网的可行性与可复制性，为后续智慧园区、工业互联网场景提供了可推广的设计模板。本次建设显著提升了园区生产可视化与运维效率。未来将进一步深化国产软硬件适配，通过昇腾NPU加速边缘AI推理性能，结合openEuler实时内核增强确定性时延性能，夯实自主可控技术底座，持续提升运营韧性。\n\n***\n***\n\n\n\n# 论智算中心（AIDC）的多维融合网络架构规划与实践\n# ——以某大型科研机构AIDC建设项目为例\n## 摘要\n\n在人工智能与大模型驱动的时代背景下，智算中心（AIDC）已成为承载国家战略与前沿科研的核心基础设施。其对网络的需求超越了传统数据中心，呈现出极致性能、智能调度、内生安全与高效运维等多维度挑战。本文以2024年某大型科研机构智算中心建设项目为例，由本人作为主要负责人深度参与规划设计，系统性地阐述了一套多维融合的网络架构方案。\n该方案在物理层，采用基于Clos架构的无损以太网承载RoCEv2流量；在虚拟层，引入SRv6与VXLAN技术构建云网算一体化的算力网络；在存储方面，选择了NVMe-oF实现高性能存算互联；在安全方面，围绕“零信任”理念构建了贯穿物理层到应用层的纵深防御体系，并完成了信创环境下的安全兼容性验证；在运维方面，规划并落地了AIOps智能运维平台**，显著提升了运维效率。\n项目成功交付后，各项性能指标均超越设计预期，并顺利通过等保2.0三级测评，为该机构在大模型训练与科学计算领域的研究提供了坚实可靠的算力底座。\n\n### 项目背景与规划目标\n\n随着以Deepseek为代表的大语言模型参数量呈指数级增长，AI训练模式已演进至万卡规模的并行计算集群。这种变革对网络提出了颠覆性的“三高一低”要求：即高带宽、高并发、高可靠（零丢包）和超低时延。我所在的大型科研机构于2024年初启动了“国家级人工智能与科学计算平台”项目，旨在构建一个拥有超过2000个计算节点的智算中心。为支撑该平台，我们确立了构建一张性能卓越、智能敏捷、安全可靠、自主可控的智-算-存一体化网络的总体目标，并制定了明确的KPI指标：存算访问端到端时延低于20μs，网络转发实现零丢包，关键故障平均定位时间（MTTR）小于15分钟，并通过等保2.0三级测评。\n\n### 网络架构与设备选型\n\n为实现上述目标，我们确立了“物理融合、逻辑解耦”的设计哲学。\n在物理架构（Underlay）方面，我们采用业界主流的Spine-Leaf三级Clos架构。该架构具备无阻塞、低延迟和水平扩展的天然优势，是构建大规模高性能网络的最佳选择。为实现零丢包的“无损网络”，我们放弃了传统PFC技术，选择了更先进的基于ECN（显式拥塞通知）和DCQCN（数据中心量化拥塞通知）的端到端拥塞控制方案。\n在虚拟架构（Overlay）方面，我们利用VXLAN技术实现多租户隔离，并创新性地引入SRv6技术，构建真正的“算力网络”，实现了业务意图与网络路径的直接映射。\n在设备选型上，我们进行了详尽的评估与博弈。Spine交换机我们选用了华为CloudEngine 16808，Leaf交换机则为CloudEngine 8850系列。这一组合的核心优势在于：首先，它们均提供高密度的400GE端口，并具备向800GE平滑演进的能力，满足了项目对带宽的长期规划。其次，CloudEngine 16808拥有业界领先的超大缓存和动态负载均衡算法，能有效吸收AI训练产生的突发流量。更重要的是，在AIOps平台选型博弈中，我们对比了另一家厂商的同类产品，其虽然性能指标接近，但Telemetry数据模型为私有格式。而华为CloudEngine系列全面支持基于gNMI的开放遥测标准。考虑到AIOps平台对开放数据采集的强依赖是保障长期运维效率的关键，我们最终确定了华为方案。这一决策体现了我们**“运维优先于极限性能”的规划原则。计算与存储节点的网卡，我们统一采用了华为IN500系列智能网卡**，它不仅支持RoCEv2硬件卸载，还内置了可编程的引擎，为后续网络功能的灵活扩展预留了空间。\n\n### 存储网络选择与容灾设计\n\nAI训练的本质是数据搬运，高性能存储网络是AIDC的基石。在存储网络方案选型阶段，我们最终选择了基于RoCEv2的NVMe-oF方案，因为它在性能、成本和生态开放性上达到了最佳平衡。我们选用了华为OceanStor Pacific系列分布式存储作为存储底座。\n在数据可靠性设计上，我们进行了多层次的深入规划。首先，针对多副本机制，我们摒弃了传统的硬件RAID技术。因为在AIDC的大规模分布式场景下，RAID的“写放大”问题严重，且单盘故障后的重构过程漫长，对整个系统性能冲击巨大。取而代之的是，我们采用了更为先进的基于软件定义的纠删码（Erasure Coding, EC）技术。我们配置了“16+4”的EC策略，即数据被分成16个数据块和4个校验块，分散存储在20个不同的节点上。这种方式不仅磁盘利用率高达80%（远超三副本的33%），而且在节点或硬盘故障时，可以由多个节点并行进行数据重构，恢复速度比传统RAID提升一个数量级，极大地保障了业务的连续性。\n在数据完整性与机密性方面，我们构建了双重保障。我们采用“SHA‑256 + SM3”双算法对写入数据进行完整性校验，签名使用“RSA‑2048 + SM2”国密算法；对传输与静态数据强制加密，并配合细粒度访问审计，确保数据全生命周期的可信与可追溯。\n\n### 等保合规与内生安全设计\n\nAIDC承载着机构最核心的数据与算力资产，安全是与性能同等重要的生命线。我们以零信任为核心，构建了“物理/链路—网络—管控/审计”三道防线。\n第一道防线是物理与链路层安全。我们在所有CloudEngine交换机之间的互联端口上启用MACsec硬件加密。\n第二道防线是网络层隔离与访问控制。我们利用VXLAN和分布式防火墙技术，实现了“微隔离”，有效遏制了威胁在数据中心内部的横向移动。\n第三道防线是管控与审计层安全。我们部署了国产SIEM/SOAR平台作为安全大脑。在此过程中，我牵头负责了安全体系的信创兼容性验证，通过大量测试，我们解决了国产密码算法（SM2/3/4）与硬件加密引擎的适配问题、PKI及SIEM日志解析的适配问题，形成了一套完整且自主可控的安全解决方案，确保安全体系既自主可控又能满足等保2.0三级要求。\n\n### 自动化运维保障\n\n我们规划并落地了一套AIOps平台作为整个网络的“智慧大脑”。该平台采用“数据湖 + AI引擎 + 自动化编排”的三层架构，通过Telemetry流式遥测采集数据，为智能分析提供了高质量的基础。\n在平台落地初期，我们曾遇到告警风暴收敛效果不佳的棘手问题。作为该模块负责人，我牵头排查发现根源在于知识图谱缺失了应用与服务器的关联关系。为此，我提出并主导了CMDB与AIOps平台的‘双向同步’改造，将应用依赖关系实时注入知识图谱。改造后，根因定位准确率从70%提升至95%以上。这个过程让我深刻认识到，AIOps的“智能”源自于数据的“全息”。\n\n### 项目交付总结与展望\n\n项目于2025年6月成功交付。 经严格测试，各项关键指标均达到或优于设计目标：网络平均端到端时延稳定在15μs，万兆并发下的丢包率为0，GPU算力利用率（XPU a-like Ratio）从未采用RDMA网络的60%提升至92%。AIOps平台上线后，98%的网络异常能够在影响业务前被感知和处置，MTTR从小时级降至15分钟内，项目顺利通过等保2.0三级测评。\n回顾整个项目，最大的挑战在于多技术栈的深度融合。一个相对遗憾的点是，由于项目周期紧张，我们优先保障了计算和存储网络的建设，而带外的管理网络建设则沿用了较为传统的方案，其自动化和安全水位未能与主网络完全看齐，这是下一阶段优化工作的重点。\n展望未来，我们将进一步探索基于意图的网络（IBN），并前瞻性地研究抗量子密码（PQC）在数据中心网络中的应用，持续夯实国家科研基础设施的数字底座。","source":"_posts/网规论文.md","raw":"---\ntitle: 网规论文\ndate: 2025-11-04 22:06\ncategories: 学习笔记\ntags: 技术\n---\n\n\n\n\n# 基于国产化设备的园区物联网建设方案研究\n# ——以某企业园区物联网建设为例\n## 摘要\n\n随着 5G、Wi-Fi 6/7 的发展，边缘计算与工业物联网迅速兴起，园区级物联网成为保障生产安全、提高运维效率与推进智能制造的关键基础设施。本文以 2023 年 3 月由本人牵头在某企业园区实施的物联网建设项目为例，系统阐述了政策背景与调研判断、分层网络与设备选型、存储与容灾备份策略，以及基于等保 2.0 的安全体制与信创兼容体系建设。工程采用国产化软硬件平台与虚拟化融合架构，安全体系覆盖物理、身份、准入、传输、审计与漏洞管理，SIEM/态势感知与 SOAR 联动实现主动防护。经联调与测试，项目于 2023 年 9 月顺利通过交付验收并投入运行；整体稳定，仅个别远端室外监测点的电源与光纤冗余需在后续建设中补强。本人作为本项目的网络规划与总体设计负责人，负责拓扑方案制定、信创兼容性验证及安全体系规划。\n\n## 正文\n\n### 引言：背景与政策支持与项目总体说明\n\n国家推动制造业智能化与信息化的政策导向， 为园区物联网建设提供了清晰指引。 自2015 年提出《中国制造2025》的智能制造愿景以 来， 政策体系持续深化： 工业和信息化部于 2016年发布《智能制造发展规划（2016—2020 年）》，并在此后数年密集出台配套文件，强调并着力推动工业互联网、5G、边缘计算及数据平台在制造业的深度融合与应用。且为保障产业链安全与供应链稳定，本项目经充分评估后，决定全面采用国产化设备，规避潜在断供风险。\n基于上述政策背景和企业数字化转型的内在需求，我单位于 2023 年 3 月立项开展园区物联网与网络升级改造工作。项目目标是通过国产化设备与分层架构，实现环境与设备的统一感知、生产过程的在线可视化、运维流程的自动化与合规审计能力，从而保障业务连续性并提升安全可控性，提升智能感知与数据决策能力。试点验证成功后，项目迅速推广至全园区，并于 2023 年 9 月完成交付验收并进入稳定运行阶段。\n\n### 调研与需求分析\n\n为保证设计方案切实满足业务需求并具备工程可落地性，项目前期历时约 3 周开展了系统调研工作，涵盖现场勘察、关键岗位访谈、历史故障与事故统计、网络与流量测量、射频扫描及安全评估等内容。\n（1）现网问题分析\n调研结果表明，现有园区网络架构陈旧、资源分配不均、安全能力不足，主要存在以下问题：\n老旧设备占比高（约 40%）：核心与汇聚设备仍为 2014 年前型号，无法支持 VXLAN、堆叠及能源管理模块，导致维护风险高、兼容性差、能耗大；\n链路利用率严重不均：部分生产区汇聚端口平均利用率长期低于 20%，而视频监控区端口峰值带宽利用率高达 95%，存在明显的带宽瓶颈与局部拥塞风险；\n无线信号盲区与同频干扰：射频扫描结果显示，厂区北区平均 RSSI −75 dBm 以下区域占比约 18%，部分高密环境存在同频干扰，影响终端漫游体验与稳定性；\n安全审计缺失：现网仅具备基础防火墙日志，缺乏终端准入、身份追溯与集中审计机制，无法满足等保 2.0 对访问控制与安全监测的要求。\n综上所述，系统性升级与重新规划势在必行，以支撑园区后续的智能制造与物联网业务发展。\n（2）业务与功能性需求\n结合园区业务特征与未来发展目标，主要需求集中在以下几个方面：\n生产与安全监测：需实现温湿度、烟感、漏水、粉尘等关键参数的实时采集、毫秒级上报与联动控制；\n设备可用性与实时控制：生产控制环节对时延、抖动和丢包敏感，需以有线方式保障稳定性；\n视频与带宽负载：高清视频回传与存储需高带宽与中心统一归档分级管理机制，以提升分析效率并降低成本；\n终端接入与安全合规：系统需承载万级传感器与千级移动终端并发接入，具备QoS优先级调度与无线侧快速漫游能力。\n合规与审计要求：满足等保2.0设计，包括设备身份认证、网络分区隔离、日志审计、态势感知等。\n据此确立总体设计思路为 “分层架构 + 混合接入 + 中心化治理 + 信创合规 + 等保防护”。\n\n### 设备选型与总体分层架构\n\n在明确总体建设思路后，项目在网络架构设计阶段遵循“分层、模块化与国产化优先”原则，形成了可扩展、可演进的园区物联网网络体系，具体架构如下：\n分层架构概览（实施情况）\n核心层采用两台华为 S12700E 系列设备作为园区核心交换机，配置双引擎、双电源、双交换版，实现单设备冗余，并通过 CSS2 实现控制与转发平面融合备份。任何一台设备出现故障都不影响业务正常运行，显著提升了网络可靠性，也简化网络管理。核心侧与数据中心互联采用双上行高可用设计，实现控制平面与数据平面的双机冗余，彻底消除核心单点故障。\n汇聚层采用华为 S6730-H 系列堆叠交换机，两两堆叠，通过多模光模块上行至核心层，构建 40G 高速骨干链路，从而在保持高带宽的同时实现多链路冗余。该设备还原生支持100G模块和VXLAN硬件转发能力，并保留丰富扩展槽位，支持未来带宽平滑升级与园区虚拟化扩展需求。\n接入层：接入交换机采用华为 S5735-S，支持PoE++（单端口90W），为 AP、摄像头与传感器提供电力与接入。接入交换机双上行到不同汇聚以避免单链路与单设备故障。考虑到不同区域需求，本次部署多种类型的无线AP。其中室外园区采用华为防护型 AP7060DN，具备防水防尘功能，适应室外恶劣环境，支持远距离覆盖；室内高密度会议室采用华为高密AP，配置智能天线，支持100人接入，能有效减少AP部署数量，防止同频干扰；室内小办公室采用墙面AP，保障每个角落信号无死角覆盖。厂区采用华为 AirEngine 6761‑22T 瘦 AP，该型号支持室内定位、资产盘点与 BLE 实时位置服务（RTLS），在物联网场景中支撑移动资产管理与人员定位。 并使用iMaster NCE‑WLAN 的 AC 功能对所有AP进行统一管理、配置下发，实现快速漫游与策略一致性,也能保障无线用户在整个园区网实现无缝漫游。\n边缘层部署 Huawei IoT Edge网关与FusionServer边缘计算节点。由边缘网关完成协议聚合、边缘节点统一由Atlas AI 模块，通过 iMaster NCE orchestrator 编排部署轻量化AI算法镜像，实现算力与任务调度的可视化管理 ，负责本地规则引擎与阈值告警，对视频流及传感信息时序流进行实时分析，识别安全生产风险事件（如人员闯入、未戴安全帽、烟火）与设备异常状态，确保本地检测毫秒级响应，并提取疑似异常特征数据，实时上传至中心平台进行深度AI分析，并在网络质量受限时，可保证本地事件上报的可靠排队与重发机制，确保极端网络中断下关键告警不丢失。\n该架构在保证“控制平面高可靠、数据平面高吞吐、管理平面可审计”的同时，通过虚拟化技术提升资源利用率，也为上层网络的虚拟化与精细化安全隔离提供了坚实的 Underlay 基础。并为未来园区的云边协同与AI推理提供良好支撑。\n\n### 存储选型与容灾备份策略\n\n为支撑园区海量的异构数据，存储方案的设计必须兼顾性能、成本、扩展性与数据安全。我们首先对项目核心数据类型进行了特征分析：\n视频录像：非结构化数据，容量大，写入频繁，读取较少，对成本敏感。\n系统日志：半结构化数据，持续生成，需支持快速检索与长期归档。\n物联传感数据：典型的时序数据，具备高并发写入、低延迟查询和高压缩比的特性。\n基于上述分析，并对比了 FC-SAN、iSCSI 等方案后，我们认为单一存储架构无法高效满足所有需求。因此，我们确立了“基于数据特性的分层混合存储”策略：\n针对视频与日志，采用华为 OceanStor NAS 与对象存储的组合。NAS 承载近期视频与热日志，提供高性价比的在线访问；对象存储则作为冷数据归档层，通过其优秀的扩展性和成本优势，满足长期留存（6个月以上）的合规要求。\n针对万级传感器毫秒级上报的并发压力，我们选用国产华为openGemini 高性能时序数据库存储。其高吞吐、低延迟的特性完美匹配传感数据的实时处理与查询需求，为上层AI分析提供有力支撑。\n同时，为保障业务连续性与数据可信，我们构建了多层次的容灾与安全机制：\n数据冗余：启用日级快照与异地异步复制，确保关键数据具备RPO/RTO分钟级的恢复能力。\n数据防篡改：采用“SHA-256 + SM3”双算法校验数据完整性，签名则使用“RSA-2048 + SM2”国密算法，并对传输与静态数据强制加密及细粒度访问审计。\n生态兼容：所有关键元数据统一同步至信创数据库（GaussDB），确保与国产软件生态的无缝对接。\n该架构不仅实现了对不同数据生命周期的精细化管理，优化了TCO（总体拥有成本），更在满足等保2.0要求的同时，为未来对接云上大数据平台奠定了坚实基础。`\n\n### 安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）\n\n我们的安全体系围绕这些威胁展开设计。\n为满足等保 2.0 在物联网场景下的合规要求，并确保信创环境下的安全可控，考虑到园区物联网面临的三大典型威胁：轻量级终端易被仿冒接入；东西向流量（如摄像头到存储）可能被窃听；供应链投毒风险。我们的安全体系围绕这些威胁展开设计。本项目安全体系以“纵深防御 + 零信任 + 信创可信计算”为核心理念，形成覆盖制度、技术与运行的三层体系。\n1. 在 身份与准入控制 方面，系统基于国产密码算法实现 PKI 体系，采用 PKI 与 802.1X的EAPTLS认证方式，实现端口级访问控制与身份可信，确保设备与运维人员的身份可验证、通信可加密；对无法证书化的轻量终端，采用网关代理与白名单方式实现受控接入，同时符合等保 2.0 “身份鉴别最小化”原则。\n2. 在 网络安全与虚拟化防护 方面，园区网络实施 IT/OT/DMZ/访客 四区隔离，并在边界部署 NGFW、IDS/IPS 与流量镜像探针。核心层 CSS2 虚拟化系统通过 VRF + VXLAN 技术实现逻辑多租户隔离，防止虚拟化平面攻击扩散。关键链路启用 MACsec 与 IPsec 双层加密，控制面采用国密隧道协议确保通信机密性与完整性。\n3. 在 审计与态势感知 层面，项目建立基于 国产 SIEM 平台，华为 iMaster SecoManager作为集中日志与事件分析中心，融合 UEBA 与威胁情报（CTI）进行异常检测。通过 SOAR 自动化响应体系，可实现事件自动隔离、工单触发与恢复闭环，将平均响应时间从人工 3 小时缩短至 15 分钟以内。\n4. 此外，系统构建了覆盖漏洞扫描、灰度补丁发布、固件签名验证及设备退役销毁的全生命周期可信管理机制，从设计源头防止供应链攻击，形成了“信创可信 + 虚拟化隔离 + 主动感知”的国产化安全体系。\n\n### 管理与运维（自动化与可审计）\n\n资产与配置管理方面，构建了 NAC 与 CMDB 联动机制，实现设备接入即登记、变更即备案，覆盖设备属性、证书、固件版本与责任人等关键信息；所有入网与变更操作均纳入审批流程并留痕。\n为降低人工错误并提升变更效率，运维采用模板化配置与脚本化发布，借助 Ansible 与自动化流水线实现批量下发、补丁发布与快速回滚，且所有变更均通过审批并记录审计日志，确保配置一致性与可追溯性。\n在日常运维中，我们建立了明确的监控职责与响应流程。由NMS平台实时监控网络性能与可用性，任何故障告警将触发运维工单；而所有安全事件则统一由SIEM平台聚合分析，并根据预设剧本（Playbook）自动触发SOAR执行响应，或在需要人工研判时，生成安全事件工单，交由值班团队处置。\n为保障运行韧性与持续改进，建立了明确的值班机制与 RTO/RPO 指标，定期开展等保自查、容灾演练和红蓝攻防演练；同时完善知识库与故障手册，组织定期运维与安全培训，确保制度与技术同频落地。\n\n### 结论与展望\n\n系统已按设计完成部署并通过专家组与用户验收。上线运行后满足既定 KPI（关键区域无线覆盖≥99.9%、关键控制消息端到端延迟<50ms、漫游切换<50ms、系统可用率≥99.95%）与合规要求，安全体系通过等保2.0三级测评，实现安全事件平均响应时间（MTTR）<30分钟。\n不过，仍存在不足：个别远端室外监测点因初期预算限制采用临时供电方案，极端天气下需人工干预。建议下阶段实施双路供电+光纤冗余改造并预留专项资金。\n综上所述，本项目成功验证了在 国产化与虚拟化融合环境 下构建高可靠园区物联网的可行性与可复制性，为后续智慧园区、工业互联网场景提供了可推广的设计模板。本次建设显著提升了园区生产可视化与运维效率。未来将进一步深化国产软硬件适配，通过昇腾NPU加速边缘AI推理性能，结合openEuler实时内核增强确定性时延性能，夯实自主可控技术底座，持续提升运营韧性。\n\n***\n***\n\n\n\n# 论智算中心（AIDC）的多维融合网络架构规划与实践\n# ——以某大型科研机构AIDC建设项目为例\n## 摘要\n\n在人工智能与大模型驱动的时代背景下，智算中心（AIDC）已成为承载国家战略与前沿科研的核心基础设施。其对网络的需求超越了传统数据中心，呈现出极致性能、智能调度、内生安全与高效运维等多维度挑战。本文以2024年某大型科研机构智算中心建设项目为例，由本人作为主要负责人深度参与规划设计，系统性地阐述了一套多维融合的网络架构方案。\n该方案在物理层，采用基于Clos架构的无损以太网承载RoCEv2流量；在虚拟层，引入SRv6与VXLAN技术构建云网算一体化的算力网络；在存储方面，选择了NVMe-oF实现高性能存算互联；在安全方面，围绕“零信任”理念构建了贯穿物理层到应用层的纵深防御体系，并完成了信创环境下的安全兼容性验证；在运维方面，规划并落地了AIOps智能运维平台**，显著提升了运维效率。\n项目成功交付后，各项性能指标均超越设计预期，并顺利通过等保2.0三级测评，为该机构在大模型训练与科学计算领域的研究提供了坚实可靠的算力底座。\n\n### 项目背景与规划目标\n\n随着以Deepseek为代表的大语言模型参数量呈指数级增长，AI训练模式已演进至万卡规模的并行计算集群。这种变革对网络提出了颠覆性的“三高一低”要求：即高带宽、高并发、高可靠（零丢包）和超低时延。我所在的大型科研机构于2024年初启动了“国家级人工智能与科学计算平台”项目，旨在构建一个拥有超过2000个计算节点的智算中心。为支撑该平台，我们确立了构建一张性能卓越、智能敏捷、安全可靠、自主可控的智-算-存一体化网络的总体目标，并制定了明确的KPI指标：存算访问端到端时延低于20μs，网络转发实现零丢包，关键故障平均定位时间（MTTR）小于15分钟，并通过等保2.0三级测评。\n\n### 网络架构与设备选型\n\n为实现上述目标，我们确立了“物理融合、逻辑解耦”的设计哲学。\n在物理架构（Underlay）方面，我们采用业界主流的Spine-Leaf三级Clos架构。该架构具备无阻塞、低延迟和水平扩展的天然优势，是构建大规模高性能网络的最佳选择。为实现零丢包的“无损网络”，我们放弃了传统PFC技术，选择了更先进的基于ECN（显式拥塞通知）和DCQCN（数据中心量化拥塞通知）的端到端拥塞控制方案。\n在虚拟架构（Overlay）方面，我们利用VXLAN技术实现多租户隔离，并创新性地引入SRv6技术，构建真正的“算力网络”，实现了业务意图与网络路径的直接映射。\n在设备选型上，我们进行了详尽的评估与博弈。Spine交换机我们选用了华为CloudEngine 16808，Leaf交换机则为CloudEngine 8850系列。这一组合的核心优势在于：首先，它们均提供高密度的400GE端口，并具备向800GE平滑演进的能力，满足了项目对带宽的长期规划。其次，CloudEngine 16808拥有业界领先的超大缓存和动态负载均衡算法，能有效吸收AI训练产生的突发流量。更重要的是，在AIOps平台选型博弈中，我们对比了另一家厂商的同类产品，其虽然性能指标接近，但Telemetry数据模型为私有格式。而华为CloudEngine系列全面支持基于gNMI的开放遥测标准。考虑到AIOps平台对开放数据采集的强依赖是保障长期运维效率的关键，我们最终确定了华为方案。这一决策体现了我们**“运维优先于极限性能”的规划原则。计算与存储节点的网卡，我们统一采用了华为IN500系列智能网卡**，它不仅支持RoCEv2硬件卸载，还内置了可编程的引擎，为后续网络功能的灵活扩展预留了空间。\n\n### 存储网络选择与容灾设计\n\nAI训练的本质是数据搬运，高性能存储网络是AIDC的基石。在存储网络方案选型阶段，我们最终选择了基于RoCEv2的NVMe-oF方案，因为它在性能、成本和生态开放性上达到了最佳平衡。我们选用了华为OceanStor Pacific系列分布式存储作为存储底座。\n在数据可靠性设计上，我们进行了多层次的深入规划。首先，针对多副本机制，我们摒弃了传统的硬件RAID技术。因为在AIDC的大规模分布式场景下，RAID的“写放大”问题严重，且单盘故障后的重构过程漫长，对整个系统性能冲击巨大。取而代之的是，我们采用了更为先进的基于软件定义的纠删码（Erasure Coding, EC）技术。我们配置了“16+4”的EC策略，即数据被分成16个数据块和4个校验块，分散存储在20个不同的节点上。这种方式不仅磁盘利用率高达80%（远超三副本的33%），而且在节点或硬盘故障时，可以由多个节点并行进行数据重构，恢复速度比传统RAID提升一个数量级，极大地保障了业务的连续性。\n在数据完整性与机密性方面，我们构建了双重保障。我们采用“SHA‑256 + SM3”双算法对写入数据进行完整性校验，签名使用“RSA‑2048 + SM2”国密算法；对传输与静态数据强制加密，并配合细粒度访问审计，确保数据全生命周期的可信与可追溯。\n\n### 等保合规与内生安全设计\n\nAIDC承载着机构最核心的数据与算力资产，安全是与性能同等重要的生命线。我们以零信任为核心，构建了“物理/链路—网络—管控/审计”三道防线。\n第一道防线是物理与链路层安全。我们在所有CloudEngine交换机之间的互联端口上启用MACsec硬件加密。\n第二道防线是网络层隔离与访问控制。我们利用VXLAN和分布式防火墙技术，实现了“微隔离”，有效遏制了威胁在数据中心内部的横向移动。\n第三道防线是管控与审计层安全。我们部署了国产SIEM/SOAR平台作为安全大脑。在此过程中，我牵头负责了安全体系的信创兼容性验证，通过大量测试，我们解决了国产密码算法（SM2/3/4）与硬件加密引擎的适配问题、PKI及SIEM日志解析的适配问题，形成了一套完整且自主可控的安全解决方案，确保安全体系既自主可控又能满足等保2.0三级要求。\n\n### 自动化运维保障\n\n我们规划并落地了一套AIOps平台作为整个网络的“智慧大脑”。该平台采用“数据湖 + AI引擎 + 自动化编排”的三层架构，通过Telemetry流式遥测采集数据，为智能分析提供了高质量的基础。\n在平台落地初期，我们曾遇到告警风暴收敛效果不佳的棘手问题。作为该模块负责人，我牵头排查发现根源在于知识图谱缺失了应用与服务器的关联关系。为此，我提出并主导了CMDB与AIOps平台的‘双向同步’改造，将应用依赖关系实时注入知识图谱。改造后，根因定位准确率从70%提升至95%以上。这个过程让我深刻认识到，AIOps的“智能”源自于数据的“全息”。\n\n### 项目交付总结与展望\n\n项目于2025年6月成功交付。 经严格测试，各项关键指标均达到或优于设计目标：网络平均端到端时延稳定在15μs，万兆并发下的丢包率为0，GPU算力利用率（XPU a-like Ratio）从未采用RDMA网络的60%提升至92%。AIOps平台上线后，98%的网络异常能够在影响业务前被感知和处置，MTTR从小时级降至15分钟内，项目顺利通过等保2.0三级测评。\n回顾整个项目，最大的挑战在于多技术栈的深度融合。一个相对遗憾的点是，由于项目周期紧张，我们优先保障了计算和存储网络的建设，而带外的管理网络建设则沿用了较为传统的方案，其自动化和安全水位未能与主网络完全看齐，这是下一阶段优化工作的重点。\n展望未来，我们将进一步探索基于意图的网络（IBN），并前瞻性地研究抗量子密码（PQC）在数据中心网络中的应用，持续夯实国家科研基础设施的数字底座。","slug":"网规论文","published":1,"updated":"2025-11-04T14:36:09.110Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivn000624j3f2jzh7af","content":"<h1 id=\"基于国产化设备的园区物联网建设方案研究\"><a href=\"#基于国产化设备的园区物联网建设方案研究\" class=\"headerlink\" title=\"基于国产化设备的园区物联网建设方案研究\"></a>基于国产化设备的园区物联网建设方案研究</h1><h1 id=\"——以某企业园区物联网建设为例\"><a href=\"#——以某企业园区物联网建设为例\" class=\"headerlink\" title=\"——以某企业园区物联网建设为例\"></a>——以某企业园区物联网建设为例</h1><h2 id=\"摘要\"><a href=\"#摘要\" class=\"headerlink\" title=\"摘要\"></a>摘要</h2><p>随着 5G、Wi-Fi 6&#x2F;7 的发展，边缘计算与工业物联网迅速兴起，园区级物联网成为保障生产安全、提高运维效率与推进智能制造的关键基础设施。本文以 2023 年 3 月由本人牵头在某企业园区实施的物联网建设项目为例，系统阐述了政策背景与调研判断、分层网络与设备选型、存储与容灾备份策略，以及基于等保 2.0 的安全体制与信创兼容体系建设。工程采用国产化软硬件平台与虚拟化融合架构，安全体系覆盖物理、身份、准入、传输、审计与漏洞管理，SIEM&#x2F;态势感知与 SOAR 联动实现主动防护。经联调与测试，项目于 2023 年 9 月顺利通过交付验收并投入运行；整体稳定，仅个别远端室外监测点的电源与光纤冗余需在后续建设中补强。本人作为本项目的网络规划与总体设计负责人，负责拓扑方案制定、信创兼容性验证及安全体系规划。</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><h3 id=\"引言：背景与政策支持与项目总体说明\"><a href=\"#引言：背景与政策支持与项目总体说明\" class=\"headerlink\" title=\"引言：背景与政策支持与项目总体说明\"></a>引言：背景与政策支持与项目总体说明</h3><p>国家推动制造业智能化与信息化的政策导向， 为园区物联网建设提供了清晰指引。 自2015 年提出《中国制造2025》的智能制造愿景以 来， 政策体系持续深化： 工业和信息化部于 2016年发布《智能制造发展规划（2016—2020 年）》，并在此后数年密集出台配套文件，强调并着力推动工业互联网、5G、边缘计算及数据平台在制造业的深度融合与应用。且为保障产业链安全与供应链稳定，本项目经充分评估后，决定全面采用国产化设备，规避潜在断供风险。<br>基于上述政策背景和企业数字化转型的内在需求，我单位于 2023 年 3 月立项开展园区物联网与网络升级改造工作。项目目标是通过国产化设备与分层架构，实现环境与设备的统一感知、生产过程的在线可视化、运维流程的自动化与合规审计能力，从而保障业务连续性并提升安全可控性，提升智能感知与数据决策能力。试点验证成功后，项目迅速推广至全园区，并于 2023 年 9 月完成交付验收并进入稳定运行阶段。</p>\n<h3 id=\"调研与需求分析\"><a href=\"#调研与需求分析\" class=\"headerlink\" title=\"调研与需求分析\"></a>调研与需求分析</h3><p>为保证设计方案切实满足业务需求并具备工程可落地性，项目前期历时约 3 周开展了系统调研工作，涵盖现场勘察、关键岗位访谈、历史故障与事故统计、网络与流量测量、射频扫描及安全评估等内容。<br>（1）现网问题分析<br>调研结果表明，现有园区网络架构陈旧、资源分配不均、安全能力不足，主要存在以下问题：<br>老旧设备占比高（约 40%）：核心与汇聚设备仍为 2014 年前型号，无法支持 VXLAN、堆叠及能源管理模块，导致维护风险高、兼容性差、能耗大；<br>链路利用率严重不均：部分生产区汇聚端口平均利用率长期低于 20%，而视频监控区端口峰值带宽利用率高达 95%，存在明显的带宽瓶颈与局部拥塞风险；<br>无线信号盲区与同频干扰：射频扫描结果显示，厂区北区平均 RSSI −75 dBm 以下区域占比约 18%，部分高密环境存在同频干扰，影响终端漫游体验与稳定性；<br>安全审计缺失：现网仅具备基础防火墙日志，缺乏终端准入、身份追溯与集中审计机制，无法满足等保 2.0 对访问控制与安全监测的要求。<br>综上所述，系统性升级与重新规划势在必行，以支撑园区后续的智能制造与物联网业务发展。<br>（2）业务与功能性需求<br>结合园区业务特征与未来发展目标，主要需求集中在以下几个方面：<br>生产与安全监测：需实现温湿度、烟感、漏水、粉尘等关键参数的实时采集、毫秒级上报与联动控制；<br>设备可用性与实时控制：生产控制环节对时延、抖动和丢包敏感，需以有线方式保障稳定性；<br>视频与带宽负载：高清视频回传与存储需高带宽与中心统一归档分级管理机制，以提升分析效率并降低成本；<br>终端接入与安全合规：系统需承载万级传感器与千级移动终端并发接入，具备QoS优先级调度与无线侧快速漫游能力。<br>合规与审计要求：满足等保2.0设计，包括设备身份认证、网络分区隔离、日志审计、态势感知等。<br>据此确立总体设计思路为 “分层架构 + 混合接入 + 中心化治理 + 信创合规 + 等保防护”。</p>\n<h3 id=\"设备选型与总体分层架构\"><a href=\"#设备选型与总体分层架构\" class=\"headerlink\" title=\"设备选型与总体分层架构\"></a>设备选型与总体分层架构</h3><p>在明确总体建设思路后，项目在网络架构设计阶段遵循“分层、模块化与国产化优先”原则，形成了可扩展、可演进的园区物联网网络体系，具体架构如下：<br>分层架构概览（实施情况）<br>核心层采用两台华为 S12700E 系列设备作为园区核心交换机，配置双引擎、双电源、双交换版，实现单设备冗余，并通过 CSS2 实现控制与转发平面融合备份。任何一台设备出现故障都不影响业务正常运行，显著提升了网络可靠性，也简化网络管理。核心侧与数据中心互联采用双上行高可用设计，实现控制平面与数据平面的双机冗余，彻底消除核心单点故障。<br>汇聚层采用华为 S6730-H 系列堆叠交换机，两两堆叠，通过多模光模块上行至核心层，构建 40G 高速骨干链路，从而在保持高带宽的同时实现多链路冗余。该设备还原生支持100G模块和VXLAN硬件转发能力，并保留丰富扩展槽位，支持未来带宽平滑升级与园区虚拟化扩展需求。<br>接入层：接入交换机采用华为 S5735-S，支持PoE++（单端口90W），为 AP、摄像头与传感器提供电力与接入。接入交换机双上行到不同汇聚以避免单链路与单设备故障。考虑到不同区域需求，本次部署多种类型的无线AP。其中室外园区采用华为防护型 AP7060DN，具备防水防尘功能，适应室外恶劣环境，支持远距离覆盖；室内高密度会议室采用华为高密AP，配置智能天线，支持100人接入，能有效减少AP部署数量，防止同频干扰；室内小办公室采用墙面AP，保障每个角落信号无死角覆盖。厂区采用华为 AirEngine 6761‑22T 瘦 AP，该型号支持室内定位、资产盘点与 BLE 实时位置服务（RTLS），在物联网场景中支撑移动资产管理与人员定位。 并使用iMaster NCE‑WLAN 的 AC 功能对所有AP进行统一管理、配置下发，实现快速漫游与策略一致性,也能保障无线用户在整个园区网实现无缝漫游。<br>边缘层部署 Huawei IoT Edge网关与FusionServer边缘计算节点。由边缘网关完成协议聚合、边缘节点统一由Atlas AI 模块，通过 iMaster NCE orchestrator 编排部署轻量化AI算法镜像，实现算力与任务调度的可视化管理 ，负责本地规则引擎与阈值告警，对视频流及传感信息时序流进行实时分析，识别安全生产风险事件（如人员闯入、未戴安全帽、烟火）与设备异常状态，确保本地检测毫秒级响应，并提取疑似异常特征数据，实时上传至中心平台进行深度AI分析，并在网络质量受限时，可保证本地事件上报的可靠排队与重发机制，确保极端网络中断下关键告警不丢失。<br>该架构在保证“控制平面高可靠、数据平面高吞吐、管理平面可审计”的同时，通过虚拟化技术提升资源利用率，也为上层网络的虚拟化与精细化安全隔离提供了坚实的 Underlay 基础。并为未来园区的云边协同与AI推理提供良好支撑。</p>\n<h3 id=\"存储选型与容灾备份策略\"><a href=\"#存储选型与容灾备份策略\" class=\"headerlink\" title=\"存储选型与容灾备份策略\"></a>存储选型与容灾备份策略</h3><p>为支撑园区海量的异构数据，存储方案的设计必须兼顾性能、成本、扩展性与数据安全。我们首先对项目核心数据类型进行了特征分析：<br>视频录像：非结构化数据，容量大，写入频繁，读取较少，对成本敏感。<br>系统日志：半结构化数据，持续生成，需支持快速检索与长期归档。<br>物联传感数据：典型的时序数据，具备高并发写入、低延迟查询和高压缩比的特性。<br>基于上述分析，并对比了 FC-SAN、iSCSI 等方案后，我们认为单一存储架构无法高效满足所有需求。因此，我们确立了“基于数据特性的分层混合存储”策略：<br>针对视频与日志，采用华为 OceanStor NAS 与对象存储的组合。NAS 承载近期视频与热日志，提供高性价比的在线访问；对象存储则作为冷数据归档层，通过其优秀的扩展性和成本优势，满足长期留存（6个月以上）的合规要求。<br>针对万级传感器毫秒级上报的并发压力，我们选用国产华为openGemini 高性能时序数据库存储。其高吞吐、低延迟的特性完美匹配传感数据的实时处理与查询需求，为上层AI分析提供有力支撑。<br>同时，为保障业务连续性与数据可信，我们构建了多层次的容灾与安全机制：<br>数据冗余：启用日级快照与异地异步复制，确保关键数据具备RPO&#x2F;RTO分钟级的恢复能力。<br>数据防篡改：采用“SHA-256 + SM3”双算法校验数据完整性，签名则使用“RSA-2048 + SM2”国密算法，并对传输与静态数据强制加密及细粒度访问审计。<br>生态兼容：所有关键元数据统一同步至信创数据库（GaussDB），确保与国产软件生态的无缝对接。<br>该架构不仅实现了对不同数据生命周期的精细化管理，优化了TCO（总体拥有成本），更在满足等保2.0要求的同时，为未来对接云上大数据平台奠定了坚实基础。&#96;</p>\n<h3 id=\"安全体制、等保-2-0-要点与态势感知能力（制度—技术—运行）\"><a href=\"#安全体制、等保-2-0-要点与态势感知能力（制度—技术—运行）\" class=\"headerlink\" title=\"安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）\"></a>安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）</h3><p>我们的安全体系围绕这些威胁展开设计。<br>为满足等保 2.0 在物联网场景下的合规要求，并确保信创环境下的安全可控，考虑到园区物联网面临的三大典型威胁：轻量级终端易被仿冒接入；东西向流量（如摄像头到存储）可能被窃听；供应链投毒风险。我们的安全体系围绕这些威胁展开设计。本项目安全体系以“纵深防御 + 零信任 + 信创可信计算”为核心理念，形成覆盖制度、技术与运行的三层体系。</p>\n<ol>\n<li>在 身份与准入控制 方面，系统基于国产密码算法实现 PKI 体系，采用 PKI 与 802.1X的EAPTLS认证方式，实现端口级访问控制与身份可信，确保设备与运维人员的身份可验证、通信可加密；对无法证书化的轻量终端，采用网关代理与白名单方式实现受控接入，同时符合等保 2.0 “身份鉴别最小化”原则。</li>\n<li>在 网络安全与虚拟化防护 方面，园区网络实施 IT&#x2F;OT&#x2F;DMZ&#x2F;访客 四区隔离，并在边界部署 NGFW、IDS&#x2F;IPS 与流量镜像探针。核心层 CSS2 虚拟化系统通过 VRF + VXLAN 技术实现逻辑多租户隔离，防止虚拟化平面攻击扩散。关键链路启用 MACsec 与 IPsec 双层加密，控制面采用国密隧道协议确保通信机密性与完整性。</li>\n<li>在 审计与态势感知 层面，项目建立基于 国产 SIEM 平台，华为 iMaster SecoManager作为集中日志与事件分析中心，融合 UEBA 与威胁情报（CTI）进行异常检测。通过 SOAR 自动化响应体系，可实现事件自动隔离、工单触发与恢复闭环，将平均响应时间从人工 3 小时缩短至 15 分钟以内。</li>\n<li>此外，系统构建了覆盖漏洞扫描、灰度补丁发布、固件签名验证及设备退役销毁的全生命周期可信管理机制，从设计源头防止供应链攻击，形成了“信创可信 + 虚拟化隔离 + 主动感知”的国产化安全体系。</li>\n</ol>\n<h3 id=\"管理与运维（自动化与可审计）\"><a href=\"#管理与运维（自动化与可审计）\" class=\"headerlink\" title=\"管理与运维（自动化与可审计）\"></a>管理与运维（自动化与可审计）</h3><p>资产与配置管理方面，构建了 NAC 与 CMDB 联动机制，实现设备接入即登记、变更即备案，覆盖设备属性、证书、固件版本与责任人等关键信息；所有入网与变更操作均纳入审批流程并留痕。<br>为降低人工错误并提升变更效率，运维采用模板化配置与脚本化发布，借助 Ansible 与自动化流水线实现批量下发、补丁发布与快速回滚，且所有变更均通过审批并记录审计日志，确保配置一致性与可追溯性。<br>在日常运维中，我们建立了明确的监控职责与响应流程。由NMS平台实时监控网络性能与可用性，任何故障告警将触发运维工单；而所有安全事件则统一由SIEM平台聚合分析，并根据预设剧本（Playbook）自动触发SOAR执行响应，或在需要人工研判时，生成安全事件工单，交由值班团队处置。<br>为保障运行韧性与持续改进，建立了明确的值班机制与 RTO&#x2F;RPO 指标，定期开展等保自查、容灾演练和红蓝攻防演练；同时完善知识库与故障手册，组织定期运维与安全培训，确保制度与技术同频落地。</p>\n<h3 id=\"结论与展望\"><a href=\"#结论与展望\" class=\"headerlink\" title=\"结论与展望\"></a>结论与展望</h3><p>系统已按设计完成部署并通过专家组与用户验收。上线运行后满足既定 KPI（关键区域无线覆盖≥99.9%、关键控制消息端到端延迟&lt;50ms、漫游切换&lt;50ms、系统可用率≥99.95%）与合规要求，安全体系通过等保2.0三级测评，实现安全事件平均响应时间（MTTR）&lt;30分钟。<br>不过，仍存在不足：个别远端室外监测点因初期预算限制采用临时供电方案，极端天气下需人工干预。建议下阶段实施双路供电+光纤冗余改造并预留专项资金。<br>综上所述，本项目成功验证了在 国产化与虚拟化融合环境 下构建高可靠园区物联网的可行性与可复制性，为后续智慧园区、工业互联网场景提供了可推广的设计模板。本次建设显著提升了园区生产可视化与运维效率。未来将进一步深化国产软硬件适配，通过昇腾NPU加速边缘AI推理性能，结合openEuler实时内核增强确定性时延性能，夯实自主可控技术底座，持续提升运营韧性。</p>\n<hr>\n<hr>\n<h1 id=\"论智算中心（AIDC）的多维融合网络架构规划与实践\"><a href=\"#论智算中心（AIDC）的多维融合网络架构规划与实践\" class=\"headerlink\" title=\"论智算中心（AIDC）的多维融合网络架构规划与实践\"></a>论智算中心（AIDC）的多维融合网络架构规划与实践</h1><h1 id=\"——以某大型科研机构AIDC建设项目为例\"><a href=\"#——以某大型科研机构AIDC建设项目为例\" class=\"headerlink\" title=\"——以某大型科研机构AIDC建设项目为例\"></a>——以某大型科研机构AIDC建设项目为例</h1><h2 id=\"摘要-1\"><a href=\"#摘要-1\" class=\"headerlink\" title=\"摘要\"></a>摘要</h2><p>在人工智能与大模型驱动的时代背景下，智算中心（AIDC）已成为承载国家战略与前沿科研的核心基础设施。其对网络的需求超越了传统数据中心，呈现出极致性能、智能调度、内生安全与高效运维等多维度挑战。本文以2024年某大型科研机构智算中心建设项目为例，由本人作为主要负责人深度参与规划设计，系统性地阐述了一套多维融合的网络架构方案。<br>该方案在物理层，采用基于Clos架构的无损以太网承载RoCEv2流量；在虚拟层，引入SRv6与VXLAN技术构建云网算一体化的算力网络；在存储方面，选择了NVMe-oF实现高性能存算互联；在安全方面，围绕“零信任”理念构建了贯穿物理层到应用层的纵深防御体系，并完成了信创环境下的安全兼容性验证；在运维方面，规划并落地了AIOps智能运维平台**，显著提升了运维效率。<br>项目成功交付后，各项性能指标均超越设计预期，并顺利通过等保2.0三级测评，为该机构在大模型训练与科学计算领域的研究提供了坚实可靠的算力底座。</p>\n<h3 id=\"项目背景与规划目标\"><a href=\"#项目背景与规划目标\" class=\"headerlink\" title=\"项目背景与规划目标\"></a>项目背景与规划目标</h3><p>随着以Deepseek为代表的大语言模型参数量呈指数级增长，AI训练模式已演进至万卡规模的并行计算集群。这种变革对网络提出了颠覆性的“三高一低”要求：即高带宽、高并发、高可靠（零丢包）和超低时延。我所在的大型科研机构于2024年初启动了“国家级人工智能与科学计算平台”项目，旨在构建一个拥有超过2000个计算节点的智算中心。为支撑该平台，我们确立了构建一张性能卓越、智能敏捷、安全可靠、自主可控的智-算-存一体化网络的总体目标，并制定了明确的KPI指标：存算访问端到端时延低于20μs，网络转发实现零丢包，关键故障平均定位时间（MTTR）小于15分钟，并通过等保2.0三级测评。</p>\n<h3 id=\"网络架构与设备选型\"><a href=\"#网络架构与设备选型\" class=\"headerlink\" title=\"网络架构与设备选型\"></a>网络架构与设备选型</h3><p>为实现上述目标，我们确立了“物理融合、逻辑解耦”的设计哲学。<br>在物理架构（Underlay）方面，我们采用业界主流的Spine-Leaf三级Clos架构。该架构具备无阻塞、低延迟和水平扩展的天然优势，是构建大规模高性能网络的最佳选择。为实现零丢包的“无损网络”，我们放弃了传统PFC技术，选择了更先进的基于ECN（显式拥塞通知）和DCQCN（数据中心量化拥塞通知）的端到端拥塞控制方案。<br>在虚拟架构（Overlay）方面，我们利用VXLAN技术实现多租户隔离，并创新性地引入SRv6技术，构建真正的“算力网络”，实现了业务意图与网络路径的直接映射。<br>在设备选型上，我们进行了详尽的评估与博弈。Spine交换机我们选用了华为CloudEngine 16808，Leaf交换机则为CloudEngine 8850系列。这一组合的核心优势在于：首先，它们均提供高密度的400GE端口，并具备向800GE平滑演进的能力，满足了项目对带宽的长期规划。其次，CloudEngine 16808拥有业界领先的超大缓存和动态负载均衡算法，能有效吸收AI训练产生的突发流量。更重要的是，在AIOps平台选型博弈中，我们对比了另一家厂商的同类产品，其虽然性能指标接近，但Telemetry数据模型为私有格式。而华为CloudEngine系列全面支持基于gNMI的开放遥测标准。考虑到AIOps平台对开放数据采集的强依赖是保障长期运维效率的关键，我们最终确定了华为方案。这一决策体现了我们<strong>“运维优先于极限性能”的规划原则。计算与存储节点的网卡，我们统一采用了华为IN500系列智能网卡</strong>，它不仅支持RoCEv2硬件卸载，还内置了可编程的引擎，为后续网络功能的灵活扩展预留了空间。</p>\n<h3 id=\"存储网络选择与容灾设计\"><a href=\"#存储网络选择与容灾设计\" class=\"headerlink\" title=\"存储网络选择与容灾设计\"></a>存储网络选择与容灾设计</h3><p>AI训练的本质是数据搬运，高性能存储网络是AIDC的基石。在存储网络方案选型阶段，我们最终选择了基于RoCEv2的NVMe-oF方案，因为它在性能、成本和生态开放性上达到了最佳平衡。我们选用了华为OceanStor Pacific系列分布式存储作为存储底座。<br>在数据可靠性设计上，我们进行了多层次的深入规划。首先，针对多副本机制，我们摒弃了传统的硬件RAID技术。因为在AIDC的大规模分布式场景下，RAID的“写放大”问题严重，且单盘故障后的重构过程漫长，对整个系统性能冲击巨大。取而代之的是，我们采用了更为先进的基于软件定义的纠删码（Erasure Coding, EC）技术。我们配置了“16+4”的EC策略，即数据被分成16个数据块和4个校验块，分散存储在20个不同的节点上。这种方式不仅磁盘利用率高达80%（远超三副本的33%），而且在节点或硬盘故障时，可以由多个节点并行进行数据重构，恢复速度比传统RAID提升一个数量级，极大地保障了业务的连续性。<br>在数据完整性与机密性方面，我们构建了双重保障。我们采用“SHA‑256 + SM3”双算法对写入数据进行完整性校验，签名使用“RSA‑2048 + SM2”国密算法；对传输与静态数据强制加密，并配合细粒度访问审计，确保数据全生命周期的可信与可追溯。</p>\n<h3 id=\"等保合规与内生安全设计\"><a href=\"#等保合规与内生安全设计\" class=\"headerlink\" title=\"等保合规与内生安全设计\"></a>等保合规与内生安全设计</h3><p>AIDC承载着机构最核心的数据与算力资产，安全是与性能同等重要的生命线。我们以零信任为核心，构建了“物理&#x2F;链路—网络—管控&#x2F;审计”三道防线。<br>第一道防线是物理与链路层安全。我们在所有CloudEngine交换机之间的互联端口上启用MACsec硬件加密。<br>第二道防线是网络层隔离与访问控制。我们利用VXLAN和分布式防火墙技术，实现了“微隔离”，有效遏制了威胁在数据中心内部的横向移动。<br>第三道防线是管控与审计层安全。我们部署了国产SIEM&#x2F;SOAR平台作为安全大脑。在此过程中，我牵头负责了安全体系的信创兼容性验证，通过大量测试，我们解决了国产密码算法（SM2&#x2F;3&#x2F;4）与硬件加密引擎的适配问题、PKI及SIEM日志解析的适配问题，形成了一套完整且自主可控的安全解决方案，确保安全体系既自主可控又能满足等保2.0三级要求。</p>\n<h3 id=\"自动化运维保障\"><a href=\"#自动化运维保障\" class=\"headerlink\" title=\"自动化运维保障\"></a>自动化运维保障</h3><p>我们规划并落地了一套AIOps平台作为整个网络的“智慧大脑”。该平台采用“数据湖 + AI引擎 + 自动化编排”的三层架构，通过Telemetry流式遥测采集数据，为智能分析提供了高质量的基础。<br>在平台落地初期，我们曾遇到告警风暴收敛效果不佳的棘手问题。作为该模块负责人，我牵头排查发现根源在于知识图谱缺失了应用与服务器的关联关系。为此，我提出并主导了CMDB与AIOps平台的‘双向同步’改造，将应用依赖关系实时注入知识图谱。改造后，根因定位准确率从70%提升至95%以上。这个过程让我深刻认识到，AIOps的“智能”源自于数据的“全息”。</p>\n<h3 id=\"项目交付总结与展望\"><a href=\"#项目交付总结与展望\" class=\"headerlink\" title=\"项目交付总结与展望\"></a>项目交付总结与展望</h3><p>项目于2025年6月成功交付。 经严格测试，各项关键指标均达到或优于设计目标：网络平均端到端时延稳定在15μs，万兆并发下的丢包率为0，GPU算力利用率（XPU a-like Ratio）从未采用RDMA网络的60%提升至92%。AIOps平台上线后，98%的网络异常能够在影响业务前被感知和处置，MTTR从小时级降至15分钟内，项目顺利通过等保2.0三级测评。<br>回顾整个项目，最大的挑战在于多技术栈的深度融合。一个相对遗憾的点是，由于项目周期紧张，我们优先保障了计算和存储网络的建设，而带外的管理网络建设则沿用了较为传统的方案，其自动化和安全水位未能与主网络完全看齐，这是下一阶段优化工作的重点。<br>展望未来，我们将进一步探索基于意图的网络（IBN），并前瞻性地研究抗量子密码（PQC）在数据中心网络中的应用，持续夯实国家科研基础设施的数字底座。</p>\n","excerpt":"","more":"<h1 id=\"基于国产化设备的园区物联网建设方案研究\"><a href=\"#基于国产化设备的园区物联网建设方案研究\" class=\"headerlink\" title=\"基于国产化设备的园区物联网建设方案研究\"></a>基于国产化设备的园区物联网建设方案研究</h1><h1 id=\"——以某企业园区物联网建设为例\"><a href=\"#——以某企业园区物联网建设为例\" class=\"headerlink\" title=\"——以某企业园区物联网建设为例\"></a>——以某企业园区物联网建设为例</h1><h2 id=\"摘要\"><a href=\"#摘要\" class=\"headerlink\" title=\"摘要\"></a>摘要</h2><p>随着 5G、Wi-Fi 6&#x2F;7 的发展，边缘计算与工业物联网迅速兴起，园区级物联网成为保障生产安全、提高运维效率与推进智能制造的关键基础设施。本文以 2023 年 3 月由本人牵头在某企业园区实施的物联网建设项目为例，系统阐述了政策背景与调研判断、分层网络与设备选型、存储与容灾备份策略，以及基于等保 2.0 的安全体制与信创兼容体系建设。工程采用国产化软硬件平台与虚拟化融合架构，安全体系覆盖物理、身份、准入、传输、审计与漏洞管理，SIEM&#x2F;态势感知与 SOAR 联动实现主动防护。经联调与测试，项目于 2023 年 9 月顺利通过交付验收并投入运行；整体稳定，仅个别远端室外监测点的电源与光纤冗余需在后续建设中补强。本人作为本项目的网络规划与总体设计负责人，负责拓扑方案制定、信创兼容性验证及安全体系规划。</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><h3 id=\"引言：背景与政策支持与项目总体说明\"><a href=\"#引言：背景与政策支持与项目总体说明\" class=\"headerlink\" title=\"引言：背景与政策支持与项目总体说明\"></a>引言：背景与政策支持与项目总体说明</h3><p>国家推动制造业智能化与信息化的政策导向， 为园区物联网建设提供了清晰指引。 自2015 年提出《中国制造2025》的智能制造愿景以 来， 政策体系持续深化： 工业和信息化部于 2016年发布《智能制造发展规划（2016—2020 年）》，并在此后数年密集出台配套文件，强调并着力推动工业互联网、5G、边缘计算及数据平台在制造业的深度融合与应用。且为保障产业链安全与供应链稳定，本项目经充分评估后，决定全面采用国产化设备，规避潜在断供风险。<br>基于上述政策背景和企业数字化转型的内在需求，我单位于 2023 年 3 月立项开展园区物联网与网络升级改造工作。项目目标是通过国产化设备与分层架构，实现环境与设备的统一感知、生产过程的在线可视化、运维流程的自动化与合规审计能力，从而保障业务连续性并提升安全可控性，提升智能感知与数据决策能力。试点验证成功后，项目迅速推广至全园区，并于 2023 年 9 月完成交付验收并进入稳定运行阶段。</p>\n<h3 id=\"调研与需求分析\"><a href=\"#调研与需求分析\" class=\"headerlink\" title=\"调研与需求分析\"></a>调研与需求分析</h3><p>为保证设计方案切实满足业务需求并具备工程可落地性，项目前期历时约 3 周开展了系统调研工作，涵盖现场勘察、关键岗位访谈、历史故障与事故统计、网络与流量测量、射频扫描及安全评估等内容。<br>（1）现网问题分析<br>调研结果表明，现有园区网络架构陈旧、资源分配不均、安全能力不足，主要存在以下问题：<br>老旧设备占比高（约 40%）：核心与汇聚设备仍为 2014 年前型号，无法支持 VXLAN、堆叠及能源管理模块，导致维护风险高、兼容性差、能耗大；<br>链路利用率严重不均：部分生产区汇聚端口平均利用率长期低于 20%，而视频监控区端口峰值带宽利用率高达 95%，存在明显的带宽瓶颈与局部拥塞风险；<br>无线信号盲区与同频干扰：射频扫描结果显示，厂区北区平均 RSSI −75 dBm 以下区域占比约 18%，部分高密环境存在同频干扰，影响终端漫游体验与稳定性；<br>安全审计缺失：现网仅具备基础防火墙日志，缺乏终端准入、身份追溯与集中审计机制，无法满足等保 2.0 对访问控制与安全监测的要求。<br>综上所述，系统性升级与重新规划势在必行，以支撑园区后续的智能制造与物联网业务发展。<br>（2）业务与功能性需求<br>结合园区业务特征与未来发展目标，主要需求集中在以下几个方面：<br>生产与安全监测：需实现温湿度、烟感、漏水、粉尘等关键参数的实时采集、毫秒级上报与联动控制；<br>设备可用性与实时控制：生产控制环节对时延、抖动和丢包敏感，需以有线方式保障稳定性；<br>视频与带宽负载：高清视频回传与存储需高带宽与中心统一归档分级管理机制，以提升分析效率并降低成本；<br>终端接入与安全合规：系统需承载万级传感器与千级移动终端并发接入，具备QoS优先级调度与无线侧快速漫游能力。<br>合规与审计要求：满足等保2.0设计，包括设备身份认证、网络分区隔离、日志审计、态势感知等。<br>据此确立总体设计思路为 “分层架构 + 混合接入 + 中心化治理 + 信创合规 + 等保防护”。</p>\n<h3 id=\"设备选型与总体分层架构\"><a href=\"#设备选型与总体分层架构\" class=\"headerlink\" title=\"设备选型与总体分层架构\"></a>设备选型与总体分层架构</h3><p>在明确总体建设思路后，项目在网络架构设计阶段遵循“分层、模块化与国产化优先”原则，形成了可扩展、可演进的园区物联网网络体系，具体架构如下：<br>分层架构概览（实施情况）<br>核心层采用两台华为 S12700E 系列设备作为园区核心交换机，配置双引擎、双电源、双交换版，实现单设备冗余，并通过 CSS2 实现控制与转发平面融合备份。任何一台设备出现故障都不影响业务正常运行，显著提升了网络可靠性，也简化网络管理。核心侧与数据中心互联采用双上行高可用设计，实现控制平面与数据平面的双机冗余，彻底消除核心单点故障。<br>汇聚层采用华为 S6730-H 系列堆叠交换机，两两堆叠，通过多模光模块上行至核心层，构建 40G 高速骨干链路，从而在保持高带宽的同时实现多链路冗余。该设备还原生支持100G模块和VXLAN硬件转发能力，并保留丰富扩展槽位，支持未来带宽平滑升级与园区虚拟化扩展需求。<br>接入层：接入交换机采用华为 S5735-S，支持PoE++（单端口90W），为 AP、摄像头与传感器提供电力与接入。接入交换机双上行到不同汇聚以避免单链路与单设备故障。考虑到不同区域需求，本次部署多种类型的无线AP。其中室外园区采用华为防护型 AP7060DN，具备防水防尘功能，适应室外恶劣环境，支持远距离覆盖；室内高密度会议室采用华为高密AP，配置智能天线，支持100人接入，能有效减少AP部署数量，防止同频干扰；室内小办公室采用墙面AP，保障每个角落信号无死角覆盖。厂区采用华为 AirEngine 6761‑22T 瘦 AP，该型号支持室内定位、资产盘点与 BLE 实时位置服务（RTLS），在物联网场景中支撑移动资产管理与人员定位。 并使用iMaster NCE‑WLAN 的 AC 功能对所有AP进行统一管理、配置下发，实现快速漫游与策略一致性,也能保障无线用户在整个园区网实现无缝漫游。<br>边缘层部署 Huawei IoT Edge网关与FusionServer边缘计算节点。由边缘网关完成协议聚合、边缘节点统一由Atlas AI 模块，通过 iMaster NCE orchestrator 编排部署轻量化AI算法镜像，实现算力与任务调度的可视化管理 ，负责本地规则引擎与阈值告警，对视频流及传感信息时序流进行实时分析，识别安全生产风险事件（如人员闯入、未戴安全帽、烟火）与设备异常状态，确保本地检测毫秒级响应，并提取疑似异常特征数据，实时上传至中心平台进行深度AI分析，并在网络质量受限时，可保证本地事件上报的可靠排队与重发机制，确保极端网络中断下关键告警不丢失。<br>该架构在保证“控制平面高可靠、数据平面高吞吐、管理平面可审计”的同时，通过虚拟化技术提升资源利用率，也为上层网络的虚拟化与精细化安全隔离提供了坚实的 Underlay 基础。并为未来园区的云边协同与AI推理提供良好支撑。</p>\n<h3 id=\"存储选型与容灾备份策略\"><a href=\"#存储选型与容灾备份策略\" class=\"headerlink\" title=\"存储选型与容灾备份策略\"></a>存储选型与容灾备份策略</h3><p>为支撑园区海量的异构数据，存储方案的设计必须兼顾性能、成本、扩展性与数据安全。我们首先对项目核心数据类型进行了特征分析：<br>视频录像：非结构化数据，容量大，写入频繁，读取较少，对成本敏感。<br>系统日志：半结构化数据，持续生成，需支持快速检索与长期归档。<br>物联传感数据：典型的时序数据，具备高并发写入、低延迟查询和高压缩比的特性。<br>基于上述分析，并对比了 FC-SAN、iSCSI 等方案后，我们认为单一存储架构无法高效满足所有需求。因此，我们确立了“基于数据特性的分层混合存储”策略：<br>针对视频与日志，采用华为 OceanStor NAS 与对象存储的组合。NAS 承载近期视频与热日志，提供高性价比的在线访问；对象存储则作为冷数据归档层，通过其优秀的扩展性和成本优势，满足长期留存（6个月以上）的合规要求。<br>针对万级传感器毫秒级上报的并发压力，我们选用国产华为openGemini 高性能时序数据库存储。其高吞吐、低延迟的特性完美匹配传感数据的实时处理与查询需求，为上层AI分析提供有力支撑。<br>同时，为保障业务连续性与数据可信，我们构建了多层次的容灾与安全机制：<br>数据冗余：启用日级快照与异地异步复制，确保关键数据具备RPO&#x2F;RTO分钟级的恢复能力。<br>数据防篡改：采用“SHA-256 + SM3”双算法校验数据完整性，签名则使用“RSA-2048 + SM2”国密算法，并对传输与静态数据强制加密及细粒度访问审计。<br>生态兼容：所有关键元数据统一同步至信创数据库（GaussDB），确保与国产软件生态的无缝对接。<br>该架构不仅实现了对不同数据生命周期的精细化管理，优化了TCO（总体拥有成本），更在满足等保2.0要求的同时，为未来对接云上大数据平台奠定了坚实基础。&#96;</p>\n<h3 id=\"安全体制、等保-2-0-要点与态势感知能力（制度—技术—运行）\"><a href=\"#安全体制、等保-2-0-要点与态势感知能力（制度—技术—运行）\" class=\"headerlink\" title=\"安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）\"></a>安全体制、等保 2.0 要点与态势感知能力（制度—技术—运行）</h3><p>我们的安全体系围绕这些威胁展开设计。<br>为满足等保 2.0 在物联网场景下的合规要求，并确保信创环境下的安全可控，考虑到园区物联网面临的三大典型威胁：轻量级终端易被仿冒接入；东西向流量（如摄像头到存储）可能被窃听；供应链投毒风险。我们的安全体系围绕这些威胁展开设计。本项目安全体系以“纵深防御 + 零信任 + 信创可信计算”为核心理念，形成覆盖制度、技术与运行的三层体系。</p>\n<ol>\n<li>在 身份与准入控制 方面，系统基于国产密码算法实现 PKI 体系，采用 PKI 与 802.1X的EAPTLS认证方式，实现端口级访问控制与身份可信，确保设备与运维人员的身份可验证、通信可加密；对无法证书化的轻量终端，采用网关代理与白名单方式实现受控接入，同时符合等保 2.0 “身份鉴别最小化”原则。</li>\n<li>在 网络安全与虚拟化防护 方面，园区网络实施 IT&#x2F;OT&#x2F;DMZ&#x2F;访客 四区隔离，并在边界部署 NGFW、IDS&#x2F;IPS 与流量镜像探针。核心层 CSS2 虚拟化系统通过 VRF + VXLAN 技术实现逻辑多租户隔离，防止虚拟化平面攻击扩散。关键链路启用 MACsec 与 IPsec 双层加密，控制面采用国密隧道协议确保通信机密性与完整性。</li>\n<li>在 审计与态势感知 层面，项目建立基于 国产 SIEM 平台，华为 iMaster SecoManager作为集中日志与事件分析中心，融合 UEBA 与威胁情报（CTI）进行异常检测。通过 SOAR 自动化响应体系，可实现事件自动隔离、工单触发与恢复闭环，将平均响应时间从人工 3 小时缩短至 15 分钟以内。</li>\n<li>此外，系统构建了覆盖漏洞扫描、灰度补丁发布、固件签名验证及设备退役销毁的全生命周期可信管理机制，从设计源头防止供应链攻击，形成了“信创可信 + 虚拟化隔离 + 主动感知”的国产化安全体系。</li>\n</ol>\n<h3 id=\"管理与运维（自动化与可审计）\"><a href=\"#管理与运维（自动化与可审计）\" class=\"headerlink\" title=\"管理与运维（自动化与可审计）\"></a>管理与运维（自动化与可审计）</h3><p>资产与配置管理方面，构建了 NAC 与 CMDB 联动机制，实现设备接入即登记、变更即备案，覆盖设备属性、证书、固件版本与责任人等关键信息；所有入网与变更操作均纳入审批流程并留痕。<br>为降低人工错误并提升变更效率，运维采用模板化配置与脚本化发布，借助 Ansible 与自动化流水线实现批量下发、补丁发布与快速回滚，且所有变更均通过审批并记录审计日志，确保配置一致性与可追溯性。<br>在日常运维中，我们建立了明确的监控职责与响应流程。由NMS平台实时监控网络性能与可用性，任何故障告警将触发运维工单；而所有安全事件则统一由SIEM平台聚合分析，并根据预设剧本（Playbook）自动触发SOAR执行响应，或在需要人工研判时，生成安全事件工单，交由值班团队处置。<br>为保障运行韧性与持续改进，建立了明确的值班机制与 RTO&#x2F;RPO 指标，定期开展等保自查、容灾演练和红蓝攻防演练；同时完善知识库与故障手册，组织定期运维与安全培训，确保制度与技术同频落地。</p>\n<h3 id=\"结论与展望\"><a href=\"#结论与展望\" class=\"headerlink\" title=\"结论与展望\"></a>结论与展望</h3><p>系统已按设计完成部署并通过专家组与用户验收。上线运行后满足既定 KPI（关键区域无线覆盖≥99.9%、关键控制消息端到端延迟&lt;50ms、漫游切换&lt;50ms、系统可用率≥99.95%）与合规要求，安全体系通过等保2.0三级测评，实现安全事件平均响应时间（MTTR）&lt;30分钟。<br>不过，仍存在不足：个别远端室外监测点因初期预算限制采用临时供电方案，极端天气下需人工干预。建议下阶段实施双路供电+光纤冗余改造并预留专项资金。<br>综上所述，本项目成功验证了在 国产化与虚拟化融合环境 下构建高可靠园区物联网的可行性与可复制性，为后续智慧园区、工业互联网场景提供了可推广的设计模板。本次建设显著提升了园区生产可视化与运维效率。未来将进一步深化国产软硬件适配，通过昇腾NPU加速边缘AI推理性能，结合openEuler实时内核增强确定性时延性能，夯实自主可控技术底座，持续提升运营韧性。</p>\n<hr>\n<hr>\n<h1 id=\"论智算中心（AIDC）的多维融合网络架构规划与实践\"><a href=\"#论智算中心（AIDC）的多维融合网络架构规划与实践\" class=\"headerlink\" title=\"论智算中心（AIDC）的多维融合网络架构规划与实践\"></a>论智算中心（AIDC）的多维融合网络架构规划与实践</h1><h1 id=\"——以某大型科研机构AIDC建设项目为例\"><a href=\"#——以某大型科研机构AIDC建设项目为例\" class=\"headerlink\" title=\"——以某大型科研机构AIDC建设项目为例\"></a>——以某大型科研机构AIDC建设项目为例</h1><h2 id=\"摘要-1\"><a href=\"#摘要-1\" class=\"headerlink\" title=\"摘要\"></a>摘要</h2><p>在人工智能与大模型驱动的时代背景下，智算中心（AIDC）已成为承载国家战略与前沿科研的核心基础设施。其对网络的需求超越了传统数据中心，呈现出极致性能、智能调度、内生安全与高效运维等多维度挑战。本文以2024年某大型科研机构智算中心建设项目为例，由本人作为主要负责人深度参与规划设计，系统性地阐述了一套多维融合的网络架构方案。<br>该方案在物理层，采用基于Clos架构的无损以太网承载RoCEv2流量；在虚拟层，引入SRv6与VXLAN技术构建云网算一体化的算力网络；在存储方面，选择了NVMe-oF实现高性能存算互联；在安全方面，围绕“零信任”理念构建了贯穿物理层到应用层的纵深防御体系，并完成了信创环境下的安全兼容性验证；在运维方面，规划并落地了AIOps智能运维平台**，显著提升了运维效率。<br>项目成功交付后，各项性能指标均超越设计预期，并顺利通过等保2.0三级测评，为该机构在大模型训练与科学计算领域的研究提供了坚实可靠的算力底座。</p>\n<h3 id=\"项目背景与规划目标\"><a href=\"#项目背景与规划目标\" class=\"headerlink\" title=\"项目背景与规划目标\"></a>项目背景与规划目标</h3><p>随着以Deepseek为代表的大语言模型参数量呈指数级增长，AI训练模式已演进至万卡规模的并行计算集群。这种变革对网络提出了颠覆性的“三高一低”要求：即高带宽、高并发、高可靠（零丢包）和超低时延。我所在的大型科研机构于2024年初启动了“国家级人工智能与科学计算平台”项目，旨在构建一个拥有超过2000个计算节点的智算中心。为支撑该平台，我们确立了构建一张性能卓越、智能敏捷、安全可靠、自主可控的智-算-存一体化网络的总体目标，并制定了明确的KPI指标：存算访问端到端时延低于20μs，网络转发实现零丢包，关键故障平均定位时间（MTTR）小于15分钟，并通过等保2.0三级测评。</p>\n<h3 id=\"网络架构与设备选型\"><a href=\"#网络架构与设备选型\" class=\"headerlink\" title=\"网络架构与设备选型\"></a>网络架构与设备选型</h3><p>为实现上述目标，我们确立了“物理融合、逻辑解耦”的设计哲学。<br>在物理架构（Underlay）方面，我们采用业界主流的Spine-Leaf三级Clos架构。该架构具备无阻塞、低延迟和水平扩展的天然优势，是构建大规模高性能网络的最佳选择。为实现零丢包的“无损网络”，我们放弃了传统PFC技术，选择了更先进的基于ECN（显式拥塞通知）和DCQCN（数据中心量化拥塞通知）的端到端拥塞控制方案。<br>在虚拟架构（Overlay）方面，我们利用VXLAN技术实现多租户隔离，并创新性地引入SRv6技术，构建真正的“算力网络”，实现了业务意图与网络路径的直接映射。<br>在设备选型上，我们进行了详尽的评估与博弈。Spine交换机我们选用了华为CloudEngine 16808，Leaf交换机则为CloudEngine 8850系列。这一组合的核心优势在于：首先，它们均提供高密度的400GE端口，并具备向800GE平滑演进的能力，满足了项目对带宽的长期规划。其次，CloudEngine 16808拥有业界领先的超大缓存和动态负载均衡算法，能有效吸收AI训练产生的突发流量。更重要的是，在AIOps平台选型博弈中，我们对比了另一家厂商的同类产品，其虽然性能指标接近，但Telemetry数据模型为私有格式。而华为CloudEngine系列全面支持基于gNMI的开放遥测标准。考虑到AIOps平台对开放数据采集的强依赖是保障长期运维效率的关键，我们最终确定了华为方案。这一决策体现了我们<strong>“运维优先于极限性能”的规划原则。计算与存储节点的网卡，我们统一采用了华为IN500系列智能网卡</strong>，它不仅支持RoCEv2硬件卸载，还内置了可编程的引擎，为后续网络功能的灵活扩展预留了空间。</p>\n<h3 id=\"存储网络选择与容灾设计\"><a href=\"#存储网络选择与容灾设计\" class=\"headerlink\" title=\"存储网络选择与容灾设计\"></a>存储网络选择与容灾设计</h3><p>AI训练的本质是数据搬运，高性能存储网络是AIDC的基石。在存储网络方案选型阶段，我们最终选择了基于RoCEv2的NVMe-oF方案，因为它在性能、成本和生态开放性上达到了最佳平衡。我们选用了华为OceanStor Pacific系列分布式存储作为存储底座。<br>在数据可靠性设计上，我们进行了多层次的深入规划。首先，针对多副本机制，我们摒弃了传统的硬件RAID技术。因为在AIDC的大规模分布式场景下，RAID的“写放大”问题严重，且单盘故障后的重构过程漫长，对整个系统性能冲击巨大。取而代之的是，我们采用了更为先进的基于软件定义的纠删码（Erasure Coding, EC）技术。我们配置了“16+4”的EC策略，即数据被分成16个数据块和4个校验块，分散存储在20个不同的节点上。这种方式不仅磁盘利用率高达80%（远超三副本的33%），而且在节点或硬盘故障时，可以由多个节点并行进行数据重构，恢复速度比传统RAID提升一个数量级，极大地保障了业务的连续性。<br>在数据完整性与机密性方面，我们构建了双重保障。我们采用“SHA‑256 + SM3”双算法对写入数据进行完整性校验，签名使用“RSA‑2048 + SM2”国密算法；对传输与静态数据强制加密，并配合细粒度访问审计，确保数据全生命周期的可信与可追溯。</p>\n<h3 id=\"等保合规与内生安全设计\"><a href=\"#等保合规与内生安全设计\" class=\"headerlink\" title=\"等保合规与内生安全设计\"></a>等保合规与内生安全设计</h3><p>AIDC承载着机构最核心的数据与算力资产，安全是与性能同等重要的生命线。我们以零信任为核心，构建了“物理&#x2F;链路—网络—管控&#x2F;审计”三道防线。<br>第一道防线是物理与链路层安全。我们在所有CloudEngine交换机之间的互联端口上启用MACsec硬件加密。<br>第二道防线是网络层隔离与访问控制。我们利用VXLAN和分布式防火墙技术，实现了“微隔离”，有效遏制了威胁在数据中心内部的横向移动。<br>第三道防线是管控与审计层安全。我们部署了国产SIEM&#x2F;SOAR平台作为安全大脑。在此过程中，我牵头负责了安全体系的信创兼容性验证，通过大量测试，我们解决了国产密码算法（SM2&#x2F;3&#x2F;4）与硬件加密引擎的适配问题、PKI及SIEM日志解析的适配问题，形成了一套完整且自主可控的安全解决方案，确保安全体系既自主可控又能满足等保2.0三级要求。</p>\n<h3 id=\"自动化运维保障\"><a href=\"#自动化运维保障\" class=\"headerlink\" title=\"自动化运维保障\"></a>自动化运维保障</h3><p>我们规划并落地了一套AIOps平台作为整个网络的“智慧大脑”。该平台采用“数据湖 + AI引擎 + 自动化编排”的三层架构，通过Telemetry流式遥测采集数据，为智能分析提供了高质量的基础。<br>在平台落地初期，我们曾遇到告警风暴收敛效果不佳的棘手问题。作为该模块负责人，我牵头排查发现根源在于知识图谱缺失了应用与服务器的关联关系。为此，我提出并主导了CMDB与AIOps平台的‘双向同步’改造，将应用依赖关系实时注入知识图谱。改造后，根因定位准确率从70%提升至95%以上。这个过程让我深刻认识到，AIOps的“智能”源自于数据的“全息”。</p>\n<h3 id=\"项目交付总结与展望\"><a href=\"#项目交付总结与展望\" class=\"headerlink\" title=\"项目交付总结与展望\"></a>项目交付总结与展望</h3><p>项目于2025年6月成功交付。 经严格测试，各项关键指标均达到或优于设计目标：网络平均端到端时延稳定在15μs，万兆并发下的丢包率为0，GPU算力利用率（XPU a-like Ratio）从未采用RDMA网络的60%提升至92%。AIOps平台上线后，98%的网络异常能够在影响业务前被感知和处置，MTTR从小时级降至15分钟内，项目顺利通过等保2.0三级测评。<br>回顾整个项目，最大的挑战在于多技术栈的深度融合。一个相对遗憾的点是，由于项目周期紧张，我们优先保障了计算和存储网络的建设，而带外的管理网络建设则沿用了较为传统的方案，其自动化和安全水位未能与主网络完全看齐，这是下一阶段优化工作的重点。<br>展望未来，我们将进一步探索基于意图的网络（IBN），并前瞻性地研究抗量子密码（PQC）在数据中心网络中的应用，持续夯实国家科研基础设施的数字底座。</p>\n"},{"title":"适老化——自动拨打视频和刷抖音","date":"2025-10-10T11:01:00.000Z","_content":"\n\n\n爷爷在世时，家里气氛还算热闹些，乡下常常养一条狗。爷爷是读过书的，会写字也会说普通话，自然会用老年机接电话，能捣鼓下电视，最常看的就是中央一台、九台、十台和江西地方台（因为常放薛平贵与王宝钏，封神演义）。那时候还有一台能插内存卡的大屏智能屏，按键在屏幕旁边一列，专门给他们看提前下好的赣剧、黄梅戏什么的。\n\n![shilaohua2](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg)\n\n奶奶已经78岁了，右眼看不见，小时候没念过书，也不会说普通话，属于那种老一辈的文盲，但十分勤劳停不下来，在家门口的地种了点菜，闲时乐趣大概也就是让爷爷放动物世界、黄梅戏、赣剧。\n\n爷爷在世时，二人在农村种点菜，每年还会种点红薯，说孙子爱吃红薯。\n\n自从爷爷过世后，奶奶的生活变得安静了很多，又养过两次狗，一次在路上被其他狗咬了，咬回去被狗主人打的惨不忍睹，回家没多久后偷偷躲在离奶奶家不远处，费了一下午找到，死了，埋了。后又养了一只，从监控看到被狗贩子在门口拿绳索栓头上带走了。\n\n她不会用那台智能屏，也一度连电话都不会接。后来和父亲慢慢教会她接电话、拨我爸的号码（电话簿第一个，按一下打开电话簿，再按一下拨号），才算勉强能沟通。智能屏里后来加上了爷爷去世时买水、入木、下葬的几小时录像，教会奶奶用那台机器后，奶奶会反复看，但内容有限，后来机器也坏了，娱乐这一块也基本断了。\n\n电视其实还能用，就是天线锅那种，就是每次开机都跳到中央一台，奶奶听不懂太多普通话不看新闻。可惜奶奶看不见又记不住按哪个键，无法跳到中央十台，各种AI尝试也不支持本地方言，想额外搞设备用AI也得从头训练语音模型识别量化，成本过高当时能力不足，基本束手无策。本想着换个智能机顶盒配合做自动化脚本，给机顶盒刷机后，发现当时的那个机顶盒只是安卓4.4，armv7架构安装不上Macrodroid，找不到32位的Macrodroid，试过另一个适配32位的软件并不好用，很多需要软件内UI交互的自动化脚本无法实现。\n\n于是我开始琢磨，能不能给奶奶整个智能机，哪怕只解决最基本的娱乐和视频通话，总比啥也没有强。\n\n现实总归比理想骨感，最后只能实现自动刷抖音和自动打接听微信视频通话这俩功能。\n\n计划从一部荣耀9X开始，但发现权限不够折腾，脚本无法控制系统层面，因为不管是什么大字版还是长辈版，对于老一辈农村人文盲而言都是没用的——看不懂字又听不懂普通话，需要另辟蹊径。\n\n后来换成了妈妈刚好退役下来的红米K30。刷了面具，ADB命令设置开机自启MacroDroid（核心出装），装了了焕晨内存优化和Adguard，尽力去除所有广告，又搞了LSPosed、逗音小手、Freedom+，差不多搞定了“自动无广告刷抖音”这件事。\n\n![shilaohua3](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg)\n\n![shilaohua4](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg)\n\n其实抖音方面，最累人的是“养号”。抖音不能一天关注太多博主，否则算法会封控，只能每天一点点关注黄梅戏、赣剧、动物类博主。相关视频上多停留点赞收藏评论，不相关的要果断点“不感兴趣”，设置里的视频推荐比例也可以稍微调整。几天后，算法基本品到了奶奶口味的咸淡，偶尔还能刷到附近的人，听到熟悉的方言，我也会特意保留点赞。再配合逗音小手和Freedom+：全屏播放，去掉顶栏，头像点赞等杂项，只留底栏的“首页”，干掉可能推送的图文直播广告更新，只留视频，避免误触，视频播完自动滑下一个，娱乐这块算是勉强交差了。\n\n视频沟通这块，奶奶常年自己在家，只有邻居陪着。她偶尔想和我爸视频，再看看儿女孙女，于是我琢磨着在微信上下点功夫。把我爸的微信聊天置顶，桌面放上爸的头像(通过万象小组件)，点一下直接触发脚本回桌面再点开微信（MacroDroid直接打开微信有bug，别用），通过按键自动拨视频。只置顶一个人，点的位置就固定，别的亲戚只能主动打进来，原想使用全屏文本识别实现多人，命中率很低，效果太差，遂放弃。\n\n![shilaohua5](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg)\n\n自动接听视频是靠脚本实现的。微信来视频有三种形式：通知弹窗、全屏、小窗。因为奶奶只能学会点全屏的绿色按键，且会忘记，故做这个脚本：小窗直接移到右上角，和通知弹窗共用一个点击。点开后会变全屏，等两秒，再用一个固定按键点绿色的接听键。测试了很多次，总算实现了自动接视频，当然条件约束要加好，每次接听或熄屏后要清理通知，不然就乱套。\n\n![shilaohua6](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg)\n\n其实还可以多做一点，可以使用TTS，通过通知昵称备注，播报对应来电人名(可以普通话音译成方言)，让奶奶提前知道是谁打的电话，这次修bug时未想到，算是个遗憾。\n\n还有，注意调整手机分辨率固定，智能省电的变化分辨率会导致UI交互坐标定位出现问题。由于偶尔会莫名其妙点到飞行模式，至今也不知道为什么。只好设置成亮屏和熄屏时自动关掉飞行模式，音量也都调到最大，打开微信抖音也调到最大，尽量别让奶奶错过什么。\n\n现在手机桌面只放两张图片——我父亲的照片和纯黑图，奶奶要学会的就是按侧键亮屏，点纯黑图片刷抖音，点我父亲照片打视频电话(侧键可以额外加上按音量键也响应打开主屏幕亮屏)打完视频刷完抖音都会自动退到桌面。\n\n![shilaohua7](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg)\n\n到头来，虽然还有很多不完美的地方，但奶奶的娱乐和沟通基本能满足了。\n\n奶奶也不再养狗了，这次中秋回家换也成了两只兔子。\n\n回头想想这些折腾，大概就是技术能给家人带来的一点点温暖吧。\n\n感谢用上的软件技术的所有开发者和其他酷友文章和评论帮助的启发。","source":"_posts/适老化——自动拨打视频和刷抖音.md","raw":"---\ntitle: 适老化——自动拨打视频和刷抖音\ndate: 2025-10-10 19:01:00\ncategories: 学习笔记\ntags: c\n---\n\n\n\n爷爷在世时，家里气氛还算热闹些，乡下常常养一条狗。爷爷是读过书的，会写字也会说普通话，自然会用老年机接电话，能捣鼓下电视，最常看的就是中央一台、九台、十台和江西地方台（因为常放薛平贵与王宝钏，封神演义）。那时候还有一台能插内存卡的大屏智能屏，按键在屏幕旁边一列，专门给他们看提前下好的赣剧、黄梅戏什么的。\n\n![shilaohua2](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua2.jpeg)\n\n奶奶已经78岁了，右眼看不见，小时候没念过书，也不会说普通话，属于那种老一辈的文盲，但十分勤劳停不下来，在家门口的地种了点菜，闲时乐趣大概也就是让爷爷放动物世界、黄梅戏、赣剧。\n\n爷爷在世时，二人在农村种点菜，每年还会种点红薯，说孙子爱吃红薯。\n\n自从爷爷过世后，奶奶的生活变得安静了很多，又养过两次狗，一次在路上被其他狗咬了，咬回去被狗主人打的惨不忍睹，回家没多久后偷偷躲在离奶奶家不远处，费了一下午找到，死了，埋了。后又养了一只，从监控看到被狗贩子在门口拿绳索栓头上带走了。\n\n她不会用那台智能屏，也一度连电话都不会接。后来和父亲慢慢教会她接电话、拨我爸的号码（电话簿第一个，按一下打开电话簿，再按一下拨号），才算勉强能沟通。智能屏里后来加上了爷爷去世时买水、入木、下葬的几小时录像，教会奶奶用那台机器后，奶奶会反复看，但内容有限，后来机器也坏了，娱乐这一块也基本断了。\n\n电视其实还能用，就是天线锅那种，就是每次开机都跳到中央一台，奶奶听不懂太多普通话不看新闻。可惜奶奶看不见又记不住按哪个键，无法跳到中央十台，各种AI尝试也不支持本地方言，想额外搞设备用AI也得从头训练语音模型识别量化，成本过高当时能力不足，基本束手无策。本想着换个智能机顶盒配合做自动化脚本，给机顶盒刷机后，发现当时的那个机顶盒只是安卓4.4，armv7架构安装不上Macrodroid，找不到32位的Macrodroid，试过另一个适配32位的软件并不好用，很多需要软件内UI交互的自动化脚本无法实现。\n\n于是我开始琢磨，能不能给奶奶整个智能机，哪怕只解决最基本的娱乐和视频通话，总比啥也没有强。\n\n现实总归比理想骨感，最后只能实现自动刷抖音和自动打接听微信视频通话这俩功能。\n\n计划从一部荣耀9X开始，但发现权限不够折腾，脚本无法控制系统层面，因为不管是什么大字版还是长辈版，对于老一辈农村人文盲而言都是没用的——看不懂字又听不懂普通话，需要另辟蹊径。\n\n后来换成了妈妈刚好退役下来的红米K30。刷了面具，ADB命令设置开机自启MacroDroid（核心出装），装了了焕晨内存优化和Adguard，尽力去除所有广告，又搞了LSPosed、逗音小手、Freedom+，差不多搞定了“自动无广告刷抖音”这件事。\n\n![shilaohua3](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua3.jpeg)\n\n![shilaohua4](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua4.jpeg)\n\n其实抖音方面，最累人的是“养号”。抖音不能一天关注太多博主，否则算法会封控，只能每天一点点关注黄梅戏、赣剧、动物类博主。相关视频上多停留点赞收藏评论，不相关的要果断点“不感兴趣”，设置里的视频推荐比例也可以稍微调整。几天后，算法基本品到了奶奶口味的咸淡，偶尔还能刷到附近的人，听到熟悉的方言，我也会特意保留点赞。再配合逗音小手和Freedom+：全屏播放，去掉顶栏，头像点赞等杂项，只留底栏的“首页”，干掉可能推送的图文直播广告更新，只留视频，避免误触，视频播完自动滑下一个，娱乐这块算是勉强交差了。\n\n视频沟通这块，奶奶常年自己在家，只有邻居陪着。她偶尔想和我爸视频，再看看儿女孙女，于是我琢磨着在微信上下点功夫。把我爸的微信聊天置顶，桌面放上爸的头像(通过万象小组件)，点一下直接触发脚本回桌面再点开微信（MacroDroid直接打开微信有bug，别用），通过按键自动拨视频。只置顶一个人，点的位置就固定，别的亲戚只能主动打进来，原想使用全屏文本识别实现多人，命中率很低，效果太差，遂放弃。\n\n![shilaohua5](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua5.jpeg)\n\n自动接听视频是靠脚本实现的。微信来视频有三种形式：通知弹窗、全屏、小窗。因为奶奶只能学会点全屏的绿色按键，且会忘记，故做这个脚本：小窗直接移到右上角，和通知弹窗共用一个点击。点开后会变全屏，等两秒，再用一个固定按键点绿色的接听键。测试了很多次，总算实现了自动接视频，当然条件约束要加好，每次接听或熄屏后要清理通知，不然就乱套。\n\n![shilaohua6](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua6.jpeg)\n\n其实还可以多做一点，可以使用TTS，通过通知昵称备注，播报对应来电人名(可以普通话音译成方言)，让奶奶提前知道是谁打的电话，这次修bug时未想到，算是个遗憾。\n\n还有，注意调整手机分辨率固定，智能省电的变化分辨率会导致UI交互坐标定位出现问题。由于偶尔会莫名其妙点到飞行模式，至今也不知道为什么。只好设置成亮屏和熄屏时自动关掉飞行模式，音量也都调到最大，打开微信抖音也调到最大，尽量别让奶奶错过什么。\n\n现在手机桌面只放两张图片——我父亲的照片和纯黑图，奶奶要学会的就是按侧键亮屏，点纯黑图片刷抖音，点我父亲照片打视频电话(侧键可以额外加上按音量键也响应打开主屏幕亮屏)打完视频刷完抖音都会自动退到桌面。\n\n![shilaohua7](/images/适老化——自动拨打视频和刷抖音.assets/shilaohua7.jpeg)\n\n到头来，虽然还有很多不完美的地方，但奶奶的娱乐和沟通基本能满足了。\n\n奶奶也不再养狗了，这次中秋回家换也成了两只兔子。\n\n回头想想这些折腾，大概就是技术能给家人带来的一点点温暖吧。\n\n感谢用上的软件技术的所有开发者和其他酷友文章和评论帮助的启发。","slug":"适老化——自动拨打视频和刷抖音","published":1,"updated":"2026-01-15T15:00:16.585Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivo000a24j326jr9583","content":"<p>爷爷在世时，家里气氛还算热闹些，乡下常常养一条狗。爷爷是读过书的，会写字也会说普通话，自然会用老年机接电话，能捣鼓下电视，最常看的就是中央一台、九台、十台和江西地方台（因为常放薛平贵与王宝钏，封神演义）。那时候还有一台能插内存卡的大屏智能屏，按键在屏幕旁边一列，专门给他们看提前下好的赣剧、黄梅戏什么的。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua2.jpeg\" alt=\"shilaohua2\"></p>\n<p>奶奶已经78岁了，右眼看不见，小时候没念过书，也不会说普通话，属于那种老一辈的文盲，但十分勤劳停不下来，在家门口的地种了点菜，闲时乐趣大概也就是让爷爷放动物世界、黄梅戏、赣剧。</p>\n<p>爷爷在世时，二人在农村种点菜，每年还会种点红薯，说孙子爱吃红薯。</p>\n<p>自从爷爷过世后，奶奶的生活变得安静了很多，又养过两次狗，一次在路上被其他狗咬了，咬回去被狗主人打的惨不忍睹，回家没多久后偷偷躲在离奶奶家不远处，费了一下午找到，死了，埋了。后又养了一只，从监控看到被狗贩子在门口拿绳索栓头上带走了。</p>\n<p>她不会用那台智能屏，也一度连电话都不会接。后来和父亲慢慢教会她接电话、拨我爸的号码（电话簿第一个，按一下打开电话簿，再按一下拨号），才算勉强能沟通。智能屏里后来加上了爷爷去世时买水、入木、下葬的几小时录像，教会奶奶用那台机器后，奶奶会反复看，但内容有限，后来机器也坏了，娱乐这一块也基本断了。</p>\n<p>电视其实还能用，就是天线锅那种，就是每次开机都跳到中央一台，奶奶听不懂太多普通话不看新闻。可惜奶奶看不见又记不住按哪个键，无法跳到中央十台，各种AI尝试也不支持本地方言，想额外搞设备用AI也得从头训练语音模型识别量化，成本过高当时能力不足，基本束手无策。本想着换个智能机顶盒配合做自动化脚本，给机顶盒刷机后，发现当时的那个机顶盒只是安卓4.4，armv7架构安装不上Macrodroid，找不到32位的Macrodroid，试过另一个适配32位的软件并不好用，很多需要软件内UI交互的自动化脚本无法实现。</p>\n<p>于是我开始琢磨，能不能给奶奶整个智能机，哪怕只解决最基本的娱乐和视频通话，总比啥也没有强。</p>\n<p>现实总归比理想骨感，最后只能实现自动刷抖音和自动打接听微信视频通话这俩功能。</p>\n<p>计划从一部荣耀9X开始，但发现权限不够折腾，脚本无法控制系统层面，因为不管是什么大字版还是长辈版，对于老一辈农村人文盲而言都是没用的——看不懂字又听不懂普通话，需要另辟蹊径。</p>\n<p>后来换成了妈妈刚好退役下来的红米K30。刷了面具，ADB命令设置开机自启MacroDroid（核心出装），装了了焕晨内存优化和Adguard，尽力去除所有广告，又搞了LSPosed、逗音小手、Freedom+，差不多搞定了“自动无广告刷抖音”这件事。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua3.jpeg\" alt=\"shilaohua3\"></p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua4.jpeg\" alt=\"shilaohua4\"></p>\n<p>其实抖音方面，最累人的是“养号”。抖音不能一天关注太多博主，否则算法会封控，只能每天一点点关注黄梅戏、赣剧、动物类博主。相关视频上多停留点赞收藏评论，不相关的要果断点“不感兴趣”，设置里的视频推荐比例也可以稍微调整。几天后，算法基本品到了奶奶口味的咸淡，偶尔还能刷到附近的人，听到熟悉的方言，我也会特意保留点赞。再配合逗音小手和Freedom+：全屏播放，去掉顶栏，头像点赞等杂项，只留底栏的“首页”，干掉可能推送的图文直播广告更新，只留视频，避免误触，视频播完自动滑下一个，娱乐这块算是勉强交差了。</p>\n<p>视频沟通这块，奶奶常年自己在家，只有邻居陪着。她偶尔想和我爸视频，再看看儿女孙女，于是我琢磨着在微信上下点功夫。把我爸的微信聊天置顶，桌面放上爸的头像(通过万象小组件)，点一下直接触发脚本回桌面再点开微信（MacroDroid直接打开微信有bug，别用），通过按键自动拨视频。只置顶一个人，点的位置就固定，别的亲戚只能主动打进来，原想使用全屏文本识别实现多人，命中率很低，效果太差，遂放弃。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua5.jpeg\" alt=\"shilaohua5\"></p>\n<p>自动接听视频是靠脚本实现的。微信来视频有三种形式：通知弹窗、全屏、小窗。因为奶奶只能学会点全屏的绿色按键，且会忘记，故做这个脚本：小窗直接移到右上角，和通知弹窗共用一个点击。点开后会变全屏，等两秒，再用一个固定按键点绿色的接听键。测试了很多次，总算实现了自动接视频，当然条件约束要加好，每次接听或熄屏后要清理通知，不然就乱套。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua6.jpeg\" alt=\"shilaohua6\"></p>\n<p>其实还可以多做一点，可以使用TTS，通过通知昵称备注，播报对应来电人名(可以普通话音译成方言)，让奶奶提前知道是谁打的电话，这次修bug时未想到，算是个遗憾。</p>\n<p>还有，注意调整手机分辨率固定，智能省电的变化分辨率会导致UI交互坐标定位出现问题。由于偶尔会莫名其妙点到飞行模式，至今也不知道为什么。只好设置成亮屏和熄屏时自动关掉飞行模式，音量也都调到最大，打开微信抖音也调到最大，尽量别让奶奶错过什么。</p>\n<p>现在手机桌面只放两张图片——我父亲的照片和纯黑图，奶奶要学会的就是按侧键亮屏，点纯黑图片刷抖音，点我父亲照片打视频电话(侧键可以额外加上按音量键也响应打开主屏幕亮屏)打完视频刷完抖音都会自动退到桌面。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua7.jpeg\" alt=\"shilaohua7\"></p>\n<p>到头来，虽然还有很多不完美的地方，但奶奶的娱乐和沟通基本能满足了。</p>\n<p>奶奶也不再养狗了，这次中秋回家换也成了两只兔子。</p>\n<p>回头想想这些折腾，大概就是技术能给家人带来的一点点温暖吧。</p>\n<p>感谢用上的软件技术的所有开发者和其他酷友文章和评论帮助的启发。</p>\n","excerpt":"","more":"<p>爷爷在世时，家里气氛还算热闹些，乡下常常养一条狗。爷爷是读过书的，会写字也会说普通话，自然会用老年机接电话，能捣鼓下电视，最常看的就是中央一台、九台、十台和江西地方台（因为常放薛平贵与王宝钏，封神演义）。那时候还有一台能插内存卡的大屏智能屏，按键在屏幕旁边一列，专门给他们看提前下好的赣剧、黄梅戏什么的。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua2.jpeg\" alt=\"shilaohua2\"></p>\n<p>奶奶已经78岁了，右眼看不见，小时候没念过书，也不会说普通话，属于那种老一辈的文盲，但十分勤劳停不下来，在家门口的地种了点菜，闲时乐趣大概也就是让爷爷放动物世界、黄梅戏、赣剧。</p>\n<p>爷爷在世时，二人在农村种点菜，每年还会种点红薯，说孙子爱吃红薯。</p>\n<p>自从爷爷过世后，奶奶的生活变得安静了很多，又养过两次狗，一次在路上被其他狗咬了，咬回去被狗主人打的惨不忍睹，回家没多久后偷偷躲在离奶奶家不远处，费了一下午找到，死了，埋了。后又养了一只，从监控看到被狗贩子在门口拿绳索栓头上带走了。</p>\n<p>她不会用那台智能屏，也一度连电话都不会接。后来和父亲慢慢教会她接电话、拨我爸的号码（电话簿第一个，按一下打开电话簿，再按一下拨号），才算勉强能沟通。智能屏里后来加上了爷爷去世时买水、入木、下葬的几小时录像，教会奶奶用那台机器后，奶奶会反复看，但内容有限，后来机器也坏了，娱乐这一块也基本断了。</p>\n<p>电视其实还能用，就是天线锅那种，就是每次开机都跳到中央一台，奶奶听不懂太多普通话不看新闻。可惜奶奶看不见又记不住按哪个键，无法跳到中央十台，各种AI尝试也不支持本地方言，想额外搞设备用AI也得从头训练语音模型识别量化，成本过高当时能力不足，基本束手无策。本想着换个智能机顶盒配合做自动化脚本，给机顶盒刷机后，发现当时的那个机顶盒只是安卓4.4，armv7架构安装不上Macrodroid，找不到32位的Macrodroid，试过另一个适配32位的软件并不好用，很多需要软件内UI交互的自动化脚本无法实现。</p>\n<p>于是我开始琢磨，能不能给奶奶整个智能机，哪怕只解决最基本的娱乐和视频通话，总比啥也没有强。</p>\n<p>现实总归比理想骨感，最后只能实现自动刷抖音和自动打接听微信视频通话这俩功能。</p>\n<p>计划从一部荣耀9X开始，但发现权限不够折腾，脚本无法控制系统层面，因为不管是什么大字版还是长辈版，对于老一辈农村人文盲而言都是没用的——看不懂字又听不懂普通话，需要另辟蹊径。</p>\n<p>后来换成了妈妈刚好退役下来的红米K30。刷了面具，ADB命令设置开机自启MacroDroid（核心出装），装了了焕晨内存优化和Adguard，尽力去除所有广告，又搞了LSPosed、逗音小手、Freedom+，差不多搞定了“自动无广告刷抖音”这件事。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua3.jpeg\" alt=\"shilaohua3\"></p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua4.jpeg\" alt=\"shilaohua4\"></p>\n<p>其实抖音方面，最累人的是“养号”。抖音不能一天关注太多博主，否则算法会封控，只能每天一点点关注黄梅戏、赣剧、动物类博主。相关视频上多停留点赞收藏评论，不相关的要果断点“不感兴趣”，设置里的视频推荐比例也可以稍微调整。几天后，算法基本品到了奶奶口味的咸淡，偶尔还能刷到附近的人，听到熟悉的方言，我也会特意保留点赞。再配合逗音小手和Freedom+：全屏播放，去掉顶栏，头像点赞等杂项，只留底栏的“首页”，干掉可能推送的图文直播广告更新，只留视频，避免误触，视频播完自动滑下一个，娱乐这块算是勉强交差了。</p>\n<p>视频沟通这块，奶奶常年自己在家，只有邻居陪着。她偶尔想和我爸视频，再看看儿女孙女，于是我琢磨着在微信上下点功夫。把我爸的微信聊天置顶，桌面放上爸的头像(通过万象小组件)，点一下直接触发脚本回桌面再点开微信（MacroDroid直接打开微信有bug，别用），通过按键自动拨视频。只置顶一个人，点的位置就固定，别的亲戚只能主动打进来，原想使用全屏文本识别实现多人，命中率很低，效果太差，遂放弃。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua5.jpeg\" alt=\"shilaohua5\"></p>\n<p>自动接听视频是靠脚本实现的。微信来视频有三种形式：通知弹窗、全屏、小窗。因为奶奶只能学会点全屏的绿色按键，且会忘记，故做这个脚本：小窗直接移到右上角，和通知弹窗共用一个点击。点开后会变全屏，等两秒，再用一个固定按键点绿色的接听键。测试了很多次，总算实现了自动接视频，当然条件约束要加好，每次接听或熄屏后要清理通知，不然就乱套。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua6.jpeg\" alt=\"shilaohua6\"></p>\n<p>其实还可以多做一点，可以使用TTS，通过通知昵称备注，播报对应来电人名(可以普通话音译成方言)，让奶奶提前知道是谁打的电话，这次修bug时未想到，算是个遗憾。</p>\n<p>还有，注意调整手机分辨率固定，智能省电的变化分辨率会导致UI交互坐标定位出现问题。由于偶尔会莫名其妙点到飞行模式，至今也不知道为什么。只好设置成亮屏和熄屏时自动关掉飞行模式，音量也都调到最大，打开微信抖音也调到最大，尽量别让奶奶错过什么。</p>\n<p>现在手机桌面只放两张图片——我父亲的照片和纯黑图，奶奶要学会的就是按侧键亮屏，点纯黑图片刷抖音，点我父亲照片打视频电话(侧键可以额外加上按音量键也响应打开主屏幕亮屏)打完视频刷完抖音都会自动退到桌面。</p>\n<p><img src=\"/images/%E9%80%82%E8%80%81%E5%8C%96%E2%80%94%E2%80%94%E8%87%AA%E5%8A%A8%E6%8B%A8%E6%89%93%E8%A7%86%E9%A2%91%E5%92%8C%E5%88%B7%E6%8A%96%E9%9F%B3.assets/shilaohua7.jpeg\" alt=\"shilaohua7\"></p>\n<p>到头来，虽然还有很多不完美的地方，但奶奶的娱乐和沟通基本能满足了。</p>\n<p>奶奶也不再养狗了，这次中秋回家换也成了两只兔子。</p>\n<p>回头想想这些折腾，大概就是技术能给家人带来的一点点温暖吧。</p>\n<p>感谢用上的软件技术的所有开发者和其他酷友文章和评论帮助的启发。</p>\n"},{"title":"从公网IPv4困境中解脱：基于IPv6的免费内网访问方案（OpenWrt实战）","_content":"\n在当今的国内网络环境中，想要通过公网IPv4访问家庭内网服务，已经成了一个越来越难实现的\"技术挑战\"。运营商普遍取消了公网IPv4分配，即使通过光猫桥接获取的IP，也多是100.x.x.x的内网地址。而传统的内网穿透工具（如frp、ngrok）不仅需要额外服务器成本，还经常面临不稳定和速度瓶颈的问题。\n\n**但IPv6的普及为我们打开了一扇新门**——三大运营商几乎100%支持IPv6，且地址是真·公网。本文将分享一个完整、稳定、成本为零的解决方案：**IPv6 + DNSHE DDNS + Caddy反向代理**，无需额外付费，无需复杂配置，即可实现安全、稳定的远程访问。\n\n------\n\n## 为什么IPv6是当前最优解？（附DDNS必要性说明）\n\n### 1. 无需额外成本\n\n- 国内三大运营商（电信/移动/联通）的宽带普遍提供IPv6\n- 不需要加钱办理专线，不依赖额外付费服务\n- 手机热点/5G CPE设备同样能获取公网IPv6\n\n### 2. 真正的公网连接\n\n- IPv6地址是全球可达的，无需NAT转换\n- 与IPv4的\"内网IP+端口映射\"相比，连接更直接、延迟更低\n\n### 3. DDNS的必要性：解决IPv6动态变化问题\n\nIPv6地址虽然提供公网连接，但它是**动态分配**的。每次路由器重启或网络重连，IPv6前缀都可能变化。如果没有DDNS，我们需要记住每次变化的IPv6地址才能访问，这显然不现实。DDNS通过将域名与动态IPv6地址关联，确保无论地址如何变化，域名始终指向正确的IP，从而实现稳定访问。\n\n> 重要提示：IPv6的DDNS比IPv4更可靠，因为IPv6地址变化频率远低于IPv4，且IPv6网络环境更简单。\n\n------\n\n## 实战方案：完整部署指南\n\n### 1. 域名准备：白嫖DNSHE二级域名\n\n**为什么选择DNSHE？**\n\n- 免费提供二级域名（如`yourname.cc.cd`）\n- 支持API动态更新，适合DDNS\n- 无广告、无强制付费\n\n**操作步骤：**\n\n1. 访问 [DNSHE官网](https://my.dnshe.com/index.php?m=domain_hub) 注册账号\n2. 申请一个二级域名（如`home.cc.cd`）\n3. 添加AAAA记录（IPv6专用）：\n   - 主机名：`@`\n   - 记录值：`::1`（临时占位）\n   - TTL：`600`（10分钟）\n\n**获取API更新地址：** 在DNSHE控制台找到\"动态域名解析\"接口，格式如下：\n\n```\nhttps://api005.dnshe.com/index.php?m=domain_hub&c=api&a=update&domain=yourdomain&username=yourusername&password=yourpassword&ipaddr=[IP]\n```\n\n*注意：`[IP]`是OpenWrt的内置变量，无需手动填写*\n\n------\n\n### 2. OpenWrt DDNS配置\n\n**关键点**：确保IPv6地址能被正确更新\n\n1. 进入OpenWrt后台：`服务 > 动态DNS`\n2. 添加新服务：\n   - 服务名称：`dnshe_ipv6`\n   - 查询主机名：`home.cc.cd`\n   - IP地址版本：`IPv6`\n   - 服务提供商：`自定义`\n   - 更新URL：填写上一步获取的API地址\n   - 检查周期：`5分钟`\n   - IP地址来源：`接口`\n   - 接口：`wan6`（IPv6接口）\n\n**验证配置**：\n\n- 启动服务后，查看日志确认`Update successful`\n- 在DNSHE控制台刷新域名解析，确认AAAA记录已更新\n\n------\n\n### 3. 修改LuCI管理界面端口（关键步骤）\n\n**问题**：OpenWrt的LuCI默认使用80和443端口，与Caddy冲突\n\n**为什么需要让出80和443端口？** Caddy作为反向代理服务器，需要监听80（HTTP）和443（HTTPS）端口，才能实现无需在URL中添加端口号，直接通过域名访问。例如，用户可以直接访问`https://home.cc.cd`，而不是`https://home.cc.cd:443`。这是HTTPS服务的标准做法，也是用户体验最佳的方式。\n\n**解决方案**：\n\n1. 进入OpenWrt管理界面：`系统 > 管理权 > 网络`\n2. 修改HTTP端口为`8080`，HTTPS端口为`8443`\n3. 保存并应用配置\n\n**验证**：\n\n- 现在LuCI可通过`http://192.168.1.1:8080`访问\n- 80和443端口已空出，供Caddy使用\n\n------\n\n### 4. 防火墙配置：最容易被忽略的关键步骤\n\n**问题现象**：配置完成后，外网无法访问\n\n**原因**：OpenWrt防火墙默认拒绝所有入站连接\n\n**为什么需要特定的防火墙规则？**\n\n- Caddy需要监听80和443端口，但默认防火墙会阻止所有入站连接\n- 仅开放IPv6的入站连接，可以避免IPv4的潜在安全风险\n- 限制为IPv6可以确保只有IPv6网络的连接被允许，提高安全性\n\n**解决方案**：\n\n1. 进入`网络 > 防火墙 > 通信规则`\n2. 添加新规则：\n   - 名称：`Allow-IPv6-Web`\n   - 协议：`TCP`\n   - 源区域：`wan6`\n   - 目标区域：`lan`（或`设备`）\n   - 目标端口：`80,443`\n   - 限制地址族：`IPv6`\n\n> **重要提示**：仅开放必要的端口，避免安全风险\n\n------\n\n### 5. Caddy部署：轻量级反向代理\n\n**为什么选择Caddy？**\n\n- Go语言编写，内存占用极低\n- 自动申请和续期HTTPS证书\n- 配置简单直观，无需复杂配置\n\n**部署步骤：**\n\n1. 在路由器上创建配置目录：\n\n   ```bash\n   mkdir -p /mnt/docker/caddy/config\n   ```\n\n2. 创建`Caddyfile`：\n\n   ```caddy\n   home.cc.cd {\n       encode gzip\n       reverse_proxy 192.168.1.1:8080\n   }\n   ```\n\n   *注：`192.168.1.1:8080`是修改后的LuCI地址*\n\n3. 启动容器：\n\n   ```bash\n   docker run -d \\\n     --name caddy \\\n     --restart unless-stopped \\\n     --network host \\\n     -v /mnt/docker/caddy/config/Caddyfile:/etc/caddy/Caddyfile \\\n     caddy:latest\n   ```\n\n**验证**：\n\n- 等待1-2分钟，Caddy会自动申请SSL证书\n- 用手机4G网络访问`https://home.cc.cd`，应显示OpenWrt登录界面\n\n------\n\n### 6. 内网DNS优化：解决\"回环\"问题\n\n**问题现象**：在家中WiFi下访问域名时速度慢或失败\n\n**原因**：内网设备解析到公网IPv6地址，导致数据包绕行\n\n**解决方案**：DNS劫持（内网直连）\n\n1. 进入`网络 > DHCP/DNS > 主机名`\n2. 添加规则：\n   - 主机名：`home.cc.cd`\n   - IP地址：`192.168.1.1`（路由器内网IPv4）\n\n**效果**：\n\n- 外网访问：解析到公网IPv6 → Caddy反代\n- 内网访问：解析到内网IPv4 → 直连路由器\n- 体验无缝切换，速度接近内网带宽\n\n------\n\n## 安全防范：内网服务暴露的风险与应对\n\n将内网服务暴露到公网，会带来一定的安全风险。虽然IPv6的地址空间极大，使得暴力破解难度增加，但仍需采取以下安全措施：\n\n1. **强密码策略**：\n   - 为OpenWrt LuCI、NAS等服务设置强密码\n   - 避免使用默认密码或常见密码（如admin/admin）\n2. **登录尝试限制**：\n   - 在OpenWrt中启用登录尝试限制（`系统 > 管理权 > 限制`）\n   - 设置最大尝试次数（如5次）和锁定时间（如15分钟）\n3. **使用HTTPS**：\n   - 通过Caddy自动启用HTTPS，避免明文传输\n   - 保证数据传输安全\n4. **定期更新**：\n   - 保持OpenWrt系统和软件包更新\n   - 及时修复已知安全漏洞\n5. **防火墙规则细化**：\n   - 限制仅允许特定IP地址访问（如家庭IP）\n   - 或者使用更复杂的规则，如基于时间的访问控制\n\n------\n\n## 总结：每个组件的作用\n\n至此，一套完整的公网访问方案就搭建完成了：\n\n1. **IPv6** 提供了物理通路，让家庭网络成为真正的\"公网\"，无需NAT转换即可直接访问。\n2. **DNSHE** 提供了免费域名，无需额外付费，且支持API动态更新，为DDNS提供基础。\n3. **DDNS** 确保了路标（域名）永远指向正确的家，解决了IPv6地址动态变化的问题。\n4. **Caddy** 提供了安全的大门（HTTPS）和分流，自动申请证书并实现反向代理，让用户可以直接通过域名访问，无需额外端口号。\n5. **本地DNS** 优化了回家的体验，让内网访问直连，速度达到内网极限，无需绕行公网。\n\n这套方案的真正价值在于：\n\n- **无需额外付费**：域名、服务全部免费\n- **长期稳定**：IPv6地址由运营商分配，变化频率远低于IPv4\n- **体验流畅**：HTTPS加密、内网直连优化，访问体验接近本地\n\n------\n\n## 为什么这套方案优于其他选择？\n\n| 方案                  | 成本       | 稳定性 | 配置难度 | 适用场景              |\n| --------------------- | ---------- | ------ | -------- | --------------------- |\n| 公网IPv4+端口映射     | 高（专线） | 低     | 中       | 企业级需求            |\n| 内网穿透（frp/ngrok） | 中         | 中     | 高       | 临时需求              |\n| **IPv6+DDNS+Caddy**   | **免费**   | **高** | **低**   | **家庭/个人长期使用** |\n\n------\n\n## 附录：常见问题排查\n\n### Q1：DDNS更新失败\n\n- 检查API地址中的参数是否正确\n- 确认OpenWrt的`wan6`接口已获取IPv6地址\n- 在路由器终端执行：`curl \"https://api005.dnshe.com/...&ipaddr=2001:db8::1\"`\n\n### Q2：外网无法访问\n\n- 检查防火墙规则是否已添加\n- 确认Caddy是否监听443端口：`docker logs caddy`\n- 使用`ping6 home.cc.cd`测试IPv6连通性\n\n### Q3：HTTPS证书申请失败\n\n- 确认防火墙开放了80端口（Caddy申请证书需要）\n- 检查域名是否已正确解析到路0由器IPv6\n- 确认LuCI端口已修改为8080/8443\n\n------\n\n## 结语\n\n在当前国内网络环境下，IPv6已成为家庭内网访问的最优解。通过DNSHE免费域名、OpenWrt DDNS、Caddy反向代理和内网DNS优化的组合方案，我们不仅避免了公网IPv4的获取困境，还实现了**稳定、安全、低成本**的远程访问。\n\n这套方案的真正价值在于：它不是临时解决方案，而是基于当前网络基础设施的长期解决方案。IPv6的普及是大势所趋，而DDNS+Caddy的组合则让这个趋势变得触手可及。\n\n> 附：[测试IPv6连通性](https://test-ipv6.com/) | [DNSHE注册链接](https://my.dnshe.com/index.php?m=domain_hub)","source":"_posts/DDNS.md","raw":"---\ntitle: 从公网IPv4困境中解脱：基于IPv6的免费内网访问方案（OpenWrt实战）\n\n---\n\n在当今的国内网络环境中，想要通过公网IPv4访问家庭内网服务，已经成了一个越来越难实现的\"技术挑战\"。运营商普遍取消了公网IPv4分配，即使通过光猫桥接获取的IP，也多是100.x.x.x的内网地址。而传统的内网穿透工具（如frp、ngrok）不仅需要额外服务器成本，还经常面临不稳定和速度瓶颈的问题。\n\n**但IPv6的普及为我们打开了一扇新门**——三大运营商几乎100%支持IPv6，且地址是真·公网。本文将分享一个完整、稳定、成本为零的解决方案：**IPv6 + DNSHE DDNS + Caddy反向代理**，无需额外付费，无需复杂配置，即可实现安全、稳定的远程访问。\n\n------\n\n## 为什么IPv6是当前最优解？（附DDNS必要性说明）\n\n### 1. 无需额外成本\n\n- 国内三大运营商（电信/移动/联通）的宽带普遍提供IPv6\n- 不需要加钱办理专线，不依赖额外付费服务\n- 手机热点/5G CPE设备同样能获取公网IPv6\n\n### 2. 真正的公网连接\n\n- IPv6地址是全球可达的，无需NAT转换\n- 与IPv4的\"内网IP+端口映射\"相比，连接更直接、延迟更低\n\n### 3. DDNS的必要性：解决IPv6动态变化问题\n\nIPv6地址虽然提供公网连接，但它是**动态分配**的。每次路由器重启或网络重连，IPv6前缀都可能变化。如果没有DDNS，我们需要记住每次变化的IPv6地址才能访问，这显然不现实。DDNS通过将域名与动态IPv6地址关联，确保无论地址如何变化，域名始终指向正确的IP，从而实现稳定访问。\n\n> 重要提示：IPv6的DDNS比IPv4更可靠，因为IPv6地址变化频率远低于IPv4，且IPv6网络环境更简单。\n\n------\n\n## 实战方案：完整部署指南\n\n### 1. 域名准备：白嫖DNSHE二级域名\n\n**为什么选择DNSHE？**\n\n- 免费提供二级域名（如`yourname.cc.cd`）\n- 支持API动态更新，适合DDNS\n- 无广告、无强制付费\n\n**操作步骤：**\n\n1. 访问 [DNSHE官网](https://my.dnshe.com/index.php?m=domain_hub) 注册账号\n2. 申请一个二级域名（如`home.cc.cd`）\n3. 添加AAAA记录（IPv6专用）：\n   - 主机名：`@`\n   - 记录值：`::1`（临时占位）\n   - TTL：`600`（10分钟）\n\n**获取API更新地址：** 在DNSHE控制台找到\"动态域名解析\"接口，格式如下：\n\n```\nhttps://api005.dnshe.com/index.php?m=domain_hub&c=api&a=update&domain=yourdomain&username=yourusername&password=yourpassword&ipaddr=[IP]\n```\n\n*注意：`[IP]`是OpenWrt的内置变量，无需手动填写*\n\n------\n\n### 2. OpenWrt DDNS配置\n\n**关键点**：确保IPv6地址能被正确更新\n\n1. 进入OpenWrt后台：`服务 > 动态DNS`\n2. 添加新服务：\n   - 服务名称：`dnshe_ipv6`\n   - 查询主机名：`home.cc.cd`\n   - IP地址版本：`IPv6`\n   - 服务提供商：`自定义`\n   - 更新URL：填写上一步获取的API地址\n   - 检查周期：`5分钟`\n   - IP地址来源：`接口`\n   - 接口：`wan6`（IPv6接口）\n\n**验证配置**：\n\n- 启动服务后，查看日志确认`Update successful`\n- 在DNSHE控制台刷新域名解析，确认AAAA记录已更新\n\n------\n\n### 3. 修改LuCI管理界面端口（关键步骤）\n\n**问题**：OpenWrt的LuCI默认使用80和443端口，与Caddy冲突\n\n**为什么需要让出80和443端口？** Caddy作为反向代理服务器，需要监听80（HTTP）和443（HTTPS）端口，才能实现无需在URL中添加端口号，直接通过域名访问。例如，用户可以直接访问`https://home.cc.cd`，而不是`https://home.cc.cd:443`。这是HTTPS服务的标准做法，也是用户体验最佳的方式。\n\n**解决方案**：\n\n1. 进入OpenWrt管理界面：`系统 > 管理权 > 网络`\n2. 修改HTTP端口为`8080`，HTTPS端口为`8443`\n3. 保存并应用配置\n\n**验证**：\n\n- 现在LuCI可通过`http://192.168.1.1:8080`访问\n- 80和443端口已空出，供Caddy使用\n\n------\n\n### 4. 防火墙配置：最容易被忽略的关键步骤\n\n**问题现象**：配置完成后，外网无法访问\n\n**原因**：OpenWrt防火墙默认拒绝所有入站连接\n\n**为什么需要特定的防火墙规则？**\n\n- Caddy需要监听80和443端口，但默认防火墙会阻止所有入站连接\n- 仅开放IPv6的入站连接，可以避免IPv4的潜在安全风险\n- 限制为IPv6可以确保只有IPv6网络的连接被允许，提高安全性\n\n**解决方案**：\n\n1. 进入`网络 > 防火墙 > 通信规则`\n2. 添加新规则：\n   - 名称：`Allow-IPv6-Web`\n   - 协议：`TCP`\n   - 源区域：`wan6`\n   - 目标区域：`lan`（或`设备`）\n   - 目标端口：`80,443`\n   - 限制地址族：`IPv6`\n\n> **重要提示**：仅开放必要的端口，避免安全风险\n\n------\n\n### 5. Caddy部署：轻量级反向代理\n\n**为什么选择Caddy？**\n\n- Go语言编写，内存占用极低\n- 自动申请和续期HTTPS证书\n- 配置简单直观，无需复杂配置\n\n**部署步骤：**\n\n1. 在路由器上创建配置目录：\n\n   ```bash\n   mkdir -p /mnt/docker/caddy/config\n   ```\n\n2. 创建`Caddyfile`：\n\n   ```caddy\n   home.cc.cd {\n       encode gzip\n       reverse_proxy 192.168.1.1:8080\n   }\n   ```\n\n   *注：`192.168.1.1:8080`是修改后的LuCI地址*\n\n3. 启动容器：\n\n   ```bash\n   docker run -d \\\n     --name caddy \\\n     --restart unless-stopped \\\n     --network host \\\n     -v /mnt/docker/caddy/config/Caddyfile:/etc/caddy/Caddyfile \\\n     caddy:latest\n   ```\n\n**验证**：\n\n- 等待1-2分钟，Caddy会自动申请SSL证书\n- 用手机4G网络访问`https://home.cc.cd`，应显示OpenWrt登录界面\n\n------\n\n### 6. 内网DNS优化：解决\"回环\"问题\n\n**问题现象**：在家中WiFi下访问域名时速度慢或失败\n\n**原因**：内网设备解析到公网IPv6地址，导致数据包绕行\n\n**解决方案**：DNS劫持（内网直连）\n\n1. 进入`网络 > DHCP/DNS > 主机名`\n2. 添加规则：\n   - 主机名：`home.cc.cd`\n   - IP地址：`192.168.1.1`（路由器内网IPv4）\n\n**效果**：\n\n- 外网访问：解析到公网IPv6 → Caddy反代\n- 内网访问：解析到内网IPv4 → 直连路由器\n- 体验无缝切换，速度接近内网带宽\n\n------\n\n## 安全防范：内网服务暴露的风险与应对\n\n将内网服务暴露到公网，会带来一定的安全风险。虽然IPv6的地址空间极大，使得暴力破解难度增加，但仍需采取以下安全措施：\n\n1. **强密码策略**：\n   - 为OpenWrt LuCI、NAS等服务设置强密码\n   - 避免使用默认密码或常见密码（如admin/admin）\n2. **登录尝试限制**：\n   - 在OpenWrt中启用登录尝试限制（`系统 > 管理权 > 限制`）\n   - 设置最大尝试次数（如5次）和锁定时间（如15分钟）\n3. **使用HTTPS**：\n   - 通过Caddy自动启用HTTPS，避免明文传输\n   - 保证数据传输安全\n4. **定期更新**：\n   - 保持OpenWrt系统和软件包更新\n   - 及时修复已知安全漏洞\n5. **防火墙规则细化**：\n   - 限制仅允许特定IP地址访问（如家庭IP）\n   - 或者使用更复杂的规则，如基于时间的访问控制\n\n------\n\n## 总结：每个组件的作用\n\n至此，一套完整的公网访问方案就搭建完成了：\n\n1. **IPv6** 提供了物理通路，让家庭网络成为真正的\"公网\"，无需NAT转换即可直接访问。\n2. **DNSHE** 提供了免费域名，无需额外付费，且支持API动态更新，为DDNS提供基础。\n3. **DDNS** 确保了路标（域名）永远指向正确的家，解决了IPv6地址动态变化的问题。\n4. **Caddy** 提供了安全的大门（HTTPS）和分流，自动申请证书并实现反向代理，让用户可以直接通过域名访问，无需额外端口号。\n5. **本地DNS** 优化了回家的体验，让内网访问直连，速度达到内网极限，无需绕行公网。\n\n这套方案的真正价值在于：\n\n- **无需额外付费**：域名、服务全部免费\n- **长期稳定**：IPv6地址由运营商分配，变化频率远低于IPv4\n- **体验流畅**：HTTPS加密、内网直连优化，访问体验接近本地\n\n------\n\n## 为什么这套方案优于其他选择？\n\n| 方案                  | 成本       | 稳定性 | 配置难度 | 适用场景              |\n| --------------------- | ---------- | ------ | -------- | --------------------- |\n| 公网IPv4+端口映射     | 高（专线） | 低     | 中       | 企业级需求            |\n| 内网穿透（frp/ngrok） | 中         | 中     | 高       | 临时需求              |\n| **IPv6+DDNS+Caddy**   | **免费**   | **高** | **低**   | **家庭/个人长期使用** |\n\n------\n\n## 附录：常见问题排查\n\n### Q1：DDNS更新失败\n\n- 检查API地址中的参数是否正确\n- 确认OpenWrt的`wan6`接口已获取IPv6地址\n- 在路由器终端执行：`curl \"https://api005.dnshe.com/...&ipaddr=2001:db8::1\"`\n\n### Q2：外网无法访问\n\n- 检查防火墙规则是否已添加\n- 确认Caddy是否监听443端口：`docker logs caddy`\n- 使用`ping6 home.cc.cd`测试IPv6连通性\n\n### Q3：HTTPS证书申请失败\n\n- 确认防火墙开放了80端口（Caddy申请证书需要）\n- 检查域名是否已正确解析到路0由器IPv6\n- 确认LuCI端口已修改为8080/8443\n\n------\n\n## 结语\n\n在当前国内网络环境下，IPv6已成为家庭内网访问的最优解。通过DNSHE免费域名、OpenWrt DDNS、Caddy反向代理和内网DNS优化的组合方案，我们不仅避免了公网IPv4的获取困境，还实现了**稳定、安全、低成本**的远程访问。\n\n这套方案的真正价值在于：它不是临时解决方案，而是基于当前网络基础设施的长期解决方案。IPv6的普及是大势所趋，而DDNS+Caddy的组合则让这个趋势变得触手可及。\n\n> 附：[测试IPv6连通性](https://test-ipv6.com/) | [DNSHE注册链接](https://my.dnshe.com/index.php?m=domain_hub)","slug":"DDNS","published":1,"date":"2025-12-09T03:55:50.585Z","updated":"2026-01-16T06:22:17.892Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivp000c24j333ug0ct2","content":"<p>在当今的国内网络环境中，想要通过公网IPv4访问家庭内网服务，已经成了一个越来越难实现的”技术挑战”。运营商普遍取消了公网IPv4分配，即使通过光猫桥接获取的IP，也多是100.x.x.x的内网地址。而传统的内网穿透工具（如frp、ngrok）不仅需要额外服务器成本，还经常面临不稳定和速度瓶颈的问题。</p>\n<p><strong>但IPv6的普及为我们打开了一扇新门</strong>——三大运营商几乎100%支持IPv6，且地址是真·公网。本文将分享一个完整、稳定、成本为零的解决方案：<strong>IPv6 + DNSHE DDNS + Caddy反向代理</strong>，无需额外付费，无需复杂配置，即可实现安全、稳定的远程访问。</p>\n<hr>\n<h2 id=\"为什么IPv6是当前最优解？（附DDNS必要性说明）\"><a href=\"#为什么IPv6是当前最优解？（附DDNS必要性说明）\" class=\"headerlink\" title=\"为什么IPv6是当前最优解？（附DDNS必要性说明）\"></a>为什么IPv6是当前最优解？（附DDNS必要性说明）</h2><h3 id=\"1-无需额外成本\"><a href=\"#1-无需额外成本\" class=\"headerlink\" title=\"1. 无需额外成本\"></a>1. 无需额外成本</h3><ul>\n<li>国内三大运营商（电信&#x2F;移动&#x2F;联通）的宽带普遍提供IPv6</li>\n<li>不需要加钱办理专线，不依赖额外付费服务</li>\n<li>手机热点&#x2F;5G CPE设备同样能获取公网IPv6</li>\n</ul>\n<h3 id=\"2-真正的公网连接\"><a href=\"#2-真正的公网连接\" class=\"headerlink\" title=\"2. 真正的公网连接\"></a>2. 真正的公网连接</h3><ul>\n<li>IPv6地址是全球可达的，无需NAT转换</li>\n<li>与IPv4的”内网IP+端口映射”相比，连接更直接、延迟更低</li>\n</ul>\n<h3 id=\"3-DDNS的必要性：解决IPv6动态变化问题\"><a href=\"#3-DDNS的必要性：解决IPv6动态变化问题\" class=\"headerlink\" title=\"3. DDNS的必要性：解决IPv6动态变化问题\"></a>3. DDNS的必要性：解决IPv6动态变化问题</h3><p>IPv6地址虽然提供公网连接，但它是<strong>动态分配</strong>的。每次路由器重启或网络重连，IPv6前缀都可能变化。如果没有DDNS，我们需要记住每次变化的IPv6地址才能访问，这显然不现实。DDNS通过将域名与动态IPv6地址关联，确保无论地址如何变化，域名始终指向正确的IP，从而实现稳定访问。</p>\n<blockquote>\n<p>重要提示：IPv6的DDNS比IPv4更可靠，因为IPv6地址变化频率远低于IPv4，且IPv6网络环境更简单。</p>\n</blockquote>\n<hr>\n<h2 id=\"实战方案：完整部署指南\"><a href=\"#实战方案：完整部署指南\" class=\"headerlink\" title=\"实战方案：完整部署指南\"></a>实战方案：完整部署指南</h2><h3 id=\"1-域名准备：白嫖DNSHE二级域名\"><a href=\"#1-域名准备：白嫖DNSHE二级域名\" class=\"headerlink\" title=\"1. 域名准备：白嫖DNSHE二级域名\"></a>1. 域名准备：白嫖DNSHE二级域名</h3><p><strong>为什么选择DNSHE？</strong></p>\n<ul>\n<li>免费提供二级域名（如<code>yourname.cc.cd</code>）</li>\n<li>支持API动态更新，适合DDNS</li>\n<li>无广告、无强制付费</li>\n</ul>\n<p><strong>操作步骤：</strong></p>\n<ol>\n<li>访问 <a href=\"https://my.dnshe.com/index.php?m=domain_hub\">DNSHE官网</a> 注册账号</li>\n<li>申请一个二级域名（如<code>home.cc.cd</code>）</li>\n<li>添加AAAA记录（IPv6专用）：<ul>\n<li>主机名：<code>@</code></li>\n<li>记录值：<code>::1</code>（临时占位）</li>\n<li>TTL：<code>600</code>（10分钟）</li>\n</ul>\n</li>\n</ol>\n<p><strong>获取API更新地址：</strong> 在DNSHE控制台找到”动态域名解析”接口，格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api005.dnshe.com/index.php?m=domain_hub&amp;c=api&amp;a=update&amp;domain=yourdomain&amp;username=yourusername&amp;password=yourpassword&amp;ipaddr=[IP]</span><br></pre></td></tr></table></figure>\n\n<p><em>注意：<code>[IP]</code>是OpenWrt的内置变量，无需手动填写</em></p>\n<hr>\n<h3 id=\"2-OpenWrt-DDNS配置\"><a href=\"#2-OpenWrt-DDNS配置\" class=\"headerlink\" title=\"2. OpenWrt DDNS配置\"></a>2. OpenWrt DDNS配置</h3><p><strong>关键点</strong>：确保IPv6地址能被正确更新</p>\n<ol>\n<li>进入OpenWrt后台：<code>服务 &gt; 动态DNS</code></li>\n<li>添加新服务：<ul>\n<li>服务名称：<code>dnshe_ipv6</code></li>\n<li>查询主机名：<code>home.cc.cd</code></li>\n<li>IP地址版本：<code>IPv6</code></li>\n<li>服务提供商：<code>自定义</code></li>\n<li>更新URL：填写上一步获取的API地址</li>\n<li>检查周期：<code>5分钟</code></li>\n<li>IP地址来源：<code>接口</code></li>\n<li>接口：<code>wan6</code>（IPv6接口）</li>\n</ul>\n</li>\n</ol>\n<p><strong>验证配置</strong>：</p>\n<ul>\n<li>启动服务后，查看日志确认<code>Update successful</code></li>\n<li>在DNSHE控制台刷新域名解析，确认AAAA记录已更新</li>\n</ul>\n<hr>\n<h3 id=\"3-修改LuCI管理界面端口（关键步骤）\"><a href=\"#3-修改LuCI管理界面端口（关键步骤）\" class=\"headerlink\" title=\"3. 修改LuCI管理界面端口（关键步骤）\"></a>3. 修改LuCI管理界面端口（关键步骤）</h3><p><strong>问题</strong>：OpenWrt的LuCI默认使用80和443端口，与Caddy冲突</p>\n<p><strong>为什么需要让出80和443端口？</strong> Caddy作为反向代理服务器，需要监听80（HTTP）和443（HTTPS）端口，才能实现无需在URL中添加端口号，直接通过域名访问。例如，用户可以直接访问<code>https://home.cc.cd</code>，而不是<code>https://home.cc.cd:443</code>。这是HTTPS服务的标准做法，也是用户体验最佳的方式。</p>\n<p><strong>解决方案</strong>：</p>\n<ol>\n<li>进入OpenWrt管理界面：<code>系统 &gt; 管理权 &gt; 网络</code></li>\n<li>修改HTTP端口为<code>8080</code>，HTTPS端口为<code>8443</code></li>\n<li>保存并应用配置</li>\n</ol>\n<p><strong>验证</strong>：</p>\n<ul>\n<li>现在LuCI可通过<code>http://192.168.1.1:8080</code>访问</li>\n<li>80和443端口已空出，供Caddy使用</li>\n</ul>\n<hr>\n<h3 id=\"4-防火墙配置：最容易被忽略的关键步骤\"><a href=\"#4-防火墙配置：最容易被忽略的关键步骤\" class=\"headerlink\" title=\"4. 防火墙配置：最容易被忽略的关键步骤\"></a>4. 防火墙配置：最容易被忽略的关键步骤</h3><p><strong>问题现象</strong>：配置完成后，外网无法访问</p>\n<p><strong>原因</strong>：OpenWrt防火墙默认拒绝所有入站连接</p>\n<p><strong>为什么需要特定的防火墙规则？</strong></p>\n<ul>\n<li>Caddy需要监听80和443端口，但默认防火墙会阻止所有入站连接</li>\n<li>仅开放IPv6的入站连接，可以避免IPv4的潜在安全风险</li>\n<li>限制为IPv6可以确保只有IPv6网络的连接被允许，提高安全性</li>\n</ul>\n<p><strong>解决方案</strong>：</p>\n<ol>\n<li>进入<code>网络 &gt; 防火墙 &gt; 通信规则</code></li>\n<li>添加新规则：<ul>\n<li>名称：<code>Allow-IPv6-Web</code></li>\n<li>协议：<code>TCP</code></li>\n<li>源区域：<code>wan6</code></li>\n<li>目标区域：<code>lan</code>（或<code>设备</code>）</li>\n<li>目标端口：<code>80,443</code></li>\n<li>限制地址族：<code>IPv6</code></li>\n</ul>\n</li>\n</ol>\n<blockquote>\n<p><strong>重要提示</strong>：仅开放必要的端口，避免安全风险</p>\n</blockquote>\n<hr>\n<h3 id=\"5-Caddy部署：轻量级反向代理\"><a href=\"#5-Caddy部署：轻量级反向代理\" class=\"headerlink\" title=\"5. Caddy部署：轻量级反向代理\"></a>5. Caddy部署：轻量级反向代理</h3><p><strong>为什么选择Caddy？</strong></p>\n<ul>\n<li>Go语言编写，内存占用极低</li>\n<li>自动申请和续期HTTPS证书</li>\n<li>配置简单直观，无需复杂配置</li>\n</ul>\n<p><strong>部署步骤：</strong></p>\n<ol>\n<li><p>在路由器上创建配置目录：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /mnt/docker/caddy/config</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>创建<code>Caddyfile</code>：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">home.cc.cd &#123;</span><br><span class=\"line\">    encode gzip</span><br><span class=\"line\">    reverse_proxy 192.168.1.1:8080</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>注：<code>192.168.1.1:8080</code>是修改后的LuCI地址</em></p>\n</li>\n<li><p>启动容器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name caddy \\</span><br><span class=\"line\">  --restart unless-stopped \\</span><br><span class=\"line\">  --network host \\</span><br><span class=\"line\">  -v /mnt/docker/caddy/config/Caddyfile:/etc/caddy/Caddyfile \\</span><br><span class=\"line\">  caddy:latest</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p><strong>验证</strong>：</p>\n<ul>\n<li>等待1-2分钟，Caddy会自动申请SSL证书</li>\n<li>用手机4G网络访问<code>https://home.cc.cd</code>，应显示OpenWrt登录界面</li>\n</ul>\n<hr>\n<h3 id=\"6-内网DNS优化：解决”回环”问题\"><a href=\"#6-内网DNS优化：解决”回环”问题\" class=\"headerlink\" title=\"6. 内网DNS优化：解决”回环”问题\"></a>6. 内网DNS优化：解决”回环”问题</h3><p><strong>问题现象</strong>：在家中WiFi下访问域名时速度慢或失败</p>\n<p><strong>原因</strong>：内网设备解析到公网IPv6地址，导致数据包绕行</p>\n<p><strong>解决方案</strong>：DNS劫持（内网直连）</p>\n<ol>\n<li>进入<code>网络 &gt; DHCP/DNS &gt; 主机名</code></li>\n<li>添加规则：<ul>\n<li>主机名：<code>home.cc.cd</code></li>\n<li>IP地址：<code>192.168.1.1</code>（路由器内网IPv4）</li>\n</ul>\n</li>\n</ol>\n<p><strong>效果</strong>：</p>\n<ul>\n<li>外网访问：解析到公网IPv6 → Caddy反代</li>\n<li>内网访问：解析到内网IPv4 → 直连路由器</li>\n<li>体验无缝切换，速度接近内网带宽</li>\n</ul>\n<hr>\n<h2 id=\"安全防范：内网服务暴露的风险与应对\"><a href=\"#安全防范：内网服务暴露的风险与应对\" class=\"headerlink\" title=\"安全防范：内网服务暴露的风险与应对\"></a>安全防范：内网服务暴露的风险与应对</h2><p>将内网服务暴露到公网，会带来一定的安全风险。虽然IPv6的地址空间极大，使得暴力破解难度增加，但仍需采取以下安全措施：</p>\n<ol>\n<li><strong>强密码策略</strong>：<ul>\n<li>为OpenWrt LuCI、NAS等服务设置强密码</li>\n<li>避免使用默认密码或常见密码（如admin&#x2F;admin）</li>\n</ul>\n</li>\n<li><strong>登录尝试限制</strong>：<ul>\n<li>在OpenWrt中启用登录尝试限制（<code>系统 &gt; 管理权 &gt; 限制</code>）</li>\n<li>设置最大尝试次数（如5次）和锁定时间（如15分钟）</li>\n</ul>\n</li>\n<li><strong>使用HTTPS</strong>：<ul>\n<li>通过Caddy自动启用HTTPS，避免明文传输</li>\n<li>保证数据传输安全</li>\n</ul>\n</li>\n<li><strong>定期更新</strong>：<ul>\n<li>保持OpenWrt系统和软件包更新</li>\n<li>及时修复已知安全漏洞</li>\n</ul>\n</li>\n<li><strong>防火墙规则细化</strong>：<ul>\n<li>限制仅允许特定IP地址访问（如家庭IP）</li>\n<li>或者使用更复杂的规则，如基于时间的访问控制</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"总结：每个组件的作用\"><a href=\"#总结：每个组件的作用\" class=\"headerlink\" title=\"总结：每个组件的作用\"></a>总结：每个组件的作用</h2><p>至此，一套完整的公网访问方案就搭建完成了：</p>\n<ol>\n<li><strong>IPv6</strong> 提供了物理通路，让家庭网络成为真正的”公网”，无需NAT转换即可直接访问。</li>\n<li><strong>DNSHE</strong> 提供了免费域名，无需额外付费，且支持API动态更新，为DDNS提供基础。</li>\n<li><strong>DDNS</strong> 确保了路标（域名）永远指向正确的家，解决了IPv6地址动态变化的问题。</li>\n<li><strong>Caddy</strong> 提供了安全的大门（HTTPS）和分流，自动申请证书并实现反向代理，让用户可以直接通过域名访问，无需额外端口号。</li>\n<li><strong>本地DNS</strong> 优化了回家的体验，让内网访问直连，速度达到内网极限，无需绕行公网。</li>\n</ol>\n<p>这套方案的真正价值在于：</p>\n<ul>\n<li><strong>无需额外付费</strong>：域名、服务全部免费</li>\n<li><strong>长期稳定</strong>：IPv6地址由运营商分配，变化频率远低于IPv4</li>\n<li><strong>体验流畅</strong>：HTTPS加密、内网直连优化，访问体验接近本地</li>\n</ul>\n<hr>\n<h2 id=\"为什么这套方案优于其他选择？\"><a href=\"#为什么这套方案优于其他选择？\" class=\"headerlink\" title=\"为什么这套方案优于其他选择？\"></a>为什么这套方案优于其他选择？</h2><table>\n<thead>\n<tr>\n<th>方案</th>\n<th>成本</th>\n<th>稳定性</th>\n<th>配置难度</th>\n<th>适用场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>公网IPv4+端口映射</td>\n<td>高（专线）</td>\n<td>低</td>\n<td>中</td>\n<td>企业级需求</td>\n</tr>\n<tr>\n<td>内网穿透（frp&#x2F;ngrok）</td>\n<td>中</td>\n<td>中</td>\n<td>高</td>\n<td>临时需求</td>\n</tr>\n<tr>\n<td><strong>IPv6+DDNS+Caddy</strong></td>\n<td><strong>免费</strong></td>\n<td><strong>高</strong></td>\n<td><strong>低</strong></td>\n<td><strong>家庭&#x2F;个人长期使用</strong></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"附录：常见问题排查\"><a href=\"#附录：常见问题排查\" class=\"headerlink\" title=\"附录：常见问题排查\"></a>附录：常见问题排查</h2><h3 id=\"Q1：DDNS更新失败\"><a href=\"#Q1：DDNS更新失败\" class=\"headerlink\" title=\"Q1：DDNS更新失败\"></a>Q1：DDNS更新失败</h3><ul>\n<li>检查API地址中的参数是否正确</li>\n<li>确认OpenWrt的<code>wan6</code>接口已获取IPv6地址</li>\n<li>在路由器终端执行：<code>curl &quot;https://api005.dnshe.com/...&amp;ipaddr=2001:db8::1&quot;</code></li>\n</ul>\n<h3 id=\"Q2：外网无法访问\"><a href=\"#Q2：外网无法访问\" class=\"headerlink\" title=\"Q2：外网无法访问\"></a>Q2：外网无法访问</h3><ul>\n<li>检查防火墙规则是否已添加</li>\n<li>确认Caddy是否监听443端口：<code>docker logs caddy</code></li>\n<li>使用<code>ping6 home.cc.cd</code>测试IPv6连通性</li>\n</ul>\n<h3 id=\"Q3：HTTPS证书申请失败\"><a href=\"#Q3：HTTPS证书申请失败\" class=\"headerlink\" title=\"Q3：HTTPS证书申请失败\"></a>Q3：HTTPS证书申请失败</h3><ul>\n<li>确认防火墙开放了80端口（Caddy申请证书需要）</li>\n<li>检查域名是否已正确解析到路0由器IPv6</li>\n<li>确认LuCI端口已修改为8080&#x2F;8443</li>\n</ul>\n<hr>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>在当前国内网络环境下，IPv6已成为家庭内网访问的最优解。通过DNSHE免费域名、OpenWrt DDNS、Caddy反向代理和内网DNS优化的组合方案，我们不仅避免了公网IPv4的获取困境，还实现了<strong>稳定、安全、低成本</strong>的远程访问。</p>\n<p>这套方案的真正价值在于：它不是临时解决方案，而是基于当前网络基础设施的长期解决方案。IPv6的普及是大势所趋，而DDNS+Caddy的组合则让这个趋势变得触手可及。</p>\n<blockquote>\n<p>附：<a href=\"https://test-ipv6.com/\">测试IPv6连通性</a> | <a href=\"https://my.dnshe.com/index.php?m=domain_hub\">DNSHE注册链接</a></p>\n</blockquote>\n","excerpt":"","more":"<p>在当今的国内网络环境中，想要通过公网IPv4访问家庭内网服务，已经成了一个越来越难实现的”技术挑战”。运营商普遍取消了公网IPv4分配，即使通过光猫桥接获取的IP，也多是100.x.x.x的内网地址。而传统的内网穿透工具（如frp、ngrok）不仅需要额外服务器成本，还经常面临不稳定和速度瓶颈的问题。</p>\n<p><strong>但IPv6的普及为我们打开了一扇新门</strong>——三大运营商几乎100%支持IPv6，且地址是真·公网。本文将分享一个完整、稳定、成本为零的解决方案：<strong>IPv6 + DNSHE DDNS + Caddy反向代理</strong>，无需额外付费，无需复杂配置，即可实现安全、稳定的远程访问。</p>\n<hr>\n<h2 id=\"为什么IPv6是当前最优解？（附DDNS必要性说明）\"><a href=\"#为什么IPv6是当前最优解？（附DDNS必要性说明）\" class=\"headerlink\" title=\"为什么IPv6是当前最优解？（附DDNS必要性说明）\"></a>为什么IPv6是当前最优解？（附DDNS必要性说明）</h2><h3 id=\"1-无需额外成本\"><a href=\"#1-无需额外成本\" class=\"headerlink\" title=\"1. 无需额外成本\"></a>1. 无需额外成本</h3><ul>\n<li>国内三大运营商（电信&#x2F;移动&#x2F;联通）的宽带普遍提供IPv6</li>\n<li>不需要加钱办理专线，不依赖额外付费服务</li>\n<li>手机热点&#x2F;5G CPE设备同样能获取公网IPv6</li>\n</ul>\n<h3 id=\"2-真正的公网连接\"><a href=\"#2-真正的公网连接\" class=\"headerlink\" title=\"2. 真正的公网连接\"></a>2. 真正的公网连接</h3><ul>\n<li>IPv6地址是全球可达的，无需NAT转换</li>\n<li>与IPv4的”内网IP+端口映射”相比，连接更直接、延迟更低</li>\n</ul>\n<h3 id=\"3-DDNS的必要性：解决IPv6动态变化问题\"><a href=\"#3-DDNS的必要性：解决IPv6动态变化问题\" class=\"headerlink\" title=\"3. DDNS的必要性：解决IPv6动态变化问题\"></a>3. DDNS的必要性：解决IPv6动态变化问题</h3><p>IPv6地址虽然提供公网连接，但它是<strong>动态分配</strong>的。每次路由器重启或网络重连，IPv6前缀都可能变化。如果没有DDNS，我们需要记住每次变化的IPv6地址才能访问，这显然不现实。DDNS通过将域名与动态IPv6地址关联，确保无论地址如何变化，域名始终指向正确的IP，从而实现稳定访问。</p>\n<blockquote>\n<p>重要提示：IPv6的DDNS比IPv4更可靠，因为IPv6地址变化频率远低于IPv4，且IPv6网络环境更简单。</p>\n</blockquote>\n<hr>\n<h2 id=\"实战方案：完整部署指南\"><a href=\"#实战方案：完整部署指南\" class=\"headerlink\" title=\"实战方案：完整部署指南\"></a>实战方案：完整部署指南</h2><h3 id=\"1-域名准备：白嫖DNSHE二级域名\"><a href=\"#1-域名准备：白嫖DNSHE二级域名\" class=\"headerlink\" title=\"1. 域名准备：白嫖DNSHE二级域名\"></a>1. 域名准备：白嫖DNSHE二级域名</h3><p><strong>为什么选择DNSHE？</strong></p>\n<ul>\n<li>免费提供二级域名（如<code>yourname.cc.cd</code>）</li>\n<li>支持API动态更新，适合DDNS</li>\n<li>无广告、无强制付费</li>\n</ul>\n<p><strong>操作步骤：</strong></p>\n<ol>\n<li>访问 <a href=\"https://my.dnshe.com/index.php?m=domain_hub\">DNSHE官网</a> 注册账号</li>\n<li>申请一个二级域名（如<code>home.cc.cd</code>）</li>\n<li>添加AAAA记录（IPv6专用）：<ul>\n<li>主机名：<code>@</code></li>\n<li>记录值：<code>::1</code>（临时占位）</li>\n<li>TTL：<code>600</code>（10分钟）</li>\n</ul>\n</li>\n</ol>\n<p><strong>获取API更新地址：</strong> 在DNSHE控制台找到”动态域名解析”接口，格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api005.dnshe.com/index.php?m=domain_hub&amp;c=api&amp;a=update&amp;domain=yourdomain&amp;username=yourusername&amp;password=yourpassword&amp;ipaddr=[IP]</span><br></pre></td></tr></table></figure>\n\n<p><em>注意：<code>[IP]</code>是OpenWrt的内置变量，无需手动填写</em></p>\n<hr>\n<h3 id=\"2-OpenWrt-DDNS配置\"><a href=\"#2-OpenWrt-DDNS配置\" class=\"headerlink\" title=\"2. OpenWrt DDNS配置\"></a>2. OpenWrt DDNS配置</h3><p><strong>关键点</strong>：确保IPv6地址能被正确更新</p>\n<ol>\n<li>进入OpenWrt后台：<code>服务 &gt; 动态DNS</code></li>\n<li>添加新服务：<ul>\n<li>服务名称：<code>dnshe_ipv6</code></li>\n<li>查询主机名：<code>home.cc.cd</code></li>\n<li>IP地址版本：<code>IPv6</code></li>\n<li>服务提供商：<code>自定义</code></li>\n<li>更新URL：填写上一步获取的API地址</li>\n<li>检查周期：<code>5分钟</code></li>\n<li>IP地址来源：<code>接口</code></li>\n<li>接口：<code>wan6</code>（IPv6接口）</li>\n</ul>\n</li>\n</ol>\n<p><strong>验证配置</strong>：</p>\n<ul>\n<li>启动服务后，查看日志确认<code>Update successful</code></li>\n<li>在DNSHE控制台刷新域名解析，确认AAAA记录已更新</li>\n</ul>\n<hr>\n<h3 id=\"3-修改LuCI管理界面端口（关键步骤）\"><a href=\"#3-修改LuCI管理界面端口（关键步骤）\" class=\"headerlink\" title=\"3. 修改LuCI管理界面端口（关键步骤）\"></a>3. 修改LuCI管理界面端口（关键步骤）</h3><p><strong>问题</strong>：OpenWrt的LuCI默认使用80和443端口，与Caddy冲突</p>\n<p><strong>为什么需要让出80和443端口？</strong> Caddy作为反向代理服务器，需要监听80（HTTP）和443（HTTPS）端口，才能实现无需在URL中添加端口号，直接通过域名访问。例如，用户可以直接访问<code>https://home.cc.cd</code>，而不是<code>https://home.cc.cd:443</code>。这是HTTPS服务的标准做法，也是用户体验最佳的方式。</p>\n<p><strong>解决方案</strong>：</p>\n<ol>\n<li>进入OpenWrt管理界面：<code>系统 &gt; 管理权 &gt; 网络</code></li>\n<li>修改HTTP端口为<code>8080</code>，HTTPS端口为<code>8443</code></li>\n<li>保存并应用配置</li>\n</ol>\n<p><strong>验证</strong>：</p>\n<ul>\n<li>现在LuCI可通过<code>http://192.168.1.1:8080</code>访问</li>\n<li>80和443端口已空出，供Caddy使用</li>\n</ul>\n<hr>\n<h3 id=\"4-防火墙配置：最容易被忽略的关键步骤\"><a href=\"#4-防火墙配置：最容易被忽略的关键步骤\" class=\"headerlink\" title=\"4. 防火墙配置：最容易被忽略的关键步骤\"></a>4. 防火墙配置：最容易被忽略的关键步骤</h3><p><strong>问题现象</strong>：配置完成后，外网无法访问</p>\n<p><strong>原因</strong>：OpenWrt防火墙默认拒绝所有入站连接</p>\n<p><strong>为什么需要特定的防火墙规则？</strong></p>\n<ul>\n<li>Caddy需要监听80和443端口，但默认防火墙会阻止所有入站连接</li>\n<li>仅开放IPv6的入站连接，可以避免IPv4的潜在安全风险</li>\n<li>限制为IPv6可以确保只有IPv6网络的连接被允许，提高安全性</li>\n</ul>\n<p><strong>解决方案</strong>：</p>\n<ol>\n<li>进入<code>网络 &gt; 防火墙 &gt; 通信规则</code></li>\n<li>添加新规则：<ul>\n<li>名称：<code>Allow-IPv6-Web</code></li>\n<li>协议：<code>TCP</code></li>\n<li>源区域：<code>wan6</code></li>\n<li>目标区域：<code>lan</code>（或<code>设备</code>）</li>\n<li>目标端口：<code>80,443</code></li>\n<li>限制地址族：<code>IPv6</code></li>\n</ul>\n</li>\n</ol>\n<blockquote>\n<p><strong>重要提示</strong>：仅开放必要的端口，避免安全风险</p>\n</blockquote>\n<hr>\n<h3 id=\"5-Caddy部署：轻量级反向代理\"><a href=\"#5-Caddy部署：轻量级反向代理\" class=\"headerlink\" title=\"5. Caddy部署：轻量级反向代理\"></a>5. Caddy部署：轻量级反向代理</h3><p><strong>为什么选择Caddy？</strong></p>\n<ul>\n<li>Go语言编写，内存占用极低</li>\n<li>自动申请和续期HTTPS证书</li>\n<li>配置简单直观，无需复杂配置</li>\n</ul>\n<p><strong>部署步骤：</strong></p>\n<ol>\n<li><p>在路由器上创建配置目录：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /mnt/docker/caddy/config</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>创建<code>Caddyfile</code>：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">home.cc.cd &#123;</span><br><span class=\"line\">    encode gzip</span><br><span class=\"line\">    reverse_proxy 192.168.1.1:8080</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>注：<code>192.168.1.1:8080</code>是修改后的LuCI地址</em></p>\n</li>\n<li><p>启动容器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name caddy \\</span><br><span class=\"line\">  --restart unless-stopped \\</span><br><span class=\"line\">  --network host \\</span><br><span class=\"line\">  -v /mnt/docker/caddy/config/Caddyfile:/etc/caddy/Caddyfile \\</span><br><span class=\"line\">  caddy:latest</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p><strong>验证</strong>：</p>\n<ul>\n<li>等待1-2分钟，Caddy会自动申请SSL证书</li>\n<li>用手机4G网络访问<code>https://home.cc.cd</code>，应显示OpenWrt登录界面</li>\n</ul>\n<hr>\n<h3 id=\"6-内网DNS优化：解决”回环”问题\"><a href=\"#6-内网DNS优化：解决”回环”问题\" class=\"headerlink\" title=\"6. 内网DNS优化：解决”回环”问题\"></a>6. 内网DNS优化：解决”回环”问题</h3><p><strong>问题现象</strong>：在家中WiFi下访问域名时速度慢或失败</p>\n<p><strong>原因</strong>：内网设备解析到公网IPv6地址，导致数据包绕行</p>\n<p><strong>解决方案</strong>：DNS劫持（内网直连）</p>\n<ol>\n<li>进入<code>网络 &gt; DHCP/DNS &gt; 主机名</code></li>\n<li>添加规则：<ul>\n<li>主机名：<code>home.cc.cd</code></li>\n<li>IP地址：<code>192.168.1.1</code>（路由器内网IPv4）</li>\n</ul>\n</li>\n</ol>\n<p><strong>效果</strong>：</p>\n<ul>\n<li>外网访问：解析到公网IPv6 → Caddy反代</li>\n<li>内网访问：解析到内网IPv4 → 直连路由器</li>\n<li>体验无缝切换，速度接近内网带宽</li>\n</ul>\n<hr>\n<h2 id=\"安全防范：内网服务暴露的风险与应对\"><a href=\"#安全防范：内网服务暴露的风险与应对\" class=\"headerlink\" title=\"安全防范：内网服务暴露的风险与应对\"></a>安全防范：内网服务暴露的风险与应对</h2><p>将内网服务暴露到公网，会带来一定的安全风险。虽然IPv6的地址空间极大，使得暴力破解难度增加，但仍需采取以下安全措施：</p>\n<ol>\n<li><strong>强密码策略</strong>：<ul>\n<li>为OpenWrt LuCI、NAS等服务设置强密码</li>\n<li>避免使用默认密码或常见密码（如admin&#x2F;admin）</li>\n</ul>\n</li>\n<li><strong>登录尝试限制</strong>：<ul>\n<li>在OpenWrt中启用登录尝试限制（<code>系统 &gt; 管理权 &gt; 限制</code>）</li>\n<li>设置最大尝试次数（如5次）和锁定时间（如15分钟）</li>\n</ul>\n</li>\n<li><strong>使用HTTPS</strong>：<ul>\n<li>通过Caddy自动启用HTTPS，避免明文传输</li>\n<li>保证数据传输安全</li>\n</ul>\n</li>\n<li><strong>定期更新</strong>：<ul>\n<li>保持OpenWrt系统和软件包更新</li>\n<li>及时修复已知安全漏洞</li>\n</ul>\n</li>\n<li><strong>防火墙规则细化</strong>：<ul>\n<li>限制仅允许特定IP地址访问（如家庭IP）</li>\n<li>或者使用更复杂的规则，如基于时间的访问控制</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"总结：每个组件的作用\"><a href=\"#总结：每个组件的作用\" class=\"headerlink\" title=\"总结：每个组件的作用\"></a>总结：每个组件的作用</h2><p>至此，一套完整的公网访问方案就搭建完成了：</p>\n<ol>\n<li><strong>IPv6</strong> 提供了物理通路，让家庭网络成为真正的”公网”，无需NAT转换即可直接访问。</li>\n<li><strong>DNSHE</strong> 提供了免费域名，无需额外付费，且支持API动态更新，为DDNS提供基础。</li>\n<li><strong>DDNS</strong> 确保了路标（域名）永远指向正确的家，解决了IPv6地址动态变化的问题。</li>\n<li><strong>Caddy</strong> 提供了安全的大门（HTTPS）和分流，自动申请证书并实现反向代理，让用户可以直接通过域名访问，无需额外端口号。</li>\n<li><strong>本地DNS</strong> 优化了回家的体验，让内网访问直连，速度达到内网极限，无需绕行公网。</li>\n</ol>\n<p>这套方案的真正价值在于：</p>\n<ul>\n<li><strong>无需额外付费</strong>：域名、服务全部免费</li>\n<li><strong>长期稳定</strong>：IPv6地址由运营商分配，变化频率远低于IPv4</li>\n<li><strong>体验流畅</strong>：HTTPS加密、内网直连优化，访问体验接近本地</li>\n</ul>\n<hr>\n<h2 id=\"为什么这套方案优于其他选择？\"><a href=\"#为什么这套方案优于其他选择？\" class=\"headerlink\" title=\"为什么这套方案优于其他选择？\"></a>为什么这套方案优于其他选择？</h2><table>\n<thead>\n<tr>\n<th>方案</th>\n<th>成本</th>\n<th>稳定性</th>\n<th>配置难度</th>\n<th>适用场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>公网IPv4+端口映射</td>\n<td>高（专线）</td>\n<td>低</td>\n<td>中</td>\n<td>企业级需求</td>\n</tr>\n<tr>\n<td>内网穿透（frp&#x2F;ngrok）</td>\n<td>中</td>\n<td>中</td>\n<td>高</td>\n<td>临时需求</td>\n</tr>\n<tr>\n<td><strong>IPv6+DDNS+Caddy</strong></td>\n<td><strong>免费</strong></td>\n<td><strong>高</strong></td>\n<td><strong>低</strong></td>\n<td><strong>家庭&#x2F;个人长期使用</strong></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"附录：常见问题排查\"><a href=\"#附录：常见问题排查\" class=\"headerlink\" title=\"附录：常见问题排查\"></a>附录：常见问题排查</h2><h3 id=\"Q1：DDNS更新失败\"><a href=\"#Q1：DDNS更新失败\" class=\"headerlink\" title=\"Q1：DDNS更新失败\"></a>Q1：DDNS更新失败</h3><ul>\n<li>检查API地址中的参数是否正确</li>\n<li>确认OpenWrt的<code>wan6</code>接口已获取IPv6地址</li>\n<li>在路由器终端执行：<code>curl &quot;https://api005.dnshe.com/...&amp;ipaddr=2001:db8::1&quot;</code></li>\n</ul>\n<h3 id=\"Q2：外网无法访问\"><a href=\"#Q2：外网无法访问\" class=\"headerlink\" title=\"Q2：外网无法访问\"></a>Q2：外网无法访问</h3><ul>\n<li>检查防火墙规则是否已添加</li>\n<li>确认Caddy是否监听443端口：<code>docker logs caddy</code></li>\n<li>使用<code>ping6 home.cc.cd</code>测试IPv6连通性</li>\n</ul>\n<h3 id=\"Q3：HTTPS证书申请失败\"><a href=\"#Q3：HTTPS证书申请失败\" class=\"headerlink\" title=\"Q3：HTTPS证书申请失败\"></a>Q3：HTTPS证书申请失败</h3><ul>\n<li>确认防火墙开放了80端口（Caddy申请证书需要）</li>\n<li>检查域名是否已正确解析到路0由器IPv6</li>\n<li>确认LuCI端口已修改为8080&#x2F;8443</li>\n</ul>\n<hr>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>在当前国内网络环境下，IPv6已成为家庭内网访问的最优解。通过DNSHE免费域名、OpenWrt DDNS、Caddy反向代理和内网DNS优化的组合方案，我们不仅避免了公网IPv4的获取困境，还实现了<strong>稳定、安全、低成本</strong>的远程访问。</p>\n<p>这套方案的真正价值在于：它不是临时解决方案，而是基于当前网络基础设施的长期解决方案。IPv6的普及是大势所趋，而DDNS+Caddy的组合则让这个趋势变得触手可及。</p>\n<blockquote>\n<p>附：<a href=\"https://test-ipv6.com/\">测试IPv6连通性</a> | <a href=\"https://my.dnshe.com/index.php?m=domain_hub\">DNSHE注册链接</a></p>\n</blockquote>\n"},{"title":"Git & GitHub & Markdown &刷课","date":"2025-10-17T03:17:00.000Z","_content":"\n# Git & GitHub & Markdown &刷课\n\n## **环境准备**\n\n### Chrome 浏览器下载\n\n**推荐使用国内 Cent Browser：**\n\n- [官方下载地址(官网)](https://www.centbrowser.cn/)\n\n- 继承谷歌内核稳定流畅的优点同时，与 Chrome 基本操作界面别无二致, 并加入其他常用功能\n\n**推荐使用谷歌 Chrome 浏览器：**\n\n- [官方下载地址（需科学上网）](https://www.google.com/chrome/)\n- 或搜索“Chrome 浏览器下载国内镜像”获取国内最新可用链接。\n\n### VPN 与机场\n\n#### VPN 是什么？机场是什么？\n\n- **VPN**：虚拟专用网络，最初是企业、学校等用于远程安全访问内部资源。后来大家习惯把“翻墙”工具称为 VPN，但实际上 VPN 协议并不专属于翻墙，比如 WireGuard、OpenVPN 等真正网络层的 VPN 协议。\n- **机场**：是专门提供“科学上网”服务的平台。机场主租用大量 VPS（国外服务器），搭建 SS、SSR、Vmess、Trojan 等代理协议节点，用户买流量后通过代理软件（如 Clash、小火箭等）连接机场获得自由访问外网的能力。\n- **区别与关系**：VPN 是网络层代理，机场多用应用层/会话层代理。大多数商业 VPN 广告多且贵，体验和性价比远不如机场。\n\n#### 为什么叫“机场”？\n\n因为最早的代理工具 Shadowsocks 图标是一架小飞机，大家就把这种代理服务叫做“机场”。\n\n\n\n机场并不是一个单一的服务器或网站，而是由许多分布在国内外的节点组成，具备分布式、多协议、动态更新和多种抗干扰技术，能灵活应对各种封锁与干扰。即使部分节点被墙，用户只需刷新订阅或等待机场主修复即可继续使用。\n\n下面分几条简要解释：\n\n1. **多节点分散部署**\n   机场通常在国内外部署了很多服务器（节点），即使部分节点被墙封锁，其他节点仍可正常工作，不会导致整个机场服务瘫痪。\n2. **协议混淆与加密**\n   机场使用的代理协议（如 SS、Trojan、Vmess 等）都具备流量加密和混淆能力，能有效隐藏翻墙行为，使防火墙难以精准识别和封锁。\n3. **动态更换节点和订阅**\n   机场可以随时更换服务器 IP、端口、协议等参数，用户通过订阅链接自动获取最新节点信息，及时绕开已被封锁的节点。\n4. **中转与专线技术**\n   很多机场采用“国内中转”、“隧道”、“专线”等技术，使流量出境路线更加隐蔽和多样化，提高抗封锁能力。\n5. **高防与灾备机制**\n   优质机场会购买高防护服务器、备用线路、CDN 加速等服务，即使遭遇攻击或封锁，也能迅速切换恢复服务。\n\n#### 协议科普\n\n- **SS/SSR**：Shadowsocks 及其分支 SSR，轻量级加密代理，速度快，兼容性好。\n- **Vmess/VLESS**：V2Ray 框架的协议，功能丰富，支持多种混淆和传输方式。\n- **Trojan**：基于 HTTPS，伪装成正常网页流量，抗封锁能力强。\n- **Hy2/Reality/Tuic**：新一代协议，多用于自建直连，机场较少支持，安全性更高。\n- **传统 VPN 协议**：如 PPTP、L2TP/IPSec、OpenVPN、WireGuard 等，主要用于网络层代理，穿透性和安全性各有不同。\n\n#### 机场线路名词解释\n\n- **规则**：只有国外网站走代理，节省流量\n- **全局**：所有流量都走代理\n- **直连**：用户设备直接连境外代理服务器，速度受限、极易被墙。\n- **中转**：流量先到国内中转服务器，再转发到境外代理服务器。可以优化速度和稳定性，降低被墙风险。\n- **隧道**：国内服务器入口+境外服务器（如香港 CMI），流量经过 TLS 加密再转发，更安全。\n- **专线（IEPL/IPLC）**：点对点物理线路，低延迟，不经过公网，最稳定但成本高，机场多用 IEPL。\n- **BGP**：边界网关协议，优化多运营商之间的互联访问速度和稳定性。\n- **前置**：中转入口前再加一台国内机器，抗通报/墙封。\n- **转发**：多个机场共享中转资源，速度和稳定性差，常见于小机场。\n- **流量倍率**：部分机场设置倍率，如 2 倍率表示实际消耗 2 倍流量。\n- **系统代理**：大多数应用（如浏览器）自动走代理，部分软件需手动设置\n- **TUN 模式/虚拟网卡**：创建虚拟网卡，实现真正全局代理，解决部分应用不走代理的问题\n- **自动选择/故障转移：** 自动选择延迟最低节点，但可能频繁切换 IP，容易被某些网站风控\n\n#### 线路体验优先级\n\n同样带宽下，体验优先级：  \n\n**IEPL 专线中转 > 隧道中转 > 公网中转（如广东移动/湖南联通） > 直连**\n\n![image-20251016175400498](/images/Git_Github_Markdown/Git_Github_Markdown_1.png)\n\n##### 1. 直连机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内防火墙/QoS 限速 → 直接连接境外 VPS/服务器 → 国际互联网\n- **特点**：没有经过国内中转节点，直接出海。速度受限、易被墙，体验和稳定性都较差，适合流量小、只偶尔使用者。\n\n##### 2. 普通中转机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内中转 VPS → 境内防火墙/QoS 限速 → 境外 VPS → 国际互联网\n- **特点**：增加了一个国内中转节点，优化了出海速度和稳定性。成本较低，但中转节点易受干扰，遇到高峰期或被墙会影响体验。\n\n##### 3. BGP 中转机场\n\n- **流程**：用户设备 → 宽带运营商 → BGP 中转服务器（多线接入、跨运营商优化） → 境内防火墙/QoS 限速 → 境外 VPS → 国际互联网\n- **特点**：BGP 中转节点支持多运营商线路，自动选择最优路径，提升了全国范围的访问速度和稳定性。更适合多地区用户，成本比普通中转高。\n\n##### 4. IPLC 中转机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内中转 VPS → IPLC 专线传输 → 境外 VPS → 国际互联网\n- **特点**：IPLC（国际专线）是物理专用通道，数据从境内直接通过专线传到境外，几乎不经过防火墙和公网，速度、稳定性和安全性最高，但价格也最贵。适合对速度和稳定性要求极高的用户或企业。\n\n---\n\n#### 推荐客户端工具\n\n- **Windows/Mac/Android**：首选 Clash 系列（Clash for Windows、Clash Verge、Clash Meta、Flclash、Clash Party、Sparkle 等）\n- **iOS**：首选小火箭（Shadowrocket，付费）。\n\n#### 客户端使用流程简述\n\n1. 下载并安装客户端软件\n2. 在机场后台获取订阅链接（通常一键复制）\n3. 导入到客户端\n4. 打开系统代理或虚拟网卡（TUN 模式），实现全局或分流科学上网\n5. 常见问题：分流规则设置、系统代理/TUN 模式选择、节点测速与切换\n\n---\n\n#### 机场购买与使用流程\n\n#### 如何购买机场\n\n- 注册账号（推荐 Gmail/Outlook 邮箱，不建议 QQ 邮箱，避免实名风险）\n- 选择套餐，付款（部分机场支持试用套餐）\n- 获取订阅链接，导入代理软件\n- 按照机场提供的小白教程操作，几乎所有机场都有详细的使用说明\n\n![三色图](/images/Git_Github_Markdown/Git_Github_Markdown_2.webp)\n\n#### 小白教程\n\n最小白的教程，适合第一次买机场的，\n\n先注册，注意的点是验证码邮件可能会在邮箱垃圾箱里面。\n如果有试用先试用，没试用就去购买套餐。\n\n1）我们以随便某个 v2board 机场为例子，因为现在很多机场都是用的 v2board 页面。\n**第一步：购买套餐：点击购买订阅–选择你想要的套餐–付款**\n[![购买订阅](/images/Git_Github_Markdown/Git_Github_Markdown_12.webp)\n[![]](/images/Git_Github_Markdown/Git_Github_Markdown_13.webp)\n\n![选择套餐](/images/Git_Github_Markdown/Git_Github_Markdown_13.webp)\n\n**第二步：下载代理软件**，这里以 Clash for windows 为例子\n\n**第三步：导入订阅：回到仪表盘–点击一键订阅–导入到你的 Clash 客户端中**\n\n![仪表盘](/images/Git_Github_Markdown/Git_Github_Markdown_14.webp)\n\n![导入订阅](/images/Git_Github_Markdown/Git_Github_Markdown_15.webp)\n\n![导入订阅后](/images/Git_Github_Markdown/Git_Github_Markdown_16.webp)\n\n具体详细操场教程可以参考各个机场的使用教程，每个机场基本都有小白教程的。\n\n#### 节点和订阅相关问题\n\n- 节点不能用时，先检查流量套餐是否到期或用尽，再刷新订阅或重新复制订阅链接\n- 校园网或公司网可能封端口或 DNS 异常，影响机场使用\n- 机场官网和订阅地址常变，因 GFW 污染 DNS，老牌机场处理经验更丰富\n\n---\n\n#### 线路技术与常见问题详解\n\n##### 机场官网慢/打不开？\n\n- 多数机场官网套了 Cloudflare CDN，隐藏真实 IP，防止被墙，访问速度慢需要科学上网\n\n##### 为什么有些机场便宜？\n\n- 便宜线路（如月抛）、多人共享、直连节点、不买中转、割韭菜跑路风险高\n\n##### 为什么流量消耗快？\n\n- 流量倍率设置、自动选择高倍率节点、系统更新等走代理流量\n\n##### 为什么机场界面都很像？\n\n- 大多数机场用开源面板（V2board、SSpanel），前端界面相似是正常现象\n\n##### 为什么延迟测试异常？\n\n- 部分机场劫持延迟测试，仅到中转入口（非真实国际延迟），可更换延迟测试 URL 验证\n\n##### 机场能否打游戏？\n\n- 不推荐机场打游戏，延迟高、UDP 支持差，建议用专业游戏加速器（如 UU 加速器）。部分机场有专线游戏节点，但不保证稳定\n\n---\n\n#### 机场安全性与合规问题\n\n#### 翻墙是安全吗？\n\n- 你猜\n- 低调，不要键政，不要绑定实名信息\n- 机场主肉身墙外更安全，选老牌大机场，月付为佳\n- 被抓多因机场主肉身墙内、高调、实名收款、境内推广\n\n#### 机场跑路怎么办？\n\n- 灰色产业，跑路风险高，优先选择老牌、肉身墙外的机场主，推荐月付。跑路后只能更换机场\n\n#### 白嫖机场安全吗？\n\n- 免费机场体验差或安全风险高，仅试用阶段可考虑，长期建议付费正规机场\n\n\n\n---\n\n## Git 与 GitHub\n\n- **Git**：核心工具，记录代码修改历史，创建分支，合并分支等。\n- **GitHub/Gitee**：代码托管平台，方便协作、展示作品、参与开源项目。、\n\n\n\n1. Git 版本控制基础\n   - 安装与配置（Windows/Mac/Linux）\n   - 常用命令演示\n2. GitHub 账号注册与界面介绍\n   - 教育邮箱注册技巧\n   - 仓库、Issue、PR 等基本功能\n3. GitHub 教育认证与 Copilot 白嫖流程\n   - Copilot 是什么\n   - 认证与激活详细步骤\n4. 基础实战：远程仓库协作、Fork、PR 操作演示\n\n\n\n### Git 是什么\n\n**Git 就像一本“时光机日记本”📖**  \n\n每段代码的改动，Git 都会帮你记录下来，随时可以“穿越回过去”查找任何时间点的代码状态。\n\n- **主要特点：**\n  1. **版本控制**：每次提交都像写新日记，保存开发成果。\n  2. **分支管理**：分支如同章节，可以并行开发互不干扰。\n  3. **分布式**：每个人都有完整的“时光机日记本”，即使没有网络也能工作。\n\n---\n\n### Git 与 GitHub SSH Key 配置与使用\n\n#### 1. 配置个人信息\n\n```bash\ngit config --global user.name \"你的名字\"\ngit config --global user.email \"你的邮箱\"\n```\n- 设置后每次提交都会自动带上你的署名。\n\n#### 2. 生成 SSH 密钥\n\n```bash\nssh-keygen -t rsa -b 4096 -C \"你的邮箱@example.com\"\n```\n- -t rsa ：使 ⽤ RSA 算法 ⽣ 成密钥。\n- 一路回车即可，密钥默认保存在 `~/.ssh/` 目录。\n\n#### 3. 查看并复制公钥内容\n\n```bash\ncat ~/.ssh/id_rsa.pub\n```\n- 复制输出的内容（全部内容）。\n\n#### 4. 添加公钥到远程仓库\n\n- **GitHub**：Settings > SSH and GPG keys > New SSH key，粘贴公钥并保存。\n- **Gitee**：设置 > 安全设置 > SSH 密钥，粘贴公钥并保存。\n\n#### 5. 测试连接\n\n- GitHub：`ssh -T git@github.com`\n- Gitee：`ssh -T git@gitee.com`\n\n- 第一次会提示“Are you sure you want to continue connecting”，输入 yes\n- 若看到 `Hi 用户名! You've successfully authenticated...` 表示成功！\n\n#### 6. 多平台/多账户密钥配置（进阶）\n\n- 多台电脑、多个平台可分别生成密钥并添加到账户。\n- 如需配置多个密钥，在 `~/.ssh/config` 文件中添加：\n\n```\nHost github.com\n  HostName github.com\n  User git\n  IdentityFile ~/.ssh/id_rsa\n\nHost gitee.com\n  HostName gitee.com\n  User git\n  IdentityFile ~/.ssh/id_rsa_gitee\n```\n\n### Git 命令\n\n#### 基本操作\n\n```bash\n# 初始化仓库（只需一次）\ngit init\n\n# 克隆远程仓库到本地\ngit clone <仓库地址>\n\n# 查看当前状态\ngit status\n\n# 查看历史提交记录\ngit log\n```\n\n#### 文件操作\n\n```bash\n# 添加所有更改到暂存区\ngit add .\n\n# 添加指定文件到暂存区\ngit add 文件名\n\n# 从暂存区移除文件\ngit reset 文件名\n```\n\n#### 提交/保存更改\n\n```bash\n# 提交到本地仓库\ngit commit -m \"提交说明\"\n```\n\n#### 与远程仓库交互\n\n```bash\n# 关联远程仓库（只需一次）\ngit remote add origin <仓库地址>\n\n# 推送到远程仓库\ngit push\n\n# 推送到远程指定分支（第一次推送用）\ngit push -u origin main\n\n# 从远程仓库拉取最新内容\ngit pull\n```\n\n#### 分支管理\n\n```bash\n# 查看所有分支\ngit branch\n\n# 创建新分支\ngit branch 新分支名\n\n# 切换分支\ngit checkout 分支名\n\n# 创建并切换到新分支\ngit checkout -b 新分支名\n\n# 删除本地分支\ngit branch -d 分支名\n\n# 查看远程分支\ngit branch -r\n\n# 拉取远程分支并创建本地分支\ngit checkout -b 本地分支名 origin/远程分支名\n\n# 删除远程分支\ngit push origin --delete 分支名\n```\n\n#### 撤销与恢复\n\n```bash\n# 撤销工作区的修改（让文件恢复到上一次commit的状态）\ngit checkout -- 文件名\n\n# 撤销暂存区的修改（把已add的文件撤回到工作区）\ngit reset HEAD 文件名\n\n# 撤销最近一次commit但保留修改（回退到上一次commit，修改内容还在）\ngit reset --soft HEAD^\n\n# 丢弃最近一次commit和修改（慎用，修改会丢失）\ngit reset --hard HEAD^\n\n# 恢复被删除的文件（找回误删的文件）\ngit checkout HEAD -- 文件名\n```\n\n#### 查看与对比\n\n```bash\n# 查看本地和远程分支对应关系\ngit branch -vv\n\n# 查看远程地址\ngit remote -v\n\n# 查看某个文件的修改内容\ngit diff 文件名\n\n# 查看暂存区和上一次commit的区别\ngit diff --cached\n\n# 查看某个文件的历史修改记录\ngit log 文件名\n\n# 对比本地分支与远程分支的差异\ngit diff main origin/main\n```\n\n#### 标签（Tag）\n\n```bash\n# 打标签\ngit tag v1.0\n\n# 推送标签到远程\ngit push origin v1.0\n\n# 查看所有标签\ngit tag\n```\n\n#### 合并与冲突\n\n```bash\n# 合并分支\ngit merge 另一个分支名\n\n# 解决冲突后，添加并提交\ngit add .\ngit commit -m \"fix conflict\"\n```\n\n---\n\n> **提示：**\n>\n> - 不会的命令可以用 `git help 命令名` 查看帮助。\n> - 日常开发建议多用 `git status` 和 `git log` 观察当前状态。\n> - 日常开发推荐分支模型，每个功能新建分支，开发完成合并主线\n\n---\n\n### Git 常用命令速查表\n\n| 功能             | 命令                                                         | 说明                                 |\n| ---------------- | ------------------------------------------------------------ | ------------------------------------ |\n| 配置用户名和邮箱 | `git config --global user.name \"你的名字\"` <br> `git config --global user.email \"你的邮箱\"` | 设置“署名”，每次提交都标记贡献者     |\n| 初始化仓库       | `git init`                                                   | 新建“时光机日记本”，准备记录代码版本 |\n| 添加文件到暂存区 | `git add 文件名` 或 `git add .`                              | 把修改内容放到“草稿区”               |\n| 提交到本地仓库   | `git commit -m \"提交说明\"`                                   | 草稿正式进入日记本，并附说明         |\n| 推送到远程仓库   | `git push origin 分支名`                                     | 把本地代码同步到远程仓库             |\n| 克隆远程仓库     | `git clone 仓库地址`                                         | 下载别人的代码到本地                 |\n| 查看状态         | `git status`                                                 | 检查当前代码变化情况                 |\n| 查看提交历史     | `git log`                                                    | 查看代码记录，回顾“时间线”           |\n| 创建分支         | `git branch 分支名`                                          | 新功能独立章节                       |\n| 切换分支         | `git checkout 分支名`                                        | 从一个章节切换到另一个章节           |\n| 合并分支         | `git merge 分支名`                                           | 不同章节内容合并到主线               |\n| 拉取远程代码     | `git pull origin 分支名`                                     | 从远程仓库获取最新代码               |\n\n---\n\n### GitHub 入门详解\n\n#### 1. GitHub 是什么？\n\n- **GitHub** 是全球最大的开源代码托管平台，基于 Git 版本控制，方便开发者协作、分享和展示项目。\n- 在 GitHub 上，你可以：\n  - 托管自己的项目代码，并进行版本管理\n  - 查找和参与全球开源项目\n  - 与他人协作开发（团队项目、开源贡献）\n  - 展示个人作品，提升技术影响力\n\n#### 2. GitHub 账号注册与界面介绍\n\n- [GitHub 注册入口](https://github.com/)\n\n- 不建议直接使用教育邮箱注册\n\n  > 我们学校的教育邮箱是   学号@stu.nchu.edu.cn\n  >\n  > 教育认证可额外绑定教育邮箱，可获取学生认证福利（如 Copilot 免费使用）\n\n- 注册流程：填写邮箱、用户名、密码 → 邮箱验证 → 完善个人资料\n\n##### GitHub 主要界面说明\n- **Repositories（仓库）**：项目代码的存放地，每个仓库包含代码、文档、历史记录等\n- **Issues**：用于提交问题、建议、任务分解，方便项目管理和交流\n- **Pull Requests（PR）**：代码协作的核心，提交代码修改请求，项目维护者审核后合并\n- **Fork**：复制别人的项目到你的账户，方便独立开发或贡献代码\n- **Star**：收藏项目，方便日后查找\n- **Actions**：自动化 CI/CD 工具，帮助自动测试和部署\n\n#### 3. GitHub 教育认证与 Copilot 白嫖流程\n\n- **GitHub Copilot**：AI 智能编程助手，自动补全代码、生成函数/注释，提升开发效率\n- **教育认证步骤**：\n  1. 注册并登录 GitHub 账号\n  2. 访问 [GitHub Education](https://education.github.com/) 页面，点击“Get benefits”或“Apply for Student Developer Pack”\n  3. 根据提示填写教育邮箱、学生身份等信息，提交认证\n  4. 通过后可免费开通 Copilot（[Copilot 激活入口](https://github.com/settings/copilot)）\n\n#### 4. GitHub 基础实战流程\n\n- **远程仓库协作流程**：\n  1. Fork 项目到个人账户\n  2. Clone 仓库到本地\n  3. 新建分支，进行开发\n  4. 提交并推送修改到远程分支\n  5. 发起 Pull Request，等待项目维护者审核合并\n  6. 参与 Issues 讨论，跟进项目进展\n\n- **常见协作场景**：\n  - 团队开发：多人协作同一项目，分工明确，分支合并\n  - 开源贡献：发现项目问题或有新功能建议，可提交 PR 或 Issue\n  - 个人作品：将自己的代码托管公开，展示技术实力\n\n#### 5. GitHub 常用术语补充\n\n- **Commit**：每一次代码提交\n- **Branch**：分支，独立开发环境\n- **Merge**：合并分支\n- **Release**：项目发布版本\n- **Webhook**：自动通知外部服务\n\n---\n\n### Gitee 入门详解\n\n#### 1. Gitee 是什么？\n\n- **Gitee（码云）**：中国主流的代码托管平台，支持 Git 管理，适合国内团队、企业使用。\n- 优势：\n  - 国内访问速度快，无需科学上网\n  - 支持私有仓库免费（适合团队或企业项目）\n  - 与中国开发者生态结合紧密（对接企事业单位、开源中国等）\n\n#### 2. Gitee 账号注册与界面介绍\n\n- [Gitee 注册入口](https://gitee.com/)\n- 支持手机号、邮箱注册\n- 注册流程：填写信息 → 验证 → 完善个人资料\n\n##### Gitee 主要界面说明\n- **项目（Project）**：代码仓库\n- **问题（Issue）**：项目问题追踪与任务管理\n- **合并请求（Pull Request）**：代码协作\n- **收藏、Fork、Watch**：功能与 GitHub 类似\n- **Gitee Pages**：静态网站托管（个人博客/项目文档）\n\n#### 3. Gitee SSH Key 配置与项目协作\n\n- SSH Key 配置流程与 GitHub 类似（见上方）\n- 项目协作流程：\n  1. 创建或 Fork 仓库\n  2. Clone 到本地\n  3. 新建分支开发，提交并推送\n  4. 发起合并请求\n  5. 参与 Issue 讨论\n\n#### 4. Gitee 特色功能\n\n- 支持企业版和团队协作\n- 支持中国主流第三方登录（微信、支付宝等）\n- 支持私有仓库免费，适合企业内部项目管理\n\n---\n\n### 第五部分：GitHub 和 Gitee 的核心功能对比\n\n| 功能         | GitHub              | Gitee                |\n| ------------ | ------------------- | -------------------- |\n| Fork         | 复制项目到个人账户  | 同样支持复制项目     |\n| Star         | 收藏项目            | 同样支持收藏项目     |\n| Watch        | 订阅项目动态        | 支持订阅             |\n| Issues       | 提交问题或建议      | 问题追踪支持更本地化 |\n| Pull Request | 提交代码修改和合并  | 类似功能             |\n| Actions      | 自动化 CI/CD 工作流 | 不支持 Actions       |\n| Pages        | 静态网站托管        | 提供类似功能         |\n| Releases     | 发布稳定版本        | 同样支持发布功能     |\n| Webhooks     | 自动消息通知        | 支持类似功能         |\n\n****\n\n### 总结\n\n- **Git**：本地代码管理和版本控制工具\n- **GitHub**：全球开源协作、作品展示和技术交流平台\n- **Gitee**：国内主流代码托管平台，适合本地团队和企业项目协作\n\n**建议：**\n\n- 日常学习和开源项目优先用 GitHub，参与国际技术社区\n- 团队/企业项目可选用 Gitee，便于国内协作和访问\n- 熟练掌握 Git 命令和 SSH 配置，提升协作效率\n\n****\n\n## Typora 与 Markdown\n\n### Typora 使用教程\n\n#### 安装和激活\n\n- 下载 Typora 安装包，运行后一路点击 OK 即可完成安装。\n- 如果需要激活，将文件夹中的 **winmm.dll** 移动到 Typora 的安装路径下（如 D:\\Program Files\\Typora）。注意此步骤需关闭 Typora 软件，否则会报错。\n\n![image-20251017092741839](/images/Git_Github_Markdown/Git_Github_Markdown_3.png)\n\n---\n\n#### 插件使用\n\n- 推荐安装 [typora_plugin](https://github.com/obgnail/typora_plugin)：可以显著优化 Typora 的使用体验，按官方文档安装即可。\n- 论文工具[typora-latex-theme](https://github.com/Keldos-Li/typora-latex-theme)：对于没有学过office三件套或WPS的同学大有帮助。\n\n---\n\n#### 建议配置\n\n##### 侧边栏设置\n\n- 建议将侧边栏打开，便于查看和管理文档结构。\n- 在 Typora 主界面点击右下角的 `显示/隐藏侧边栏` 按钮即可。\n\n![image-20251017093303047](/images/Git_Github_Markdown/Git_Github_Markdown_4.png)\n\n---\n\n##### 文件配置\n\n- 进入 Typora 菜单栏 `文件 -> 偏好设置`，进行文件相关配置。\n- 推荐按照下图设置，便于文档管理与文件归档。\n\n![image-20251017093318594](/images/Git_Github_Markdown/Git_Github_Markdown_5.png)\n\n---\n\n##### 编辑器配置\n\n- 推荐启用智能缩进、自动补全 Markdown 字符、统一行尾符号等功能，提升编辑效率，减少语法出错。\n\n![image-20251017093327185](/images/Git_Github_Markdown/Git_Github_Markdown_6.png)\n\n---\n\n##### 图片配置\n\n- 插入图片时，建议选择自动复制图片到当前 md 文件同名的 assets 文件夹下，方便文档迁移和分享。  \n- 推荐勾选：  \n  - 自动上传图片到 assets 文件夹\n  - 优化图片路径显示\n  - 生成图片相对路径  \n- 图片插入后，建议压缩图片或生成缩略图，减少文档体积。\n\n---\n\n##### Markdown 配置\n\n我们在这里可以配置markdown的语法相关，我的建议是全部勾上（除了那个首行缩进<这是个人喜好\n\n\\>），一定勾选上那个图表，这样可以让typora对mermaid等图表代码直接进行渲染，下面的公式编号还是看个人情况，这里就不过多说了\n\n- 建议开启 Typora 对 mermaid 图表和数学公式的支持，方便画流程图和写公式。\n- 推荐设置常用语法快捷键，提升编辑效率。\n\n![image-20251017093521861](/images/Git_Github_Markdown/Git_Github_Markdown_8.png)\n\n---\n\n#####  导出配置\n\n- 可根据个人需求设置 PDF 导出参数，包括页面大小、边距等。\n- 支持设置 YAML 头信息（如 title、author），导出时自动识别并加到对应位置。\n\n![image-20251017093617999](/images/Git_Github_Markdown/Git_Github_Markdown_9.png)\n\n---\n\n##### 外观配置\n\n- 推荐使用「经典」模式，字体大小和主题可按个人习惯调整，支持多种主题切换（如 HappySimple、Jetbrains Mono Theme 等）。\n\n![image-20251017093703523](/images/Git_Github_Markdown/Git_Github_Markdown_10.png)\n\n- 主题获取途径：\n  - [Themes Gallery – Typora](https://theme.typora.io/)\n  - GitHub 搜索 typora theme\n\n---\n\n##### 通用配置\n\n![image-20251017093728150](/images/Git_Github_Markdown/Git_Github_Markdown_11.png)\n\n- 建议关闭自动检查更新和开发版更新，稳定性更好。\n- 可自定义快捷键，提升操作效率。\n\n---\n\n#### 主题美化\n\n- 推荐主题：\n  - **Neil Jetbrains Mono Theme**：适合 Jetbrains 系 IDE 用户，字体美观，界面简洁。\n  - **HappySimple**：视觉舒适，适合日常写作和学习。\n\n---\n\n### Markdown 使用教程\n\n#### 一、什么是 Markdown？\n\nMarkdown 是一种轻量级的标记语言，设计用于让普通文本具有丰富的格式表现，同时保留文案内容的易读性和易写性。通过简单直观的标记符号实现文档格式化，广泛应用于技术文档、博客文章、电子邮件、笔记和协作文档等。\n\n---\n\n#### 二、为什么选择 Markdown？\n\n1. **简单直观**：语法易学易用，常见标记符号即可快速上手。\n2. **跨平台支持**：兼容多种工具和平台，如 GitHub、Notion、VS Code、Jupyter Notebook 等。\n3. **多格式输出**：可转为 HTML、PDF、Word 等多种格式，满足不同需求。\n4. **专注创作**：无需复杂排版工具，专注内容本身，提升写作效率。\n\n---\n\n#### 三、Markdown 语法详解\n\n##### 1. 标题\n\n使用 `#` 符号表示标题，支持六级标题，`#` 的数量代表标题级别。\n\n```markdown\n# 一级标题\n## 二级标题\n### 三级标题\n#### 四级标题\n##### 五级标题\n###### 六级标题\n```\n---\n\n##### 2. 段落与换行\n\n普通文本直接书写即可。若需换行，在行尾添加两个空格。\n\n```markdown\n这是一段文字，行尾加两个空格后换行。  \n这是下一行。\n```\n---\n\n##### 3. 强调\n\n支持斜体和加粗，以及两者组合。\n\n```markdown\n*斜体* 或 _斜体_\n**加粗** 或 __加粗__\n***斜体加粗*** 或 ___斜体加粗___\n```\n\n效果：\n- *斜体*\n- **加粗**\n- ***斜体加粗***\n\n---\n\n##### 4. 列表\n\n支持无序列表和有序列表。\n\n###### 无序列表\n\n使用 `-`、`*` 或 `+` 作为标记符。\n\n```markdown\n- 项目一\n- 项目二\n  - 子项目一\n  - 子项目三\n* 项目三\n```\n\n效果：\n- 项目一\n- 项目二\n  - 子项目一\n  - 子项目三\n- 项目三\n\n###### 有序列表\n\n使用数字加点 `1.`，数字顺序可不连续，最终会按顺序渲染。\n\n```markdown\n1. 项目一\n2. 项目二\n   1. 子项目一\n   2. 子项目二\n```\n\n效果：\n1. 项目一\n2. 项目二\n   1. 子项目一\n   2. 子项目二\n\n---\n\n##### 5. 链接\n\n添加超链接：\n\n```markdown\n[链接文字](链接地址)\n[google](https://www.google.com)\n```\n\n带标题提示：\n\n```markdown\n[链接文字](链接地址 \"标题提示\")\n[google](https://www.google.com \"谷歌搜索\")\n```\n\n效果如下：\n[Google](https://www.google.com)\n[Google](https://www.google.com \"谷歌搜索\")\n\n---\n\n##### 6. 图片\n\n添加图片与链接类似，只需在前面加一个 `!`。\n\n```markdown\n![图片描述](图片地址)\n![鹿乃.jpg](https://s2.loli.net/2024/10/27/I1iqvzVtnxEYuaT.jpg)\n```\n\n---\n\n##### 7. 引用\n\n引用使用 `>` 进行标记，支持嵌套引用。\n\n```markdown\n> 这是一个引用。\n>> 这是嵌套引用。\n```\n\n效果：\n> 这是一个引用。\n> > 这是嵌套引用。\n\n---\n\n##### 8. 代码块\n\n###### 行内代码\n\n用反引号（`）包裹。\n\n```markdown\n`这是行内代码` 示例。\n```\n\n效果：`这是行内代码` 示例。\n\n###### 多行代码块\n\n用三个反引号（```）包裹，可指定语言高亮。\n\n```markdown\n``` python\ndef hello():\n    print(\"Hello, Markdown!\")\n```\n```\n\n效果如下：\n\n```python\ndef hello():\n    print(\"Hello, Markdown!\")\n```\n\n---\n\n##### 9. 表格\n\n使用 `|` 和 `-` 创建表格。\n\n```markdown\n| 表头1 | 表头2 | 表头3 |\n|-------|-------|-------|\n| 数据1 | 数据2 | 数据3 |\n| 数据4 | 数据5 | 数据6 |\n```\n\n效果：\n| 表头 1 | 表头 2 | 表头 3 |\n| ----- | ----- | ----- |\n| 数据 1 | 数据 2 | 数据 3 |\n| 数据 4 | 数据 5 | 数据 6 |\n\n---\n\n##### 10. 分隔线\n\n用三个或更多的 `-`、`*` 或 `_` 创建分隔线。\n\n```markdown\n---\n***\n___\n```\n\n#### 效果如下：\n\n****\n\n#### 任务列表\n\n用 `- [ ]` 创建未完成任务，`- [x]` 创建已完成任务。\n\n```markdown\n- [ ] 任务一\n- [x] 任务二\n- [ ] 任务三\n```\n\n效果：\n- [ ] 任务一\n- [x] 任务二\n- [ ] 任务三\n\n---\n\n##### 12. 公式\n\n支持 LaTeX 数学公式（部分编辑器/平台需开启支持）。\n\n```markdown\n$\\frac{a}{b}$\n```\n\n效果：$\\frac{a}{b}$\n\n---\n\n##### 13. mermaid 绘图\n\n支持流程图、时序图等（需平台支持）。\n\n```markdown\ngraph TD\nA[串口中断接收] --> B{中断号判断}\nB -->|USART1 或 USART2| C[堆栈寄存器压入\\n]\nC --> B\n```\n\n---\n\n### Typora 快捷键速查表\n\n| 功能            | 快捷键（Windows）   | 快捷键（Mac）     | 说明                           |\n| --------------- | ------------------- | ----------------- | ------------------------------ |\n| 加粗            | Ctrl + B            | Cmd + B           | 选中内容加粗                   |\n| 斜体            | Ctrl + I            | Cmd + I           | 选中内容斜体                   |\n| 插入标题        | Ctrl + 1 ~ Ctrl + 6 | Cmd + 1 ~ Cmd + 6 | 对应一级至六级标题             |\n| 插入无序列表    | Ctrl + Shift + U    | Cmd + Shift + U   | 快速插入无序列表               |\n| 插入有序列表    | Ctrl + Shift + O    | Cmd + Shift + O   | 快速插入有序列表               |\n| 插入任务列表    | Ctrl + Shift + C    | Cmd + Shift + C   | 插入 `- [ ]` 任务项            |\n| 插入代码块      | Ctrl + Shift + K    | Cmd + Option + K  | 插入三反引号代码块（块级代码） |\n| 插入行内代码    | Ctrl + E            | Cmd + E           | 插入行内代码（单反引号）       |\n| 插入图片        | Ctrl + Shift + I    | Cmd + Shift + I   | 打开插入图片对话框             |\n| 插入链接        | Ctrl + K            | Cmd + K           | 插入超链接                     |\n| 插入引用        | Ctrl + Shift + Q    | Cmd + Shift + Q   | 插入引用 >                     |\n| 插入表格        | Ctrl + T            | Cmd + T           | 打开插入表格面板               |\n| 插入公式        | Ctrl + Shift + M    | Cmd + Shift + M   | 插入公式块（$$）               |\n| 插入Mermaid图   | Ctrl + Shift + G    | Cmd + Shift + G   | 插入mermaid绘图代码块          |\n| 切换专注模式    | F8                  | F8                | 切换专注模式（Focus Mode）     |\n| 打开/关闭侧边栏 | Ctrl + /            | Cmd + /           | 显示或隐藏左侧目录栏           |\n| 查找            | Ctrl + F            | Cmd + F           | 查找文本                       |\n| 替换            | Ctrl + H            | Cmd + Option + F  | 查找并替换文本                 |\n| 保存            | Ctrl + S            | Cmd + S           | 保存文档                       |\n| 导出            | Ctrl + Shift + E    | Cmd + Shift + E   | 导出为PDF、HTML等格式          |\n| 打开偏好设置    | Ctrl + ,            | Cmd + ,           | 打开Typora设置                 |\n| 新建文档        | Ctrl + N            | Cmd + N           | 新建一个空白文档               |\n| 打开文档        | Ctrl + O            | Cmd + O           | 打开本地文档                   |\n| 关闭文档        | Ctrl + W            | Cmd + W           | 关闭当前标签页                 |\n\n> **提示：**  \n> Typora 支持自定义快捷键，部分功能可在 “偏好设置” > “快捷键”中自定义。  \n> 常用操作如插入代码块、插入图片、切换侧边栏等快捷键建议多加练习，提升效率。\n\n\n\n---\n\n## 插件与刷课脚本部分\n\n### 一、浏览器插件简介\n\n#### 1. 什么是浏览器插件？\n\n浏览器插件（扩展）是一种可以为浏览器增加新功能的小型程序。它们能够帮助用户实现自动化、界面美化、广告屏蔽、脚本自定义等功能，极大提升日常上网体验和效率。\n\n---\n\n#### 2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\n\n**油猴（Tampermonkey）** 和 **篡改猴（Violentmonkey）** 都是浏览器端最主流的用户脚本管理器插件，能够让用户轻松安装、管理和运行自定义脚本（如刷课、自动答题、网页优化等）。\n\n|          | 油猴（Tampermonkey）        | 篡改猴（Violentmonkey）    |\n| -------- | --------------------------- | -------------------------- |\n| 兼容性   | Chrome/Edge/Firefox/Safari  | Chrome/Edge/Firefox/Opera  |\n| 界面     | 功能丰富，设置选项更多      | 界面简洁，轻量，易用       |\n| 脚本支持 | 支持几乎所有主流用户脚本    | 支持大部分脚本，兼容性优秀 |\n| 开发者   | 国外团队                    | 国外团队（有国人参与）     |\n| 推荐场景 | 需要高级管理/脚本较多的用户 | 追求简洁/轻量的用户        |\n\n**小结：**\n- 油猴（Tampermonkey）适合大多数用户，功能更全，兼容性最好，推荐新手优先选择。\n- 篡改猴（Violentmonkey）更轻量，界面简洁，资源占用更低。\n\n---\n\n#### 3. 安装方法\n\n**a. Chrome 浏览器：**\n- 推荐前往 [crx搜搜插件网](https://www.crxsoso.com/search) 搜索「Tampermonkey」或「Violentmonkey」并下载安装（国内无需科学上网）。\n\n  > 聚合了 Chrome、Edge、Firefox 各类插件和油猴脚本，国内访问速度快，适合查找各类扩展和脚本。\n\n- 也可去 [Chrome Web Store](https://chrome.google.com/webstore/) 安装（需科学上网）。\n\n**b. Edge 浏览器：**\n- 可在 Edge 插件商店或 crx搜搜 搜索并安装。\n\n**c. Firefox 浏览器：**\n- 前往 [Firefox 附加组件](https://addons.mozilla.org/) 搜索并安装。\n\n---\n\n### OCS网课助手与刷课脚本\n\n#### OCS网课助手简介\n\nOCS网课助手是一款专为网课平台（如超星、智慧树、学堂在线等）开发的刷课插件，能实现自动播放、刷视频、自动答题等功能，大大提高网课学习效率。适合需要快速完成网课任务的同学。\n\n- **官网/项目主页**：[OCS网课助手](https://docs.ocsjs.com/)\n- **主要功能**：\n  - 自动刷视频、自动答题、自动过考试\n  - 支持多个主流网课平台\n  - 可配合题库使用（如教材/言溪题库等）\n\n#### 言溪题库简介\n\n- **官网主页**：[言溪题库](https://tk.enncy.cn/)\n\n- 提供超星、智慧树等平台的题目答案，可提升刷课和自动答题的正确率。\n- 常见用法：在 OCS 等刷课插件设置里绑定题库接口，或手动查找题目答案。\n\n#### WE Learn & U校园刷课脚本与教程\n\n- **EOC 一站式刷课脚本合集**：[EOC项目主页](https://ssmjae.github.io/EOC/)\n  - 该网站提供了针对多种主流校园网课平台（如 WE Learn、U校园等）的刷课脚本及详细教程。\n  - 主要功能包括：\n    - 自动刷视频、自动答题、自动完成作业、考试辅助等\n    - 支持多平台、多类型课程的自动化处理\n    - 提供详细的安装流程、脚本下载链接、常见问题解答\n  - 网站内容持续更新，适合自助查找和学习刷课自动化工具\n\n**使用建议：**\n- 进入 EOC 项目主页后，根据你的网课平台（如 WE Learn、U校园）选择对应脚本和教程，按照页面说明进行安装和使用。\n- 建议优先使用油猴（Tampermonkey）或篡改猴（Violentmonkey）插件进行脚本管理，确保兼容性和脚本运行稳定。\n- 脚本仅供学习和便捷课程管理使用，切勿用于违规用途。\n\n---\n\n**实用建议：**\n\n- 插件和脚本建议只从知名平台和官方渠道下载，避免安全风险。\n- 使用脚本前请详细阅读说明，注意账号安全，不要泄露个人信息。\n- 刷课脚本仅供学习交流，勿用于违规用途。\n\n","source":"_posts/Git_Github_Markdown.md","raw":"---\ntitle: Git & GitHub & Markdown &刷课\ndate: 2025-10-17 11:17\ncategories: 学习笔记\ntags: [技术, 教程]\n---\n\n# Git & GitHub & Markdown &刷课\n\n## **环境准备**\n\n### Chrome 浏览器下载\n\n**推荐使用国内 Cent Browser：**\n\n- [官方下载地址(官网)](https://www.centbrowser.cn/)\n\n- 继承谷歌内核稳定流畅的优点同时，与 Chrome 基本操作界面别无二致, 并加入其他常用功能\n\n**推荐使用谷歌 Chrome 浏览器：**\n\n- [官方下载地址（需科学上网）](https://www.google.com/chrome/)\n- 或搜索“Chrome 浏览器下载国内镜像”获取国内最新可用链接。\n\n### VPN 与机场\n\n#### VPN 是什么？机场是什么？\n\n- **VPN**：虚拟专用网络，最初是企业、学校等用于远程安全访问内部资源。后来大家习惯把“翻墙”工具称为 VPN，但实际上 VPN 协议并不专属于翻墙，比如 WireGuard、OpenVPN 等真正网络层的 VPN 协议。\n- **机场**：是专门提供“科学上网”服务的平台。机场主租用大量 VPS（国外服务器），搭建 SS、SSR、Vmess、Trojan 等代理协议节点，用户买流量后通过代理软件（如 Clash、小火箭等）连接机场获得自由访问外网的能力。\n- **区别与关系**：VPN 是网络层代理，机场多用应用层/会话层代理。大多数商业 VPN 广告多且贵，体验和性价比远不如机场。\n\n#### 为什么叫“机场”？\n\n因为最早的代理工具 Shadowsocks 图标是一架小飞机，大家就把这种代理服务叫做“机场”。\n\n\n\n机场并不是一个单一的服务器或网站，而是由许多分布在国内外的节点组成，具备分布式、多协议、动态更新和多种抗干扰技术，能灵活应对各种封锁与干扰。即使部分节点被墙，用户只需刷新订阅或等待机场主修复即可继续使用。\n\n下面分几条简要解释：\n\n1. **多节点分散部署**\n   机场通常在国内外部署了很多服务器（节点），即使部分节点被墙封锁，其他节点仍可正常工作，不会导致整个机场服务瘫痪。\n2. **协议混淆与加密**\n   机场使用的代理协议（如 SS、Trojan、Vmess 等）都具备流量加密和混淆能力，能有效隐藏翻墙行为，使防火墙难以精准识别和封锁。\n3. **动态更换节点和订阅**\n   机场可以随时更换服务器 IP、端口、协议等参数，用户通过订阅链接自动获取最新节点信息，及时绕开已被封锁的节点。\n4. **中转与专线技术**\n   很多机场采用“国内中转”、“隧道”、“专线”等技术，使流量出境路线更加隐蔽和多样化，提高抗封锁能力。\n5. **高防与灾备机制**\n   优质机场会购买高防护服务器、备用线路、CDN 加速等服务，即使遭遇攻击或封锁，也能迅速切换恢复服务。\n\n#### 协议科普\n\n- **SS/SSR**：Shadowsocks 及其分支 SSR，轻量级加密代理，速度快，兼容性好。\n- **Vmess/VLESS**：V2Ray 框架的协议，功能丰富，支持多种混淆和传输方式。\n- **Trojan**：基于 HTTPS，伪装成正常网页流量，抗封锁能力强。\n- **Hy2/Reality/Tuic**：新一代协议，多用于自建直连，机场较少支持，安全性更高。\n- **传统 VPN 协议**：如 PPTP、L2TP/IPSec、OpenVPN、WireGuard 等，主要用于网络层代理，穿透性和安全性各有不同。\n\n#### 机场线路名词解释\n\n- **规则**：只有国外网站走代理，节省流量\n- **全局**：所有流量都走代理\n- **直连**：用户设备直接连境外代理服务器，速度受限、极易被墙。\n- **中转**：流量先到国内中转服务器，再转发到境外代理服务器。可以优化速度和稳定性，降低被墙风险。\n- **隧道**：国内服务器入口+境外服务器（如香港 CMI），流量经过 TLS 加密再转发，更安全。\n- **专线（IEPL/IPLC）**：点对点物理线路，低延迟，不经过公网，最稳定但成本高，机场多用 IEPL。\n- **BGP**：边界网关协议，优化多运营商之间的互联访问速度和稳定性。\n- **前置**：中转入口前再加一台国内机器，抗通报/墙封。\n- **转发**：多个机场共享中转资源，速度和稳定性差，常见于小机场。\n- **流量倍率**：部分机场设置倍率，如 2 倍率表示实际消耗 2 倍流量。\n- **系统代理**：大多数应用（如浏览器）自动走代理，部分软件需手动设置\n- **TUN 模式/虚拟网卡**：创建虚拟网卡，实现真正全局代理，解决部分应用不走代理的问题\n- **自动选择/故障转移：** 自动选择延迟最低节点，但可能频繁切换 IP，容易被某些网站风控\n\n#### 线路体验优先级\n\n同样带宽下，体验优先级：  \n\n**IEPL 专线中转 > 隧道中转 > 公网中转（如广东移动/湖南联通） > 直连**\n\n![image-20251016175400498](/images/Git_Github_Markdown/Git_Github_Markdown_1.png)\n\n##### 1. 直连机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内防火墙/QoS 限速 → 直接连接境外 VPS/服务器 → 国际互联网\n- **特点**：没有经过国内中转节点，直接出海。速度受限、易被墙，体验和稳定性都较差，适合流量小、只偶尔使用者。\n\n##### 2. 普通中转机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内中转 VPS → 境内防火墙/QoS 限速 → 境外 VPS → 国际互联网\n- **特点**：增加了一个国内中转节点，优化了出海速度和稳定性。成本较低，但中转节点易受干扰，遇到高峰期或被墙会影响体验。\n\n##### 3. BGP 中转机场\n\n- **流程**：用户设备 → 宽带运营商 → BGP 中转服务器（多线接入、跨运营商优化） → 境内防火墙/QoS 限速 → 境外 VPS → 国际互联网\n- **特点**：BGP 中转节点支持多运营商线路，自动选择最优路径，提升了全国范围的访问速度和稳定性。更适合多地区用户，成本比普通中转高。\n\n##### 4. IPLC 中转机场\n\n- **流程**：用户设备 → 宽带运营商 → 境内中转 VPS → IPLC 专线传输 → 境外 VPS → 国际互联网\n- **特点**：IPLC（国际专线）是物理专用通道，数据从境内直接通过专线传到境外，几乎不经过防火墙和公网，速度、稳定性和安全性最高，但价格也最贵。适合对速度和稳定性要求极高的用户或企业。\n\n---\n\n#### 推荐客户端工具\n\n- **Windows/Mac/Android**：首选 Clash 系列（Clash for Windows、Clash Verge、Clash Meta、Flclash、Clash Party、Sparkle 等）\n- **iOS**：首选小火箭（Shadowrocket，付费）。\n\n#### 客户端使用流程简述\n\n1. 下载并安装客户端软件\n2. 在机场后台获取订阅链接（通常一键复制）\n3. 导入到客户端\n4. 打开系统代理或虚拟网卡（TUN 模式），实现全局或分流科学上网\n5. 常见问题：分流规则设置、系统代理/TUN 模式选择、节点测速与切换\n\n---\n\n#### 机场购买与使用流程\n\n#### 如何购买机场\n\n- 注册账号（推荐 Gmail/Outlook 邮箱，不建议 QQ 邮箱，避免实名风险）\n- 选择套餐，付款（部分机场支持试用套餐）\n- 获取订阅链接，导入代理软件\n- 按照机场提供的小白教程操作，几乎所有机场都有详细的使用说明\n\n![三色图](/images/Git_Github_Markdown/Git_Github_Markdown_2.webp)\n\n#### 小白教程\n\n最小白的教程，适合第一次买机场的，\n\n先注册，注意的点是验证码邮件可能会在邮箱垃圾箱里面。\n如果有试用先试用，没试用就去购买套餐。\n\n1）我们以随便某个 v2board 机场为例子，因为现在很多机场都是用的 v2board 页面。\n**第一步：购买套餐：点击购买订阅–选择你想要的套餐–付款**\n[![购买订阅](/images/Git_Github_Markdown/Git_Github_Markdown_12.webp)\n[![]](/images/Git_Github_Markdown/Git_Github_Markdown_13.webp)\n\n![选择套餐](/images/Git_Github_Markdown/Git_Github_Markdown_13.webp)\n\n**第二步：下载代理软件**，这里以 Clash for windows 为例子\n\n**第三步：导入订阅：回到仪表盘–点击一键订阅–导入到你的 Clash 客户端中**\n\n![仪表盘](/images/Git_Github_Markdown/Git_Github_Markdown_14.webp)\n\n![导入订阅](/images/Git_Github_Markdown/Git_Github_Markdown_15.webp)\n\n![导入订阅后](/images/Git_Github_Markdown/Git_Github_Markdown_16.webp)\n\n具体详细操场教程可以参考各个机场的使用教程，每个机场基本都有小白教程的。\n\n#### 节点和订阅相关问题\n\n- 节点不能用时，先检查流量套餐是否到期或用尽，再刷新订阅或重新复制订阅链接\n- 校园网或公司网可能封端口或 DNS 异常，影响机场使用\n- 机场官网和订阅地址常变，因 GFW 污染 DNS，老牌机场处理经验更丰富\n\n---\n\n#### 线路技术与常见问题详解\n\n##### 机场官网慢/打不开？\n\n- 多数机场官网套了 Cloudflare CDN，隐藏真实 IP，防止被墙，访问速度慢需要科学上网\n\n##### 为什么有些机场便宜？\n\n- 便宜线路（如月抛）、多人共享、直连节点、不买中转、割韭菜跑路风险高\n\n##### 为什么流量消耗快？\n\n- 流量倍率设置、自动选择高倍率节点、系统更新等走代理流量\n\n##### 为什么机场界面都很像？\n\n- 大多数机场用开源面板（V2board、SSpanel），前端界面相似是正常现象\n\n##### 为什么延迟测试异常？\n\n- 部分机场劫持延迟测试，仅到中转入口（非真实国际延迟），可更换延迟测试 URL 验证\n\n##### 机场能否打游戏？\n\n- 不推荐机场打游戏，延迟高、UDP 支持差，建议用专业游戏加速器（如 UU 加速器）。部分机场有专线游戏节点，但不保证稳定\n\n---\n\n#### 机场安全性与合规问题\n\n#### 翻墙是安全吗？\n\n- 你猜\n- 低调，不要键政，不要绑定实名信息\n- 机场主肉身墙外更安全，选老牌大机场，月付为佳\n- 被抓多因机场主肉身墙内、高调、实名收款、境内推广\n\n#### 机场跑路怎么办？\n\n- 灰色产业，跑路风险高，优先选择老牌、肉身墙外的机场主，推荐月付。跑路后只能更换机场\n\n#### 白嫖机场安全吗？\n\n- 免费机场体验差或安全风险高，仅试用阶段可考虑，长期建议付费正规机场\n\n\n\n---\n\n## Git 与 GitHub\n\n- **Git**：核心工具，记录代码修改历史，创建分支，合并分支等。\n- **GitHub/Gitee**：代码托管平台，方便协作、展示作品、参与开源项目。、\n\n\n\n1. Git 版本控制基础\n   - 安装与配置（Windows/Mac/Linux）\n   - 常用命令演示\n2. GitHub 账号注册与界面介绍\n   - 教育邮箱注册技巧\n   - 仓库、Issue、PR 等基本功能\n3. GitHub 教育认证与 Copilot 白嫖流程\n   - Copilot 是什么\n   - 认证与激活详细步骤\n4. 基础实战：远程仓库协作、Fork、PR 操作演示\n\n\n\n### Git 是什么\n\n**Git 就像一本“时光机日记本”📖**  \n\n每段代码的改动，Git 都会帮你记录下来，随时可以“穿越回过去”查找任何时间点的代码状态。\n\n- **主要特点：**\n  1. **版本控制**：每次提交都像写新日记，保存开发成果。\n  2. **分支管理**：分支如同章节，可以并行开发互不干扰。\n  3. **分布式**：每个人都有完整的“时光机日记本”，即使没有网络也能工作。\n\n---\n\n### Git 与 GitHub SSH Key 配置与使用\n\n#### 1. 配置个人信息\n\n```bash\ngit config --global user.name \"你的名字\"\ngit config --global user.email \"你的邮箱\"\n```\n- 设置后每次提交都会自动带上你的署名。\n\n#### 2. 生成 SSH 密钥\n\n```bash\nssh-keygen -t rsa -b 4096 -C \"你的邮箱@example.com\"\n```\n- -t rsa ：使 ⽤ RSA 算法 ⽣ 成密钥。\n- 一路回车即可，密钥默认保存在 `~/.ssh/` 目录。\n\n#### 3. 查看并复制公钥内容\n\n```bash\ncat ~/.ssh/id_rsa.pub\n```\n- 复制输出的内容（全部内容）。\n\n#### 4. 添加公钥到远程仓库\n\n- **GitHub**：Settings > SSH and GPG keys > New SSH key，粘贴公钥并保存。\n- **Gitee**：设置 > 安全设置 > SSH 密钥，粘贴公钥并保存。\n\n#### 5. 测试连接\n\n- GitHub：`ssh -T git@github.com`\n- Gitee：`ssh -T git@gitee.com`\n\n- 第一次会提示“Are you sure you want to continue connecting”，输入 yes\n- 若看到 `Hi 用户名! You've successfully authenticated...` 表示成功！\n\n#### 6. 多平台/多账户密钥配置（进阶）\n\n- 多台电脑、多个平台可分别生成密钥并添加到账户。\n- 如需配置多个密钥，在 `~/.ssh/config` 文件中添加：\n\n```\nHost github.com\n  HostName github.com\n  User git\n  IdentityFile ~/.ssh/id_rsa\n\nHost gitee.com\n  HostName gitee.com\n  User git\n  IdentityFile ~/.ssh/id_rsa_gitee\n```\n\n### Git 命令\n\n#### 基本操作\n\n```bash\n# 初始化仓库（只需一次）\ngit init\n\n# 克隆远程仓库到本地\ngit clone <仓库地址>\n\n# 查看当前状态\ngit status\n\n# 查看历史提交记录\ngit log\n```\n\n#### 文件操作\n\n```bash\n# 添加所有更改到暂存区\ngit add .\n\n# 添加指定文件到暂存区\ngit add 文件名\n\n# 从暂存区移除文件\ngit reset 文件名\n```\n\n#### 提交/保存更改\n\n```bash\n# 提交到本地仓库\ngit commit -m \"提交说明\"\n```\n\n#### 与远程仓库交互\n\n```bash\n# 关联远程仓库（只需一次）\ngit remote add origin <仓库地址>\n\n# 推送到远程仓库\ngit push\n\n# 推送到远程指定分支（第一次推送用）\ngit push -u origin main\n\n# 从远程仓库拉取最新内容\ngit pull\n```\n\n#### 分支管理\n\n```bash\n# 查看所有分支\ngit branch\n\n# 创建新分支\ngit branch 新分支名\n\n# 切换分支\ngit checkout 分支名\n\n# 创建并切换到新分支\ngit checkout -b 新分支名\n\n# 删除本地分支\ngit branch -d 分支名\n\n# 查看远程分支\ngit branch -r\n\n# 拉取远程分支并创建本地分支\ngit checkout -b 本地分支名 origin/远程分支名\n\n# 删除远程分支\ngit push origin --delete 分支名\n```\n\n#### 撤销与恢复\n\n```bash\n# 撤销工作区的修改（让文件恢复到上一次commit的状态）\ngit checkout -- 文件名\n\n# 撤销暂存区的修改（把已add的文件撤回到工作区）\ngit reset HEAD 文件名\n\n# 撤销最近一次commit但保留修改（回退到上一次commit，修改内容还在）\ngit reset --soft HEAD^\n\n# 丢弃最近一次commit和修改（慎用，修改会丢失）\ngit reset --hard HEAD^\n\n# 恢复被删除的文件（找回误删的文件）\ngit checkout HEAD -- 文件名\n```\n\n#### 查看与对比\n\n```bash\n# 查看本地和远程分支对应关系\ngit branch -vv\n\n# 查看远程地址\ngit remote -v\n\n# 查看某个文件的修改内容\ngit diff 文件名\n\n# 查看暂存区和上一次commit的区别\ngit diff --cached\n\n# 查看某个文件的历史修改记录\ngit log 文件名\n\n# 对比本地分支与远程分支的差异\ngit diff main origin/main\n```\n\n#### 标签（Tag）\n\n```bash\n# 打标签\ngit tag v1.0\n\n# 推送标签到远程\ngit push origin v1.0\n\n# 查看所有标签\ngit tag\n```\n\n#### 合并与冲突\n\n```bash\n# 合并分支\ngit merge 另一个分支名\n\n# 解决冲突后，添加并提交\ngit add .\ngit commit -m \"fix conflict\"\n```\n\n---\n\n> **提示：**\n>\n> - 不会的命令可以用 `git help 命令名` 查看帮助。\n> - 日常开发建议多用 `git status` 和 `git log` 观察当前状态。\n> - 日常开发推荐分支模型，每个功能新建分支，开发完成合并主线\n\n---\n\n### Git 常用命令速查表\n\n| 功能             | 命令                                                         | 说明                                 |\n| ---------------- | ------------------------------------------------------------ | ------------------------------------ |\n| 配置用户名和邮箱 | `git config --global user.name \"你的名字\"` <br> `git config --global user.email \"你的邮箱\"` | 设置“署名”，每次提交都标记贡献者     |\n| 初始化仓库       | `git init`                                                   | 新建“时光机日记本”，准备记录代码版本 |\n| 添加文件到暂存区 | `git add 文件名` 或 `git add .`                              | 把修改内容放到“草稿区”               |\n| 提交到本地仓库   | `git commit -m \"提交说明\"`                                   | 草稿正式进入日记本，并附说明         |\n| 推送到远程仓库   | `git push origin 分支名`                                     | 把本地代码同步到远程仓库             |\n| 克隆远程仓库     | `git clone 仓库地址`                                         | 下载别人的代码到本地                 |\n| 查看状态         | `git status`                                                 | 检查当前代码变化情况                 |\n| 查看提交历史     | `git log`                                                    | 查看代码记录，回顾“时间线”           |\n| 创建分支         | `git branch 分支名`                                          | 新功能独立章节                       |\n| 切换分支         | `git checkout 分支名`                                        | 从一个章节切换到另一个章节           |\n| 合并分支         | `git merge 分支名`                                           | 不同章节内容合并到主线               |\n| 拉取远程代码     | `git pull origin 分支名`                                     | 从远程仓库获取最新代码               |\n\n---\n\n### GitHub 入门详解\n\n#### 1. GitHub 是什么？\n\n- **GitHub** 是全球最大的开源代码托管平台，基于 Git 版本控制，方便开发者协作、分享和展示项目。\n- 在 GitHub 上，你可以：\n  - 托管自己的项目代码，并进行版本管理\n  - 查找和参与全球开源项目\n  - 与他人协作开发（团队项目、开源贡献）\n  - 展示个人作品，提升技术影响力\n\n#### 2. GitHub 账号注册与界面介绍\n\n- [GitHub 注册入口](https://github.com/)\n\n- 不建议直接使用教育邮箱注册\n\n  > 我们学校的教育邮箱是   学号@stu.nchu.edu.cn\n  >\n  > 教育认证可额外绑定教育邮箱，可获取学生认证福利（如 Copilot 免费使用）\n\n- 注册流程：填写邮箱、用户名、密码 → 邮箱验证 → 完善个人资料\n\n##### GitHub 主要界面说明\n- **Repositories（仓库）**：项目代码的存放地，每个仓库包含代码、文档、历史记录等\n- **Issues**：用于提交问题、建议、任务分解，方便项目管理和交流\n- **Pull Requests（PR）**：代码协作的核心，提交代码修改请求，项目维护者审核后合并\n- **Fork**：复制别人的项目到你的账户，方便独立开发或贡献代码\n- **Star**：收藏项目，方便日后查找\n- **Actions**：自动化 CI/CD 工具，帮助自动测试和部署\n\n#### 3. GitHub 教育认证与 Copilot 白嫖流程\n\n- **GitHub Copilot**：AI 智能编程助手，自动补全代码、生成函数/注释，提升开发效率\n- **教育认证步骤**：\n  1. 注册并登录 GitHub 账号\n  2. 访问 [GitHub Education](https://education.github.com/) 页面，点击“Get benefits”或“Apply for Student Developer Pack”\n  3. 根据提示填写教育邮箱、学生身份等信息，提交认证\n  4. 通过后可免费开通 Copilot（[Copilot 激活入口](https://github.com/settings/copilot)）\n\n#### 4. GitHub 基础实战流程\n\n- **远程仓库协作流程**：\n  1. Fork 项目到个人账户\n  2. Clone 仓库到本地\n  3. 新建分支，进行开发\n  4. 提交并推送修改到远程分支\n  5. 发起 Pull Request，等待项目维护者审核合并\n  6. 参与 Issues 讨论，跟进项目进展\n\n- **常见协作场景**：\n  - 团队开发：多人协作同一项目，分工明确，分支合并\n  - 开源贡献：发现项目问题或有新功能建议，可提交 PR 或 Issue\n  - 个人作品：将自己的代码托管公开，展示技术实力\n\n#### 5. GitHub 常用术语补充\n\n- **Commit**：每一次代码提交\n- **Branch**：分支，独立开发环境\n- **Merge**：合并分支\n- **Release**：项目发布版本\n- **Webhook**：自动通知外部服务\n\n---\n\n### Gitee 入门详解\n\n#### 1. Gitee 是什么？\n\n- **Gitee（码云）**：中国主流的代码托管平台，支持 Git 管理，适合国内团队、企业使用。\n- 优势：\n  - 国内访问速度快，无需科学上网\n  - 支持私有仓库免费（适合团队或企业项目）\n  - 与中国开发者生态结合紧密（对接企事业单位、开源中国等）\n\n#### 2. Gitee 账号注册与界面介绍\n\n- [Gitee 注册入口](https://gitee.com/)\n- 支持手机号、邮箱注册\n- 注册流程：填写信息 → 验证 → 完善个人资料\n\n##### Gitee 主要界面说明\n- **项目（Project）**：代码仓库\n- **问题（Issue）**：项目问题追踪与任务管理\n- **合并请求（Pull Request）**：代码协作\n- **收藏、Fork、Watch**：功能与 GitHub 类似\n- **Gitee Pages**：静态网站托管（个人博客/项目文档）\n\n#### 3. Gitee SSH Key 配置与项目协作\n\n- SSH Key 配置流程与 GitHub 类似（见上方）\n- 项目协作流程：\n  1. 创建或 Fork 仓库\n  2. Clone 到本地\n  3. 新建分支开发，提交并推送\n  4. 发起合并请求\n  5. 参与 Issue 讨论\n\n#### 4. Gitee 特色功能\n\n- 支持企业版和团队协作\n- 支持中国主流第三方登录（微信、支付宝等）\n- 支持私有仓库免费，适合企业内部项目管理\n\n---\n\n### 第五部分：GitHub 和 Gitee 的核心功能对比\n\n| 功能         | GitHub              | Gitee                |\n| ------------ | ------------------- | -------------------- |\n| Fork         | 复制项目到个人账户  | 同样支持复制项目     |\n| Star         | 收藏项目            | 同样支持收藏项目     |\n| Watch        | 订阅项目动态        | 支持订阅             |\n| Issues       | 提交问题或建议      | 问题追踪支持更本地化 |\n| Pull Request | 提交代码修改和合并  | 类似功能             |\n| Actions      | 自动化 CI/CD 工作流 | 不支持 Actions       |\n| Pages        | 静态网站托管        | 提供类似功能         |\n| Releases     | 发布稳定版本        | 同样支持发布功能     |\n| Webhooks     | 自动消息通知        | 支持类似功能         |\n\n****\n\n### 总结\n\n- **Git**：本地代码管理和版本控制工具\n- **GitHub**：全球开源协作、作品展示和技术交流平台\n- **Gitee**：国内主流代码托管平台，适合本地团队和企业项目协作\n\n**建议：**\n\n- 日常学习和开源项目优先用 GitHub，参与国际技术社区\n- 团队/企业项目可选用 Gitee，便于国内协作和访问\n- 熟练掌握 Git 命令和 SSH 配置，提升协作效率\n\n****\n\n## Typora 与 Markdown\n\n### Typora 使用教程\n\n#### 安装和激活\n\n- 下载 Typora 安装包，运行后一路点击 OK 即可完成安装。\n- 如果需要激活，将文件夹中的 **winmm.dll** 移动到 Typora 的安装路径下（如 D:\\Program Files\\Typora）。注意此步骤需关闭 Typora 软件，否则会报错。\n\n![image-20251017092741839](/images/Git_Github_Markdown/Git_Github_Markdown_3.png)\n\n---\n\n#### 插件使用\n\n- 推荐安装 [typora_plugin](https://github.com/obgnail/typora_plugin)：可以显著优化 Typora 的使用体验，按官方文档安装即可。\n- 论文工具[typora-latex-theme](https://github.com/Keldos-Li/typora-latex-theme)：对于没有学过office三件套或WPS的同学大有帮助。\n\n---\n\n#### 建议配置\n\n##### 侧边栏设置\n\n- 建议将侧边栏打开，便于查看和管理文档结构。\n- 在 Typora 主界面点击右下角的 `显示/隐藏侧边栏` 按钮即可。\n\n![image-20251017093303047](/images/Git_Github_Markdown/Git_Github_Markdown_4.png)\n\n---\n\n##### 文件配置\n\n- 进入 Typora 菜单栏 `文件 -> 偏好设置`，进行文件相关配置。\n- 推荐按照下图设置，便于文档管理与文件归档。\n\n![image-20251017093318594](/images/Git_Github_Markdown/Git_Github_Markdown_5.png)\n\n---\n\n##### 编辑器配置\n\n- 推荐启用智能缩进、自动补全 Markdown 字符、统一行尾符号等功能，提升编辑效率，减少语法出错。\n\n![image-20251017093327185](/images/Git_Github_Markdown/Git_Github_Markdown_6.png)\n\n---\n\n##### 图片配置\n\n- 插入图片时，建议选择自动复制图片到当前 md 文件同名的 assets 文件夹下，方便文档迁移和分享。  \n- 推荐勾选：  \n  - 自动上传图片到 assets 文件夹\n  - 优化图片路径显示\n  - 生成图片相对路径  \n- 图片插入后，建议压缩图片或生成缩略图，减少文档体积。\n\n---\n\n##### Markdown 配置\n\n我们在这里可以配置markdown的语法相关，我的建议是全部勾上（除了那个首行缩进<这是个人喜好\n\n\\>），一定勾选上那个图表，这样可以让typora对mermaid等图表代码直接进行渲染，下面的公式编号还是看个人情况，这里就不过多说了\n\n- 建议开启 Typora 对 mermaid 图表和数学公式的支持，方便画流程图和写公式。\n- 推荐设置常用语法快捷键，提升编辑效率。\n\n![image-20251017093521861](/images/Git_Github_Markdown/Git_Github_Markdown_8.png)\n\n---\n\n#####  导出配置\n\n- 可根据个人需求设置 PDF 导出参数，包括页面大小、边距等。\n- 支持设置 YAML 头信息（如 title、author），导出时自动识别并加到对应位置。\n\n![image-20251017093617999](/images/Git_Github_Markdown/Git_Github_Markdown_9.png)\n\n---\n\n##### 外观配置\n\n- 推荐使用「经典」模式，字体大小和主题可按个人习惯调整，支持多种主题切换（如 HappySimple、Jetbrains Mono Theme 等）。\n\n![image-20251017093703523](/images/Git_Github_Markdown/Git_Github_Markdown_10.png)\n\n- 主题获取途径：\n  - [Themes Gallery – Typora](https://theme.typora.io/)\n  - GitHub 搜索 typora theme\n\n---\n\n##### 通用配置\n\n![image-20251017093728150](/images/Git_Github_Markdown/Git_Github_Markdown_11.png)\n\n- 建议关闭自动检查更新和开发版更新，稳定性更好。\n- 可自定义快捷键，提升操作效率。\n\n---\n\n#### 主题美化\n\n- 推荐主题：\n  - **Neil Jetbrains Mono Theme**：适合 Jetbrains 系 IDE 用户，字体美观，界面简洁。\n  - **HappySimple**：视觉舒适，适合日常写作和学习。\n\n---\n\n### Markdown 使用教程\n\n#### 一、什么是 Markdown？\n\nMarkdown 是一种轻量级的标记语言，设计用于让普通文本具有丰富的格式表现，同时保留文案内容的易读性和易写性。通过简单直观的标记符号实现文档格式化，广泛应用于技术文档、博客文章、电子邮件、笔记和协作文档等。\n\n---\n\n#### 二、为什么选择 Markdown？\n\n1. **简单直观**：语法易学易用，常见标记符号即可快速上手。\n2. **跨平台支持**：兼容多种工具和平台，如 GitHub、Notion、VS Code、Jupyter Notebook 等。\n3. **多格式输出**：可转为 HTML、PDF、Word 等多种格式，满足不同需求。\n4. **专注创作**：无需复杂排版工具，专注内容本身，提升写作效率。\n\n---\n\n#### 三、Markdown 语法详解\n\n##### 1. 标题\n\n使用 `#` 符号表示标题，支持六级标题，`#` 的数量代表标题级别。\n\n```markdown\n# 一级标题\n## 二级标题\n### 三级标题\n#### 四级标题\n##### 五级标题\n###### 六级标题\n```\n---\n\n##### 2. 段落与换行\n\n普通文本直接书写即可。若需换行，在行尾添加两个空格。\n\n```markdown\n这是一段文字，行尾加两个空格后换行。  \n这是下一行。\n```\n---\n\n##### 3. 强调\n\n支持斜体和加粗，以及两者组合。\n\n```markdown\n*斜体* 或 _斜体_\n**加粗** 或 __加粗__\n***斜体加粗*** 或 ___斜体加粗___\n```\n\n效果：\n- *斜体*\n- **加粗**\n- ***斜体加粗***\n\n---\n\n##### 4. 列表\n\n支持无序列表和有序列表。\n\n###### 无序列表\n\n使用 `-`、`*` 或 `+` 作为标记符。\n\n```markdown\n- 项目一\n- 项目二\n  - 子项目一\n  - 子项目三\n* 项目三\n```\n\n效果：\n- 项目一\n- 项目二\n  - 子项目一\n  - 子项目三\n- 项目三\n\n###### 有序列表\n\n使用数字加点 `1.`，数字顺序可不连续，最终会按顺序渲染。\n\n```markdown\n1. 项目一\n2. 项目二\n   1. 子项目一\n   2. 子项目二\n```\n\n效果：\n1. 项目一\n2. 项目二\n   1. 子项目一\n   2. 子项目二\n\n---\n\n##### 5. 链接\n\n添加超链接：\n\n```markdown\n[链接文字](链接地址)\n[google](https://www.google.com)\n```\n\n带标题提示：\n\n```markdown\n[链接文字](链接地址 \"标题提示\")\n[google](https://www.google.com \"谷歌搜索\")\n```\n\n效果如下：\n[Google](https://www.google.com)\n[Google](https://www.google.com \"谷歌搜索\")\n\n---\n\n##### 6. 图片\n\n添加图片与链接类似，只需在前面加一个 `!`。\n\n```markdown\n![图片描述](图片地址)\n![鹿乃.jpg](https://s2.loli.net/2024/10/27/I1iqvzVtnxEYuaT.jpg)\n```\n\n---\n\n##### 7. 引用\n\n引用使用 `>` 进行标记，支持嵌套引用。\n\n```markdown\n> 这是一个引用。\n>> 这是嵌套引用。\n```\n\n效果：\n> 这是一个引用。\n> > 这是嵌套引用。\n\n---\n\n##### 8. 代码块\n\n###### 行内代码\n\n用反引号（`）包裹。\n\n```markdown\n`这是行内代码` 示例。\n```\n\n效果：`这是行内代码` 示例。\n\n###### 多行代码块\n\n用三个反引号（```）包裹，可指定语言高亮。\n\n```markdown\n``` python\ndef hello():\n    print(\"Hello, Markdown!\")\n```\n```\n\n效果如下：\n\n```python\ndef hello():\n    print(\"Hello, Markdown!\")\n```\n\n---\n\n##### 9. 表格\n\n使用 `|` 和 `-` 创建表格。\n\n```markdown\n| 表头1 | 表头2 | 表头3 |\n|-------|-------|-------|\n| 数据1 | 数据2 | 数据3 |\n| 数据4 | 数据5 | 数据6 |\n```\n\n效果：\n| 表头 1 | 表头 2 | 表头 3 |\n| ----- | ----- | ----- |\n| 数据 1 | 数据 2 | 数据 3 |\n| 数据 4 | 数据 5 | 数据 6 |\n\n---\n\n##### 10. 分隔线\n\n用三个或更多的 `-`、`*` 或 `_` 创建分隔线。\n\n```markdown\n---\n***\n___\n```\n\n#### 效果如下：\n\n****\n\n#### 任务列表\n\n用 `- [ ]` 创建未完成任务，`- [x]` 创建已完成任务。\n\n```markdown\n- [ ] 任务一\n- [x] 任务二\n- [ ] 任务三\n```\n\n效果：\n- [ ] 任务一\n- [x] 任务二\n- [ ] 任务三\n\n---\n\n##### 12. 公式\n\n支持 LaTeX 数学公式（部分编辑器/平台需开启支持）。\n\n```markdown\n$\\frac{a}{b}$\n```\n\n效果：$\\frac{a}{b}$\n\n---\n\n##### 13. mermaid 绘图\n\n支持流程图、时序图等（需平台支持）。\n\n```markdown\ngraph TD\nA[串口中断接收] --> B{中断号判断}\nB -->|USART1 或 USART2| C[堆栈寄存器压入\\n]\nC --> B\n```\n\n---\n\n### Typora 快捷键速查表\n\n| 功能            | 快捷键（Windows）   | 快捷键（Mac）     | 说明                           |\n| --------------- | ------------------- | ----------------- | ------------------------------ |\n| 加粗            | Ctrl + B            | Cmd + B           | 选中内容加粗                   |\n| 斜体            | Ctrl + I            | Cmd + I           | 选中内容斜体                   |\n| 插入标题        | Ctrl + 1 ~ Ctrl + 6 | Cmd + 1 ~ Cmd + 6 | 对应一级至六级标题             |\n| 插入无序列表    | Ctrl + Shift + U    | Cmd + Shift + U   | 快速插入无序列表               |\n| 插入有序列表    | Ctrl + Shift + O    | Cmd + Shift + O   | 快速插入有序列表               |\n| 插入任务列表    | Ctrl + Shift + C    | Cmd + Shift + C   | 插入 `- [ ]` 任务项            |\n| 插入代码块      | Ctrl + Shift + K    | Cmd + Option + K  | 插入三反引号代码块（块级代码） |\n| 插入行内代码    | Ctrl + E            | Cmd + E           | 插入行内代码（单反引号）       |\n| 插入图片        | Ctrl + Shift + I    | Cmd + Shift + I   | 打开插入图片对话框             |\n| 插入链接        | Ctrl + K            | Cmd + K           | 插入超链接                     |\n| 插入引用        | Ctrl + Shift + Q    | Cmd + Shift + Q   | 插入引用 >                     |\n| 插入表格        | Ctrl + T            | Cmd + T           | 打开插入表格面板               |\n| 插入公式        | Ctrl + Shift + M    | Cmd + Shift + M   | 插入公式块（$$）               |\n| 插入Mermaid图   | Ctrl + Shift + G    | Cmd + Shift + G   | 插入mermaid绘图代码块          |\n| 切换专注模式    | F8                  | F8                | 切换专注模式（Focus Mode）     |\n| 打开/关闭侧边栏 | Ctrl + /            | Cmd + /           | 显示或隐藏左侧目录栏           |\n| 查找            | Ctrl + F            | Cmd + F           | 查找文本                       |\n| 替换            | Ctrl + H            | Cmd + Option + F  | 查找并替换文本                 |\n| 保存            | Ctrl + S            | Cmd + S           | 保存文档                       |\n| 导出            | Ctrl + Shift + E    | Cmd + Shift + E   | 导出为PDF、HTML等格式          |\n| 打开偏好设置    | Ctrl + ,            | Cmd + ,           | 打开Typora设置                 |\n| 新建文档        | Ctrl + N            | Cmd + N           | 新建一个空白文档               |\n| 打开文档        | Ctrl + O            | Cmd + O           | 打开本地文档                   |\n| 关闭文档        | Ctrl + W            | Cmd + W           | 关闭当前标签页                 |\n\n> **提示：**  \n> Typora 支持自定义快捷键，部分功能可在 “偏好设置” > “快捷键”中自定义。  \n> 常用操作如插入代码块、插入图片、切换侧边栏等快捷键建议多加练习，提升效率。\n\n\n\n---\n\n## 插件与刷课脚本部分\n\n### 一、浏览器插件简介\n\n#### 1. 什么是浏览器插件？\n\n浏览器插件（扩展）是一种可以为浏览器增加新功能的小型程序。它们能够帮助用户实现自动化、界面美化、广告屏蔽、脚本自定义等功能，极大提升日常上网体验和效率。\n\n---\n\n#### 2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\n\n**油猴（Tampermonkey）** 和 **篡改猴（Violentmonkey）** 都是浏览器端最主流的用户脚本管理器插件，能够让用户轻松安装、管理和运行自定义脚本（如刷课、自动答题、网页优化等）。\n\n|          | 油猴（Tampermonkey）        | 篡改猴（Violentmonkey）    |\n| -------- | --------------------------- | -------------------------- |\n| 兼容性   | Chrome/Edge/Firefox/Safari  | Chrome/Edge/Firefox/Opera  |\n| 界面     | 功能丰富，设置选项更多      | 界面简洁，轻量，易用       |\n| 脚本支持 | 支持几乎所有主流用户脚本    | 支持大部分脚本，兼容性优秀 |\n| 开发者   | 国外团队                    | 国外团队（有国人参与）     |\n| 推荐场景 | 需要高级管理/脚本较多的用户 | 追求简洁/轻量的用户        |\n\n**小结：**\n- 油猴（Tampermonkey）适合大多数用户，功能更全，兼容性最好，推荐新手优先选择。\n- 篡改猴（Violentmonkey）更轻量，界面简洁，资源占用更低。\n\n---\n\n#### 3. 安装方法\n\n**a. Chrome 浏览器：**\n- 推荐前往 [crx搜搜插件网](https://www.crxsoso.com/search) 搜索「Tampermonkey」或「Violentmonkey」并下载安装（国内无需科学上网）。\n\n  > 聚合了 Chrome、Edge、Firefox 各类插件和油猴脚本，国内访问速度快，适合查找各类扩展和脚本。\n\n- 也可去 [Chrome Web Store](https://chrome.google.com/webstore/) 安装（需科学上网）。\n\n**b. Edge 浏览器：**\n- 可在 Edge 插件商店或 crx搜搜 搜索并安装。\n\n**c. Firefox 浏览器：**\n- 前往 [Firefox 附加组件](https://addons.mozilla.org/) 搜索并安装。\n\n---\n\n### OCS网课助手与刷课脚本\n\n#### OCS网课助手简介\n\nOCS网课助手是一款专为网课平台（如超星、智慧树、学堂在线等）开发的刷课插件，能实现自动播放、刷视频、自动答题等功能，大大提高网课学习效率。适合需要快速完成网课任务的同学。\n\n- **官网/项目主页**：[OCS网课助手](https://docs.ocsjs.com/)\n- **主要功能**：\n  - 自动刷视频、自动答题、自动过考试\n  - 支持多个主流网课平台\n  - 可配合题库使用（如教材/言溪题库等）\n\n#### 言溪题库简介\n\n- **官网主页**：[言溪题库](https://tk.enncy.cn/)\n\n- 提供超星、智慧树等平台的题目答案，可提升刷课和自动答题的正确率。\n- 常见用法：在 OCS 等刷课插件设置里绑定题库接口，或手动查找题目答案。\n\n#### WE Learn & U校园刷课脚本与教程\n\n- **EOC 一站式刷课脚本合集**：[EOC项目主页](https://ssmjae.github.io/EOC/)\n  - 该网站提供了针对多种主流校园网课平台（如 WE Learn、U校园等）的刷课脚本及详细教程。\n  - 主要功能包括：\n    - 自动刷视频、自动答题、自动完成作业、考试辅助等\n    - 支持多平台、多类型课程的自动化处理\n    - 提供详细的安装流程、脚本下载链接、常见问题解答\n  - 网站内容持续更新，适合自助查找和学习刷课自动化工具\n\n**使用建议：**\n- 进入 EOC 项目主页后，根据你的网课平台（如 WE Learn、U校园）选择对应脚本和教程，按照页面说明进行安装和使用。\n- 建议优先使用油猴（Tampermonkey）或篡改猴（Violentmonkey）插件进行脚本管理，确保兼容性和脚本运行稳定。\n- 脚本仅供学习和便捷课程管理使用，切勿用于违规用途。\n\n---\n\n**实用建议：**\n\n- 插件和脚本建议只从知名平台和官方渠道下载，避免安全风险。\n- 使用脚本前请详细阅读说明，注意账号安全，不要泄露个人信息。\n- 刷课脚本仅供学习交流，勿用于违规用途。\n\n","slug":"Git_Github_Markdown","published":1,"updated":"2026-01-15T15:29:30.178Z","comments":1,"layout":"post","photos":[],"_id":"cmkh5iivq000g24j3ck1bcu8q","content":"<h1 id=\"Git-GitHub-Markdown-刷课\"><a href=\"#Git-GitHub-Markdown-刷课\" class=\"headerlink\" title=\"Git &amp; GitHub &amp; Markdown &amp;刷课\"></a>Git &amp; GitHub &amp; Markdown &amp;刷课</h1><h2 id=\"环境准备\"><a href=\"#环境准备\" class=\"headerlink\" title=\"环境准备\"></a><strong>环境准备</strong></h2><h3 id=\"Chrome-浏览器下载\"><a href=\"#Chrome-浏览器下载\" class=\"headerlink\" title=\"Chrome 浏览器下载\"></a>Chrome 浏览器下载</h3><p><strong>推荐使用国内 Cent Browser：</strong></p>\n<ul>\n<li><p><a href=\"https://www.centbrowser.cn/\">官方下载地址(官网)</a></p>\n</li>\n<li><p>继承谷歌内核稳定流畅的优点同时，与 Chrome 基本操作界面别无二致, 并加入其他常用功能</p>\n</li>\n</ul>\n<p><strong>推荐使用谷歌 Chrome 浏览器：</strong></p>\n<ul>\n<li><a href=\"https://www.google.com/chrome/\">官方下载地址（需科学上网）</a></li>\n<li>或搜索“Chrome 浏览器下载国内镜像”获取国内最新可用链接。</li>\n</ul>\n<h3 id=\"VPN-与机场\"><a href=\"#VPN-与机场\" class=\"headerlink\" title=\"VPN 与机场\"></a>VPN 与机场</h3><h4 id=\"VPN-是什么？机场是什么？\"><a href=\"#VPN-是什么？机场是什么？\" class=\"headerlink\" title=\"VPN 是什么？机场是什么？\"></a>VPN 是什么？机场是什么？</h4><ul>\n<li><strong>VPN</strong>：虚拟专用网络，最初是企业、学校等用于远程安全访问内部资源。后来大家习惯把“翻墙”工具称为 VPN，但实际上 VPN 协议并不专属于翻墙，比如 WireGuard、OpenVPN 等真正网络层的 VPN 协议。</li>\n<li><strong>机场</strong>：是专门提供“科学上网”服务的平台。机场主租用大量 VPS（国外服务器），搭建 SS、SSR、Vmess、Trojan 等代理协议节点，用户买流量后通过代理软件（如 Clash、小火箭等）连接机场获得自由访问外网的能力。</li>\n<li><strong>区别与关系</strong>：VPN 是网络层代理，机场多用应用层&#x2F;会话层代理。大多数商业 VPN 广告多且贵，体验和性价比远不如机场。</li>\n</ul>\n<h4 id=\"为什么叫“机场”？\"><a href=\"#为什么叫“机场”？\" class=\"headerlink\" title=\"为什么叫“机场”？\"></a>为什么叫“机场”？</h4><p>因为最早的代理工具 Shadowsocks 图标是一架小飞机，大家就把这种代理服务叫做“机场”。</p>\n<p>机场并不是一个单一的服务器或网站，而是由许多分布在国内外的节点组成，具备分布式、多协议、动态更新和多种抗干扰技术，能灵活应对各种封锁与干扰。即使部分节点被墙，用户只需刷新订阅或等待机场主修复即可继续使用。</p>\n<p>下面分几条简要解释：</p>\n<ol>\n<li><strong>多节点分散部署</strong><br>机场通常在国内外部署了很多服务器（节点），即使部分节点被墙封锁，其他节点仍可正常工作，不会导致整个机场服务瘫痪。</li>\n<li><strong>协议混淆与加密</strong><br>机场使用的代理协议（如 SS、Trojan、Vmess 等）都具备流量加密和混淆能力，能有效隐藏翻墙行为，使防火墙难以精准识别和封锁。</li>\n<li><strong>动态更换节点和订阅</strong><br>机场可以随时更换服务器 IP、端口、协议等参数，用户通过订阅链接自动获取最新节点信息，及时绕开已被封锁的节点。</li>\n<li><strong>中转与专线技术</strong><br>很多机场采用“国内中转”、“隧道”、“专线”等技术，使流量出境路线更加隐蔽和多样化，提高抗封锁能力。</li>\n<li><strong>高防与灾备机制</strong><br>优质机场会购买高防护服务器、备用线路、CDN 加速等服务，即使遭遇攻击或封锁，也能迅速切换恢复服务。</li>\n</ol>\n<h4 id=\"协议科普\"><a href=\"#协议科普\" class=\"headerlink\" title=\"协议科普\"></a>协议科普</h4><ul>\n<li><strong>SS&#x2F;SSR</strong>：Shadowsocks 及其分支 SSR，轻量级加密代理，速度快，兼容性好。</li>\n<li><strong>Vmess&#x2F;VLESS</strong>：V2Ray 框架的协议，功能丰富，支持多种混淆和传输方式。</li>\n<li><strong>Trojan</strong>：基于 HTTPS，伪装成正常网页流量，抗封锁能力强。</li>\n<li><strong>Hy2&#x2F;Reality&#x2F;Tuic</strong>：新一代协议，多用于自建直连，机场较少支持，安全性更高。</li>\n<li><strong>传统 VPN 协议</strong>：如 PPTP、L2TP&#x2F;IPSec、OpenVPN、WireGuard 等，主要用于网络层代理，穿透性和安全性各有不同。</li>\n</ul>\n<h4 id=\"机场线路名词解释\"><a href=\"#机场线路名词解释\" class=\"headerlink\" title=\"机场线路名词解释\"></a>机场线路名词解释</h4><ul>\n<li><strong>规则</strong>：只有国外网站走代理，节省流量</li>\n<li><strong>全局</strong>：所有流量都走代理</li>\n<li><strong>直连</strong>：用户设备直接连境外代理服务器，速度受限、极易被墙。</li>\n<li><strong>中转</strong>：流量先到国内中转服务器，再转发到境外代理服务器。可以优化速度和稳定性，降低被墙风险。</li>\n<li><strong>隧道</strong>：国内服务器入口+境外服务器（如香港 CMI），流量经过 TLS 加密再转发，更安全。</li>\n<li><strong>专线（IEPL&#x2F;IPLC）</strong>：点对点物理线路，低延迟，不经过公网，最稳定但成本高，机场多用 IEPL。</li>\n<li><strong>BGP</strong>：边界网关协议，优化多运营商之间的互联访问速度和稳定性。</li>\n<li><strong>前置</strong>：中转入口前再加一台国内机器，抗通报&#x2F;墙封。</li>\n<li><strong>转发</strong>：多个机场共享中转资源，速度和稳定性差，常见于小机场。</li>\n<li><strong>流量倍率</strong>：部分机场设置倍率，如 2 倍率表示实际消耗 2 倍流量。</li>\n<li><strong>系统代理</strong>：大多数应用（如浏览器）自动走代理，部分软件需手动设置</li>\n<li><strong>TUN 模式&#x2F;虚拟网卡</strong>：创建虚拟网卡，实现真正全局代理，解决部分应用不走代理的问题</li>\n<li><strong>自动选择&#x2F;故障转移：</strong> 自动选择延迟最低节点，但可能频繁切换 IP，容易被某些网站风控</li>\n</ul>\n<h4 id=\"线路体验优先级\"><a href=\"#线路体验优先级\" class=\"headerlink\" title=\"线路体验优先级\"></a>线路体验优先级</h4><p>同样带宽下，体验优先级：  </p>\n<p><strong>IEPL 专线中转 &gt; 隧道中转 &gt; 公网中转（如广东移动&#x2F;湖南联通） &gt; 直连</strong></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_1.png\" alt=\"image-20251016175400498\"></p>\n<h5 id=\"1-直连机场\"><a href=\"#1-直连机场\" class=\"headerlink\" title=\"1. 直连机场\"></a>1. 直连机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内防火墙&#x2F;QoS 限速 → 直接连接境外 VPS&#x2F;服务器 → 国际互联网</li>\n<li><strong>特点</strong>：没有经过国内中转节点，直接出海。速度受限、易被墙，体验和稳定性都较差，适合流量小、只偶尔使用者。</li>\n</ul>\n<h5 id=\"2-普通中转机场\"><a href=\"#2-普通中转机场\" class=\"headerlink\" title=\"2. 普通中转机场\"></a>2. 普通中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内中转 VPS → 境内防火墙&#x2F;QoS 限速 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：增加了一个国内中转节点，优化了出海速度和稳定性。成本较低，但中转节点易受干扰，遇到高峰期或被墙会影响体验。</li>\n</ul>\n<h5 id=\"3-BGP-中转机场\"><a href=\"#3-BGP-中转机场\" class=\"headerlink\" title=\"3. BGP 中转机场\"></a>3. BGP 中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → BGP 中转服务器（多线接入、跨运营商优化） → 境内防火墙&#x2F;QoS 限速 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：BGP 中转节点支持多运营商线路，自动选择最优路径，提升了全国范围的访问速度和稳定性。更适合多地区用户，成本比普通中转高。</li>\n</ul>\n<h5 id=\"4-IPLC-中转机场\"><a href=\"#4-IPLC-中转机场\" class=\"headerlink\" title=\"4. IPLC 中转机场\"></a>4. IPLC 中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内中转 VPS → IPLC 专线传输 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：IPLC（国际专线）是物理专用通道，数据从境内直接通过专线传到境外，几乎不经过防火墙和公网，速度、稳定性和安全性最高，但价格也最贵。适合对速度和稳定性要求极高的用户或企业。</li>\n</ul>\n<hr>\n<h4 id=\"推荐客户端工具\"><a href=\"#推荐客户端工具\" class=\"headerlink\" title=\"推荐客户端工具\"></a>推荐客户端工具</h4><ul>\n<li><strong>Windows&#x2F;Mac&#x2F;Android</strong>：首选 Clash 系列（Clash for Windows、Clash Verge、Clash Meta、Flclash、Clash Party、Sparkle 等）</li>\n<li><strong>iOS</strong>：首选小火箭（Shadowrocket，付费）。</li>\n</ul>\n<h4 id=\"客户端使用流程简述\"><a href=\"#客户端使用流程简述\" class=\"headerlink\" title=\"客户端使用流程简述\"></a>客户端使用流程简述</h4><ol>\n<li>下载并安装客户端软件</li>\n<li>在机场后台获取订阅链接（通常一键复制）</li>\n<li>导入到客户端</li>\n<li>打开系统代理或虚拟网卡（TUN 模式），实现全局或分流科学上网</li>\n<li>常见问题：分流规则设置、系统代理&#x2F;TUN 模式选择、节点测速与切换</li>\n</ol>\n<hr>\n<h4 id=\"机场购买与使用流程\"><a href=\"#机场购买与使用流程\" class=\"headerlink\" title=\"机场购买与使用流程\"></a>机场购买与使用流程</h4><h4 id=\"如何购买机场\"><a href=\"#如何购买机场\" class=\"headerlink\" title=\"如何购买机场\"></a>如何购买机场</h4><ul>\n<li>注册账号（推荐 Gmail&#x2F;Outlook 邮箱，不建议 QQ 邮箱，避免实名风险）</li>\n<li>选择套餐，付款（部分机场支持试用套餐）</li>\n<li>获取订阅链接，导入代理软件</li>\n<li>按照机场提供的小白教程操作，几乎所有机场都有详细的使用说明</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_2.webp\" alt=\"三色图\"></p>\n<h4 id=\"小白教程\"><a href=\"#小白教程\" class=\"headerlink\" title=\"小白教程\"></a>小白教程</h4><p>最小白的教程，适合第一次买机场的，</p>\n<p>先注册，注意的点是验证码邮件可能会在邮箱垃圾箱里面。<br>如果有试用先试用，没试用就去购买套餐。</p>\n<p>1）我们以随便某个 v2board 机场为例子，因为现在很多机场都是用的 v2board 页面。<br><strong>第一步：购买套餐：点击购买订阅–选择你想要的套餐–付款</strong><br>[<img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_12.webp\" alt=\"购买订阅\"><br><a href=\"/images/Git_Github_Markdown/Git_Github_Markdown_13.webp\">![]</a></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_13.webp\" alt=\"选择套餐\"></p>\n<p><strong>第二步：下载代理软件</strong>，这里以 Clash for windows 为例子</p>\n<p><strong>第三步：导入订阅：回到仪表盘–点击一键订阅–导入到你的 Clash 客户端中</strong></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_14.webp\" alt=\"仪表盘\"></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_15.webp\" alt=\"导入订阅\"></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_16.webp\" alt=\"导入订阅后\"></p>\n<p>具体详细操场教程可以参考各个机场的使用教程，每个机场基本都有小白教程的。</p>\n<h4 id=\"节点和订阅相关问题\"><a href=\"#节点和订阅相关问题\" class=\"headerlink\" title=\"节点和订阅相关问题\"></a>节点和订阅相关问题</h4><ul>\n<li>节点不能用时，先检查流量套餐是否到期或用尽，再刷新订阅或重新复制订阅链接</li>\n<li>校园网或公司网可能封端口或 DNS 异常，影响机场使用</li>\n<li>机场官网和订阅地址常变，因 GFW 污染 DNS，老牌机场处理经验更丰富</li>\n</ul>\n<hr>\n<h4 id=\"线路技术与常见问题详解\"><a href=\"#线路技术与常见问题详解\" class=\"headerlink\" title=\"线路技术与常见问题详解\"></a>线路技术与常见问题详解</h4><h5 id=\"机场官网慢-打不开？\"><a href=\"#机场官网慢-打不开？\" class=\"headerlink\" title=\"机场官网慢&#x2F;打不开？\"></a>机场官网慢&#x2F;打不开？</h5><ul>\n<li>多数机场官网套了 Cloudflare CDN，隐藏真实 IP，防止被墙，访问速度慢需要科学上网</li>\n</ul>\n<h5 id=\"为什么有些机场便宜？\"><a href=\"#为什么有些机场便宜？\" class=\"headerlink\" title=\"为什么有些机场便宜？\"></a>为什么有些机场便宜？</h5><ul>\n<li>便宜线路（如月抛）、多人共享、直连节点、不买中转、割韭菜跑路风险高</li>\n</ul>\n<h5 id=\"为什么流量消耗快？\"><a href=\"#为什么流量消耗快？\" class=\"headerlink\" title=\"为什么流量消耗快？\"></a>为什么流量消耗快？</h5><ul>\n<li>流量倍率设置、自动选择高倍率节点、系统更新等走代理流量</li>\n</ul>\n<h5 id=\"为什么机场界面都很像？\"><a href=\"#为什么机场界面都很像？\" class=\"headerlink\" title=\"为什么机场界面都很像？\"></a>为什么机场界面都很像？</h5><ul>\n<li>大多数机场用开源面板（V2board、SSpanel），前端界面相似是正常现象</li>\n</ul>\n<h5 id=\"为什么延迟测试异常？\"><a href=\"#为什么延迟测试异常？\" class=\"headerlink\" title=\"为什么延迟测试异常？\"></a>为什么延迟测试异常？</h5><ul>\n<li>部分机场劫持延迟测试，仅到中转入口（非真实国际延迟），可更换延迟测试 URL 验证</li>\n</ul>\n<h5 id=\"机场能否打游戏？\"><a href=\"#机场能否打游戏？\" class=\"headerlink\" title=\"机场能否打游戏？\"></a>机场能否打游戏？</h5><ul>\n<li>不推荐机场打游戏，延迟高、UDP 支持差，建议用专业游戏加速器（如 UU 加速器）。部分机场有专线游戏节点，但不保证稳定</li>\n</ul>\n<hr>\n<h4 id=\"机场安全性与合规问题\"><a href=\"#机场安全性与合规问题\" class=\"headerlink\" title=\"机场安全性与合规问题\"></a>机场安全性与合规问题</h4><h4 id=\"翻墙是安全吗？\"><a href=\"#翻墙是安全吗？\" class=\"headerlink\" title=\"翻墙是安全吗？\"></a>翻墙是安全吗？</h4><ul>\n<li>你猜</li>\n<li>低调，不要键政，不要绑定实名信息</li>\n<li>机场主肉身墙外更安全，选老牌大机场，月付为佳</li>\n<li>被抓多因机场主肉身墙内、高调、实名收款、境内推广</li>\n</ul>\n<h4 id=\"机场跑路怎么办？\"><a href=\"#机场跑路怎么办？\" class=\"headerlink\" title=\"机场跑路怎么办？\"></a>机场跑路怎么办？</h4><ul>\n<li>灰色产业，跑路风险高，优先选择老牌、肉身墙外的机场主，推荐月付。跑路后只能更换机场</li>\n</ul>\n<h4 id=\"白嫖机场安全吗？\"><a href=\"#白嫖机场安全吗？\" class=\"headerlink\" title=\"白嫖机场安全吗？\"></a>白嫖机场安全吗？</h4><ul>\n<li>免费机场体验差或安全风险高，仅试用阶段可考虑，长期建议付费正规机场</li>\n</ul>\n<hr>\n<h2 id=\"Git-与-GitHub\"><a href=\"#Git-与-GitHub\" class=\"headerlink\" title=\"Git 与 GitHub\"></a>Git 与 GitHub</h2><ul>\n<li><strong>Git</strong>：核心工具，记录代码修改历史，创建分支，合并分支等。</li>\n<li><strong>GitHub&#x2F;Gitee</strong>：代码托管平台，方便协作、展示作品、参与开源项目。、</li>\n</ul>\n<ol>\n<li>Git 版本控制基础<ul>\n<li>安装与配置（Windows&#x2F;Mac&#x2F;Linux）</li>\n<li>常用命令演示</li>\n</ul>\n</li>\n<li>GitHub 账号注册与界面介绍<ul>\n<li>教育邮箱注册技巧</li>\n<li>仓库、Issue、PR 等基本功能</li>\n</ul>\n</li>\n<li>GitHub 教育认证与 Copilot 白嫖流程<ul>\n<li>Copilot 是什么</li>\n<li>认证与激活详细步骤</li>\n</ul>\n</li>\n<li>基础实战：远程仓库协作、Fork、PR 操作演示</li>\n</ol>\n<h3 id=\"Git-是什么\"><a href=\"#Git-是什么\" class=\"headerlink\" title=\"Git 是什么\"></a>Git 是什么</h3><p><strong>Git 就像一本“时光机日记本”📖</strong>  </p>\n<p>每段代码的改动，Git 都会帮你记录下来，随时可以“穿越回过去”查找任何时间点的代码状态。</p>\n<ul>\n<li><strong>主要特点：</strong><ol>\n<li><strong>版本控制</strong>：每次提交都像写新日记，保存开发成果。</li>\n<li><strong>分支管理</strong>：分支如同章节，可以并行开发互不干扰。</li>\n<li><strong>分布式</strong>：每个人都有完整的“时光机日记本”，即使没有网络也能工作。</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h3 id=\"Git-与-GitHub-SSH-Key-配置与使用\"><a href=\"#Git-与-GitHub-SSH-Key-配置与使用\" class=\"headerlink\" title=\"Git 与 GitHub SSH Key 配置与使用\"></a>Git 与 GitHub SSH Key 配置与使用</h3><h4 id=\"1-配置个人信息\"><a href=\"#1-配置个人信息\" class=\"headerlink\" title=\"1. 配置个人信息\"></a>1. 配置个人信息</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">&quot;你的名字&quot;</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">&quot;你的邮箱&quot;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>设置后每次提交都会自动带上你的署名。</li>\n</ul>\n<h4 id=\"2-生成-SSH-密钥\"><a href=\"#2-生成-SSH-密钥\" class=\"headerlink\" title=\"2. 生成 SSH 密钥\"></a>2. 生成 SSH 密钥</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -b 4096 -C <span class=\"string\">&quot;你的邮箱@example.com&quot;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>-t rsa ：使 ⽤ RSA 算法 ⽣ 成密钥。</li>\n<li>一路回车即可，密钥默认保存在 <code>~/.ssh/</code> 目录。</li>\n</ul>\n<h4 id=\"3-查看并复制公钥内容\"><a href=\"#3-查看并复制公钥内容\" class=\"headerlink\" title=\"3. 查看并复制公钥内容\"></a>3. 查看并复制公钥内容</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<ul>\n<li>复制输出的内容（全部内容）。</li>\n</ul>\n<h4 id=\"4-添加公钥到远程仓库\"><a href=\"#4-添加公钥到远程仓库\" class=\"headerlink\" title=\"4. 添加公钥到远程仓库\"></a>4. 添加公钥到远程仓库</h4><ul>\n<li><strong>GitHub</strong>：Settings &gt; SSH and GPG keys &gt; New SSH key，粘贴公钥并保存。</li>\n<li><strong>Gitee</strong>：设置 &gt; 安全设置 &gt; SSH 密钥，粘贴公钥并保存。</li>\n</ul>\n<h4 id=\"5-测试连接\"><a href=\"#5-测试连接\" class=\"headerlink\" title=\"5. 测试连接\"></a>5. 测试连接</h4><ul>\n<li><p>GitHub：<code>ssh -T git@github.com</code></p>\n</li>\n<li><p>Gitee：<code>ssh -T git@gitee.com</code></p>\n</li>\n<li><p>第一次会提示“Are you sure you want to continue connecting”，输入 yes</p>\n</li>\n<li><p>若看到 <code>Hi 用户名! You&#39;ve successfully authenticated...</code> 表示成功！</p>\n</li>\n</ul>\n<h4 id=\"6-多平台-多账户密钥配置（进阶）\"><a href=\"#6-多平台-多账户密钥配置（进阶）\" class=\"headerlink\" title=\"6. 多平台&#x2F;多账户密钥配置（进阶）\"></a>6. 多平台&#x2F;多账户密钥配置（进阶）</h4><ul>\n<li>多台电脑、多个平台可分别生成密钥并添加到账户。</li>\n<li>如需配置多个密钥，在 <code>~/.ssh/config</code> 文件中添加：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host github.com</span><br><span class=\"line\">  HostName github.com</span><br><span class=\"line\">  User git</span><br><span class=\"line\">  IdentityFile ~/.ssh/id_rsa</span><br><span class=\"line\"></span><br><span class=\"line\">Host gitee.com</span><br><span class=\"line\">  HostName gitee.com</span><br><span class=\"line\">  User git</span><br><span class=\"line\">  IdentityFile ~/.ssh/id_rsa_gitee</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Git-命令\"><a href=\"#Git-命令\" class=\"headerlink\" title=\"Git 命令\"></a>Git 命令</h3><h4 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 初始化仓库（只需一次）</span></span><br><span class=\"line\">git init</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 克隆远程仓库到本地</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> &lt;仓库地址&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看当前状态</span></span><br><span class=\"line\">git status</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看历史提交记录</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"文件操作\"><a href=\"#文件操作\" class=\"headerlink\" title=\"文件操作\"></a>文件操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 添加所有更改到暂存区</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加指定文件到暂存区</span></span><br><span class=\"line\">git add 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从暂存区移除文件</span></span><br><span class=\"line\">git reset 文件名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"提交-保存更改\"><a href=\"#提交-保存更改\" class=\"headerlink\" title=\"提交&#x2F;保存更改\"></a>提交&#x2F;保存更改</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 提交到本地仓库</span></span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;提交说明&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"与远程仓库交互\"><a href=\"#与远程仓库交互\" class=\"headerlink\" title=\"与远程仓库交互\"></a>与远程仓库交互</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关联远程仓库（只需一次）</span></span><br><span class=\"line\">git remote add origin &lt;仓库地址&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到远程仓库</span></span><br><span class=\"line\">git push</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到远程指定分支（第一次推送用）</span></span><br><span class=\"line\">git push -u origin main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从远程仓库拉取最新内容</span></span><br><span class=\"line\">git pull</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"分支管理\"><a href=\"#分支管理\" class=\"headerlink\" title=\"分支管理\"></a>分支管理</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看所有分支</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建新分支</span></span><br><span class=\"line\">git branch 新分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 切换分支</span></span><br><span class=\"line\">git checkout 分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建并切换到新分支</span></span><br><span class=\"line\">git checkout -b 新分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除本地分支</span></span><br><span class=\"line\">git branch -d 分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看远程分支</span></span><br><span class=\"line\">git branch -r</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拉取远程分支并创建本地分支</span></span><br><span class=\"line\">git checkout -b 本地分支名 origin/远程分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除远程分支</span></span><br><span class=\"line\">git push origin --delete 分支名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"撤销与恢复\"><a href=\"#撤销与恢复\" class=\"headerlink\" title=\"撤销与恢复\"></a>撤销与恢复</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 撤销工作区的修改（让文件恢复到上一次commit的状态）</span></span><br><span class=\"line\">git checkout -- 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 撤销暂存区的修改（把已add的文件撤回到工作区）</span></span><br><span class=\"line\">git reset HEAD 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 撤销最近一次commit但保留修改（回退到上一次commit，修改内容还在）</span></span><br><span class=\"line\">git reset --soft HEAD^</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 丢弃最近一次commit和修改（慎用，修改会丢失）</span></span><br><span class=\"line\">git reset --hard HEAD^</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 恢复被删除的文件（找回误删的文件）</span></span><br><span class=\"line\">git checkout HEAD -- 文件名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看与对比\"><a href=\"#查看与对比\" class=\"headerlink\" title=\"查看与对比\"></a>查看与对比</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看本地和远程分支对应关系</span></span><br><span class=\"line\">git branch -vv</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看远程地址</span></span><br><span class=\"line\">git remote -v</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看某个文件的修改内容</span></span><br><span class=\"line\">git diff 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看暂存区和上一次commit的区别</span></span><br><span class=\"line\">git diff --cached</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看某个文件的历史修改记录</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span> 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 对比本地分支与远程分支的差异</span></span><br><span class=\"line\">git diff main origin/main</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"标签（Tag）\"><a href=\"#标签（Tag）\" class=\"headerlink\" title=\"标签（Tag）\"></a>标签（Tag）</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 打标签</span></span><br><span class=\"line\">git tag v1.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送标签到远程</span></span><br><span class=\"line\">git push origin v1.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有标签</span></span><br><span class=\"line\">git tag</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"合并与冲突\"><a href=\"#合并与冲突\" class=\"headerlink\" title=\"合并与冲突\"></a>合并与冲突</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 合并分支</span></span><br><span class=\"line\">git merge 另一个分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 解决冲突后，添加并提交</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;fix conflict&quot;</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<blockquote>\n<p><strong>提示：</strong></p>\n<ul>\n<li>不会的命令可以用 <code>git help 命令名</code> 查看帮助。</li>\n<li>日常开发建议多用 <code>git status</code> 和 <code>git log</code> 观察当前状态。</li>\n<li>日常开发推荐分支模型，每个功能新建分支，开发完成合并主线</li>\n</ul>\n</blockquote>\n<hr>\n<h3 id=\"Git-常用命令速查表\"><a href=\"#Git-常用命令速查表\" class=\"headerlink\" title=\"Git 常用命令速查表\"></a>Git 常用命令速查表</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>命令</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>配置用户名和邮箱</td>\n<td><code>git config --global user.name &quot;你的名字&quot;</code> <br> <code>git config --global user.email &quot;你的邮箱&quot;</code></td>\n<td>设置“署名”，每次提交都标记贡献者</td>\n</tr>\n<tr>\n<td>初始化仓库</td>\n<td><code>git init</code></td>\n<td>新建“时光机日记本”，准备记录代码版本</td>\n</tr>\n<tr>\n<td>添加文件到暂存区</td>\n<td><code>git add 文件名</code> 或 <code>git add .</code></td>\n<td>把修改内容放到“草稿区”</td>\n</tr>\n<tr>\n<td>提交到本地仓库</td>\n<td><code>git commit -m &quot;提交说明&quot;</code></td>\n<td>草稿正式进入日记本，并附说明</td>\n</tr>\n<tr>\n<td>推送到远程仓库</td>\n<td><code>git push origin 分支名</code></td>\n<td>把本地代码同步到远程仓库</td>\n</tr>\n<tr>\n<td>克隆远程仓库</td>\n<td><code>git clone 仓库地址</code></td>\n<td>下载别人的代码到本地</td>\n</tr>\n<tr>\n<td>查看状态</td>\n<td><code>git status</code></td>\n<td>检查当前代码变化情况</td>\n</tr>\n<tr>\n<td>查看提交历史</td>\n<td><code>git log</code></td>\n<td>查看代码记录，回顾“时间线”</td>\n</tr>\n<tr>\n<td>创建分支</td>\n<td><code>git branch 分支名</code></td>\n<td>新功能独立章节</td>\n</tr>\n<tr>\n<td>切换分支</td>\n<td><code>git checkout 分支名</code></td>\n<td>从一个章节切换到另一个章节</td>\n</tr>\n<tr>\n<td>合并分支</td>\n<td><code>git merge 分支名</code></td>\n<td>不同章节内容合并到主线</td>\n</tr>\n<tr>\n<td>拉取远程代码</td>\n<td><code>git pull origin 分支名</code></td>\n<td>从远程仓库获取最新代码</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"GitHub-入门详解\"><a href=\"#GitHub-入门详解\" class=\"headerlink\" title=\"GitHub 入门详解\"></a>GitHub 入门详解</h3><h4 id=\"1-GitHub-是什么？\"><a href=\"#1-GitHub-是什么？\" class=\"headerlink\" title=\"1. GitHub 是什么？\"></a>1. GitHub 是什么？</h4><ul>\n<li><strong>GitHub</strong> 是全球最大的开源代码托管平台，基于 Git 版本控制，方便开发者协作、分享和展示项目。</li>\n<li>在 GitHub 上，你可以：<ul>\n<li>托管自己的项目代码，并进行版本管理</li>\n<li>查找和参与全球开源项目</li>\n<li>与他人协作开发（团队项目、开源贡献）</li>\n<li>展示个人作品，提升技术影响力</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-GitHub-账号注册与界面介绍\"><a href=\"#2-GitHub-账号注册与界面介绍\" class=\"headerlink\" title=\"2. GitHub 账号注册与界面介绍\"></a>2. GitHub 账号注册与界面介绍</h4><ul>\n<li><p><a href=\"https://github.com/\">GitHub 注册入口</a></p>\n</li>\n<li><p>不建议直接使用教育邮箱注册</p>\n<blockquote>\n<p>我们学校的教育邮箱是   学号@stu.nchu.edu.cn</p>\n<p>教育认证可额外绑定教育邮箱，可获取学生认证福利（如 Copilot 免费使用）</p>\n</blockquote>\n</li>\n<li><p>注册流程：填写邮箱、用户名、密码 → 邮箱验证 → 完善个人资料</p>\n</li>\n</ul>\n<h5 id=\"GitHub-主要界面说明\"><a href=\"#GitHub-主要界面说明\" class=\"headerlink\" title=\"GitHub 主要界面说明\"></a>GitHub 主要界面说明</h5><ul>\n<li><strong>Repositories（仓库）</strong>：项目代码的存放地，每个仓库包含代码、文档、历史记录等</li>\n<li><strong>Issues</strong>：用于提交问题、建议、任务分解，方便项目管理和交流</li>\n<li><strong>Pull Requests（PR）</strong>：代码协作的核心，提交代码修改请求，项目维护者审核后合并</li>\n<li><strong>Fork</strong>：复制别人的项目到你的账户，方便独立开发或贡献代码</li>\n<li><strong>Star</strong>：收藏项目，方便日后查找</li>\n<li><strong>Actions</strong>：自动化 CI&#x2F;CD 工具，帮助自动测试和部署</li>\n</ul>\n<h4 id=\"3-GitHub-教育认证与-Copilot-白嫖流程\"><a href=\"#3-GitHub-教育认证与-Copilot-白嫖流程\" class=\"headerlink\" title=\"3. GitHub 教育认证与 Copilot 白嫖流程\"></a>3. GitHub 教育认证与 Copilot 白嫖流程</h4><ul>\n<li><strong>GitHub Copilot</strong>：AI 智能编程助手，自动补全代码、生成函数&#x2F;注释，提升开发效率</li>\n<li><strong>教育认证步骤</strong>：<ol>\n<li>注册并登录 GitHub 账号</li>\n<li>访问 <a href=\"https://education.github.com/\">GitHub Education</a> 页面，点击“Get benefits”或“Apply for Student Developer Pack”</li>\n<li>根据提示填写教育邮箱、学生身份等信息，提交认证</li>\n<li>通过后可免费开通 Copilot（<a href=\"https://github.com/settings/copilot\">Copilot 激活入口</a>）</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"4-GitHub-基础实战流程\"><a href=\"#4-GitHub-基础实战流程\" class=\"headerlink\" title=\"4. GitHub 基础实战流程\"></a>4. GitHub 基础实战流程</h4><ul>\n<li><p><strong>远程仓库协作流程</strong>：</p>\n<ol>\n<li>Fork 项目到个人账户</li>\n<li>Clone 仓库到本地</li>\n<li>新建分支，进行开发</li>\n<li>提交并推送修改到远程分支</li>\n<li>发起 Pull Request，等待项目维护者审核合并</li>\n<li>参与 Issues 讨论，跟进项目进展</li>\n</ol>\n</li>\n<li><p><strong>常见协作场景</strong>：</p>\n<ul>\n<li>团队开发：多人协作同一项目，分工明确，分支合并</li>\n<li>开源贡献：发现项目问题或有新功能建议，可提交 PR 或 Issue</li>\n<li>个人作品：将自己的代码托管公开，展示技术实力</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"5-GitHub-常用术语补充\"><a href=\"#5-GitHub-常用术语补充\" class=\"headerlink\" title=\"5. GitHub 常用术语补充\"></a>5. GitHub 常用术语补充</h4><ul>\n<li><strong>Commit</strong>：每一次代码提交</li>\n<li><strong>Branch</strong>：分支，独立开发环境</li>\n<li><strong>Merge</strong>：合并分支</li>\n<li><strong>Release</strong>：项目发布版本</li>\n<li><strong>Webhook</strong>：自动通知外部服务</li>\n</ul>\n<hr>\n<h3 id=\"Gitee-入门详解\"><a href=\"#Gitee-入门详解\" class=\"headerlink\" title=\"Gitee 入门详解\"></a>Gitee 入门详解</h3><h4 id=\"1-Gitee-是什么？\"><a href=\"#1-Gitee-是什么？\" class=\"headerlink\" title=\"1. Gitee 是什么？\"></a>1. Gitee 是什么？</h4><ul>\n<li><strong>Gitee（码云）</strong>：中国主流的代码托管平台，支持 Git 管理，适合国内团队、企业使用。</li>\n<li>优势：<ul>\n<li>国内访问速度快，无需科学上网</li>\n<li>支持私有仓库免费（适合团队或企业项目）</li>\n<li>与中国开发者生态结合紧密（对接企事业单位、开源中国等）</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-Gitee-账号注册与界面介绍\"><a href=\"#2-Gitee-账号注册与界面介绍\" class=\"headerlink\" title=\"2. Gitee 账号注册与界面介绍\"></a>2. Gitee 账号注册与界面介绍</h4><ul>\n<li><a href=\"https://gitee.com/\">Gitee 注册入口</a></li>\n<li>支持手机号、邮箱注册</li>\n<li>注册流程：填写信息 → 验证 → 完善个人资料</li>\n</ul>\n<h5 id=\"Gitee-主要界面说明\"><a href=\"#Gitee-主要界面说明\" class=\"headerlink\" title=\"Gitee 主要界面说明\"></a>Gitee 主要界面说明</h5><ul>\n<li><strong>项目（Project）</strong>：代码仓库</li>\n<li><strong>问题（Issue）</strong>：项目问题追踪与任务管理</li>\n<li><strong>合并请求（Pull Request）</strong>：代码协作</li>\n<li><strong>收藏、Fork、Watch</strong>：功能与 GitHub 类似</li>\n<li><strong>Gitee Pages</strong>：静态网站托管（个人博客&#x2F;项目文档）</li>\n</ul>\n<h4 id=\"3-Gitee-SSH-Key-配置与项目协作\"><a href=\"#3-Gitee-SSH-Key-配置与项目协作\" class=\"headerlink\" title=\"3. Gitee SSH Key 配置与项目协作\"></a>3. Gitee SSH Key 配置与项目协作</h4><ul>\n<li>SSH Key 配置流程与 GitHub 类似（见上方）</li>\n<li>项目协作流程：<ol>\n<li>创建或 Fork 仓库</li>\n<li>Clone 到本地</li>\n<li>新建分支开发，提交并推送</li>\n<li>发起合并请求</li>\n<li>参与 Issue 讨论</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"4-Gitee-特色功能\"><a href=\"#4-Gitee-特色功能\" class=\"headerlink\" title=\"4. Gitee 特色功能\"></a>4. Gitee 特色功能</h4><ul>\n<li>支持企业版和团队协作</li>\n<li>支持中国主流第三方登录（微信、支付宝等）</li>\n<li>支持私有仓库免费，适合企业内部项目管理</li>\n</ul>\n<hr>\n<h3 id=\"第五部分：GitHub-和-Gitee-的核心功能对比\"><a href=\"#第五部分：GitHub-和-Gitee-的核心功能对比\" class=\"headerlink\" title=\"第五部分：GitHub 和 Gitee 的核心功能对比\"></a>第五部分：GitHub 和 Gitee 的核心功能对比</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>GitHub</th>\n<th>Gitee</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Fork</td>\n<td>复制项目到个人账户</td>\n<td>同样支持复制项目</td>\n</tr>\n<tr>\n<td>Star</td>\n<td>收藏项目</td>\n<td>同样支持收藏项目</td>\n</tr>\n<tr>\n<td>Watch</td>\n<td>订阅项目动态</td>\n<td>支持订阅</td>\n</tr>\n<tr>\n<td>Issues</td>\n<td>提交问题或建议</td>\n<td>问题追踪支持更本地化</td>\n</tr>\n<tr>\n<td>Pull Request</td>\n<td>提交代码修改和合并</td>\n<td>类似功能</td>\n</tr>\n<tr>\n<td>Actions</td>\n<td>自动化 CI&#x2F;CD 工作流</td>\n<td>不支持 Actions</td>\n</tr>\n<tr>\n<td>Pages</td>\n<td>静态网站托管</td>\n<td>提供类似功能</td>\n</tr>\n<tr>\n<td>Releases</td>\n<td>发布稳定版本</td>\n<td>同样支持发布功能</td>\n</tr>\n<tr>\n<td>Webhooks</td>\n<td>自动消息通知</td>\n<td>支持类似功能</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ul>\n<li><strong>Git</strong>：本地代码管理和版本控制工具</li>\n<li><strong>GitHub</strong>：全球开源协作、作品展示和技术交流平台</li>\n<li><strong>Gitee</strong>：国内主流代码托管平台，适合本地团队和企业项目协作</li>\n</ul>\n<p><strong>建议：</strong></p>\n<ul>\n<li>日常学习和开源项目优先用 GitHub，参与国际技术社区</li>\n<li>团队&#x2F;企业项目可选用 Gitee，便于国内协作和访问</li>\n<li>熟练掌握 Git 命令和 SSH 配置，提升协作效率</li>\n</ul>\n<hr>\n<h2 id=\"Typora-与-Markdown\"><a href=\"#Typora-与-Markdown\" class=\"headerlink\" title=\"Typora 与 Markdown\"></a>Typora 与 Markdown</h2><h3 id=\"Typora-使用教程\"><a href=\"#Typora-使用教程\" class=\"headerlink\" title=\"Typora 使用教程\"></a>Typora 使用教程</h3><h4 id=\"安装和激活\"><a href=\"#安装和激活\" class=\"headerlink\" title=\"安装和激活\"></a>安装和激活</h4><ul>\n<li>下载 Typora 安装包，运行后一路点击 OK 即可完成安装。</li>\n<li>如果需要激活，将文件夹中的 <strong>winmm.dll</strong> 移动到 Typora 的安装路径下（如 D:\\Program Files\\Typora）。注意此步骤需关闭 Typora 软件，否则会报错。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_3.png\" alt=\"image-20251017092741839\"></p>\n<hr>\n<h4 id=\"插件使用\"><a href=\"#插件使用\" class=\"headerlink\" title=\"插件使用\"></a>插件使用</h4><ul>\n<li>推荐安装 <a href=\"https://github.com/obgnail/typora_plugin\">typora_plugin</a>：可以显著优化 Typora 的使用体验，按官方文档安装即可。</li>\n<li>论文工具<a href=\"https://github.com/Keldos-Li/typora-latex-theme\">typora-latex-theme</a>：对于没有学过office三件套或WPS的同学大有帮助。</li>\n</ul>\n<hr>\n<h4 id=\"建议配置\"><a href=\"#建议配置\" class=\"headerlink\" title=\"建议配置\"></a>建议配置</h4><h5 id=\"侧边栏设置\"><a href=\"#侧边栏设置\" class=\"headerlink\" title=\"侧边栏设置\"></a>侧边栏设置</h5><ul>\n<li>建议将侧边栏打开，便于查看和管理文档结构。</li>\n<li>在 Typora 主界面点击右下角的 <code>显示/隐藏侧边栏</code> 按钮即可。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_4.png\" alt=\"image-20251017093303047\"></p>\n<hr>\n<h5 id=\"文件配置\"><a href=\"#文件配置\" class=\"headerlink\" title=\"文件配置\"></a>文件配置</h5><ul>\n<li>进入 Typora 菜单栏 <code>文件 -&gt; 偏好设置</code>，进行文件相关配置。</li>\n<li>推荐按照下图设置，便于文档管理与文件归档。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_5.png\" alt=\"image-20251017093318594\"></p>\n<hr>\n<h5 id=\"编辑器配置\"><a href=\"#编辑器配置\" class=\"headerlink\" title=\"编辑器配置\"></a>编辑器配置</h5><ul>\n<li>推荐启用智能缩进、自动补全 Markdown 字符、统一行尾符号等功能，提升编辑效率，减少语法出错。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_6.png\" alt=\"image-20251017093327185\"></p>\n<hr>\n<h5 id=\"图片配置\"><a href=\"#图片配置\" class=\"headerlink\" title=\"图片配置\"></a>图片配置</h5><ul>\n<li>插入图片时，建议选择自动复制图片到当前 md 文件同名的 assets 文件夹下，方便文档迁移和分享。  </li>\n<li>推荐勾选：  <ul>\n<li>自动上传图片到 assets 文件夹</li>\n<li>优化图片路径显示</li>\n<li>生成图片相对路径</li>\n</ul>\n</li>\n<li>图片插入后，建议压缩图片或生成缩略图，减少文档体积。</li>\n</ul>\n<hr>\n<h5 id=\"Markdown-配置\"><a href=\"#Markdown-配置\" class=\"headerlink\" title=\"Markdown 配置\"></a>Markdown 配置</h5><p>我们在这里可以配置markdown的语法相关，我的建议是全部勾上（除了那个首行缩进&lt;这是个人喜好</p>\n<p>&gt;），一定勾选上那个图表，这样可以让typora对mermaid等图表代码直接进行渲染，下面的公式编号还是看个人情况，这里就不过多说了</p>\n<ul>\n<li>建议开启 Typora 对 mermaid 图表和数学公式的支持，方便画流程图和写公式。</li>\n<li>推荐设置常用语法快捷键，提升编辑效率。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_8.png\" alt=\"image-20251017093521861\"></p>\n<hr>\n<h5 id=\"导出配置\"><a href=\"#导出配置\" class=\"headerlink\" title=\"导出配置\"></a>导出配置</h5><ul>\n<li>可根据个人需求设置 PDF 导出参数，包括页面大小、边距等。</li>\n<li>支持设置 YAML 头信息（如 title、author），导出时自动识别并加到对应位置。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_9.png\" alt=\"image-20251017093617999\"></p>\n<hr>\n<h5 id=\"外观配置\"><a href=\"#外观配置\" class=\"headerlink\" title=\"外观配置\"></a>外观配置</h5><ul>\n<li>推荐使用「经典」模式，字体大小和主题可按个人习惯调整，支持多种主题切换（如 HappySimple、Jetbrains Mono Theme 等）。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_10.png\" alt=\"image-20251017093703523\"></p>\n<ul>\n<li>主题获取途径：<ul>\n<li><a href=\"https://theme.typora.io/\">Themes Gallery – Typora</a></li>\n<li>GitHub 搜索 typora theme</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h5 id=\"通用配置\"><a href=\"#通用配置\" class=\"headerlink\" title=\"通用配置\"></a>通用配置</h5><p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_11.png\" alt=\"image-20251017093728150\"></p>\n<ul>\n<li>建议关闭自动检查更新和开发版更新，稳定性更好。</li>\n<li>可自定义快捷键，提升操作效率。</li>\n</ul>\n<hr>\n<h4 id=\"主题美化\"><a href=\"#主题美化\" class=\"headerlink\" title=\"主题美化\"></a>主题美化</h4><ul>\n<li>推荐主题：<ul>\n<li><strong>Neil Jetbrains Mono Theme</strong>：适合 Jetbrains 系 IDE 用户，字体美观，界面简洁。</li>\n<li><strong>HappySimple</strong>：视觉舒适，适合日常写作和学习。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"Markdown-使用教程\"><a href=\"#Markdown-使用教程\" class=\"headerlink\" title=\"Markdown 使用教程\"></a>Markdown 使用教程</h3><h4 id=\"一、什么是-Markdown？\"><a href=\"#一、什么是-Markdown？\" class=\"headerlink\" title=\"一、什么是 Markdown？\"></a>一、什么是 Markdown？</h4><p>Markdown 是一种轻量级的标记语言，设计用于让普通文本具有丰富的格式表现，同时保留文案内容的易读性和易写性。通过简单直观的标记符号实现文档格式化，广泛应用于技术文档、博客文章、电子邮件、笔记和协作文档等。</p>\n<hr>\n<h4 id=\"二、为什么选择-Markdown？\"><a href=\"#二、为什么选择-Markdown？\" class=\"headerlink\" title=\"二、为什么选择 Markdown？\"></a>二、为什么选择 Markdown？</h4><ol>\n<li><strong>简单直观</strong>：语法易学易用，常见标记符号即可快速上手。</li>\n<li><strong>跨平台支持</strong>：兼容多种工具和平台，如 GitHub、Notion、VS Code、Jupyter Notebook 等。</li>\n<li><strong>多格式输出</strong>：可转为 HTML、PDF、Word 等多种格式，满足不同需求。</li>\n<li><strong>专注创作</strong>：无需复杂排版工具，专注内容本身，提升写作效率。</li>\n</ol>\n<hr>\n<h4 id=\"三、Markdown-语法详解\"><a href=\"#三、Markdown-语法详解\" class=\"headerlink\" title=\"三、Markdown 语法详解\"></a>三、Markdown 语法详解</h4><h5 id=\"1-标题\"><a href=\"#1-标题\" class=\"headerlink\" title=\"1. 标题\"></a>1. 标题</h5><p>使用 <code>#</code> 符号表示标题，支持六级标题，<code>#</code> 的数量代表标题级别。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\"># 一级标题</span></span><br><span class=\"line\"><span class=\"section\">## 二级标题</span></span><br><span class=\"line\"><span class=\"section\">### 三级标题</span></span><br><span class=\"line\"><span class=\"section\">#### 四级标题</span></span><br><span class=\"line\"><span class=\"section\">##### 五级标题</span></span><br><span class=\"line\"><span class=\"section\">###### 六级标题</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"2-段落与换行\"><a href=\"#2-段落与换行\" class=\"headerlink\" title=\"2. 段落与换行\"></a>2. 段落与换行</h5><p>普通文本直接书写即可。若需换行，在行尾添加两个空格。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这是一段文字，行尾加两个空格后换行。  </span><br><span class=\"line\">这是下一行。</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"3-强调\"><a href=\"#3-强调\" class=\"headerlink\" title=\"3. 强调\"></a>3. 强调</h5><p>支持斜体和加粗，以及两者组合。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"emphasis\">*斜体*</span> 或 <span class=\"emphasis\">_斜体_</span></span><br><span class=\"line\"><span class=\"strong\">**加粗**</span> 或 <span class=\"strong\">__加粗__</span></span><br><span class=\"line\"><span class=\"strong\">**<span class=\"emphasis\">*斜体加粗*</span>**</span> 或 <span class=\"strong\">__<span class=\"emphasis\">_斜体加粗_</span>__</span></span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li><em>斜体</em></li>\n<li><strong>加粗</strong></li>\n<li><em><strong>斜体加粗</strong></em></li>\n</ul>\n<hr>\n<h5 id=\"4-列表\"><a href=\"#4-列表\" class=\"headerlink\" title=\"4. 列表\"></a>4. 列表</h5><p>支持无序列表和有序列表。</p>\n<h6 id=\"无序列表\"><a href=\"#无序列表\" class=\"headerlink\" title=\"无序列表\"></a>无序列表</h6><p>使用 <code>-</code>、<code>*</code> 或 <code>+</code> 作为标记符。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">-</span> 项目一</span><br><span class=\"line\"><span class=\"bullet\">-</span> 项目二</span><br><span class=\"line\"><span class=\"bullet\">  -</span> 子项目一</span><br><span class=\"line\"><span class=\"bullet\">  -</span> 子项目三</span><br><span class=\"line\"><span class=\"bullet\">*</span> 项目三</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li>项目一</li>\n<li>项目二<ul>\n<li>子项目一</li>\n<li>子项目三</li>\n</ul>\n</li>\n<li>项目三</li>\n</ul>\n<h6 id=\"有序列表\"><a href=\"#有序列表\" class=\"headerlink\" title=\"有序列表\"></a>有序列表</h6><p>使用数字加点 <code>1.</code>，数字顺序可不连续，最终会按顺序渲染。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1.</span> 项目一</span><br><span class=\"line\"><span class=\"bullet\">2.</span> 项目二</span><br><span class=\"line\"><span class=\"bullet\">   1.</span> 子项目一</span><br><span class=\"line\"><span class=\"bullet\">   2.</span> 子项目二</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ol>\n<li>项目一</li>\n<li>项目二<ol>\n<li>子项目一</li>\n<li>子项目二</li>\n</ol>\n</li>\n</ol>\n<hr>\n<h5 id=\"5-链接\"><a href=\"#5-链接\" class=\"headerlink\" title=\"5. 链接\"></a>5. 链接</h5><p>添加超链接：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">链接文字</span>](<span class=\"link\">链接地址</span>)</span><br><span class=\"line\">[<span class=\"string\">google</span>](<span class=\"link\">https://www.google.com</span>)</span><br></pre></td></tr></table></figure>\n\n<p>带标题提示：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">链接文字</span>](<span class=\"link\">链接地址 &quot;标题提示&quot;</span>)</span><br><span class=\"line\">[<span class=\"string\">google</span>](<span class=\"link\">https://www.google.com &quot;谷歌搜索&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>效果如下：<br><a href=\"https://www.google.com/\">Google</a><br><a href=\"https://www.google.com/\" title=\"谷歌搜索\">Google</a></p>\n<hr>\n<h5 id=\"6-图片\"><a href=\"#6-图片\" class=\"headerlink\" title=\"6. 图片\"></a>6. 图片</h5><p>添加图片与链接类似，只需在前面加一个 <code>!</code>。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\">图片描述</span>](<span class=\"link\">图片地址</span>)</span><br><span class=\"line\">![<span class=\"string\">鹿乃.jpg</span>](<span class=\"link\">https://s2.loli.net/2024/10/27/I1iqvzVtnxEYuaT.jpg</span>)</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h5 id=\"7-引用\"><a href=\"#7-引用\" class=\"headerlink\" title=\"7. 引用\"></a>7. 引用</h5><p>引用使用 <code>&gt;</code> 进行标记，支持嵌套引用。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"quote\">&gt; 这是一个引用。</span></span><br><span class=\"line\">&gt;&gt; 这是嵌套引用。</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<blockquote>\n<p>这是一个引用。</p>\n<blockquote>\n<p>这是嵌套引用。</p>\n</blockquote>\n</blockquote>\n<hr>\n<h5 id=\"8-代码块\"><a href=\"#8-代码块\" class=\"headerlink\" title=\"8. 代码块\"></a>8. 代码块</h5><h6 id=\"行内代码\"><a href=\"#行内代码\" class=\"headerlink\" title=\"行内代码\"></a>行内代码</h6><p>用反引号（&#96;）包裹。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"code\">`这是行内代码`</span> 示例。</span><br></pre></td></tr></table></figure>\n\n<p>效果：<code>这是行内代码</code> 示例。</p>\n<h6 id=\"多行代码块\"><a href=\"#多行代码块\" class=\"headerlink\" title=\"多行代码块\"></a>多行代码块</h6><p>用三个反引号（&#96;&#96;&#96;）包裹，可指定语言高亮。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"code\">``` python</span></span><br><span class=\"line\"><span class=\"code\">def hello():</span></span><br><span class=\"line\"><span class=\"code\">    print(&quot;Hello, Markdown!&quot;)</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">效果如下：</span><br><span class=\"line\"></span><br><span class=\"line\">```python</span><br><span class=\"line\">def hello():</span><br><span class=\"line\">    print(&quot;Hello, Markdown!&quot;)</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h5 id=\"9-表格\"><a href=\"#9-表格\" class=\"headerlink\" title=\"9. 表格\"></a>9. 表格</h5><p>使用 <code>|</code> 和 <code>-</code> 创建表格。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">| 表头1 | 表头2 | 表头3 |</span><br><span class=\"line\">|-------|-------|-------|</span><br><span class=\"line\">| 数据1 | 数据2 | 数据3 |</span><br><span class=\"line\">| 数据4 | 数据5 | 数据6 |</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<table>\n<thead>\n<tr>\n<th>表头 1</th>\n<th>表头 2</th>\n<th>表头 3</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>数据 1</td>\n<td>数据 2</td>\n<td>数据 3</td>\n</tr>\n<tr>\n<td>数据 4</td>\n<td>数据 5</td>\n<td>数据 6</td>\n</tr>\n</tbody></table>\n<hr>\n<h5 id=\"10-分隔线\"><a href=\"#10-分隔线\" class=\"headerlink\" title=\"10. 分隔线\"></a>10. 分隔线</h5><p>用三个或更多的 <code>-</code>、<code>*</code> 或 <code>_</code> 创建分隔线。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\"><span class=\"strong\">***</span></span><br><span class=\"line\"><span class=\"strong\">__<span class=\"emphasis\">_</span></span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"效果如下：\"><a href=\"#效果如下：\" class=\"headerlink\" title=\"效果如下：\"></a>效果如下：</h4><hr>\n<h4 id=\"任务列表\"><a href=\"#任务列表\" class=\"headerlink\" title=\"任务列表\"></a>任务列表</h4><p>用 <code>- [ ]</code> 创建未完成任务，<code>- [x]</code> 创建已完成任务。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">-</span> [ ] 任务一</span><br><span class=\"line\"><span class=\"bullet\">-</span> [x] 任务二</span><br><span class=\"line\"><span class=\"bullet\">-</span> [ ] 任务三</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\"> 任务一</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> 任务二</li>\n<li><input disabled=\"\" type=\"checkbox\"> 任务三</li>\n</ul>\n<hr>\n<h5 id=\"12-公式\"><a href=\"#12-公式\" class=\"headerlink\" title=\"12. 公式\"></a>12. 公式</h5><p>支持 LaTeX 数学公式（部分编辑器&#x2F;平台需开启支持）。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$\\frac&#123;a&#125;&#123;b&#125;$</span><br></pre></td></tr></table></figure>\n\n<p>效果：$\\frac{a}{b}$</p>\n<hr>\n<h5 id=\"13-mermaid-绘图\"><a href=\"#13-mermaid-绘图\" class=\"headerlink\" title=\"13. mermaid 绘图\"></a>13. mermaid 绘图</h5><p>支持流程图、时序图等（需平台支持）。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">A[串口中断接收] --&gt; B&#123;中断号判断&#125;</span><br><span class=\"line\">B --&gt;|USART1 或 USART2| C[堆栈寄存器压入\\n]</span><br><span class=\"line\">C --&gt; B</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h3 id=\"Typora-快捷键速查表\"><a href=\"#Typora-快捷键速查表\" class=\"headerlink\" title=\"Typora 快捷键速查表\"></a>Typora 快捷键速查表</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>快捷键（Windows）</th>\n<th>快捷键（Mac）</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>加粗</td>\n<td>Ctrl + B</td>\n<td>Cmd + B</td>\n<td>选中内容加粗</td>\n</tr>\n<tr>\n<td>斜体</td>\n<td>Ctrl + I</td>\n<td>Cmd + I</td>\n<td>选中内容斜体</td>\n</tr>\n<tr>\n<td>插入标题</td>\n<td>Ctrl + 1 ~ Ctrl + 6</td>\n<td>Cmd + 1 ~ Cmd + 6</td>\n<td>对应一级至六级标题</td>\n</tr>\n<tr>\n<td>插入无序列表</td>\n<td>Ctrl + Shift + U</td>\n<td>Cmd + Shift + U</td>\n<td>快速插入无序列表</td>\n</tr>\n<tr>\n<td>插入有序列表</td>\n<td>Ctrl + Shift + O</td>\n<td>Cmd + Shift + O</td>\n<td>快速插入有序列表</td>\n</tr>\n<tr>\n<td>插入任务列表</td>\n<td>Ctrl + Shift + C</td>\n<td>Cmd + Shift + C</td>\n<td>插入 <code>- [ ]</code> 任务项</td>\n</tr>\n<tr>\n<td>插入代码块</td>\n<td>Ctrl + Shift + K</td>\n<td>Cmd + Option + K</td>\n<td>插入三反引号代码块（块级代码）</td>\n</tr>\n<tr>\n<td>插入行内代码</td>\n<td>Ctrl + E</td>\n<td>Cmd + E</td>\n<td>插入行内代码（单反引号）</td>\n</tr>\n<tr>\n<td>插入图片</td>\n<td>Ctrl + Shift + I</td>\n<td>Cmd + Shift + I</td>\n<td>打开插入图片对话框</td>\n</tr>\n<tr>\n<td>插入链接</td>\n<td>Ctrl + K</td>\n<td>Cmd + K</td>\n<td>插入超链接</td>\n</tr>\n<tr>\n<td>插入引用</td>\n<td>Ctrl + Shift + Q</td>\n<td>Cmd + Shift + Q</td>\n<td>插入引用 &gt;</td>\n</tr>\n<tr>\n<td>插入表格</td>\n<td>Ctrl + T</td>\n<td>Cmd + T</td>\n<td>打开插入表格面板</td>\n</tr>\n<tr>\n<td>插入公式</td>\n<td>Ctrl + Shift + M</td>\n<td>Cmd + Shift + M</td>\n<td>插入公式块（$$）</td>\n</tr>\n<tr>\n<td>插入Mermaid图</td>\n<td>Ctrl + Shift + G</td>\n<td>Cmd + Shift + G</td>\n<td>插入mermaid绘图代码块</td>\n</tr>\n<tr>\n<td>切换专注模式</td>\n<td>F8</td>\n<td>F8</td>\n<td>切换专注模式（Focus Mode）</td>\n</tr>\n<tr>\n<td>打开&#x2F;关闭侧边栏</td>\n<td>Ctrl + &#x2F;</td>\n<td>Cmd + &#x2F;</td>\n<td>显示或隐藏左侧目录栏</td>\n</tr>\n<tr>\n<td>查找</td>\n<td>Ctrl + F</td>\n<td>Cmd + F</td>\n<td>查找文本</td>\n</tr>\n<tr>\n<td>替换</td>\n<td>Ctrl + H</td>\n<td>Cmd + Option + F</td>\n<td>查找并替换文本</td>\n</tr>\n<tr>\n<td>保存</td>\n<td>Ctrl + S</td>\n<td>Cmd + S</td>\n<td>保存文档</td>\n</tr>\n<tr>\n<td>导出</td>\n<td>Ctrl + Shift + E</td>\n<td>Cmd + Shift + E</td>\n<td>导出为PDF、HTML等格式</td>\n</tr>\n<tr>\n<td>打开偏好设置</td>\n<td>Ctrl + ,</td>\n<td>Cmd + ,</td>\n<td>打开Typora设置</td>\n</tr>\n<tr>\n<td>新建文档</td>\n<td>Ctrl + N</td>\n<td>Cmd + N</td>\n<td>新建一个空白文档</td>\n</tr>\n<tr>\n<td>打开文档</td>\n<td>Ctrl + O</td>\n<td>Cmd + O</td>\n<td>打开本地文档</td>\n</tr>\n<tr>\n<td>关闭文档</td>\n<td>Ctrl + W</td>\n<td>Cmd + W</td>\n<td>关闭当前标签页</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p><strong>提示：</strong><br>Typora 支持自定义快捷键，部分功能可在 “偏好设置” &gt; “快捷键”中自定义。<br>常用操作如插入代码块、插入图片、切换侧边栏等快捷键建议多加练习，提升效率。</p>\n</blockquote>\n<hr>\n<h2 id=\"插件与刷课脚本部分\"><a href=\"#插件与刷课脚本部分\" class=\"headerlink\" title=\"插件与刷课脚本部分\"></a>插件与刷课脚本部分</h2><h3 id=\"一、浏览器插件简介\"><a href=\"#一、浏览器插件简介\" class=\"headerlink\" title=\"一、浏览器插件简介\"></a>一、浏览器插件简介</h3><h4 id=\"1-什么是浏览器插件？\"><a href=\"#1-什么是浏览器插件？\" class=\"headerlink\" title=\"1. 什么是浏览器插件？\"></a>1. 什么是浏览器插件？</h4><p>浏览器插件（扩展）是一种可以为浏览器增加新功能的小型程序。它们能够帮助用户实现自动化、界面美化、广告屏蔽、脚本自定义等功能，极大提升日常上网体验和效率。</p>\n<hr>\n<h4 id=\"2-油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\"><a href=\"#2-油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\" class=\"headerlink\" title=\"2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\"></a>2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比</h4><p><strong>油猴（Tampermonkey）</strong> 和 <strong>篡改猴（Violentmonkey）</strong> 都是浏览器端最主流的用户脚本管理器插件，能够让用户轻松安装、管理和运行自定义脚本（如刷课、自动答题、网页优化等）。</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>油猴（Tampermonkey）</th>\n<th>篡改猴（Violentmonkey）</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>兼容性</td>\n<td>Chrome&#x2F;Edge&#x2F;Firefox&#x2F;Safari</td>\n<td>Chrome&#x2F;Edge&#x2F;Firefox&#x2F;Opera</td>\n</tr>\n<tr>\n<td>界面</td>\n<td>功能丰富，设置选项更多</td>\n<td>界面简洁，轻量，易用</td>\n</tr>\n<tr>\n<td>脚本支持</td>\n<td>支持几乎所有主流用户脚本</td>\n<td>支持大部分脚本，兼容性优秀</td>\n</tr>\n<tr>\n<td>开发者</td>\n<td>国外团队</td>\n<td>国外团队（有国人参与）</td>\n</tr>\n<tr>\n<td>推荐场景</td>\n<td>需要高级管理&#x2F;脚本较多的用户</td>\n<td>追求简洁&#x2F;轻量的用户</td>\n</tr>\n</tbody></table>\n<p><strong>小结：</strong></p>\n<ul>\n<li>油猴（Tampermonkey）适合大多数用户，功能更全，兼容性最好，推荐新手优先选择。</li>\n<li>篡改猴（Violentmonkey）更轻量，界面简洁，资源占用更低。</li>\n</ul>\n<hr>\n<h4 id=\"3-安装方法\"><a href=\"#3-安装方法\" class=\"headerlink\" title=\"3. 安装方法\"></a>3. 安装方法</h4><p><strong>a. Chrome 浏览器：</strong></p>\n<ul>\n<li><p>推荐前往 <a href=\"https://www.crxsoso.com/search\">crx搜搜插件网</a> 搜索「Tampermonkey」或「Violentmonkey」并下载安装（国内无需科学上网）。</p>\n<blockquote>\n<p>聚合了 Chrome、Edge、Firefox 各类插件和油猴脚本，国内访问速度快，适合查找各类扩展和脚本。</p>\n</blockquote>\n</li>\n<li><p>也可去 <a href=\"https://chrome.google.com/webstore/\">Chrome Web Store</a> 安装（需科学上网）。</p>\n</li>\n</ul>\n<p><strong>b. Edge 浏览器：</strong></p>\n<ul>\n<li>可在 Edge 插件商店或 crx搜搜 搜索并安装。</li>\n</ul>\n<p><strong>c. Firefox 浏览器：</strong></p>\n<ul>\n<li>前往 <a href=\"https://addons.mozilla.org/\">Firefox 附加组件</a> 搜索并安装。</li>\n</ul>\n<hr>\n<h3 id=\"OCS网课助手与刷课脚本\"><a href=\"#OCS网课助手与刷课脚本\" class=\"headerlink\" title=\"OCS网课助手与刷课脚本\"></a>OCS网课助手与刷课脚本</h3><h4 id=\"OCS网课助手简介\"><a href=\"#OCS网课助手简介\" class=\"headerlink\" title=\"OCS网课助手简介\"></a>OCS网课助手简介</h4><p>OCS网课助手是一款专为网课平台（如超星、智慧树、学堂在线等）开发的刷课插件，能实现自动播放、刷视频、自动答题等功能，大大提高网课学习效率。适合需要快速完成网课任务的同学。</p>\n<ul>\n<li><strong>官网&#x2F;项目主页</strong>：<a href=\"https://docs.ocsjs.com/\">OCS网课助手</a></li>\n<li><strong>主要功能</strong>：<ul>\n<li>自动刷视频、自动答题、自动过考试</li>\n<li>支持多个主流网课平台</li>\n<li>可配合题库使用（如教材&#x2F;言溪题库等）</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"言溪题库简介\"><a href=\"#言溪题库简介\" class=\"headerlink\" title=\"言溪题库简介\"></a>言溪题库简介</h4><ul>\n<li><p><strong>官网主页</strong>：<a href=\"https://tk.enncy.cn/\">言溪题库</a></p>\n</li>\n<li><p>提供超星、智慧树等平台的题目答案，可提升刷课和自动答题的正确率。</p>\n</li>\n<li><p>常见用法：在 OCS 等刷课插件设置里绑定题库接口，或手动查找题目答案。</p>\n</li>\n</ul>\n<h4 id=\"WE-Learn-U校园刷课脚本与教程\"><a href=\"#WE-Learn-U校园刷课脚本与教程\" class=\"headerlink\" title=\"WE Learn &amp; U校园刷课脚本与教程\"></a>WE Learn &amp; U校园刷课脚本与教程</h4><ul>\n<li><strong>EOC 一站式刷课脚本合集</strong>：<a href=\"https://ssmjae.github.io/EOC/\">EOC项目主页</a><ul>\n<li>该网站提供了针对多种主流校园网课平台（如 WE Learn、U校园等）的刷课脚本及详细教程。</li>\n<li>主要功能包括：<ul>\n<li>自动刷视频、自动答题、自动完成作业、考试辅助等</li>\n<li>支持多平台、多类型课程的自动化处理</li>\n<li>提供详细的安装流程、脚本下载链接、常见问题解答</li>\n</ul>\n</li>\n<li>网站内容持续更新，适合自助查找和学习刷课自动化工具</li>\n</ul>\n</li>\n</ul>\n<p><strong>使用建议：</strong></p>\n<ul>\n<li>进入 EOC 项目主页后，根据你的网课平台（如 WE Learn、U校园）选择对应脚本和教程，按照页面说明进行安装和使用。</li>\n<li>建议优先使用油猴（Tampermonkey）或篡改猴（Violentmonkey）插件进行脚本管理，确保兼容性和脚本运行稳定。</li>\n<li>脚本仅供学习和便捷课程管理使用，切勿用于违规用途。</li>\n</ul>\n<hr>\n<p><strong>实用建议：</strong></p>\n<ul>\n<li>插件和脚本建议只从知名平台和官方渠道下载，避免安全风险。</li>\n<li>使用脚本前请详细阅读说明，注意账号安全，不要泄露个人信息。</li>\n<li>刷课脚本仅供学习交流，勿用于违规用途。</li>\n</ul>\n","excerpt":"","more":"<h1 id=\"Git-GitHub-Markdown-刷课\"><a href=\"#Git-GitHub-Markdown-刷课\" class=\"headerlink\" title=\"Git &amp; GitHub &amp; Markdown &amp;刷课\"></a>Git &amp; GitHub &amp; Markdown &amp;刷课</h1><h2 id=\"环境准备\"><a href=\"#环境准备\" class=\"headerlink\" title=\"环境准备\"></a><strong>环境准备</strong></h2><h3 id=\"Chrome-浏览器下载\"><a href=\"#Chrome-浏览器下载\" class=\"headerlink\" title=\"Chrome 浏览器下载\"></a>Chrome 浏览器下载</h3><p><strong>推荐使用国内 Cent Browser：</strong></p>\n<ul>\n<li><p><a href=\"https://www.centbrowser.cn/\">官方下载地址(官网)</a></p>\n</li>\n<li><p>继承谷歌内核稳定流畅的优点同时，与 Chrome 基本操作界面别无二致, 并加入其他常用功能</p>\n</li>\n</ul>\n<p><strong>推荐使用谷歌 Chrome 浏览器：</strong></p>\n<ul>\n<li><a href=\"https://www.google.com/chrome/\">官方下载地址（需科学上网）</a></li>\n<li>或搜索“Chrome 浏览器下载国内镜像”获取国内最新可用链接。</li>\n</ul>\n<h3 id=\"VPN-与机场\"><a href=\"#VPN-与机场\" class=\"headerlink\" title=\"VPN 与机场\"></a>VPN 与机场</h3><h4 id=\"VPN-是什么？机场是什么？\"><a href=\"#VPN-是什么？机场是什么？\" class=\"headerlink\" title=\"VPN 是什么？机场是什么？\"></a>VPN 是什么？机场是什么？</h4><ul>\n<li><strong>VPN</strong>：虚拟专用网络，最初是企业、学校等用于远程安全访问内部资源。后来大家习惯把“翻墙”工具称为 VPN，但实际上 VPN 协议并不专属于翻墙，比如 WireGuard、OpenVPN 等真正网络层的 VPN 协议。</li>\n<li><strong>机场</strong>：是专门提供“科学上网”服务的平台。机场主租用大量 VPS（国外服务器），搭建 SS、SSR、Vmess、Trojan 等代理协议节点，用户买流量后通过代理软件（如 Clash、小火箭等）连接机场获得自由访问外网的能力。</li>\n<li><strong>区别与关系</strong>：VPN 是网络层代理，机场多用应用层&#x2F;会话层代理。大多数商业 VPN 广告多且贵，体验和性价比远不如机场。</li>\n</ul>\n<h4 id=\"为什么叫“机场”？\"><a href=\"#为什么叫“机场”？\" class=\"headerlink\" title=\"为什么叫“机场”？\"></a>为什么叫“机场”？</h4><p>因为最早的代理工具 Shadowsocks 图标是一架小飞机，大家就把这种代理服务叫做“机场”。</p>\n<p>机场并不是一个单一的服务器或网站，而是由许多分布在国内外的节点组成，具备分布式、多协议、动态更新和多种抗干扰技术，能灵活应对各种封锁与干扰。即使部分节点被墙，用户只需刷新订阅或等待机场主修复即可继续使用。</p>\n<p>下面分几条简要解释：</p>\n<ol>\n<li><strong>多节点分散部署</strong><br>机场通常在国内外部署了很多服务器（节点），即使部分节点被墙封锁，其他节点仍可正常工作，不会导致整个机场服务瘫痪。</li>\n<li><strong>协议混淆与加密</strong><br>机场使用的代理协议（如 SS、Trojan、Vmess 等）都具备流量加密和混淆能力，能有效隐藏翻墙行为，使防火墙难以精准识别和封锁。</li>\n<li><strong>动态更换节点和订阅</strong><br>机场可以随时更换服务器 IP、端口、协议等参数，用户通过订阅链接自动获取最新节点信息，及时绕开已被封锁的节点。</li>\n<li><strong>中转与专线技术</strong><br>很多机场采用“国内中转”、“隧道”、“专线”等技术，使流量出境路线更加隐蔽和多样化，提高抗封锁能力。</li>\n<li><strong>高防与灾备机制</strong><br>优质机场会购买高防护服务器、备用线路、CDN 加速等服务，即使遭遇攻击或封锁，也能迅速切换恢复服务。</li>\n</ol>\n<h4 id=\"协议科普\"><a href=\"#协议科普\" class=\"headerlink\" title=\"协议科普\"></a>协议科普</h4><ul>\n<li><strong>SS&#x2F;SSR</strong>：Shadowsocks 及其分支 SSR，轻量级加密代理，速度快，兼容性好。</li>\n<li><strong>Vmess&#x2F;VLESS</strong>：V2Ray 框架的协议，功能丰富，支持多种混淆和传输方式。</li>\n<li><strong>Trojan</strong>：基于 HTTPS，伪装成正常网页流量，抗封锁能力强。</li>\n<li><strong>Hy2&#x2F;Reality&#x2F;Tuic</strong>：新一代协议，多用于自建直连，机场较少支持，安全性更高。</li>\n<li><strong>传统 VPN 协议</strong>：如 PPTP、L2TP&#x2F;IPSec、OpenVPN、WireGuard 等，主要用于网络层代理，穿透性和安全性各有不同。</li>\n</ul>\n<h4 id=\"机场线路名词解释\"><a href=\"#机场线路名词解释\" class=\"headerlink\" title=\"机场线路名词解释\"></a>机场线路名词解释</h4><ul>\n<li><strong>规则</strong>：只有国外网站走代理，节省流量</li>\n<li><strong>全局</strong>：所有流量都走代理</li>\n<li><strong>直连</strong>：用户设备直接连境外代理服务器，速度受限、极易被墙。</li>\n<li><strong>中转</strong>：流量先到国内中转服务器，再转发到境外代理服务器。可以优化速度和稳定性，降低被墙风险。</li>\n<li><strong>隧道</strong>：国内服务器入口+境外服务器（如香港 CMI），流量经过 TLS 加密再转发，更安全。</li>\n<li><strong>专线（IEPL&#x2F;IPLC）</strong>：点对点物理线路，低延迟，不经过公网，最稳定但成本高，机场多用 IEPL。</li>\n<li><strong>BGP</strong>：边界网关协议，优化多运营商之间的互联访问速度和稳定性。</li>\n<li><strong>前置</strong>：中转入口前再加一台国内机器，抗通报&#x2F;墙封。</li>\n<li><strong>转发</strong>：多个机场共享中转资源，速度和稳定性差，常见于小机场。</li>\n<li><strong>流量倍率</strong>：部分机场设置倍率，如 2 倍率表示实际消耗 2 倍流量。</li>\n<li><strong>系统代理</strong>：大多数应用（如浏览器）自动走代理，部分软件需手动设置</li>\n<li><strong>TUN 模式&#x2F;虚拟网卡</strong>：创建虚拟网卡，实现真正全局代理，解决部分应用不走代理的问题</li>\n<li><strong>自动选择&#x2F;故障转移：</strong> 自动选择延迟最低节点，但可能频繁切换 IP，容易被某些网站风控</li>\n</ul>\n<h4 id=\"线路体验优先级\"><a href=\"#线路体验优先级\" class=\"headerlink\" title=\"线路体验优先级\"></a>线路体验优先级</h4><p>同样带宽下，体验优先级：  </p>\n<p><strong>IEPL 专线中转 &gt; 隧道中转 &gt; 公网中转（如广东移动&#x2F;湖南联通） &gt; 直连</strong></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_1.png\" alt=\"image-20251016175400498\"></p>\n<h5 id=\"1-直连机场\"><a href=\"#1-直连机场\" class=\"headerlink\" title=\"1. 直连机场\"></a>1. 直连机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内防火墙&#x2F;QoS 限速 → 直接连接境外 VPS&#x2F;服务器 → 国际互联网</li>\n<li><strong>特点</strong>：没有经过国内中转节点，直接出海。速度受限、易被墙，体验和稳定性都较差，适合流量小、只偶尔使用者。</li>\n</ul>\n<h5 id=\"2-普通中转机场\"><a href=\"#2-普通中转机场\" class=\"headerlink\" title=\"2. 普通中转机场\"></a>2. 普通中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内中转 VPS → 境内防火墙&#x2F;QoS 限速 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：增加了一个国内中转节点，优化了出海速度和稳定性。成本较低，但中转节点易受干扰，遇到高峰期或被墙会影响体验。</li>\n</ul>\n<h5 id=\"3-BGP-中转机场\"><a href=\"#3-BGP-中转机场\" class=\"headerlink\" title=\"3. BGP 中转机场\"></a>3. BGP 中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → BGP 中转服务器（多线接入、跨运营商优化） → 境内防火墙&#x2F;QoS 限速 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：BGP 中转节点支持多运营商线路，自动选择最优路径，提升了全国范围的访问速度和稳定性。更适合多地区用户，成本比普通中转高。</li>\n</ul>\n<h5 id=\"4-IPLC-中转机场\"><a href=\"#4-IPLC-中转机场\" class=\"headerlink\" title=\"4. IPLC 中转机场\"></a>4. IPLC 中转机场</h5><ul>\n<li><strong>流程</strong>：用户设备 → 宽带运营商 → 境内中转 VPS → IPLC 专线传输 → 境外 VPS → 国际互联网</li>\n<li><strong>特点</strong>：IPLC（国际专线）是物理专用通道，数据从境内直接通过专线传到境外，几乎不经过防火墙和公网，速度、稳定性和安全性最高，但价格也最贵。适合对速度和稳定性要求极高的用户或企业。</li>\n</ul>\n<hr>\n<h4 id=\"推荐客户端工具\"><a href=\"#推荐客户端工具\" class=\"headerlink\" title=\"推荐客户端工具\"></a>推荐客户端工具</h4><ul>\n<li><strong>Windows&#x2F;Mac&#x2F;Android</strong>：首选 Clash 系列（Clash for Windows、Clash Verge、Clash Meta、Flclash、Clash Party、Sparkle 等）</li>\n<li><strong>iOS</strong>：首选小火箭（Shadowrocket，付费）。</li>\n</ul>\n<h4 id=\"客户端使用流程简述\"><a href=\"#客户端使用流程简述\" class=\"headerlink\" title=\"客户端使用流程简述\"></a>客户端使用流程简述</h4><ol>\n<li>下载并安装客户端软件</li>\n<li>在机场后台获取订阅链接（通常一键复制）</li>\n<li>导入到客户端</li>\n<li>打开系统代理或虚拟网卡（TUN 模式），实现全局或分流科学上网</li>\n<li>常见问题：分流规则设置、系统代理&#x2F;TUN 模式选择、节点测速与切换</li>\n</ol>\n<hr>\n<h4 id=\"机场购买与使用流程\"><a href=\"#机场购买与使用流程\" class=\"headerlink\" title=\"机场购买与使用流程\"></a>机场购买与使用流程</h4><h4 id=\"如何购买机场\"><a href=\"#如何购买机场\" class=\"headerlink\" title=\"如何购买机场\"></a>如何购买机场</h4><ul>\n<li>注册账号（推荐 Gmail&#x2F;Outlook 邮箱，不建议 QQ 邮箱，避免实名风险）</li>\n<li>选择套餐，付款（部分机场支持试用套餐）</li>\n<li>获取订阅链接，导入代理软件</li>\n<li>按照机场提供的小白教程操作，几乎所有机场都有详细的使用说明</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_2.webp\" alt=\"三色图\"></p>\n<h4 id=\"小白教程\"><a href=\"#小白教程\" class=\"headerlink\" title=\"小白教程\"></a>小白教程</h4><p>最小白的教程，适合第一次买机场的，</p>\n<p>先注册，注意的点是验证码邮件可能会在邮箱垃圾箱里面。<br>如果有试用先试用，没试用就去购买套餐。</p>\n<p>1）我们以随便某个 v2board 机场为例子，因为现在很多机场都是用的 v2board 页面。<br><strong>第一步：购买套餐：点击购买订阅–选择你想要的套餐–付款</strong><br>[<img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_12.webp\" alt=\"购买订阅\"><br><a href=\"/images/Git_Github_Markdown/Git_Github_Markdown_13.webp\">![]</a></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_13.webp\" alt=\"选择套餐\"></p>\n<p><strong>第二步：下载代理软件</strong>，这里以 Clash for windows 为例子</p>\n<p><strong>第三步：导入订阅：回到仪表盘–点击一键订阅–导入到你的 Clash 客户端中</strong></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_14.webp\" alt=\"仪表盘\"></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_15.webp\" alt=\"导入订阅\"></p>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_16.webp\" alt=\"导入订阅后\"></p>\n<p>具体详细操场教程可以参考各个机场的使用教程，每个机场基本都有小白教程的。</p>\n<h4 id=\"节点和订阅相关问题\"><a href=\"#节点和订阅相关问题\" class=\"headerlink\" title=\"节点和订阅相关问题\"></a>节点和订阅相关问题</h4><ul>\n<li>节点不能用时，先检查流量套餐是否到期或用尽，再刷新订阅或重新复制订阅链接</li>\n<li>校园网或公司网可能封端口或 DNS 异常，影响机场使用</li>\n<li>机场官网和订阅地址常变，因 GFW 污染 DNS，老牌机场处理经验更丰富</li>\n</ul>\n<hr>\n<h4 id=\"线路技术与常见问题详解\"><a href=\"#线路技术与常见问题详解\" class=\"headerlink\" title=\"线路技术与常见问题详解\"></a>线路技术与常见问题详解</h4><h5 id=\"机场官网慢-打不开？\"><a href=\"#机场官网慢-打不开？\" class=\"headerlink\" title=\"机场官网慢&#x2F;打不开？\"></a>机场官网慢&#x2F;打不开？</h5><ul>\n<li>多数机场官网套了 Cloudflare CDN，隐藏真实 IP，防止被墙，访问速度慢需要科学上网</li>\n</ul>\n<h5 id=\"为什么有些机场便宜？\"><a href=\"#为什么有些机场便宜？\" class=\"headerlink\" title=\"为什么有些机场便宜？\"></a>为什么有些机场便宜？</h5><ul>\n<li>便宜线路（如月抛）、多人共享、直连节点、不买中转、割韭菜跑路风险高</li>\n</ul>\n<h5 id=\"为什么流量消耗快？\"><a href=\"#为什么流量消耗快？\" class=\"headerlink\" title=\"为什么流量消耗快？\"></a>为什么流量消耗快？</h5><ul>\n<li>流量倍率设置、自动选择高倍率节点、系统更新等走代理流量</li>\n</ul>\n<h5 id=\"为什么机场界面都很像？\"><a href=\"#为什么机场界面都很像？\" class=\"headerlink\" title=\"为什么机场界面都很像？\"></a>为什么机场界面都很像？</h5><ul>\n<li>大多数机场用开源面板（V2board、SSpanel），前端界面相似是正常现象</li>\n</ul>\n<h5 id=\"为什么延迟测试异常？\"><a href=\"#为什么延迟测试异常？\" class=\"headerlink\" title=\"为什么延迟测试异常？\"></a>为什么延迟测试异常？</h5><ul>\n<li>部分机场劫持延迟测试，仅到中转入口（非真实国际延迟），可更换延迟测试 URL 验证</li>\n</ul>\n<h5 id=\"机场能否打游戏？\"><a href=\"#机场能否打游戏？\" class=\"headerlink\" title=\"机场能否打游戏？\"></a>机场能否打游戏？</h5><ul>\n<li>不推荐机场打游戏，延迟高、UDP 支持差，建议用专业游戏加速器（如 UU 加速器）。部分机场有专线游戏节点，但不保证稳定</li>\n</ul>\n<hr>\n<h4 id=\"机场安全性与合规问题\"><a href=\"#机场安全性与合规问题\" class=\"headerlink\" title=\"机场安全性与合规问题\"></a>机场安全性与合规问题</h4><h4 id=\"翻墙是安全吗？\"><a href=\"#翻墙是安全吗？\" class=\"headerlink\" title=\"翻墙是安全吗？\"></a>翻墙是安全吗？</h4><ul>\n<li>你猜</li>\n<li>低调，不要键政，不要绑定实名信息</li>\n<li>机场主肉身墙外更安全，选老牌大机场，月付为佳</li>\n<li>被抓多因机场主肉身墙内、高调、实名收款、境内推广</li>\n</ul>\n<h4 id=\"机场跑路怎么办？\"><a href=\"#机场跑路怎么办？\" class=\"headerlink\" title=\"机场跑路怎么办？\"></a>机场跑路怎么办？</h4><ul>\n<li>灰色产业，跑路风险高，优先选择老牌、肉身墙外的机场主，推荐月付。跑路后只能更换机场</li>\n</ul>\n<h4 id=\"白嫖机场安全吗？\"><a href=\"#白嫖机场安全吗？\" class=\"headerlink\" title=\"白嫖机场安全吗？\"></a>白嫖机场安全吗？</h4><ul>\n<li>免费机场体验差或安全风险高，仅试用阶段可考虑，长期建议付费正规机场</li>\n</ul>\n<hr>\n<h2 id=\"Git-与-GitHub\"><a href=\"#Git-与-GitHub\" class=\"headerlink\" title=\"Git 与 GitHub\"></a>Git 与 GitHub</h2><ul>\n<li><strong>Git</strong>：核心工具，记录代码修改历史，创建分支，合并分支等。</li>\n<li><strong>GitHub&#x2F;Gitee</strong>：代码托管平台，方便协作、展示作品、参与开源项目。、</li>\n</ul>\n<ol>\n<li>Git 版本控制基础<ul>\n<li>安装与配置（Windows&#x2F;Mac&#x2F;Linux）</li>\n<li>常用命令演示</li>\n</ul>\n</li>\n<li>GitHub 账号注册与界面介绍<ul>\n<li>教育邮箱注册技巧</li>\n<li>仓库、Issue、PR 等基本功能</li>\n</ul>\n</li>\n<li>GitHub 教育认证与 Copilot 白嫖流程<ul>\n<li>Copilot 是什么</li>\n<li>认证与激活详细步骤</li>\n</ul>\n</li>\n<li>基础实战：远程仓库协作、Fork、PR 操作演示</li>\n</ol>\n<h3 id=\"Git-是什么\"><a href=\"#Git-是什么\" class=\"headerlink\" title=\"Git 是什么\"></a>Git 是什么</h3><p><strong>Git 就像一本“时光机日记本”📖</strong>  </p>\n<p>每段代码的改动，Git 都会帮你记录下来，随时可以“穿越回过去”查找任何时间点的代码状态。</p>\n<ul>\n<li><strong>主要特点：</strong><ol>\n<li><strong>版本控制</strong>：每次提交都像写新日记，保存开发成果。</li>\n<li><strong>分支管理</strong>：分支如同章节，可以并行开发互不干扰。</li>\n<li><strong>分布式</strong>：每个人都有完整的“时光机日记本”，即使没有网络也能工作。</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h3 id=\"Git-与-GitHub-SSH-Key-配置与使用\"><a href=\"#Git-与-GitHub-SSH-Key-配置与使用\" class=\"headerlink\" title=\"Git 与 GitHub SSH Key 配置与使用\"></a>Git 与 GitHub SSH Key 配置与使用</h3><h4 id=\"1-配置个人信息\"><a href=\"#1-配置个人信息\" class=\"headerlink\" title=\"1. 配置个人信息\"></a>1. 配置个人信息</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">&quot;你的名字&quot;</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">&quot;你的邮箱&quot;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>设置后每次提交都会自动带上你的署名。</li>\n</ul>\n<h4 id=\"2-生成-SSH-密钥\"><a href=\"#2-生成-SSH-密钥\" class=\"headerlink\" title=\"2. 生成 SSH 密钥\"></a>2. 生成 SSH 密钥</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -b 4096 -C <span class=\"string\">&quot;你的邮箱@example.com&quot;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>-t rsa ：使 ⽤ RSA 算法 ⽣ 成密钥。</li>\n<li>一路回车即可，密钥默认保存在 <code>~/.ssh/</code> 目录。</li>\n</ul>\n<h4 id=\"3-查看并复制公钥内容\"><a href=\"#3-查看并复制公钥内容\" class=\"headerlink\" title=\"3. 查看并复制公钥内容\"></a>3. 查看并复制公钥内容</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<ul>\n<li>复制输出的内容（全部内容）。</li>\n</ul>\n<h4 id=\"4-添加公钥到远程仓库\"><a href=\"#4-添加公钥到远程仓库\" class=\"headerlink\" title=\"4. 添加公钥到远程仓库\"></a>4. 添加公钥到远程仓库</h4><ul>\n<li><strong>GitHub</strong>：Settings &gt; SSH and GPG keys &gt; New SSH key，粘贴公钥并保存。</li>\n<li><strong>Gitee</strong>：设置 &gt; 安全设置 &gt; SSH 密钥，粘贴公钥并保存。</li>\n</ul>\n<h4 id=\"5-测试连接\"><a href=\"#5-测试连接\" class=\"headerlink\" title=\"5. 测试连接\"></a>5. 测试连接</h4><ul>\n<li><p>GitHub：<code>ssh -T git@github.com</code></p>\n</li>\n<li><p>Gitee：<code>ssh -T git@gitee.com</code></p>\n</li>\n<li><p>第一次会提示“Are you sure you want to continue connecting”，输入 yes</p>\n</li>\n<li><p>若看到 <code>Hi 用户名! You&#39;ve successfully authenticated...</code> 表示成功！</p>\n</li>\n</ul>\n<h4 id=\"6-多平台-多账户密钥配置（进阶）\"><a href=\"#6-多平台-多账户密钥配置（进阶）\" class=\"headerlink\" title=\"6. 多平台&#x2F;多账户密钥配置（进阶）\"></a>6. 多平台&#x2F;多账户密钥配置（进阶）</h4><ul>\n<li>多台电脑、多个平台可分别生成密钥并添加到账户。</li>\n<li>如需配置多个密钥，在 <code>~/.ssh/config</code> 文件中添加：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host github.com</span><br><span class=\"line\">  HostName github.com</span><br><span class=\"line\">  User git</span><br><span class=\"line\">  IdentityFile ~/.ssh/id_rsa</span><br><span class=\"line\"></span><br><span class=\"line\">Host gitee.com</span><br><span class=\"line\">  HostName gitee.com</span><br><span class=\"line\">  User git</span><br><span class=\"line\">  IdentityFile ~/.ssh/id_rsa_gitee</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Git-命令\"><a href=\"#Git-命令\" class=\"headerlink\" title=\"Git 命令\"></a>Git 命令</h3><h4 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 初始化仓库（只需一次）</span></span><br><span class=\"line\">git init</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 克隆远程仓库到本地</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> &lt;仓库地址&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看当前状态</span></span><br><span class=\"line\">git status</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看历史提交记录</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"文件操作\"><a href=\"#文件操作\" class=\"headerlink\" title=\"文件操作\"></a>文件操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 添加所有更改到暂存区</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加指定文件到暂存区</span></span><br><span class=\"line\">git add 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从暂存区移除文件</span></span><br><span class=\"line\">git reset 文件名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"提交-保存更改\"><a href=\"#提交-保存更改\" class=\"headerlink\" title=\"提交&#x2F;保存更改\"></a>提交&#x2F;保存更改</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 提交到本地仓库</span></span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;提交说明&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"与远程仓库交互\"><a href=\"#与远程仓库交互\" class=\"headerlink\" title=\"与远程仓库交互\"></a>与远程仓库交互</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关联远程仓库（只需一次）</span></span><br><span class=\"line\">git remote add origin &lt;仓库地址&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到远程仓库</span></span><br><span class=\"line\">git push</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到远程指定分支（第一次推送用）</span></span><br><span class=\"line\">git push -u origin main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从远程仓库拉取最新内容</span></span><br><span class=\"line\">git pull</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"分支管理\"><a href=\"#分支管理\" class=\"headerlink\" title=\"分支管理\"></a>分支管理</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看所有分支</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建新分支</span></span><br><span class=\"line\">git branch 新分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 切换分支</span></span><br><span class=\"line\">git checkout 分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建并切换到新分支</span></span><br><span class=\"line\">git checkout -b 新分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除本地分支</span></span><br><span class=\"line\">git branch -d 分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看远程分支</span></span><br><span class=\"line\">git branch -r</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拉取远程分支并创建本地分支</span></span><br><span class=\"line\">git checkout -b 本地分支名 origin/远程分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除远程分支</span></span><br><span class=\"line\">git push origin --delete 分支名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"撤销与恢复\"><a href=\"#撤销与恢复\" class=\"headerlink\" title=\"撤销与恢复\"></a>撤销与恢复</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 撤销工作区的修改（让文件恢复到上一次commit的状态）</span></span><br><span class=\"line\">git checkout -- 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 撤销暂存区的修改（把已add的文件撤回到工作区）</span></span><br><span class=\"line\">git reset HEAD 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 撤销最近一次commit但保留修改（回退到上一次commit，修改内容还在）</span></span><br><span class=\"line\">git reset --soft HEAD^</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 丢弃最近一次commit和修改（慎用，修改会丢失）</span></span><br><span class=\"line\">git reset --hard HEAD^</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 恢复被删除的文件（找回误删的文件）</span></span><br><span class=\"line\">git checkout HEAD -- 文件名</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看与对比\"><a href=\"#查看与对比\" class=\"headerlink\" title=\"查看与对比\"></a>查看与对比</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看本地和远程分支对应关系</span></span><br><span class=\"line\">git branch -vv</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看远程地址</span></span><br><span class=\"line\">git remote -v</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看某个文件的修改内容</span></span><br><span class=\"line\">git diff 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看暂存区和上一次commit的区别</span></span><br><span class=\"line\">git diff --cached</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看某个文件的历史修改记录</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span> 文件名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 对比本地分支与远程分支的差异</span></span><br><span class=\"line\">git diff main origin/main</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"标签（Tag）\"><a href=\"#标签（Tag）\" class=\"headerlink\" title=\"标签（Tag）\"></a>标签（Tag）</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 打标签</span></span><br><span class=\"line\">git tag v1.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送标签到远程</span></span><br><span class=\"line\">git push origin v1.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有标签</span></span><br><span class=\"line\">git tag</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"合并与冲突\"><a href=\"#合并与冲突\" class=\"headerlink\" title=\"合并与冲突\"></a>合并与冲突</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 合并分支</span></span><br><span class=\"line\">git merge 另一个分支名</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 解决冲突后，添加并提交</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;fix conflict&quot;</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<blockquote>\n<p><strong>提示：</strong></p>\n<ul>\n<li>不会的命令可以用 <code>git help 命令名</code> 查看帮助。</li>\n<li>日常开发建议多用 <code>git status</code> 和 <code>git log</code> 观察当前状态。</li>\n<li>日常开发推荐分支模型，每个功能新建分支，开发完成合并主线</li>\n</ul>\n</blockquote>\n<hr>\n<h3 id=\"Git-常用命令速查表\"><a href=\"#Git-常用命令速查表\" class=\"headerlink\" title=\"Git 常用命令速查表\"></a>Git 常用命令速查表</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>命令</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>配置用户名和邮箱</td>\n<td><code>git config --global user.name &quot;你的名字&quot;</code> <br> <code>git config --global user.email &quot;你的邮箱&quot;</code></td>\n<td>设置“署名”，每次提交都标记贡献者</td>\n</tr>\n<tr>\n<td>初始化仓库</td>\n<td><code>git init</code></td>\n<td>新建“时光机日记本”，准备记录代码版本</td>\n</tr>\n<tr>\n<td>添加文件到暂存区</td>\n<td><code>git add 文件名</code> 或 <code>git add .</code></td>\n<td>把修改内容放到“草稿区”</td>\n</tr>\n<tr>\n<td>提交到本地仓库</td>\n<td><code>git commit -m &quot;提交说明&quot;</code></td>\n<td>草稿正式进入日记本，并附说明</td>\n</tr>\n<tr>\n<td>推送到远程仓库</td>\n<td><code>git push origin 分支名</code></td>\n<td>把本地代码同步到远程仓库</td>\n</tr>\n<tr>\n<td>克隆远程仓库</td>\n<td><code>git clone 仓库地址</code></td>\n<td>下载别人的代码到本地</td>\n</tr>\n<tr>\n<td>查看状态</td>\n<td><code>git status</code></td>\n<td>检查当前代码变化情况</td>\n</tr>\n<tr>\n<td>查看提交历史</td>\n<td><code>git log</code></td>\n<td>查看代码记录，回顾“时间线”</td>\n</tr>\n<tr>\n<td>创建分支</td>\n<td><code>git branch 分支名</code></td>\n<td>新功能独立章节</td>\n</tr>\n<tr>\n<td>切换分支</td>\n<td><code>git checkout 分支名</code></td>\n<td>从一个章节切换到另一个章节</td>\n</tr>\n<tr>\n<td>合并分支</td>\n<td><code>git merge 分支名</code></td>\n<td>不同章节内容合并到主线</td>\n</tr>\n<tr>\n<td>拉取远程代码</td>\n<td><code>git pull origin 分支名</code></td>\n<td>从远程仓库获取最新代码</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"GitHub-入门详解\"><a href=\"#GitHub-入门详解\" class=\"headerlink\" title=\"GitHub 入门详解\"></a>GitHub 入门详解</h3><h4 id=\"1-GitHub-是什么？\"><a href=\"#1-GitHub-是什么？\" class=\"headerlink\" title=\"1. GitHub 是什么？\"></a>1. GitHub 是什么？</h4><ul>\n<li><strong>GitHub</strong> 是全球最大的开源代码托管平台，基于 Git 版本控制，方便开发者协作、分享和展示项目。</li>\n<li>在 GitHub 上，你可以：<ul>\n<li>托管自己的项目代码，并进行版本管理</li>\n<li>查找和参与全球开源项目</li>\n<li>与他人协作开发（团队项目、开源贡献）</li>\n<li>展示个人作品，提升技术影响力</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-GitHub-账号注册与界面介绍\"><a href=\"#2-GitHub-账号注册与界面介绍\" class=\"headerlink\" title=\"2. GitHub 账号注册与界面介绍\"></a>2. GitHub 账号注册与界面介绍</h4><ul>\n<li><p><a href=\"https://github.com/\">GitHub 注册入口</a></p>\n</li>\n<li><p>不建议直接使用教育邮箱注册</p>\n<blockquote>\n<p>我们学校的教育邮箱是   学号@stu.nchu.edu.cn</p>\n<p>教育认证可额外绑定教育邮箱，可获取学生认证福利（如 Copilot 免费使用）</p>\n</blockquote>\n</li>\n<li><p>注册流程：填写邮箱、用户名、密码 → 邮箱验证 → 完善个人资料</p>\n</li>\n</ul>\n<h5 id=\"GitHub-主要界面说明\"><a href=\"#GitHub-主要界面说明\" class=\"headerlink\" title=\"GitHub 主要界面说明\"></a>GitHub 主要界面说明</h5><ul>\n<li><strong>Repositories（仓库）</strong>：项目代码的存放地，每个仓库包含代码、文档、历史记录等</li>\n<li><strong>Issues</strong>：用于提交问题、建议、任务分解，方便项目管理和交流</li>\n<li><strong>Pull Requests（PR）</strong>：代码协作的核心，提交代码修改请求，项目维护者审核后合并</li>\n<li><strong>Fork</strong>：复制别人的项目到你的账户，方便独立开发或贡献代码</li>\n<li><strong>Star</strong>：收藏项目，方便日后查找</li>\n<li><strong>Actions</strong>：自动化 CI&#x2F;CD 工具，帮助自动测试和部署</li>\n</ul>\n<h4 id=\"3-GitHub-教育认证与-Copilot-白嫖流程\"><a href=\"#3-GitHub-教育认证与-Copilot-白嫖流程\" class=\"headerlink\" title=\"3. GitHub 教育认证与 Copilot 白嫖流程\"></a>3. GitHub 教育认证与 Copilot 白嫖流程</h4><ul>\n<li><strong>GitHub Copilot</strong>：AI 智能编程助手，自动补全代码、生成函数&#x2F;注释，提升开发效率</li>\n<li><strong>教育认证步骤</strong>：<ol>\n<li>注册并登录 GitHub 账号</li>\n<li>访问 <a href=\"https://education.github.com/\">GitHub Education</a> 页面，点击“Get benefits”或“Apply for Student Developer Pack”</li>\n<li>根据提示填写教育邮箱、学生身份等信息，提交认证</li>\n<li>通过后可免费开通 Copilot（<a href=\"https://github.com/settings/copilot\">Copilot 激活入口</a>）</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"4-GitHub-基础实战流程\"><a href=\"#4-GitHub-基础实战流程\" class=\"headerlink\" title=\"4. GitHub 基础实战流程\"></a>4. GitHub 基础实战流程</h4><ul>\n<li><p><strong>远程仓库协作流程</strong>：</p>\n<ol>\n<li>Fork 项目到个人账户</li>\n<li>Clone 仓库到本地</li>\n<li>新建分支，进行开发</li>\n<li>提交并推送修改到远程分支</li>\n<li>发起 Pull Request，等待项目维护者审核合并</li>\n<li>参与 Issues 讨论，跟进项目进展</li>\n</ol>\n</li>\n<li><p><strong>常见协作场景</strong>：</p>\n<ul>\n<li>团队开发：多人协作同一项目，分工明确，分支合并</li>\n<li>开源贡献：发现项目问题或有新功能建议，可提交 PR 或 Issue</li>\n<li>个人作品：将自己的代码托管公开，展示技术实力</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"5-GitHub-常用术语补充\"><a href=\"#5-GitHub-常用术语补充\" class=\"headerlink\" title=\"5. GitHub 常用术语补充\"></a>5. GitHub 常用术语补充</h4><ul>\n<li><strong>Commit</strong>：每一次代码提交</li>\n<li><strong>Branch</strong>：分支，独立开发环境</li>\n<li><strong>Merge</strong>：合并分支</li>\n<li><strong>Release</strong>：项目发布版本</li>\n<li><strong>Webhook</strong>：自动通知外部服务</li>\n</ul>\n<hr>\n<h3 id=\"Gitee-入门详解\"><a href=\"#Gitee-入门详解\" class=\"headerlink\" title=\"Gitee 入门详解\"></a>Gitee 入门详解</h3><h4 id=\"1-Gitee-是什么？\"><a href=\"#1-Gitee-是什么？\" class=\"headerlink\" title=\"1. Gitee 是什么？\"></a>1. Gitee 是什么？</h4><ul>\n<li><strong>Gitee（码云）</strong>：中国主流的代码托管平台，支持 Git 管理，适合国内团队、企业使用。</li>\n<li>优势：<ul>\n<li>国内访问速度快，无需科学上网</li>\n<li>支持私有仓库免费（适合团队或企业项目）</li>\n<li>与中国开发者生态结合紧密（对接企事业单位、开源中国等）</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-Gitee-账号注册与界面介绍\"><a href=\"#2-Gitee-账号注册与界面介绍\" class=\"headerlink\" title=\"2. Gitee 账号注册与界面介绍\"></a>2. Gitee 账号注册与界面介绍</h4><ul>\n<li><a href=\"https://gitee.com/\">Gitee 注册入口</a></li>\n<li>支持手机号、邮箱注册</li>\n<li>注册流程：填写信息 → 验证 → 完善个人资料</li>\n</ul>\n<h5 id=\"Gitee-主要界面说明\"><a href=\"#Gitee-主要界面说明\" class=\"headerlink\" title=\"Gitee 主要界面说明\"></a>Gitee 主要界面说明</h5><ul>\n<li><strong>项目（Project）</strong>：代码仓库</li>\n<li><strong>问题（Issue）</strong>：项目问题追踪与任务管理</li>\n<li><strong>合并请求（Pull Request）</strong>：代码协作</li>\n<li><strong>收藏、Fork、Watch</strong>：功能与 GitHub 类似</li>\n<li><strong>Gitee Pages</strong>：静态网站托管（个人博客&#x2F;项目文档）</li>\n</ul>\n<h4 id=\"3-Gitee-SSH-Key-配置与项目协作\"><a href=\"#3-Gitee-SSH-Key-配置与项目协作\" class=\"headerlink\" title=\"3. Gitee SSH Key 配置与项目协作\"></a>3. Gitee SSH Key 配置与项目协作</h4><ul>\n<li>SSH Key 配置流程与 GitHub 类似（见上方）</li>\n<li>项目协作流程：<ol>\n<li>创建或 Fork 仓库</li>\n<li>Clone 到本地</li>\n<li>新建分支开发，提交并推送</li>\n<li>发起合并请求</li>\n<li>参与 Issue 讨论</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"4-Gitee-特色功能\"><a href=\"#4-Gitee-特色功能\" class=\"headerlink\" title=\"4. Gitee 特色功能\"></a>4. Gitee 特色功能</h4><ul>\n<li>支持企业版和团队协作</li>\n<li>支持中国主流第三方登录（微信、支付宝等）</li>\n<li>支持私有仓库免费，适合企业内部项目管理</li>\n</ul>\n<hr>\n<h3 id=\"第五部分：GitHub-和-Gitee-的核心功能对比\"><a href=\"#第五部分：GitHub-和-Gitee-的核心功能对比\" class=\"headerlink\" title=\"第五部分：GitHub 和 Gitee 的核心功能对比\"></a>第五部分：GitHub 和 Gitee 的核心功能对比</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>GitHub</th>\n<th>Gitee</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Fork</td>\n<td>复制项目到个人账户</td>\n<td>同样支持复制项目</td>\n</tr>\n<tr>\n<td>Star</td>\n<td>收藏项目</td>\n<td>同样支持收藏项目</td>\n</tr>\n<tr>\n<td>Watch</td>\n<td>订阅项目动态</td>\n<td>支持订阅</td>\n</tr>\n<tr>\n<td>Issues</td>\n<td>提交问题或建议</td>\n<td>问题追踪支持更本地化</td>\n</tr>\n<tr>\n<td>Pull Request</td>\n<td>提交代码修改和合并</td>\n<td>类似功能</td>\n</tr>\n<tr>\n<td>Actions</td>\n<td>自动化 CI&#x2F;CD 工作流</td>\n<td>不支持 Actions</td>\n</tr>\n<tr>\n<td>Pages</td>\n<td>静态网站托管</td>\n<td>提供类似功能</td>\n</tr>\n<tr>\n<td>Releases</td>\n<td>发布稳定版本</td>\n<td>同样支持发布功能</td>\n</tr>\n<tr>\n<td>Webhooks</td>\n<td>自动消息通知</td>\n<td>支持类似功能</td>\n</tr>\n</tbody></table>\n<hr>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ul>\n<li><strong>Git</strong>：本地代码管理和版本控制工具</li>\n<li><strong>GitHub</strong>：全球开源协作、作品展示和技术交流平台</li>\n<li><strong>Gitee</strong>：国内主流代码托管平台，适合本地团队和企业项目协作</li>\n</ul>\n<p><strong>建议：</strong></p>\n<ul>\n<li>日常学习和开源项目优先用 GitHub，参与国际技术社区</li>\n<li>团队&#x2F;企业项目可选用 Gitee，便于国内协作和访问</li>\n<li>熟练掌握 Git 命令和 SSH 配置，提升协作效率</li>\n</ul>\n<hr>\n<h2 id=\"Typora-与-Markdown\"><a href=\"#Typora-与-Markdown\" class=\"headerlink\" title=\"Typora 与 Markdown\"></a>Typora 与 Markdown</h2><h3 id=\"Typora-使用教程\"><a href=\"#Typora-使用教程\" class=\"headerlink\" title=\"Typora 使用教程\"></a>Typora 使用教程</h3><h4 id=\"安装和激活\"><a href=\"#安装和激活\" class=\"headerlink\" title=\"安装和激活\"></a>安装和激活</h4><ul>\n<li>下载 Typora 安装包，运行后一路点击 OK 即可完成安装。</li>\n<li>如果需要激活，将文件夹中的 <strong>winmm.dll</strong> 移动到 Typora 的安装路径下（如 D:\\Program Files\\Typora）。注意此步骤需关闭 Typora 软件，否则会报错。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_3.png\" alt=\"image-20251017092741839\"></p>\n<hr>\n<h4 id=\"插件使用\"><a href=\"#插件使用\" class=\"headerlink\" title=\"插件使用\"></a>插件使用</h4><ul>\n<li>推荐安装 <a href=\"https://github.com/obgnail/typora_plugin\">typora_plugin</a>：可以显著优化 Typora 的使用体验，按官方文档安装即可。</li>\n<li>论文工具<a href=\"https://github.com/Keldos-Li/typora-latex-theme\">typora-latex-theme</a>：对于没有学过office三件套或WPS的同学大有帮助。</li>\n</ul>\n<hr>\n<h4 id=\"建议配置\"><a href=\"#建议配置\" class=\"headerlink\" title=\"建议配置\"></a>建议配置</h4><h5 id=\"侧边栏设置\"><a href=\"#侧边栏设置\" class=\"headerlink\" title=\"侧边栏设置\"></a>侧边栏设置</h5><ul>\n<li>建议将侧边栏打开，便于查看和管理文档结构。</li>\n<li>在 Typora 主界面点击右下角的 <code>显示/隐藏侧边栏</code> 按钮即可。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_4.png\" alt=\"image-20251017093303047\"></p>\n<hr>\n<h5 id=\"文件配置\"><a href=\"#文件配置\" class=\"headerlink\" title=\"文件配置\"></a>文件配置</h5><ul>\n<li>进入 Typora 菜单栏 <code>文件 -&gt; 偏好设置</code>，进行文件相关配置。</li>\n<li>推荐按照下图设置，便于文档管理与文件归档。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_5.png\" alt=\"image-20251017093318594\"></p>\n<hr>\n<h5 id=\"编辑器配置\"><a href=\"#编辑器配置\" class=\"headerlink\" title=\"编辑器配置\"></a>编辑器配置</h5><ul>\n<li>推荐启用智能缩进、自动补全 Markdown 字符、统一行尾符号等功能，提升编辑效率，减少语法出错。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_6.png\" alt=\"image-20251017093327185\"></p>\n<hr>\n<h5 id=\"图片配置\"><a href=\"#图片配置\" class=\"headerlink\" title=\"图片配置\"></a>图片配置</h5><ul>\n<li>插入图片时，建议选择自动复制图片到当前 md 文件同名的 assets 文件夹下，方便文档迁移和分享。  </li>\n<li>推荐勾选：  <ul>\n<li>自动上传图片到 assets 文件夹</li>\n<li>优化图片路径显示</li>\n<li>生成图片相对路径</li>\n</ul>\n</li>\n<li>图片插入后，建议压缩图片或生成缩略图，减少文档体积。</li>\n</ul>\n<hr>\n<h5 id=\"Markdown-配置\"><a href=\"#Markdown-配置\" class=\"headerlink\" title=\"Markdown 配置\"></a>Markdown 配置</h5><p>我们在这里可以配置markdown的语法相关，我的建议是全部勾上（除了那个首行缩进&lt;这是个人喜好</p>\n<p>&gt;），一定勾选上那个图表，这样可以让typora对mermaid等图表代码直接进行渲染，下面的公式编号还是看个人情况，这里就不过多说了</p>\n<ul>\n<li>建议开启 Typora 对 mermaid 图表和数学公式的支持，方便画流程图和写公式。</li>\n<li>推荐设置常用语法快捷键，提升编辑效率。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_8.png\" alt=\"image-20251017093521861\"></p>\n<hr>\n<h5 id=\"导出配置\"><a href=\"#导出配置\" class=\"headerlink\" title=\"导出配置\"></a>导出配置</h5><ul>\n<li>可根据个人需求设置 PDF 导出参数，包括页面大小、边距等。</li>\n<li>支持设置 YAML 头信息（如 title、author），导出时自动识别并加到对应位置。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_9.png\" alt=\"image-20251017093617999\"></p>\n<hr>\n<h5 id=\"外观配置\"><a href=\"#外观配置\" class=\"headerlink\" title=\"外观配置\"></a>外观配置</h5><ul>\n<li>推荐使用「经典」模式，字体大小和主题可按个人习惯调整，支持多种主题切换（如 HappySimple、Jetbrains Mono Theme 等）。</li>\n</ul>\n<p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_10.png\" alt=\"image-20251017093703523\"></p>\n<ul>\n<li>主题获取途径：<ul>\n<li><a href=\"https://theme.typora.io/\">Themes Gallery – Typora</a></li>\n<li>GitHub 搜索 typora theme</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h5 id=\"通用配置\"><a href=\"#通用配置\" class=\"headerlink\" title=\"通用配置\"></a>通用配置</h5><p><img src=\"/images/Git_Github_Markdown/Git_Github_Markdown_11.png\" alt=\"image-20251017093728150\"></p>\n<ul>\n<li>建议关闭自动检查更新和开发版更新，稳定性更好。</li>\n<li>可自定义快捷键，提升操作效率。</li>\n</ul>\n<hr>\n<h4 id=\"主题美化\"><a href=\"#主题美化\" class=\"headerlink\" title=\"主题美化\"></a>主题美化</h4><ul>\n<li>推荐主题：<ul>\n<li><strong>Neil Jetbrains Mono Theme</strong>：适合 Jetbrains 系 IDE 用户，字体美观，界面简洁。</li>\n<li><strong>HappySimple</strong>：视觉舒适，适合日常写作和学习。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"Markdown-使用教程\"><a href=\"#Markdown-使用教程\" class=\"headerlink\" title=\"Markdown 使用教程\"></a>Markdown 使用教程</h3><h4 id=\"一、什么是-Markdown？\"><a href=\"#一、什么是-Markdown？\" class=\"headerlink\" title=\"一、什么是 Markdown？\"></a>一、什么是 Markdown？</h4><p>Markdown 是一种轻量级的标记语言，设计用于让普通文本具有丰富的格式表现，同时保留文案内容的易读性和易写性。通过简单直观的标记符号实现文档格式化，广泛应用于技术文档、博客文章、电子邮件、笔记和协作文档等。</p>\n<hr>\n<h4 id=\"二、为什么选择-Markdown？\"><a href=\"#二、为什么选择-Markdown？\" class=\"headerlink\" title=\"二、为什么选择 Markdown？\"></a>二、为什么选择 Markdown？</h4><ol>\n<li><strong>简单直观</strong>：语法易学易用，常见标记符号即可快速上手。</li>\n<li><strong>跨平台支持</strong>：兼容多种工具和平台，如 GitHub、Notion、VS Code、Jupyter Notebook 等。</li>\n<li><strong>多格式输出</strong>：可转为 HTML、PDF、Word 等多种格式，满足不同需求。</li>\n<li><strong>专注创作</strong>：无需复杂排版工具，专注内容本身，提升写作效率。</li>\n</ol>\n<hr>\n<h4 id=\"三、Markdown-语法详解\"><a href=\"#三、Markdown-语法详解\" class=\"headerlink\" title=\"三、Markdown 语法详解\"></a>三、Markdown 语法详解</h4><h5 id=\"1-标题\"><a href=\"#1-标题\" class=\"headerlink\" title=\"1. 标题\"></a>1. 标题</h5><p>使用 <code>#</code> 符号表示标题，支持六级标题，<code>#</code> 的数量代表标题级别。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\"># 一级标题</span></span><br><span class=\"line\"><span class=\"section\">## 二级标题</span></span><br><span class=\"line\"><span class=\"section\">### 三级标题</span></span><br><span class=\"line\"><span class=\"section\">#### 四级标题</span></span><br><span class=\"line\"><span class=\"section\">##### 五级标题</span></span><br><span class=\"line\"><span class=\"section\">###### 六级标题</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"2-段落与换行\"><a href=\"#2-段落与换行\" class=\"headerlink\" title=\"2. 段落与换行\"></a>2. 段落与换行</h5><p>普通文本直接书写即可。若需换行，在行尾添加两个空格。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这是一段文字，行尾加两个空格后换行。  </span><br><span class=\"line\">这是下一行。</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"3-强调\"><a href=\"#3-强调\" class=\"headerlink\" title=\"3. 强调\"></a>3. 强调</h5><p>支持斜体和加粗，以及两者组合。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"emphasis\">*斜体*</span> 或 <span class=\"emphasis\">_斜体_</span></span><br><span class=\"line\"><span class=\"strong\">**加粗**</span> 或 <span class=\"strong\">__加粗__</span></span><br><span class=\"line\"><span class=\"strong\">**<span class=\"emphasis\">*斜体加粗*</span>**</span> 或 <span class=\"strong\">__<span class=\"emphasis\">_斜体加粗_</span>__</span></span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li><em>斜体</em></li>\n<li><strong>加粗</strong></li>\n<li><em><strong>斜体加粗</strong></em></li>\n</ul>\n<hr>\n<h5 id=\"4-列表\"><a href=\"#4-列表\" class=\"headerlink\" title=\"4. 列表\"></a>4. 列表</h5><p>支持无序列表和有序列表。</p>\n<h6 id=\"无序列表\"><a href=\"#无序列表\" class=\"headerlink\" title=\"无序列表\"></a>无序列表</h6><p>使用 <code>-</code>、<code>*</code> 或 <code>+</code> 作为标记符。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">-</span> 项目一</span><br><span class=\"line\"><span class=\"bullet\">-</span> 项目二</span><br><span class=\"line\"><span class=\"bullet\">  -</span> 子项目一</span><br><span class=\"line\"><span class=\"bullet\">  -</span> 子项目三</span><br><span class=\"line\"><span class=\"bullet\">*</span> 项目三</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li>项目一</li>\n<li>项目二<ul>\n<li>子项目一</li>\n<li>子项目三</li>\n</ul>\n</li>\n<li>项目三</li>\n</ul>\n<h6 id=\"有序列表\"><a href=\"#有序列表\" class=\"headerlink\" title=\"有序列表\"></a>有序列表</h6><p>使用数字加点 <code>1.</code>，数字顺序可不连续，最终会按顺序渲染。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1.</span> 项目一</span><br><span class=\"line\"><span class=\"bullet\">2.</span> 项目二</span><br><span class=\"line\"><span class=\"bullet\">   1.</span> 子项目一</span><br><span class=\"line\"><span class=\"bullet\">   2.</span> 子项目二</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ol>\n<li>项目一</li>\n<li>项目二<ol>\n<li>子项目一</li>\n<li>子项目二</li>\n</ol>\n</li>\n</ol>\n<hr>\n<h5 id=\"5-链接\"><a href=\"#5-链接\" class=\"headerlink\" title=\"5. 链接\"></a>5. 链接</h5><p>添加超链接：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">链接文字</span>](<span class=\"link\">链接地址</span>)</span><br><span class=\"line\">[<span class=\"string\">google</span>](<span class=\"link\">https://www.google.com</span>)</span><br></pre></td></tr></table></figure>\n\n<p>带标题提示：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">链接文字</span>](<span class=\"link\">链接地址 &quot;标题提示&quot;</span>)</span><br><span class=\"line\">[<span class=\"string\">google</span>](<span class=\"link\">https://www.google.com &quot;谷歌搜索&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>效果如下：<br><a href=\"https://www.google.com/\">Google</a><br><a href=\"https://www.google.com/\" title=\"谷歌搜索\">Google</a></p>\n<hr>\n<h5 id=\"6-图片\"><a href=\"#6-图片\" class=\"headerlink\" title=\"6. 图片\"></a>6. 图片</h5><p>添加图片与链接类似，只需在前面加一个 <code>!</code>。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\">图片描述</span>](<span class=\"link\">图片地址</span>)</span><br><span class=\"line\">![<span class=\"string\">鹿乃.jpg</span>](<span class=\"link\">https://s2.loli.net/2024/10/27/I1iqvzVtnxEYuaT.jpg</span>)</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h5 id=\"7-引用\"><a href=\"#7-引用\" class=\"headerlink\" title=\"7. 引用\"></a>7. 引用</h5><p>引用使用 <code>&gt;</code> 进行标记，支持嵌套引用。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"quote\">&gt; 这是一个引用。</span></span><br><span class=\"line\">&gt;&gt; 这是嵌套引用。</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<blockquote>\n<p>这是一个引用。</p>\n<blockquote>\n<p>这是嵌套引用。</p>\n</blockquote>\n</blockquote>\n<hr>\n<h5 id=\"8-代码块\"><a href=\"#8-代码块\" class=\"headerlink\" title=\"8. 代码块\"></a>8. 代码块</h5><h6 id=\"行内代码\"><a href=\"#行内代码\" class=\"headerlink\" title=\"行内代码\"></a>行内代码</h6><p>用反引号（&#96;）包裹。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"code\">`这是行内代码`</span> 示例。</span><br></pre></td></tr></table></figure>\n\n<p>效果：<code>这是行内代码</code> 示例。</p>\n<h6 id=\"多行代码块\"><a href=\"#多行代码块\" class=\"headerlink\" title=\"多行代码块\"></a>多行代码块</h6><p>用三个反引号（&#96;&#96;&#96;）包裹，可指定语言高亮。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"code\">``` python</span></span><br><span class=\"line\"><span class=\"code\">def hello():</span></span><br><span class=\"line\"><span class=\"code\">    print(&quot;Hello, Markdown!&quot;)</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">效果如下：</span><br><span class=\"line\"></span><br><span class=\"line\">```python</span><br><span class=\"line\">def hello():</span><br><span class=\"line\">    print(&quot;Hello, Markdown!&quot;)</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h5 id=\"9-表格\"><a href=\"#9-表格\" class=\"headerlink\" title=\"9. 表格\"></a>9. 表格</h5><p>使用 <code>|</code> 和 <code>-</code> 创建表格。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">| 表头1 | 表头2 | 表头3 |</span><br><span class=\"line\">|-------|-------|-------|</span><br><span class=\"line\">| 数据1 | 数据2 | 数据3 |</span><br><span class=\"line\">| 数据4 | 数据5 | 数据6 |</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<table>\n<thead>\n<tr>\n<th>表头 1</th>\n<th>表头 2</th>\n<th>表头 3</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>数据 1</td>\n<td>数据 2</td>\n<td>数据 3</td>\n</tr>\n<tr>\n<td>数据 4</td>\n<td>数据 5</td>\n<td>数据 6</td>\n</tr>\n</tbody></table>\n<hr>\n<h5 id=\"10-分隔线\"><a href=\"#10-分隔线\" class=\"headerlink\" title=\"10. 分隔线\"></a>10. 分隔线</h5><p>用三个或更多的 <code>-</code>、<code>*</code> 或 <code>_</code> 创建分隔线。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\"><span class=\"strong\">***</span></span><br><span class=\"line\"><span class=\"strong\">__<span class=\"emphasis\">_</span></span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"效果如下：\"><a href=\"#效果如下：\" class=\"headerlink\" title=\"效果如下：\"></a>效果如下：</h4><hr>\n<h4 id=\"任务列表\"><a href=\"#任务列表\" class=\"headerlink\" title=\"任务列表\"></a>任务列表</h4><p>用 <code>- [ ]</code> 创建未完成任务，<code>- [x]</code> 创建已完成任务。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">-</span> [ ] 任务一</span><br><span class=\"line\"><span class=\"bullet\">-</span> [x] 任务二</span><br><span class=\"line\"><span class=\"bullet\">-</span> [ ] 任务三</span><br></pre></td></tr></table></figure>\n\n<p>效果：</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\"> 任务一</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> 任务二</li>\n<li><input disabled=\"\" type=\"checkbox\"> 任务三</li>\n</ul>\n<hr>\n<h5 id=\"12-公式\"><a href=\"#12-公式\" class=\"headerlink\" title=\"12. 公式\"></a>12. 公式</h5><p>支持 LaTeX 数学公式（部分编辑器&#x2F;平台需开启支持）。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$\\frac&#123;a&#125;&#123;b&#125;$</span><br></pre></td></tr></table></figure>\n\n<p>效果：$\\frac{a}{b}$</p>\n<hr>\n<h5 id=\"13-mermaid-绘图\"><a href=\"#13-mermaid-绘图\" class=\"headerlink\" title=\"13. mermaid 绘图\"></a>13. mermaid 绘图</h5><p>支持流程图、时序图等（需平台支持）。</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">A[串口中断接收] --&gt; B&#123;中断号判断&#125;</span><br><span class=\"line\">B --&gt;|USART1 或 USART2| C[堆栈寄存器压入\\n]</span><br><span class=\"line\">C --&gt; B</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h3 id=\"Typora-快捷键速查表\"><a href=\"#Typora-快捷键速查表\" class=\"headerlink\" title=\"Typora 快捷键速查表\"></a>Typora 快捷键速查表</h3><table>\n<thead>\n<tr>\n<th>功能</th>\n<th>快捷键（Windows）</th>\n<th>快捷键（Mac）</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>加粗</td>\n<td>Ctrl + B</td>\n<td>Cmd + B</td>\n<td>选中内容加粗</td>\n</tr>\n<tr>\n<td>斜体</td>\n<td>Ctrl + I</td>\n<td>Cmd + I</td>\n<td>选中内容斜体</td>\n</tr>\n<tr>\n<td>插入标题</td>\n<td>Ctrl + 1 ~ Ctrl + 6</td>\n<td>Cmd + 1 ~ Cmd + 6</td>\n<td>对应一级至六级标题</td>\n</tr>\n<tr>\n<td>插入无序列表</td>\n<td>Ctrl + Shift + U</td>\n<td>Cmd + Shift + U</td>\n<td>快速插入无序列表</td>\n</tr>\n<tr>\n<td>插入有序列表</td>\n<td>Ctrl + Shift + O</td>\n<td>Cmd + Shift + O</td>\n<td>快速插入有序列表</td>\n</tr>\n<tr>\n<td>插入任务列表</td>\n<td>Ctrl + Shift + C</td>\n<td>Cmd + Shift + C</td>\n<td>插入 <code>- [ ]</code> 任务项</td>\n</tr>\n<tr>\n<td>插入代码块</td>\n<td>Ctrl + Shift + K</td>\n<td>Cmd + Option + K</td>\n<td>插入三反引号代码块（块级代码）</td>\n</tr>\n<tr>\n<td>插入行内代码</td>\n<td>Ctrl + E</td>\n<td>Cmd + E</td>\n<td>插入行内代码（单反引号）</td>\n</tr>\n<tr>\n<td>插入图片</td>\n<td>Ctrl + Shift + I</td>\n<td>Cmd + Shift + I</td>\n<td>打开插入图片对话框</td>\n</tr>\n<tr>\n<td>插入链接</td>\n<td>Ctrl + K</td>\n<td>Cmd + K</td>\n<td>插入超链接</td>\n</tr>\n<tr>\n<td>插入引用</td>\n<td>Ctrl + Shift + Q</td>\n<td>Cmd + Shift + Q</td>\n<td>插入引用 &gt;</td>\n</tr>\n<tr>\n<td>插入表格</td>\n<td>Ctrl + T</td>\n<td>Cmd + T</td>\n<td>打开插入表格面板</td>\n</tr>\n<tr>\n<td>插入公式</td>\n<td>Ctrl + Shift + M</td>\n<td>Cmd + Shift + M</td>\n<td>插入公式块（$$）</td>\n</tr>\n<tr>\n<td>插入Mermaid图</td>\n<td>Ctrl + Shift + G</td>\n<td>Cmd + Shift + G</td>\n<td>插入mermaid绘图代码块</td>\n</tr>\n<tr>\n<td>切换专注模式</td>\n<td>F8</td>\n<td>F8</td>\n<td>切换专注模式（Focus Mode）</td>\n</tr>\n<tr>\n<td>打开&#x2F;关闭侧边栏</td>\n<td>Ctrl + &#x2F;</td>\n<td>Cmd + &#x2F;</td>\n<td>显示或隐藏左侧目录栏</td>\n</tr>\n<tr>\n<td>查找</td>\n<td>Ctrl + F</td>\n<td>Cmd + F</td>\n<td>查找文本</td>\n</tr>\n<tr>\n<td>替换</td>\n<td>Ctrl + H</td>\n<td>Cmd + Option + F</td>\n<td>查找并替换文本</td>\n</tr>\n<tr>\n<td>保存</td>\n<td>Ctrl + S</td>\n<td>Cmd + S</td>\n<td>保存文档</td>\n</tr>\n<tr>\n<td>导出</td>\n<td>Ctrl + Shift + E</td>\n<td>Cmd + Shift + E</td>\n<td>导出为PDF、HTML等格式</td>\n</tr>\n<tr>\n<td>打开偏好设置</td>\n<td>Ctrl + ,</td>\n<td>Cmd + ,</td>\n<td>打开Typora设置</td>\n</tr>\n<tr>\n<td>新建文档</td>\n<td>Ctrl + N</td>\n<td>Cmd + N</td>\n<td>新建一个空白文档</td>\n</tr>\n<tr>\n<td>打开文档</td>\n<td>Ctrl + O</td>\n<td>Cmd + O</td>\n<td>打开本地文档</td>\n</tr>\n<tr>\n<td>关闭文档</td>\n<td>Ctrl + W</td>\n<td>Cmd + W</td>\n<td>关闭当前标签页</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p><strong>提示：</strong><br>Typora 支持自定义快捷键，部分功能可在 “偏好设置” &gt; “快捷键”中自定义。<br>常用操作如插入代码块、插入图片、切换侧边栏等快捷键建议多加练习，提升效率。</p>\n</blockquote>\n<hr>\n<h2 id=\"插件与刷课脚本部分\"><a href=\"#插件与刷课脚本部分\" class=\"headerlink\" title=\"插件与刷课脚本部分\"></a>插件与刷课脚本部分</h2><h3 id=\"一、浏览器插件简介\"><a href=\"#一、浏览器插件简介\" class=\"headerlink\" title=\"一、浏览器插件简介\"></a>一、浏览器插件简介</h3><h4 id=\"1-什么是浏览器插件？\"><a href=\"#1-什么是浏览器插件？\" class=\"headerlink\" title=\"1. 什么是浏览器插件？\"></a>1. 什么是浏览器插件？</h4><p>浏览器插件（扩展）是一种可以为浏览器增加新功能的小型程序。它们能够帮助用户实现自动化、界面美化、广告屏蔽、脚本自定义等功能，极大提升日常上网体验和效率。</p>\n<hr>\n<h4 id=\"2-油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\"><a href=\"#2-油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\" class=\"headerlink\" title=\"2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比\"></a>2. 油猴（Tampermonkey）与篡改猴（Violentmonkey）简介与对比</h4><p><strong>油猴（Tampermonkey）</strong> 和 <strong>篡改猴（Violentmonkey）</strong> 都是浏览器端最主流的用户脚本管理器插件，能够让用户轻松安装、管理和运行自定义脚本（如刷课、自动答题、网页优化等）。</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>油猴（Tampermonkey）</th>\n<th>篡改猴（Violentmonkey）</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>兼容性</td>\n<td>Chrome&#x2F;Edge&#x2F;Firefox&#x2F;Safari</td>\n<td>Chrome&#x2F;Edge&#x2F;Firefox&#x2F;Opera</td>\n</tr>\n<tr>\n<td>界面</td>\n<td>功能丰富，设置选项更多</td>\n<td>界面简洁，轻量，易用</td>\n</tr>\n<tr>\n<td>脚本支持</td>\n<td>支持几乎所有主流用户脚本</td>\n<td>支持大部分脚本，兼容性优秀</td>\n</tr>\n<tr>\n<td>开发者</td>\n<td>国外团队</td>\n<td>国外团队（有国人参与）</td>\n</tr>\n<tr>\n<td>推荐场景</td>\n<td>需要高级管理&#x2F;脚本较多的用户</td>\n<td>追求简洁&#x2F;轻量的用户</td>\n</tr>\n</tbody></table>\n<p><strong>小结：</strong></p>\n<ul>\n<li>油猴（Tampermonkey）适合大多数用户，功能更全，兼容性最好，推荐新手优先选择。</li>\n<li>篡改猴（Violentmonkey）更轻量，界面简洁，资源占用更低。</li>\n</ul>\n<hr>\n<h4 id=\"3-安装方法\"><a href=\"#3-安装方法\" class=\"headerlink\" title=\"3. 安装方法\"></a>3. 安装方法</h4><p><strong>a. Chrome 浏览器：</strong></p>\n<ul>\n<li><p>推荐前往 <a href=\"https://www.crxsoso.com/search\">crx搜搜插件网</a> 搜索「Tampermonkey」或「Violentmonkey」并下载安装（国内无需科学上网）。</p>\n<blockquote>\n<p>聚合了 Chrome、Edge、Firefox 各类插件和油猴脚本，国内访问速度快，适合查找各类扩展和脚本。</p>\n</blockquote>\n</li>\n<li><p>也可去 <a href=\"https://chrome.google.com/webstore/\">Chrome Web Store</a> 安装（需科学上网）。</p>\n</li>\n</ul>\n<p><strong>b. Edge 浏览器：</strong></p>\n<ul>\n<li>可在 Edge 插件商店或 crx搜搜 搜索并安装。</li>\n</ul>\n<p><strong>c. Firefox 浏览器：</strong></p>\n<ul>\n<li>前往 <a href=\"https://addons.mozilla.org/\">Firefox 附加组件</a> 搜索并安装。</li>\n</ul>\n<hr>\n<h3 id=\"OCS网课助手与刷课脚本\"><a href=\"#OCS网课助手与刷课脚本\" class=\"headerlink\" title=\"OCS网课助手与刷课脚本\"></a>OCS网课助手与刷课脚本</h3><h4 id=\"OCS网课助手简介\"><a href=\"#OCS网课助手简介\" class=\"headerlink\" title=\"OCS网课助手简介\"></a>OCS网课助手简介</h4><p>OCS网课助手是一款专为网课平台（如超星、智慧树、学堂在线等）开发的刷课插件，能实现自动播放、刷视频、自动答题等功能，大大提高网课学习效率。适合需要快速完成网课任务的同学。</p>\n<ul>\n<li><strong>官网&#x2F;项目主页</strong>：<a href=\"https://docs.ocsjs.com/\">OCS网课助手</a></li>\n<li><strong>主要功能</strong>：<ul>\n<li>自动刷视频、自动答题、自动过考试</li>\n<li>支持多个主流网课平台</li>\n<li>可配合题库使用（如教材&#x2F;言溪题库等）</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"言溪题库简介\"><a href=\"#言溪题库简介\" class=\"headerlink\" title=\"言溪题库简介\"></a>言溪题库简介</h4><ul>\n<li><p><strong>官网主页</strong>：<a href=\"https://tk.enncy.cn/\">言溪题库</a></p>\n</li>\n<li><p>提供超星、智慧树等平台的题目答案，可提升刷课和自动答题的正确率。</p>\n</li>\n<li><p>常见用法：在 OCS 等刷课插件设置里绑定题库接口，或手动查找题目答案。</p>\n</li>\n</ul>\n<h4 id=\"WE-Learn-U校园刷课脚本与教程\"><a href=\"#WE-Learn-U校园刷课脚本与教程\" class=\"headerlink\" title=\"WE Learn &amp; U校园刷课脚本与教程\"></a>WE Learn &amp; U校园刷课脚本与教程</h4><ul>\n<li><strong>EOC 一站式刷课脚本合集</strong>：<a href=\"https://ssmjae.github.io/EOC/\">EOC项目主页</a><ul>\n<li>该网站提供了针对多种主流校园网课平台（如 WE Learn、U校园等）的刷课脚本及详细教程。</li>\n<li>主要功能包括：<ul>\n<li>自动刷视频、自动答题、自动完成作业、考试辅助等</li>\n<li>支持多平台、多类型课程的自动化处理</li>\n<li>提供详细的安装流程、脚本下载链接、常见问题解答</li>\n</ul>\n</li>\n<li>网站内容持续更新，适合自助查找和学习刷课自动化工具</li>\n</ul>\n</li>\n</ul>\n<p><strong>使用建议：</strong></p>\n<ul>\n<li>进入 EOC 项目主页后，根据你的网课平台（如 WE Learn、U校园）选择对应脚本和教程，按照页面说明进行安装和使用。</li>\n<li>建议优先使用油猴（Tampermonkey）或篡改猴（Violentmonkey）插件进行脚本管理，确保兼容性和脚本运行稳定。</li>\n<li>脚本仅供学习和便捷课程管理使用，切勿用于违规用途。</li>\n</ul>\n<hr>\n<p><strong>实用建议：</strong></p>\n<ul>\n<li>插件和脚本建议只从知名平台和官方渠道下载，避免安全风险。</li>\n<li>使用脚本前请详细阅读说明，注意账号安全，不要泄露个人信息。</li>\n<li>刷课脚本仅供学习交流，勿用于违规用途。</li>\n</ul>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cmkh5iivn000524j37nt6ep1s","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivp000d24j31d1gcarx"},{"post_id":"cmkh5iivi000024j39efd8pir","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000h24j3b1w66t8u"},{"post_id":"cmkh5iivn000624j3f2jzh7af","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000i24j3hej651r0"},{"post_id":"cmkh5iivo000a24j326jr9583","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000l24j3eumaewsv"},{"post_id":"cmkh5iivk000124j3fxf58sat","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000n24j3g0kd1y8n"},{"post_id":"cmkh5iivq000g24j3ck1bcu8q","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000q24j3ff2t8twa"},{"post_id":"cmkh5iivm000424j3cr6u8ta9","category_id":"cmkh5iivl000224j3f85q2bmk","_id":"cmkh5iivq000s24j39wvu5mcn"}],"PostTag":[{"post_id":"cmkh5iivn000524j37nt6ep1s","tag_id":"cmkh5iivm000324j3arp23tdu","_id":"cmkh5iivo000924j389s686gu"},{"post_id":"cmkh5iivn000624j3f2jzh7af","tag_id":"cmkh5iivm000324j3arp23tdu","_id":"cmkh5iivp000b24j3apkzfw3l"},{"post_id":"cmkh5iivq000g24j3ck1bcu8q","tag_id":"cmkh5iivm000324j3arp23tdu","_id":"cmkh5iivq000k24j32oh2cp5p"},{"post_id":"cmkh5iivq000g24j3ck1bcu8q","tag_id":"cmkh5iivo000824j3g5figz9a","_id":"cmkh5iivq000m24j3drj247uj"},{"post_id":"cmkh5iivi000024j39efd8pir","tag_id":"cmkh5iivm000324j3arp23tdu","_id":"cmkh5iivq000p24j38de96bau"},{"post_id":"cmkh5iivi000024j39efd8pir","tag_id":"cmkh5iivo000824j3g5figz9a","_id":"cmkh5iivq000r24j3e529ev16"},{"post_id":"cmkh5iivi000024j39efd8pir","tag_id":"cmkh5iivp000f24j3fhfc66h8","_id":"cmkh5iivq000u24j35kfd8e6f"},{"post_id":"cmkh5iivk000124j3fxf58sat","tag_id":"cmkh5iivm000324j3arp23tdu","_id":"cmkh5iivr000w24j3czw14muc"},{"post_id":"cmkh5iivk000124j3fxf58sat","tag_id":"cmkh5iivo000824j3g5figz9a","_id":"cmkh5iivr000x24j36irk0kfi"},{"post_id":"cmkh5iivk000124j3fxf58sat","tag_id":"cmkh5iivp000f24j3fhfc66h8","_id":"cmkh5iivr000z24j3fwuec5vb"},{"post_id":"cmkh5iivm000424j3cr6u8ta9","tag_id":"cmkh5iivr000v24j31au91yoz","_id":"cmkh5iivr001124j3fcsuaeco"},{"post_id":"cmkh5iivm000424j3cr6u8ta9","tag_id":"cmkh5iivr000y24j335wm9txq","_id":"cmkh5iivr001224j32n9z2505"},{"post_id":"cmkh5iivo000a24j326jr9583","tag_id":"cmkh5iivr001024j3323k677o","_id":"cmkh5iivr001324j3dkye4fsw"}],"Tag":[{"name":"技术","_id":"cmkh5iivm000324j3arp23tdu"},{"name":"教程","_id":"cmkh5iivo000824j3g5figz9a"},{"name":"Openwrt","_id":"cmkh5iivp000f24j3fhfc66h8"},{"name":"Hexo","_id":"cmkh5iivr000v24j31au91yoz"},{"name":"博客","_id":"cmkh5iivr000y24j335wm9txq"},{"name":"c","_id":"cmkh5iivr001024j3323k677o"}]}}